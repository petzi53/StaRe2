<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.4.349" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />


<title>Personal Notes: Statistical Rethinking (2nd ed) – 3  Sampling the Imaginary</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="quarto.css" />
<link rel="stylesheet" href="glossary.css" />
</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn"
      data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" 
      aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
      onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <h1 class="quarto-secondary-nav-title no-breadcrumbs"></h1>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" 
        aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
        onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="/">
      Personal Notes: Statistical Rethinking (2nd ed)
      </a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/petzi53/statistical-rethinking-2-2023"  title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/01-golem-of-prague.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>1</span>  <span class='chapter-title'>Golem of Prague</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/02-small-and-large-worlds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>Small and Large Worlds</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/03-sampling-the-imaginary.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class='chapter-number'>3</span>  <span class='chapter-title'>Sampling the Imaginary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/04-geocentric-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>4</span>  <span class='chapter-title'>Geocentric Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/05-many-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>5</span>  <span class='chapter-title'>The Many Variables & The Spurious Waffles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/95-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/96-quarto-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>A</span>  <span class='chapter-title'>Comments about using Quarto</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" ></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-chap03" class="quarto-section-identifier"><span class="chapter-number">3</span>  <span class="chapter-title">Sampling the Imaginary</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>
<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#vampire-example" id="toc-vampire-example">Vampire Example</a>
  <ul>
  <li><a href="#original" id="toc-original">ORIGINAL</a>
  <ul>
  <li><a href="#a-medical-test-scenario-with-bayes-theorem" id="toc-a-medical-test-scenario-with-bayes-theorem">a) Medical Test Scenario with Bayes theorem</a></li>
  <li><a href="#b-medical-test-scenario-with-natural-frequencies" id="toc-b-medical-test-scenario-with-natural-frequencies">b) Medical test scenario with natural frequencies</a></li>
  </ul></li>
  <li><a href="#tidyverse" id="toc-tidyverse">TIDYVERSE</a>
  <ul>
  <li><a href="#a-medical-test-scenario-with-bayes-theorem-1" id="toc-a-medical-test-scenario-with-bayes-theorem-1">a) Medical Test Scenario with Bayes theorem</a></li>
  <li><a href="#b-medical-test-scenario-with-natural-frequencies-1" id="toc-b-medical-test-scenario-with-natural-frequencies-1">b) Medical test scenario with natural frequencies</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-chap-03-sampling-grid" id="toc-sec-chap-03-sampling-grid"><span class="header-section-number">3.1</span> Sampling from a grid-approximate posterior</a>
  <ul>
  <li><a href="#original-1" id="toc-original-1"><span class="header-section-number">3.1.1</span> ORIGINAL</a></li>
  <li><a href="#tidyverse-1" id="toc-tidyverse-1"><span class="header-section-number">3.1.2</span> TIDYVERSE</a></li>
  </ul></li>
  <li><a href="#sec-sampling-to-summarize" id="toc-sec-sampling-to-summarize"><span class="header-section-number">3.2</span> Sampling to Summarize</a>
  <ul>
  <li><a href="#sec-chap-03-defined-boundaries" id="toc-sec-chap-03-defined-boundaries"><span class="header-section-number">3.2.1</span> Intervals of Defined Boundaries</a>
  <ul>
  <li><a href="#original-2" id="toc-original-2"><span class="header-section-number">3.2.1.1</span> ORIGINAL</a>
  <ul>
  <li><a href="#grid-approximate-posterior" id="toc-grid-approximate-posterior"><span class="header-section-number">3.2.1.1.1</span> Grid-approximate Posterior</a></li>
  <li><a href="#samples-from-the-posterior" id="toc-samples-from-the-posterior"><span class="header-section-number">3.2.1.1.2</span> Samples from the Posterior</a></li>
  </ul></li>
  <li><a href="#tidyverse-2" id="toc-tidyverse-2"><span class="header-section-number">3.2.1.2</span> TIDYVERSE</a>
  <ul>
  <li><a href="#grid-approximate-posterior-1" id="toc-grid-approximate-posterior-1"><span class="header-section-number">3.2.1.2.1</span> Grid-approximate Posterior</a></li>
  <li><a href="#samples-from-the-posterior-1" id="toc-samples-from-the-posterior-1"><span class="header-section-number">3.2.1.2.2</span> Samples from the Posterior</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-chap-03-probability-mass" id="toc-sec-chap-03-probability-mass"><span class="header-section-number">3.2.2</span> Intervals of Defined Probability Mass</a>
  <ul>
  <li><a href="#original-3" id="toc-original-3"><span class="header-section-number">3.2.2.1</span> ORIGINAL</a>
  <ul>
  <li><a href="#quantiles" id="toc-quantiles"><span class="header-section-number">3.2.2.1.1</span> Quantiles</a></li>
  <li><a href="#percentile-interval-pi" id="toc-percentile-interval-pi"><span class="header-section-number">3.2.2.1.2</span> Percentile Interval (PI)</a></li>
  <li><a href="#highest-posterior-density-interval-hpdi" id="toc-highest-posterior-density-interval-hpdi"><span class="header-section-number">3.2.2.1.3</span> Highest Posterior Density Interval (HPDI)</a></li>
  </ul></li>
  <li><a href="#tidyverse-3" id="toc-tidyverse-3"><span class="header-section-number">3.2.2.2</span> TIDYVERSE</a>
  <ul>
  <li><a href="#quantiles-1" id="toc-quantiles-1"><span class="header-section-number">3.2.2.2.1</span> Quantiles</a></li>
  <li><a href="#percentile-interval-pi-1" id="toc-percentile-interval-pi-1"><span class="header-section-number">3.2.2.2.2</span> Percentile Interval (PI)</a></li>
  <li><a href="#introducing-tidybayes" id="toc-introducing-tidybayes">Introducing tidybayes</a></li>
  <li><a href="#highest-posterior-density-interval-hpdi-1" id="toc-highest-posterior-density-interval-hpdi-1"><span class="header-section-number">3.2.2.2.3</span> Highest Posterior Density Interval (HPDI)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-chap-03-point-estimates" id="toc-sec-chap-03-point-estimates"><span class="header-section-number">3.2.3</span> Point Estimates</a>
  <ul>
  <li><a href="#original-4" id="toc-original-4"><span class="header-section-number">3.2.3.1</span> ORIGINAL</a>
  <ul>
  <li><a href="#measures-of-central-tendency" id="toc-measures-of-central-tendency"><span class="header-section-number">3.2.3.1.1</span> Measures of Central Tendency</a></li>
  <li><a href="#loss-function-to-support-particular-decisions" id="toc-loss-function-to-support-particular-decisions"><span class="header-section-number">3.2.3.1.2</span> Loss function to support particular decisions</a></li>
  </ul></li>
  <li><a href="#tidyverse-4" id="toc-tidyverse-4"><span class="header-section-number">3.2.3.2</span> TIDYVERSE</a>
  <ul>
  <li><a href="#measures-of-central-tendency-1" id="toc-measures-of-central-tendency-1"><span class="header-section-number">3.2.3.2.1</span> Measures of Central Tendency</a></li>
  <li><a href="#loss-function-to-support-particular-decisions-1" id="toc-loss-function-to-support-particular-decisions-1"><span class="header-section-number">3.2.3.2.2</span> Loss function to support particular decisions</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#sampling-to-simulate-prediction" id="toc-sampling-to-simulate-prediction"><span class="header-section-number">3.3</span> Sampling to simulate prediction</a>
  <ul>
  <li><a href="#original-5" id="toc-original-5"><span class="header-section-number">3.3.1</span> ORIGINAL</a>
  <ul>
  <li><a href="#dummy-data" id="toc-dummy-data"><span class="header-section-number">3.3.1.1</span> Dummy data</a></li>
  <li><a href="#model-checking" id="toc-model-checking"><span class="header-section-number">3.3.1.2</span> Model checking</a></li>
  </ul></li>
  <li><a href="#tidyverse-5" id="toc-tidyverse-5"><span class="header-section-number">3.3.2</span> TIDYVERSE</a>
  <ul>
  <li><a href="#dummy-data-1" id="toc-dummy-data-1"><span class="header-section-number">3.3.2.1</span> Dummy data</a></li>
  <li><a href="#model-checking-1" id="toc-model-checking-1"><span class="header-section-number">3.3.2.2</span> Model checking</a></li>
  <li><a href="#lets-practice-with-brms" id="toc-lets-practice-with-brms"><span class="header-section-number">3.3.2.3</span> Let’s practice with {<strong>brms</strong>}</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#practice" id="toc-practice"><span class="header-section-number">3.4</span> Practice</a>
  <ul>
  <li><a href="#easy" id="toc-easy"><span class="header-section-number">3.4.1</span> Easy</a>
  <ul>
  <li><a href="#exercises-3e1---3e7" id="toc-exercises-3e1---3e7"><span class="header-section-number">3.4.1.1</span> Exercises 3E1 - 3E7</a></li>
  </ul></li>
  <li><a href="#middle-1" id="toc-middle-1"><span class="header-section-number">3.4.2</span> Middle</a>
  <ul>
  <li><a href="#sec-e3m1" id="toc-sec-e3m1"><span class="header-section-number">3.4.2.1</span> 3M1</a></li>
  <li><a href="#m2" id="toc-m2"><span class="header-section-number">3.4.2.2</span> 3M2</a></li>
  <li><a href="#m3" id="toc-m3"><span class="header-section-number">3.4.2.3</span> 3M3</a></li>
  <li><a href="#m4" id="toc-m4"><span class="header-section-number">3.4.2.4</span> 3M4</a></li>
  <li><a href="#m5" id="toc-m5"><span class="header-section-number">3.4.2.5</span> 3M5</a></li>
  <li><a href="#m6" id="toc-m6"><span class="header-section-number">3.4.2.6</span> 3M6</a></li>
  </ul></li>
  <li><a href="#hard" id="toc-hard"><span class="header-section-number">3.4.3</span> Hard</a>
  <ul>
  <li><a href="#h1" id="toc-h1"><span class="header-section-number">3.4.3.1</span> 3H1</a></li>
  <li><a href="#h2" id="toc-h2"><span class="header-section-number">3.4.3.2</span> 3H2</a></li>
  <li><a href="#h3" id="toc-h3"><span class="header-section-number">3.4.3.3</span> 3H3</a></li>
  <li><a href="#h4" id="toc-h4"><span class="header-section-number">3.4.3.4</span> 3H4</a></li>
  <li><a href="#h5" id="toc-h5"><span class="header-section-number">3.4.3.5</span> 3H5</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#session-info" id="toc-session-info"><span class="header-section-number">3.5</span> Session info</a></li>
  </ul>
</nav>
<div class="my-objectives">
<div class="my-objectives-header">
<p>Learning Objectives:</p>
</div>
<div class="my-objectives-container">
<p>This chapter teaches the basic skills for working with samples from the posterior distribution. We’ll begin to use samples to summarize and simulate model output. The skills learned here will apply to every problem in the remainder of the book, even though the details of the models and how the samples are produced will vary.</p>
<p>The chapter exploits the fact that people are better in counts than in probabilities. We will take the probability distributions from the previous chapter and sampling from them to produce counts.</p>
</div>
</div>
<section id="vampire-example" class="level2 unnumbered">
<h2 class="unnumbered">Vampire Example</h2>
<section id="original" class="level3 unnumbered">
<h3 class="unnumbered">ORIGINAL</h3>
<div class="my-definition">
<div class="my-definition-header">
<div id="def-chap-03-1" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.1 </strong></span>: Probability Notation</p>
</div>
</div>
<div class="my-definition-container">
<p>As a repetition and to get a better understanding of the following formulae in this section I read a very <a href="(https://www.mathsisfun.com/data/probability-events-conditional.html)">basic introduction into probability notation</a></p>
<p><span class="math inline">\(P(A)\)</span> means “<strong>Probability Of Event A</strong>”.</p>
<div class="my-example">
<div class="my-example-header">
<p>Probability of an Event</p>
</div>
<div class="my-example-container">
<p>What is the probability of <span class="math inline">\(2\)</span> after throwing a dice? <span class="math display">\[P(A) = \frac{1}{6}\]</span></p>
</div>
</div>
<p><span class="math inline">\(P(B \mid A)\)</span> means “<strong>Probability of Event B given A</strong>”.</p>
<p>This is a conditional probability. After event <span class="math inline">\(A\)</span> has happened, what is the probability of <span class="math inline">\(B\)</span>? If the events are independent from each other than the changes do not influence each other.</p>
<div class="my-example">
<div class="my-example-header">
<p>Independent Conditional Events</p>
</div>
<div class="my-example-container">
<p>The probability to throw <span class="math inline">\(2\)</span> in a second dice throw are still <span class="math inline">\(P(B \mid A) = \frac{1}{6}\)</span>. If the events are dependent of each other then “Probability of event A and event B equals the probability of event A times the probability of event B given event A.”</p>
<p><span class="math display">\[
P(A \space and\space B) = P(A) \times P(B \mid A)
\]</span></p>
</div>
</div>
<div class="my-example">
<div class="my-example-header">
<p>Dependent Conditional Events</p>
</div>
<div class="my-example-container">
<p>Typical example is removing marble from a bag without replacement. Let’s take a red marble from a bag of <span class="math inline">\(5\)</span> red and <span class="math inline">\(5\)</span> blue marbles without replacement. Here the probability of a red marble (in the second draw) given the probability of a red marble (in the first draw) is</p>
<p><span class="math display">\[
\frac{5}{10} \times \frac{4}{9} = \frac{2}{9}
\]</span></p>
</div>
</div>
</div>
</div>
<section id="a-medical-test-scenario-with-bayes-theorem" class="level4 unnumbered">
<h4 class="unnumbered">a) Medical Test Scenario with Bayes theorem</h4>
<blockquote>
<p>“suppose there is a blood test that correctly detects vampirism 95% of the time. In more precise and mathematical notation, <span class="math inline">\(Pr(\text{positive test result} \mid vampire) = 0.95\)</span>. It’s a very accurate test, nearly always catching real vampires. It also make mistakes, though, in the form of false positives. One percent of the time, it incorrectly diagnoses normal people as vampires, <span class="math inline">\(Pr(\text{positive test result}|mortal) = 0.01\)</span>. The final bit of information we are told is that vampires are rather rare, being only <span class="math inline">\(0.1\%\)</span> of the population, implying <span class="math inline">\(Pr(vampire) = 0.001\)</span>. Suppose now that someone tests positive for vampirism. What’s the probability that he or she is a bloodsucking immortal?” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 49</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=68&amp;annotation=W9MU6VCZ">pdf</a>)</p>
</blockquote>
<blockquote>
<p>“The correct approach is just to use Bayes’ theorem to invert the probability, to compute <span class="math inline">\(Pr(vampire|positive)\)</span>. The calculation can be presented as:</p>
</blockquote>
<p><span id="eq-vampire"><span class="math display">\[
\begin{align*}
Pr(vampire\mid positive) = \frac{Pr(positive\mid vampire) Pr(vampire)}{Pr(positive)}\\
\text{where Pr(positive) is the average probability of a positive test result, that is,}\\ Pr(positive) = Pr(positive \mid vampire) Pr(vampire) \\
+ Pr(positive \mid mortal) 1 − Pr(vampire)
\end{align*}
\tag{3.1}\]</span></span> ” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 49</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=68&amp;annotation=X4KD33AT">pdf</a>)</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-vampire-bayes-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.1 </strong></span>a: Performing vampire calculation with <a class='glossary' title='This is the theorem that gives Bayesian data analysis its name. But the theorem itself is a trivial implication of probability theory. The mathematical definition of the posterior distribution arises from Bayes’ Theorem. The key lesson is that the posterior is proportional to the product of the prior and the probability of the data. (Chap.2)'>Bayes’ theorem</a> in Base R</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/vampire-bayes-a_e78cb07b12eb859739d60464ecdf29b9">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.1a Vampire ##################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pr_positive_vampire_a <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pr_positive_mortal_a <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>pr_vampire_a <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>pr_positive_a <span class="ot">&lt;-</span> pr_positive_vampire_a <span class="sc">*</span> pr_vampire_a <span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  pr_positive_mortal_a <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pr_vampire_a)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>( </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  pr_vampire_positive_a <span class="ot">&lt;-</span> pr_positive_vampire_a <span class="sc">*</span> pr_vampire_a <span class="sc">/</span> pr_positive_a</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.08683729</code></pre>
</div>
</div>
</div>
</div>
<p>There is only an 0.0868373% chance that the suspect is actually a vampire.</p>
<blockquote>
<p>“Most people find this result counterintuitive. And it’s a very important result, because it mimics the structure of many realistic testing contexts, such as HIV and DNA testing, criminal profiling, and even statistical significance testing (see the Rethinking box at the end of this section). Whenever the condition of interest is very rare, having a test that finds all the true cases is still no guarantee that a positive result carries much information at all. The reason is that most positive results are false positives, even when all the true positives are detected correctly” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 49</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=68&amp;annotation=CMMR49PQ">pdf</a>)</p>
</blockquote>
</section>
<section id="b-medical-test-scenario-with-natural-frequencies" class="level4 unnumbered">
<h4 class="unnumbered">b) Medical test scenario with natural frequencies</h4>
<blockquote>
<p>“There is a way to present the same problem that does make it more intuitive” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 50</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=69&amp;annotation=2DWF7729">pdf</a>)</p>
</blockquote>
<pre><code>(1)  In a population of 100,000 people, 100 of them are vampires.
(2)  Of the 100 who are vampires, 95 of them will test positive for vampirism.
(3)  Of the 99,900 mortals, 999 of them will test positive for vampirism.</code></pre>
<p>There are 999 + 95 = 1094 people tested positive. But from these people only 95 / (999 + 95) = 8.6837294 % are actually vampires.</p>
<p>Or with a slightly different wording it is still easier to understand:</p>
<ol type="1">
<li>We can just count up the number of people who test positive: <span class="math inline">\(95 + 999 = 1094\)</span>.</li>
<li>Out of these <span class="math inline">\(1094\)</span> positive tests, <span class="math inline">\(95\)</span> of them are real vampires, so that implies:</li>
</ol>
<p><span class="math display">\[
Pr(positive \mid vampire) = \frac{95}{1094}
\]</span></p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-vampire-frequencies-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.2 </strong></span>a: Performing vampire calculation with frequencies in Base R</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/vampire-frequencies-a_077f85fa03a7b9232d043d649a18af36">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pr_vampire_a2 <span class="ot">&lt;-</span>  <span class="dv">100</span> <span class="sc">/</span> <span class="dv">100000</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>pr_positive_vampire_a2 <span class="ot">&lt;-</span>  <span class="dv">95</span> <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>pr_positive_mortal_a2  <span class="ot">&lt;-</span>  <span class="dv">999</span> <span class="sc">/</span> <span class="dv">99900</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>pr_positive_a2 <span class="ot">&lt;-</span>  <span class="dv">95</span> <span class="sc">+</span> <span class="dv">999</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  pr_vampire_positive_a2 <span class="ot">&lt;-</span>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    pr_positive_vampire_a2 <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> pr_positive_a2</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.08683729</code></pre>
</div>
</div>
</div>
</div>
<blockquote>
<p>“The second presentation of the problem, using counts rather than probabilities, is often called the frequency format or natural frequencies. Why a frequency format helps people intuit the correct approach remains contentious. Some people think that human psychology naturally works better when it receives information in the form a person in a natural environment would receive it. In the real world, we encounter counts only. No one has ever seen a probability, the thinking goes. But everyone sees counts (”frequencies”) in their daily lives.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 50</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=69&amp;annotation=G26ZTDUZ">pdf</a>)</p>
</blockquote>
<blockquote>
<p>“many scientists are uncomfortable with integral calculus, even though they have strong and valid intuitions about how to summarize data. Working with samples transforms a problem in calculus into a problem in data summary, into a frequency format problem. An integral in a typical Bayesian context is just the total probability in some interval. That can be a challenging calculus problem. But once you have samples from the probability distribution, it’s just a matter of counting values in the interval. An empirical attack on the posterior allows the scientist to ask and answer more questions about the model, without relying upon a captive mathematician. For this reason, it is easier and more intuitive to work with samples from the posterior, than to work with probabilities and integrals directly.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 51</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=70&amp;annotation=M7I2DV3C">pdf</a>)</p>
</blockquote>
</section>
</section>
<section id="tidyverse" class="level3 unnumbered">
<h3 class="unnumbered">TIDYVERSE</h3>
<section id="a-medical-test-scenario-with-bayes-theorem-1" class="level4 unnumbered">
<h4 class="unnumbered">a) Medical Test Scenario with Bayes theorem</h4>
<div class="my-important">
<div class="my-important-header">
<p>Vectors in Base R are tibble columns in tidyverse</p>
</div>
<div class="my-important-container">
<p>Whenever there is a calculation with vectors the pendant in tidyverse mode is to generate columns in a tibble with <code>tibble::tibble()</code> or if there is already a data frame with <code>dplyr::mutate()</code> and to do the appropriate calculation with these columns.</p>
<p>The following <a href="#cnj-vampire-bayes-a" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-vampire-bayes-a</span></a> transformed the Base R calculation <a href="#cnj-vampire-bayes-b" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-vampire-bayes-b</span></a> into a computation using the tidyverse approach.</p>
</div>
</div>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-vampire-bayes-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.3 </strong></span>b: Performing the calculation using Bayes’ theorem with tidyverse approach in R</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/vampire-bayes-b_38ad763c3220dc9abaea623ddf42c66c">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.1b Vampire ##########</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">pr_positive_vampire_b =</span> .<span class="dv">95</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_positive_mortal_b  =</span> .<span class="dv">01</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_vampire_b          =</span> .<span class="dv">001</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr_positive_b =</span> pr_positive_vampire_b <span class="sc">*</span> pr_vampire_b</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="sc">+</span> pr_positive_mortal_b <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pr_vampire_b)) <span class="sc">|&gt;</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr_vampire_positive_b =</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>           pr_positive_vampire_b <span class="sc">*</span> pr_vampire_b <span class="sc">/</span> pr_positive_b) <span class="sc">|&gt;</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 1
#&gt; Columns: 5
#&gt; $ pr_positive_vampire_b &lt;dbl&gt; 0.95
#&gt; $ pr_positive_mortal_b  &lt;dbl&gt; 0.01
#&gt; $ pr_vampire_b          &lt;dbl&gt; 0.001
#&gt; $ pr_positive_b         &lt;dbl&gt; 0.01094
#&gt; $ pr_vampire_positive_b &lt;dbl&gt; 0.08683729</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="b-medical-test-scenario-with-natural-frequencies-1" class="level4 unnumbered">
<h4 class="unnumbered">b) Medical test scenario with natural frequencies</h4>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-vampire-frequencies-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.4 </strong></span>b: Performing the calculation using frequencies with tidyverse approach in R</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/vampire-frequencies-b_3af6a8ccab79d23238af0d9fbba9b902">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">pr_vampire_b2          =</span> <span class="dv">100</span> <span class="sc">/</span> <span class="dv">100000</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_positive_vampire_b2 =</span> <span class="dv">95</span> <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_positive_mortal_b2  =</span> <span class="dv">999</span> <span class="sc">/</span> <span class="dv">99900</span>)  <span class="sc">|&gt;</span>  </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr_positive_b2 =</span> <span class="dv">95</span> <span class="sc">+</span> <span class="dv">999</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr_vampire_positive_b2 =</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                  pr_positive_vampire_b2 <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> pr_positive_b2) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 1
#&gt; Columns: 5
#&gt; $ pr_vampire_b2          &lt;dbl&gt; 0.001
#&gt; $ pr_positive_vampire_b2 &lt;dbl&gt; 0.95
#&gt; $ pr_positive_mortal_b2  &lt;dbl&gt; 0.01
#&gt; $ pr_positive_b2         &lt;dbl&gt; 1094
#&gt; $ pr_vampire_positive_b2 &lt;dbl&gt; 0.08683729</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="sec-chap-03-sampling-grid" class="level2" data-number="3.1">
<h2 data-number="3.1"><span class="header-section-number">3.1</span> Sampling from a grid-approximate posterior</h2>
<section id="original-1" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1"><span class="header-section-number">3.1.1</span> ORIGINAL</h3>
<p>Before we are going to draw samples from the posterior distribution we need to compute the distribution similar as we had done in the globe tossing example.</p>
<blockquote>
<p>“Here’s a reminder for how to compute the posterior for the globe tossing model, using grid approximation. Remember, the posterior here means the probability of p conditional on the data.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 52</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=71&amp;annotation=KKQLR3FL">pdf</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-grid-globe-tossing-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.5 </strong></span>a: Generate the posterior distribution form the globe-tossing example (Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/grid-globe-tossing-a_8d5503f9b16f241aa18f6304644fac9e">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">### R code 3.2a Grid Globe ##########################</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># change prob_b to prior</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># change prob_data to likelihood</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># added variables: n_grid_a, n_success_a, n_trials_a</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>n_grid_a <span class="ot">&lt;-</span> <span class="dv">1000</span>L <span class="co"># number of grid points</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>n_success_a <span class="ot">&lt;-</span> <span class="dv">6</span>L <span class="co"># observed water</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>n_trials_a <span class="ot">&lt;-</span>  <span class="dv">9</span>L <span class="co"># number of trials</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>p_grid_a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> n_grid_a)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>prior_a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, n_grid_a) <span class="co"># = prior, = uniform distribution, 1000 times 1</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>likelihood_a <span class="ot">&lt;-</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbinom</span>(n_success_a, <span class="at">size =</span> n_trials_a, <span class="at">prob =</span> p_grid_a) <span class="co"># = likelihood</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>posterior_a <span class="ot">&lt;-</span> likelihood_a <span class="sc">*</span> prior_a</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>posterior_a <span class="ot">&lt;-</span> posterior_a <span class="sc">/</span> <span class="fu">sum</span>(posterior_a)</span></code></pre></div>
</details>
</div>
</div>
</div>
<blockquote>
<p>“Now we wish to draw 10,000 samples from this posterior. Imagine the posterior is a bucket full of parameter values, numbers such as <span class="math inline">\(0.1, 0.7, 0.5, 1,\)</span> etc. Within the bucket, each value exists in proportion to its posterior probability, such that values near the peak are much more common than those in the tails. We’re going to scoop out 10,000 values from the bucket. Provided the bucket is well mixed, the resulting samples will have the same proportions as the exact posterior density. Therefore the individual values of <span class="math inline">\(p\)</span> will appear in our samples in proportion to the posterior plausibility of each value.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 52</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=71&amp;annotation=GS5GCASA">pdf</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-sample-globe-tossing" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.6 </strong></span>a: Draw 1000 samples from the posterior distribution (Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/sample-globe-tossing-a_64e758147cfeecb38abd575bc4e591dc">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>n_samples_a <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>) <span class="co"># for reproducibility</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.3a Sample Globe ##########################################</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>samples_a <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid_a, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> posterior_a, <span class="co"># from previous code chunk</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> n_samples_a, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
</div>
</div>
</div>
<p>The probability of each value is given by <code>posterior_a</code>, which we computed with <a href="#cnj-grid-globe-tossing-a" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-grid-globe-tossing-a</span></a>.</p>
<div class="my-note">
<div class="my-note-header">
<div id="cor-excursion-a" class="theorem corollary">
<p><span class="theorem-title"><strong>Note 3.1 </strong></span>: Details for a better understanding and comparison with the tidyverse version</p>
</div>
</div>
<div class="my-note-container">
<p>To compare with the tidyverse version, I collected the three vectors with <code>base::cbind()</code> into a matrix and displayed the first six lines with <code>utils::head()</code>. Additionally I also displayed the first 10 values of <code>samples_a</code> vector.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-excursion-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.7 </strong></span>a: Excursion for better comparison (Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/excursion_a_6bcbd9775ad385a9b88bc2762c3ca8f0">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display grid results to compare with variant b</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>d_a <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_grid_a, prior_a, likelihood_a, posterior_a) </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d_a, <span class="dv">10</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          p_grid_a prior_a likelihood_a  posterior_a
#&gt;  [1,] 0.000000000       1 0.000000e+00 0.000000e+00
#&gt;  [2,] 0.001001001       1 8.425225e-17 8.433659e-19
#&gt;  [3,] 0.002002002       1 5.375951e-15 5.381333e-17
#&gt;  [4,] 0.003003003       1 6.105137e-14 6.111249e-16
#&gt;  [5,] 0.004004004       1 3.419945e-13 3.423368e-15
#&gt;  [6,] 0.005005005       1 1.300676e-12 1.301978e-14
#&gt;  [7,] 0.006006006       1 3.872087e-12 3.875963e-14
#&gt;  [8,] 0.007007007       1 9.734489e-12 9.744233e-14
#&gt;  [9,] 0.008008008       1 2.162473e-11 2.164638e-13
#&gt; [10,] 0.009009009       1 4.370695e-11 4.375070e-13</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display sample results to compare with variant b</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(samples_a, <span class="dv">10</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] 0.5645646 0.6516517 0.5475475 0.5905906 0.5955956 0.7877878 0.7267267
#&gt;  [8] 0.4914915 0.7507508 0.4494494</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-globe-glossing-scatterplot-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.8 </strong></span>a: Scatterplot of the drawn samples (Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-globe-tossing-scatterplot-a_ef2e6612a39527c5676d3efd727180de">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.4a Globe Scatterplot #############</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samples_a)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-globe-tossing-scatterplot-a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-globe-tossing-scatterplot-a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.1: Scatterplot of the drawn samples (Base R)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<p>In fig-globe-glossing-plot-a “it’s as if you are flying over the posterior distribution, looking down on it. There are many more samples from the dense region near 0.6 and very few samples below 0.25. On the right, the plot shows the density estimate computed from these samples.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 53</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=72&amp;annotation=4WVLNZBT">pdf</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-globe-tossing-density-plot-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.9 </strong></span>a: Density estimate of the drawn samples (Rethinking)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-globe-tossing-density-plot-a_d3498b1f608a4f243f88f768ac48d285">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.5a Globe Density plot #############</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(samples_a)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-globe-tossing-density-plot-a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-globe-tossing-density-plot-a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.2: Density estimate of the drawn samples (Rethinking)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="tidyverse-1" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2"><span class="header-section-number">3.1.2</span> TIDYVERSE</h3>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-grid-globe-tossing-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.10 </strong></span>b: Generate the posterior distribution form the globe-tossing example (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/grid-globe-tossing-b_39b7f1360506fc533b0fd3665c87d50b">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.2b Grid Globe #####################</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># how many grid points would you like?</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>n_grid_b <span class="ot">&lt;-</span> <span class="dv">1000</span>L</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>n_success_b <span class="ot">&lt;-</span> <span class="dv">6</span>L</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>n_trials_b  <span class="ot">&lt;-</span> <span class="dv">9</span>L</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>d_b <span class="ot">&lt;-</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_b =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> n_grid_b),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_b  =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span>  <span class="co"># flat uniform prior, vector 1L recycling</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">likelihood_b =</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                  stats<span class="sc">::</span><span class="fu">dbinom</span>(n_success_b, <span class="at">size =</span> n_trials_b, <span class="at">prob =</span> p_grid_b)) <span class="sc">|&gt;</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">posterior_b =</span> </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                  (likelihood_b <span class="sc">*</span> prior_b) <span class="sc">/</span> <span class="fu">sum</span>(likelihood_b <span class="sc">*</span> prior_b))</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d_b)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 6 × 4
#&gt;   p_grid_b prior_b likelihood_b posterior_b
#&gt;      &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
#&gt; 1  0             1     0           0       
#&gt; 2  0.00100       1     8.43e-17    8.43e-19
#&gt; 3  0.00200       1     5.38e-15    5.38e-17
#&gt; 4  0.00300       1     6.11e-14    6.11e-16
#&gt; 5  0.00400       1     3.42e-13    3.42e-15
#&gt; 6  0.00501       1     1.30e-12    1.30e-14</code></pre>
</div>
</div>
</div>
</div>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>Variable names changed</p>
</div>
<div class="my-watch-out-container">
<p>I have changed McElreath’s variable name <code>prob_p</code> and <code>prob_data</code> as <code>prior_x</code> and <code>likelihood_x</code>, where <code>x</code> stands for <code>a</code> (Base R) or <code>b</code> (Tidyverse).</p>
<p>To see the difference between grid and samples I will add “_sample” to all the other variable names.</p>
</div>
</div>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-sample-globe-tossing-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.11 </strong></span>b: Draw 1000 samples from the posterior distribution (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/sample-globe-tossing-b_704e34271f9d9fb89611d35fde18215d">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.3b Sample Globe #####################</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># how many samples would you like?</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>n_samples_b <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make it reproducible</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="ot">&lt;-</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  d_b <span class="sc">|&gt;</span> </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples_b, <span class="at">weight_by =</span> posterior_b, <span class="at">replace =</span> T)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="ot">&lt;-</span> df_samples_b <span class="sc">|&gt;</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">samples_b =</span> p_grid_b,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">likelihood_samples_b =</span> likelihood_b,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">prior_samples_b =</span> prior_b,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_samples_b =</span> posterior_b)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_samples_b)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 6 × 4
#&gt;   samples_b prior_samples_b likelihood_samples_b posterior_samples_b
#&gt;       &lt;dbl&gt;           &lt;dbl&gt;                &lt;dbl&gt;               &lt;dbl&gt;
#&gt; 1     0.565               1                0.225             0.00225
#&gt; 2     0.652               1                0.272             0.00272
#&gt; 3     0.548               1                0.210             0.00210
#&gt; 4     0.591               1                0.245             0.00245
#&gt; 5     0.596               1                0.248             0.00248
#&gt; 6     0.788               1                0.192             0.00192</code></pre>
</div>
</div>
<hr />
<p><code>identical(samples_a, df_samples_b$samples_b)</code> = TRUE.</p>
<p>The column <code>samples_b</code> is identical with vector <code>samples_a</code>, because I have used in both sampling processes <code>base::set.seed(3)</code>, so that I (and you) could reproduce the data.</p>
</div>
</div>
<p>There are different possibilities to display data frames respectively tibbles:</p>
<ol type="1">
<li>You can use the internal print facility of tibbles. It shows only the first ten rows and all columns that fit on the screen. You see an example in <a href="#cnj-sample-globe-tossing-b" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-sample-globe-tossing-b</span></a>.</li>
<li>With the <code>utils::str()</code> function you will get a result with shorter figures that is better adapted to a small screen.</li>
<li>Another alternative is the tidyverse approach of <code>dplyr::glimpse()</code>.</li>
<li>With <code>skimr::skim()</code> you will get a compact summary of all data.</li>
</ol>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-excursion-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.12 </strong></span>b: Excursion: Printing varieties for better comparison (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/excursion-b_c4556d558095a87c7961f0c2f4bfc8f3">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb22"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;USING THE str() FUNCTION:&#39;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">str</span>(df_samples_b)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;USING THE dplyr::glimpse() FUNCTION:&#39;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(df_samples_b)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;USING THE skimr::skim() FUNCTION:&#39;</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(df_samples_b)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; USING THE str() FUNCTION:
#&gt; tibble [10,000 × 4] (S3: tbl_df/tbl/data.frame)
#&gt;  $ samples_b           : num [1:10000] 0.565 0.652 0.548 0.591 0.596 ...
#&gt;  $ prior_samples_b     : num [1:10000] 1 1 1 1 1 1 1 1 1 1 ...
#&gt;  $ likelihood_samples_b: num [1:10000] 0.225 0.272 0.21 0.245 0.248 ...
#&gt;  $ posterior_samples_b : num [1:10000] 0.00225 0.00272 0.0021 0.00245 0.00248 ...
#&gt; #####################################################
#&gt; 
#&gt; USING THE dplyr::glimpse() FUNCTION:
#&gt; Rows: 10,000
#&gt; Columns: 4
#&gt; $ samples_b            &lt;dbl&gt; 0.5645646, 0.6516517, 0.5475475, 0.5905906, 0.595…
#&gt; $ prior_samples_b      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
#&gt; $ likelihood_samples_b &lt;dbl&gt; 0.22455994, 0.27190272, 0.20966655, 0.24460869, 0…
#&gt; $ posterior_samples_b  &lt;dbl&gt; 0.0022478473, 0.0027217490, 0.0020987643, 0.00244…
#&gt; #####################################################
#&gt; 
#&gt; USING THE skimr::skim() FUNCTION:</code></pre>
</div>
<div class="cell-output-display">
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df_samples_b</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 11%" />
<col style="width: 16%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">samples_b</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: left;">▁▂▇▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">prior_samples_b</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▁▁▇▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">likelihood_samples_b</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: left;">▁▁▂▃▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">posterior_samples_b</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">▁▁▂▃▇</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>We can plot the left panel of Figure 3.1 from the book with <code>ggplot2::geom_point()</code>. But before we do, we’ll need to add a variable numbering the samples. This is necessary as the x-parameter of the plot.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-globe-tossing-scatterplot-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.13 </strong></span>b: Scatterplot of the drawn samples (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-globe-tossing-scatterplot-b_d0d6f923a809b65a07aec13aa6709641">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb24"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.4b Globe Scatterplot ########################</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sample_number =</span> <span class="dv">1</span><span class="sc">:</span>dplyr<span class="sc">::</span><span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> sample_number, <span class="at">y =</span> samples_b)) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">&quot;sample number&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-globe-tossing-scatterplot-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-globe-tossing-scatterplot-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.3: Scatterplot of the drawn samples (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>If you hover over this link from <a href="#fig-globe-tossing-scatterplot-a" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-globe-tossing-scatterplot-a</span></a> you can compare the Base R version with the tidyverse result.</p>
<p>Instead of the <code>rethinking::dens()</code> we’ll plot the density in the right panel of the books Figure 3.1 with <code>ggplot2::geom_density()</code>.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-globe-tossing-densitiy-plot-b1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.14 </strong></span>b: Density estimate of the drawn samples with 1e4 grid points (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-globe-tossing-density-plot-b1_4494bfccdfee58dfff83bc53c4e8a164">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.5b(1) Globe Density ###########################</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-globe-tossing-density-plot-b1" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-globe-tossing-density-plot-b1-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.4: Density estimate of the drawn samples with 1e4 grid points (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Compare this somewhat smoother tidyverse plot with <a href="#fig-globe-tossing-density-plot-a" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-globe-tossing-density-plot-a</span></a>.</p>
<blockquote>
<p>“You can see that the estimated density is very similar to ideal posterior you computed via grid approximation. If you draw even more samples, maybe 1e5 or 1e6, the density estimate will get more and more similar to the ideal.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 53</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=72&amp;annotation=EXBQWX2M">pdf</a>)</p>
</blockquote>
<p>Here’s what it looks like with <code>1e6</code>.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-ID-text" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.15 </strong></span>b: Density estimate of the drawn samples with 1e6 grid points (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-globe-tossing-density-plot-b2_5bf5f393a85eb07d7f72b5cc8526f944">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb26"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.5b(2) Globe Density ###########################</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>d_b <span class="sc">|&gt;</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e6</span>, <span class="at">weight_by =</span> posterior_b, <span class="at">replace =</span> T) <span class="sc">|&gt;</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_b)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-globe-tossing-density-plot-b2" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-globe-tossing-density-plot-b2-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.5: Density estimate of the drawn samples with 1e6 grid points (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-sampling-to-summarize" class="level2" data-number="3.2">
<h2 data-number="3.2"><span class="header-section-number">3.2</span> Sampling to Summarize</h2>
<p>All we have done so far is crudely replicate the posterior density we had already computed in the previous chapter. Now it is time to use these samples to describe and understand the posterior.</p>
<p>The description to understand the posterior can be divided into three inquiries:</p>
<ol type="1">
<li>Questions about intervals of <em>defined boundaries</em>. See <a href="#sec-chap-03-defined-boundaries" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap-03-defined-boundaries</span></a>.</li>
<li>Questions about intervals of <em>defined probability mass</em>. See <a href="#sec-chap-03-probability-mass" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap-03-probability-mass</span></a>.</li>
<li>Questions about <em>point estimates</em>. See: <a href="#sec-chap-03-point-estimates" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap-03-point-estimates</span></a>.</li>
</ol>
<section id="sec-chap-03-defined-boundaries" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1"><span class="header-section-number">3.2.1</span> Intervals of Defined Boundaries</h3>
<section id="original-2" class="level4" data-number="3.2.1.1">
<h4 data-number="3.2.1.1"><span class="header-section-number">3.2.1.1</span> ORIGINAL</h4>
<section id="grid-approximate-posterior" class="level5" data-number="3.2.1.1.1">
<h5 data-number="3.2.1.1.1"><span class="header-section-number">3.2.1.1.1</span> Grid-approximate Posterior</h5>
<p>For instance: What is the probability that the proportion of water is less than 0.5?</p>
<blockquote>
<p>“Using the grid-approximate posterior, you can just add up all of the probabilities, where the corresponding parameter value is less than 0.5:” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 53</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=72&amp;annotation=Z7XSZ6WT">pdf</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-grid-posterior-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.16 </strong></span>a: Define boundaries using the grid-approximate posterior (Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/grid-posterior-a_2235e2be878cff741f4df70708ad100c">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.6a Grid Posterior Boundary ##############################</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add up posterior probability where p &lt; 0.5</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(posterior_a[p_grid_a <span class="sc">&lt;</span> <span class="fl">0.5</span>])</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.1718746</code></pre>
</div>
</div>
</div>
</div>
<p>About 17% of the posterior probability is below 0.5.</p>
</section>
<section id="samples-from-the-posterior" class="level5" data-number="3.2.1.1.2">
<h5 data-number="3.2.1.1.2"><span class="header-section-number">3.2.1.1.2</span> Samples from the Posterior</h5>
<p>But this easy calculation based on grid approximation is often not practical when there are more parameters. In this case you can draw samples from the posterior. But this approach requires a different calculation:</p>
<blockquote>
<p>“This approach does generalize to complex models with many parameters, and so you can use it everywhere. All you have to do is similarly add up all of the samples below 0.5, but also // divide the resulting count by the total number of samples. In other words, find the frequency of parameter values below 0.5” (McElreath, 2020, p. 53/54)” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 53</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=72&amp;annotation=SMQ6B78K">pdf</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-sample-boundary-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.17 </strong></span>a: Compute posterior probability below 0.5 using the sampling approach (Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/sample-boundary-a_ac5e358f12ca53c7b0c76fcded2b5129">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.7a Sample Boundary #############################</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>(p_boundary_a <span class="ot">&lt;-</span> <span class="fu">sum</span>(samples_a <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fl">1e4</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.1629</code></pre>
</div>
</div>
</div>
</div>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>Different values with samples from the posterior</p>
</div>
<div class="my-watch-out-container">
<p>In comparison with the value of the posterior probability below 0.5 in the book of 0.1726 the result in 0.1629 from <a href="#cnj-sample-boundary-a" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-sample-boundary-a</span></a> is quite different.</p>
<p>The reason for the difference is that you can’t get the same values in a sampling processes. This is the nature of randomness. And McElreath did not include the <code>base::set.seed()</code> function for (exact) reproducibility.</p>
</div>
</div>
<p>Using the same approach, you can ask how much posterior probability lies between 0.5 and 0.75:</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-sample-interval-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.18 </strong></span>a: Compute posterior probability between 0.5 and 0.75 using the sampling approach (Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/sample-interval-a_68054e287a571bbc5efb53baf15a9dd3">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.8a Sample Interval #############################</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>(p_boundary_a8 <span class="ot">&lt;-</span> <span class="fu">sum</span>(samples_a <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> samples_a <span class="sc">&lt;</span> <span class="fl">0.75</span>) <span class="sc">/</span> <span class="fl">1e4</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.6061</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="tidyverse-2" class="level4" data-number="3.2.1.2">
<h4 data-number="3.2.1.2"><span class="header-section-number">3.2.1.2</span> TIDYVERSE</h4>
<section id="grid-approximate-posterior-1" class="level5" data-number="3.2.1.2.1">
<h5 data-number="3.2.1.2.1"><span class="header-section-number">3.2.1.2.1</span> Grid-approximate Posterior</h5>
<blockquote>
<p>To get the proportion of water less than some value of <code>p_grid_b</code> within the {<strong>tidyverse}</strong>, you might first <code>filter()</code> by that value and then take the <code>sum()</code> within <code>summarise()</code>. (<a href="https://bookdown.org/content/4857/sampling-the-imaginary.html#intervals-of-defined-boundaries.">Kurz</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-grid-boundary-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.19 </strong></span>b: Compute posterior probability below 0.5 using the grid approach (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/grid-boundary-b_cf905dee69da77b4bd5d5f1648a75a72">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.6b Grid Boundary ######################</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add up posterior probability where p &lt; 0.5</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>d_b <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(p_grid_b <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> base<span class="sc">::</span><span class="fu">sum</span>(posterior_b))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1 × 1
#&gt;     sum
#&gt;   &lt;dbl&gt;
#&gt; 1 0.172</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="samples-from-the-posterior-1" class="level5" data-number="3.2.1.2.2">
<h5 data-number="3.2.1.2.2"><span class="header-section-number">3.2.1.2.2</span> Samples from the Posterior</h5>
<p>Kurz offers several methods to calculate the posterior probability below 0.5:</p>
<ol type="1">
<li><strong>Method</strong>: <code>filter()</code> &amp; <code>n()</code> within <code>summarize()</code></li>
<li><strong>Method</strong>: <code>count()</code> followed by <code>mutate()</code></li>
<li><strong>Method</strong>: Logical condition within <code>mean()</code></li>
</ol>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-sample-boundary" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.20 </strong></span>b: Compute posterior probability below 0.5 using the sampling approach with different methods (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/sample-boundary-b_80f4fe6a73350bb98988edcee0cf6262">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb35"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add up all posterior probabilities of samples under .5</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.7b Sample Boundary #########################</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (1) #######</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>method_1 <span class="ot">&lt;-</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&lt;</span> .<span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> n_samples_b)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 1:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>method_1</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;##################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (2) #######</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>method_2 <span class="ot">&lt;-</span> </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(samples_b <span class="sc">&lt;</span> .<span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">probability =</span> n_samples_b <span class="sc">/</span> base<span class="sc">::</span><span class="fu">sum</span>(n_samples_b))</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 2:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>method_2</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;##################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (3) #######</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>method_3 <span class="ot">&lt;-</span> </span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> <span class="fu">mean</span>(samples_b <span class="sc">&lt;</span> .<span class="dv">5</span>))</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 3:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>method_3</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Method 1:
#&gt; # A tibble: 1 × 1
#&gt;     sum
#&gt;   &lt;dbl&gt;
#&gt; 1 0.163
#&gt; ##################################################
#&gt; 
#&gt; Method 2:
#&gt; # A tibble: 2 × 3
#&gt;   `samples_b &lt; 0.5`     n probability
#&gt;   &lt;lgl&gt;             &lt;int&gt;       &lt;dbl&gt;
#&gt; 1 FALSE              8371           1
#&gt; 2 TRUE               1629           1
#&gt; ##################################################
#&gt; 
#&gt; Method 3:
#&gt; # A tibble: 1 × 1
#&gt;     sum
#&gt;   &lt;dbl&gt;
#&gt; 1 0.163</code></pre>
</div>
</div>
</div>
</div>
<p>To determine the posterior probability between 0.5 and 0.75, you can use <code>&amp;</code> within <code>filter()</code>. Just multiply that result by 100 to get the value in percent.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-sample-interval-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.21 </strong></span>b: Compute posterior probability between 0.5 and 0.75 using the sampling approach (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/sample-interval-b_0e773a5896b0c5798679813e8b94b37c">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.8b Sample Interval ##############</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&gt;</span> .<span class="dv">5</span> <span class="sc">&amp;</span> samples_b <span class="sc">&lt;</span> .<span class="dv">75</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> n_samples_b)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1 × 1
#&gt;     sum
#&gt;   &lt;dbl&gt;
#&gt; 1 0.606</code></pre>
</div>
</div>
</div>
</div>
<p>And, of course, you can do this calculation with the other methods as well.</p>
<p>To produce the top part of Figure 3.2 of the book we apply following code lines:</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-upper-part-3-2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.22 </strong></span>b: Posterior distribution produced with {<strong>tidyverse</strong>} approach</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-upper-part-3.2-b_c5a169d8b5cdb4fbf12db53b72f8e094">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R Code Fig 3.2 Upper Part #############</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># upper left panel</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  df_samples_b  <span class="sc">|&gt;</span>  </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b, <span class="at">y =</span> posterior_samples_b)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_samples_b  <span class="sc">|&gt;</span>  </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&lt;</span> .<span class="dv">5</span>), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)  <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># upper right panel</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  df_samples_b  <span class="sc">|&gt;</span>  </span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b, <span class="at">y =</span> posterior_samples_b)) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_samples_b  <span class="sc">|&gt;</span>  </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&gt;</span> .<span class="dv">5</span> <span class="sc">&amp;</span> samples_b <span class="sc">&lt;</span> .<span class="dv">75</span>), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-upper-part-3.2-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-upper-part-3.2-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.6: Upper part of SR2 Figure 3.2: Intervals of defined boundaries produced with {<strong>tidyverse</strong>} tools: Left: The blue area is the posterior probability below a parameter value of 0.5. Right: The posterior probability between 0.5 and 0.75.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="sec-chap-03-probability-mass" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2"><span class="header-section-number">3.2.2</span> Intervals of Defined Probability Mass</h3>
<section id="original-3" class="level4" data-number="3.2.2.1">
<h4 data-number="3.2.2.1"><span class="header-section-number">3.2.2.1</span> ORIGINAL</h4>
<section id="quantiles" class="level5" data-number="3.2.2.1.1">
<h5 data-number="3.2.2.1.1"><span class="header-section-number">3.2.2.1.1</span> Quantiles</h5>
<div class="my-definition">
<div class="my-definition-header">
<div id="def-probability-mass-intervals" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.2 </strong></span>: Several Terms for Intervals of Defined Probability Mass</p>
</div>
</div>
<div class="my-definition-container">
<ul>
<li><a class='glossary' title='A range of values, calculated from the sample observations, that is believed, with a particular probability, to contain the true parameter value. (Cambridge Dictionary of Statistics, 4th ed., p.98)'>Confidence Interval</a>: Term chiefly used in frequentist statistics.</li>
<li><a class='glossary' title='Two parameter values that contain between them a specified amount of posterior probability, a probability mass, is usually known as confidence interval in FREQUENTIST STATISTICS and credible interval in BAYESIAN STATISTICS.'>Credible Interval</a>: Term predominantly used in Bayesian statistics.</li>
<li><a class='glossary' title='Two parameter values that contain between them a specified amount of posterior probability, a probability mass, is usually know as confidence interval that may instead be called a credible interval. We’re going to call it a compatibility interval instead, in order to avoid the unwarranted implications of “confidence”” and “credibility.” What the interval indicates is a range of parameter values compatible with the model and data. The model and data themselves may not inspire confidence, in which case the interval will not either. (Chap.3)'>Compatibility Interval</a>: Term preferably used by Richard McElreath.</li>
</ul>
<p>The abbreviation for all three versions of probability mass intervals is “CI”.</p>
<p>McElreath tries to avoid the semantic of “confidence” or “credibility” because</p>
<blockquote>
<p>“What the interval indicates is a range of parameter values compatible with the model and data. The model and data themselves may not inspire confidence, in which case the interval will not either.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 54</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=73&amp;annotation=BHMW5CJ4">pdf</a>)</p>
</blockquote>
</div>
</div>
<p>The values of these intervals can be found easier by using samples from the posterior than by using a grid approximation.</p>
<blockquote>
<p>“Suppose for example you want to know the boundaries of the lower <span class="math inline">\(80\%\)</span> posterior probability. You know this interval starts at <span class="math inline">\(p = 0\)</span>. To find out where it stops, think of the samples as data and ask where the <span class="math inline">\(80th\)</span> percentile lies:” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 54</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=73&amp;annotation=3SA8YJWX">pdf</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-quantiles-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.23 </strong></span>a: Compute posterior probability intervals lower <span class="math inline">\(80\%\)</span> and from 10th to 90th percentile</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/quantiles-a_9e784ce0c867f8fccc0f74018b761567">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.9a Quantile 0.8 #######################</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>q8 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples_a, <span class="fl">0.8</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.10a PI = Quantile 0.1-0.9 ###################</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>q1_9 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples_a, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span></code></pre></div>
</details>
</div>
<ul>
<li>Lower <span class="math inline">\(80\%\)</span> = 0.7627628</li>
<li>Between <span class="math inline">\(10\%\)</span> = 0.4514515 and <span class="math inline">\(90\%\)</span> = 0.8148148</li>
</ul>
</div>
</div>
</section>
<section id="percentile-interval-pi" class="level5" data-number="3.2.2.1.2">
<h5 data-number="3.2.2.1.2"><span class="header-section-number">3.2.2.1.2</span> Percentile Interval (PI)</h5>
<p>The second calculation returns the middle 80% of the distribution</p>
<blockquote>
<p>“Intervals of this sort, which assign equal probability mass to each tail, are very common in the scientific literature. We’ll call them <a class='glossary' title='The set of divisions that produce exactly 100 equal parts in a series of continuous values, such as blood pressure, weight, height, etc. Thus a person with blood pressure above the 80th percentile has a greater blood pressure value than over 80% of the other recorded values.” (CDS, p.323)'>percentile intervals</a> (PI). These intervals do a good job of communicating the shape of a distribution, as long as the distribution isn’t too asymmetrical. But in terms of supporting inferences about which parameters are consistent with the data, they are not perfect.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 55</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=74&amp;annotation=5GPNVTUH">pdf</a>)</p>
</blockquote>
<p>But they do not work well with highly skewed data. See <a href="#fig-skewed-dist-a" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-skewed-dist-a</span></a> where the posterior is consistent with observing three waters in three tosses and a uniform (flat) prior.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-skewed-dist-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.24 </strong></span>a: Skewed posterior distribution observing three waters in three tosses and a uniform (flat) prior (Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-skewed-dist-a_fc0ad86c429badbace91c39191cfd874">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.11a Skewed data #####################</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>p_grid_skewed_a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>prior_skewed_a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>likelihood_skewed_a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">3</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">prob =</span> p_grid_skewed_a)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>posterior_skewed_a <span class="ot">&lt;-</span> likelihood_skewed_a <span class="sc">*</span> prior_skewed_a</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>posterior_skewed_a <span class="ot">&lt;-</span> posterior_skewed_a <span class="sc">/</span> <span class="fu">sum</span>(posterior_skewed_a)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>) <span class="co"># added to make sampling distribution reproducible (pb)</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>samples_skewed_a <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid_skewed_a, </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> posterior_skewed_a)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># added to show the skewed posterior distribution (pb)</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(samples_skewed_a)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-skewed-dist-a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-skewed-dist-a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.7: Skewed posterior distribution observing three waters in three tosses and a uniform (flat) prior. It is highly skewed, having its maximum value at the boundary where p equals 1.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<p>“[The <a class='glossary' title='The set of divisions that produce exactly 100 equal parts in a series of continuous values, such as blood pressure, weight, height, etc. Thus a person with blood pressure above the 80th percentile has a greater blood pressure value than over 80% of the other recorded values.” (CDS, p.323)'>percentile interval</a>] assigns 25% of the probability mass above and below the interval. So it provides the central 50% probability. But in this example, it ends up excluding the most probable parameter values, near p = 1. So in terms of describing the shape of the posterior distribution—which is really all these intervals are asked to do—the percentile interval can be misleading.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 56</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=75&amp;annotation=96JZPRGW">pdf</a>)</p>
</blockquote>
<p><code>rethinking::PI()</code> is just a shorthand for the base R <code>stats::quantile()</code> function.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-pi-a1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.25 </strong></span>a: Computing the Percentile Interval (PI)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/pi-a1_9f9a0ac9e55c376e74ba91061a626ac0">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb42"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12a(1) PI ############################</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_skewed_a, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;       25%       75% 
#&gt; 0.7087087 0.9349349</code></pre>
</div>
</div>
</div>
</div>
<div class="my-procedure">
<div class="my-procedure-header">
<div id="prp-pi-a1" class="theorem proposition">
<p><span class="theorem-title"><strong>Procedure 3.1 </strong></span>: Probability mass (PI) <code>prob = 0.6</code> equals the interval between <span class="math inline">\(20-80\%\)</span></p>
</div>
</div>
<div class="my-procedure-container">
<p><code>rethinking::PI()</code> is just a shorthand for the base R <code>stats::quantile()</code> function. Instead of providing the interval explicitly (for instance <span class="math inline">\(20-80\%\)</span>) we just say that we want the central <span class="math inline">\(60\%\)</span> = PI of <code>prob = 0.6</code>.</p>
<p><code>rethinking::PI()</code> simplifies the following three steps:</p>
<ol type="1">
<li>We divide always the percentage assigned to the <code>prob</code> value by 2: 60% / 2 = 30%$</li>
<li>We subtract, respectively add this value to 50: 50% - 30% = 20% and 50% + 30% = 80%</li>
<li>The result is the probability mass between 20-80%.</li>
</ol>
</div>
</div>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-pi-a2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.26 </strong></span>a: Compute PI between <span class="math inline">\(20-80\%\)</span> (Rethinking and Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/pi-a2_a059f98a558eef9e646ea6b5e3c57705">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb44"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12a(2) PI ############################</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Central Propbability Mass calculated with rethinking::PI()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_skewed_a, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;########################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Central Propbability Mass calculated with stats::quantile()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples_skewed_a, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">20</span>, .<span class="dv">80</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Central Propbability Mass calculated with rethinking::PI()
#&gt;       20%       80% 
#&gt; 0.6706707 0.9481481 
#&gt; ########################################################
#&gt; 
#&gt; Central Propbability Mass calculated with stats::quantile()
#&gt;       20%       80% 
#&gt; 0.6706707 0.9481481</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="highest-posterior-density-interval-hpdi" class="level5" data-number="3.2.2.1.3">
<h5 data-number="3.2.2.1.3"><span class="header-section-number">3.2.2.1.3</span> Highest Posterior Density Interval (HPDI)</h5>
<p>To include the most probable parameter value, the modus or <a class='glossary' title='In Bayesian statistics a Maximum A Posteriori probability or MAP is essentially the mode of posterior distribution. (CDS, p.272)'>MAP</a> we should calculate the <a class='glossary' title='Highest Posterior Density Interval (HPDI) is the Highest Density Interval (HDI) or Highest Density Region (HDR) of all possible regions of probability coverage, the HDR has the smallest region possible in the sample space. For a unimodal distribution it will include the mode (the maximum a posteriori, or MAP). (Cross Validated).'>HPDI</a>:</p>
<blockquote>
<p>“The HPDI is the narrowest interval containing the specified probability mass. If you think about it, there must be an infinite number of posterior intervals // with the same mass. But if you want an interval that best represents the parameter values most consistent with the data, then you want the densest of these intervals. That’s what the HPDI is.” (McElreath, 2020, p. 56/57)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-hpdi-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.27 </strong></span>a: Compute Highest Posterior Density Interval (HPDI) (Rethinking / Base R)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/rethinking-HPDI-a_1157a07b6ed1e72fc5a91e8f1ab1c825">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb46"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13a HPDI ###############################</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_skewed_a, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      |0.5      0.5| 
#&gt; 0.8418418 0.9989990</code></pre>
</div>
</div>
</div>
</div>
<div class="my-note">
<div class="my-note-header">
<div id="cor-pi-hpdo" class="theorem corollary">
<p><span class="theorem-title"><strong>Note 3.2 </strong></span>: HPDI versus PI</p>
</div>
</div>
<div class="my-note-container">
<p><strong>Advantages of HPDI</strong></p>
<ol type="1">
<li>HPDI captures the parameters with highest posterior probability</li>
<li>HPDI is noticeably narrower than PI. In our example 0.157 versus <code>r</code>round(rethinking::PI(samples_skewed_a, prob = 0.5)[[2]] - rethinking::PI(samples_skewed_a, prob = 0.5)[[1]], 3)`.</li>
</ol>
<p>But this is only valid if we have a very skewed distribution.</p>
<p><strong>Disadvantages of HPDI</strong></p>
<ol type="1">
<li>HPDI is more computationally intensive than PI</li>
<li>HPDI is sensitive of the number of samples drawn (= greater simulation variance)</li>
<li>HPDI is more difficult to understand</li>
</ol>
<p><strong>Remember, the entire posterior distribution is the Bayesian estimate</strong></p>
<blockquote>
<p>“Overall, if the choice of interval type makes a big difference, then you shouldn’t be using intervals to summarize the posterior. Remember, the entire posterior distribution is the Bayesian ‘estimate.’ It summarizes the relative plausibilities of each possible value of the parameter. Intervals of the distribution are just helpful for summarizing it. If choice of interval leads to different inferences, then you’d be better off just plotting the entire posterior distribution.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 58</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=77&amp;annotation=XGHNSWCG">pdf</a>)</p>
</blockquote>
</div>
</div>
<p>“[I]n most cases, these two types of interval are very similar.58 They only look so different in this case because the posterior distribution is highly skewed.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 57</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=76&amp;annotation=FQPNEVHV">pdf</a>)n</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-pi-hpdi-symmetric-dist-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.28 </strong></span>a: Compare PI and HPDI of symmetric distributions: Six ‘Water’, 9 tosses</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/pi-hpdi-symmetric-dist-a_83b76a9a735cc676bd488772bdcfcd66">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb48"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pi8a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_a, <span class="at">prob =</span> <span class="fl">0.8</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>hpdi8a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_a, <span class="at">prob =</span> <span class="fl">0.8</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>pi95a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_a, <span class="at">prob =</span> <span class="fl">0.95</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>hpdi95a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_a, <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code></pre></div>
</details>
</div>
<ul>
<li>PI 80% = 0.4514515, 0.8148148 versus HPDI 80% = 0.4874875, 0.8448448.</li>
<li>PI 95% = 0.3493493, 0.8788789 versus HPDI 95% = 0.3703704, 0.8938939.</li>
</ul>
</div>
</div>
<p>The 95% interval in frequentist statistics is just a convention, there are no analytical reasons why you should choose exactly this interval. But convenience is not a serious criterion. So what to do instead?</p>
<div class="my-tip">
<div class="my-tip-header">
<p>Instead of 95% intervals use the widest interval that excludes the value you want to report or provide a series of nested intervals</p>
</div>
<div class="my-tip-container">
<blockquote>
<p>“If you are trying to say that an interval doesn’t include some value, then you might use the widest interval that excludes the value. Often, all compatibility intervals do is communicate the shape of a distribution. In that case, a series of nested intervals may be more useful than any one interval. For example, why not present 67%, 89%, and 97% intervals, along with the median? Why these values? No reason. They are prime numbers, which makes them easy to remember. But all that matters is they be spaced enough to illustrate the shape of the posterior. And these values avoid 95%, since conventional 95% intervals encourage many readers to conduct unconscious hypothesis tests.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 56</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=75&amp;annotation=TG2LCZAG">pdf</a>)</p>
</blockquote>
</div>
</div>
<div class="my-note">
<div class="my-note-header">
<p>Boundaries versus Probability Mass Intervals</p>
</div>
<div class="my-note-container">
<p><strong>Boundaries</strong>:</p>
<ul>
<li>We ask for a <strong>probability of frequencies</strong>.</li>
<li>Result is a <strong>percentage of probability</strong>.</li>
<li>Boundaries are grounded on the <strong>probability (<code>prob</code>) values (</strong><span class="math inline">\(0-1\)</span>).</li>
</ul>
<p><strong>Probability Mass</strong>:</p>
<ul>
<li>We ask for a specified <strong>amount of posterior probability</strong>.</li>
<li>Result is the probability value of the <strong>percentage of frequencies</strong> we looked for.</li>
<li>Probability Mass is grounded on the <strong>percentage of probabilities (</strong><span class="math inline">\(0-100\%\)</span>).</li>
</ul>
</div>
</div>
</section>
</section>
<section id="tidyverse-3" class="level4" data-number="3.2.2.2">
<h4 data-number="3.2.2.2"><span class="header-section-number">3.2.2.2</span> TIDYVERSE</h4>
<section id="quantiles-1" class="level5" data-number="3.2.2.2.1">
<h5 data-number="3.2.2.2.1"><span class="header-section-number">3.2.2.2.1</span> Quantiles</h5>
<p>Kurz offers again different methods — this time to calculate probability mass:</p>
<ol type="1">
<li><strong>Method</strong>: Since we saved our <code>samples_b</code> samples within the <code>df_samples_b</code> tibble, we’ll have to index with <code>$</code> within <code>stats::quantile()</code>.</li>
<li><strong>Method</strong>: For an alternative approach, we could <code>dplyr::select()</code> the <code>samples_b</code> vector, extract it from the tibble with <code>dplyr::pull()</code>, and then pump it into <code>stats::quantile()</code>.</li>
</ol>
<blockquote>
<p><code>pull()</code> is similar to <code>$</code>. It’s mostly useful because it looks a little nicer in pipes, it also works with remote data frames, and it can optionally name the output. (<a href="https://dplyr.tidyverse.org/reference/pull.html"><code>dplyr::pull()</code> help file “Extract a single column”</a>)</p>
</blockquote>
<ol start="3" type="1">
<li><strong>Method</strong>: We might also use <code>stats::quantile()</code> within <code>dplyr::summarize()</code>.</li>
</ol>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-quantiles-b1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.29 </strong></span>b: Compute posterior probability mass intervals of <span class="math inline">\(80\%\)</span> with different methods</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/quantiles-b1_d8a9e12aa98dcc92518764eebe4ce17f">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.9b Quantile 0.8 diff. approaches   #######################</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (1) #######</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>method_1 <span class="ot">&lt;-</span> q80 <span class="ot">&lt;-</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">probs =</span> .<span class="dv">8</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 1:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>method_1</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;##################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (2) #######</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>method_2 <span class="ot">&lt;-</span> </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">pull</span>(samples_b) <span class="sc">|&gt;</span> </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">quantile</span>(<span class="at">probs =</span> .<span class="dv">8</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 2:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>method_2</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;##################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (3) #######</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>method_3 <span class="ot">&lt;-</span> </span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">q80_2 =</span> <span class="fu">quantile</span>(samples_b, <span class="at">probs =</span> .<span class="dv">8</span>))</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 3:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>method_3</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Method 1:
#&gt;       80% 
#&gt; 0.7627628 
#&gt; ##################################################
#&gt; 
#&gt; Method 2:
#&gt;       80% 
#&gt; 0.7627628 
#&gt; ##################################################
#&gt; 
#&gt; Method 3:
#&gt; # A tibble: 1 × 1
#&gt;   q80_2
#&gt;   &lt;dbl&gt;
#&gt; 1 0.763</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="percentile-interval-pi-1" class="level5" data-number="3.2.2.2.2">
<h5 data-number="3.2.2.2.2"><span class="header-section-number">3.2.2.2.2</span> Percentile Interval (PI)</h5>
<p>Here’s the <code>summarize()</code> approach with two probabilities returning the <a class='glossary' title='The set of divisions that produce exactly 100 equal parts in a series of continuous values, such as blood pressure, weight, height, etc. Thus a person with blood pressure above the 80th percentile has a greater blood pressure value than over 80% of the other recorded values.” (CDS, p.323)'>percentile interval</a> (PI).</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-pi-b1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.30 </strong></span>b: Compute probability mass of 80% with summarize method</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/pi-b1_1a616f218aa64abc0f38a3b457ea7604">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.10b(1) PI = Quantile 0.1-0.9 ###################</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">q10 =</span> <span class="fu">quantile</span>(samples_b, <span class="at">probs =</span> .<span class="dv">1</span>),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">q90 =</span> <span class="fu">quantile</span>(samples_b, <span class="at">probs =</span> .<span class="dv">9</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1 × 2
#&gt;     q10   q90
#&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 0.451 0.815</code></pre>
</div>
</div>
</div>
</div>
<p>Kurz refers also to a now deprecated calculation using the vector feature of R to summarize different quantiles with one line.</p>
<hr />
<pre><code>samples_b |&gt; dplyr::summarize(q10_90 = quantile(samples_b, probs = c(.1, .9)))</code></pre>
<hr />
<p>This produces nowadays the following warning message:</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Watch out!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Warning: Returning more (or less) than 1 row per <code>summarise()</code> group was deprecated in dplyr 1.1.0.</p>
<p>Please use <code>reframe()</code> instead.</p>
<p>When switching from <code>summarise()</code> to <code>reframe()</code>, remember that <code>reframe()</code> always returns an ungrouped data frame and adjust accordingly.</p>
</div>
</div>
<p>Therefore I am going to change <code>dplyr::summarize()</code> to <code>dplyr::reframe()</code>.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-reframe" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.31 </strong></span>b: Using <code>dplyr::reframe()</code> to compute probability mass intervals of 80%</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/quantile-reframe_69b30bcbce92df99da4f43b36726e49a">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb54"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.10b(2) PI = Quantile 0.1-0.9 ###################</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">reframe</span>(<span class="at">q10_90 =</span> <span class="fu">quantile</span>(samples_b, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>)))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 1
#&gt;   q10_90
#&gt;    &lt;dbl&gt;
#&gt; 1  0.451
#&gt; 2  0.815</code></pre>
</div>
</div>
<div class="my-note">
<div class="my-note-header">
<div id="cor-reframe" class="theorem corollary">
<p><span class="theorem-title"><strong>Note 3.3 </strong></span>: Excursion: Using <code>dplyr::reframe()</code> and friends</p>
</div>
</div>
<div class="my-note-container">
<p>From the help file of <code>dplyr::reframe()</code>:</p>
<blockquote>
<p>While <code>summarise()</code> requires that each argument returns a single value, and <code>mutate()</code> requires that each argument returns the same number of rows as the input, <code>reframe()</code> is a more general workhorse with no requirements on the number of rows returned per group.</p>
<p><code>reframe()</code> creates a new data frame by applying functions to columns of an existing data frame. It is most similar to <code>summarise()</code>, with two big differences:</p>
<ul>
<li><code>reframe()</code> can return an arbitrary number of rows per group, while <code>summarise()</code> reduces each group down to a single row.</li>
<li><code>reframe()</code> always returns an ungrouped data frame, while <code>summarise()</code> might return a grouped or rowwise data frame, depending on the scenario.</li>
</ul>
<p>We expect that you’ll use <code>summarise()</code> much more often than <code>reframe()</code>, but <code>reframe()</code> can be particularly helpful when you need to apply a complex function that doesn’t return a single summary value.</p>
</blockquote>
<p>See also the appropriate <a href="https://www.tidyverse.org/blog/2023/02/dplyr-1-1-0-pick-reframe-arrange/#reframe">section in the blog post</a> about changes in {<strong>dplyr</strong>} 1.1.0. The name <code>reframe()</code> is in accordance with <code>tibble::enframe()</code> and <code>tibble::deframe()</code>:</p>
<ul>
<li><code>enframe()</code>: Takes a vector, returns a data frame</li>
<li><code>deframe()</code>: Takes a data frame, returns a vector</li>
<li><code>reframe()</code>: Takes a data frame, returns a data frame</li>
</ul>
</div>
</div>
</div>
</div>
<blockquote>
<p>The functions of the tidyverse approach typically returns a data frame. But sometimes you just want your values in a numeric vector for the sake of quick indexing. In that case, base R <code>stats::quantile()</code> shines: (Kurz in the section: <a href="https://bookdown.org/content/4857/sampling-the-imaginary.html#intervals-of-defined-mass.">Intervals of defined mass</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-pi-b2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.32 </strong></span>b: Using <code>stats::quantile()</code> to get a vector of a probability mass calculation</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/pi-b2_b6701835d008ad8c209d8a6f3d086c4d">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb56"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12b(1) PI = Quantile 0.1-0.9#############################</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">q10_q90 =</span> <span class="fu">quantile</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>)))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;       10%       90% 
#&gt; 0.4514515 0.8148148</code></pre>
</div>
</div>
<p>This is the same method as in R base with the difference that we are working with tibbles and need therefore to use the <code>$</code> operator.</p>
</div>
</div>
<p>To produce the bottom part of Figure 3.2 of the book we apply following code lines.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-lower-part-3-2b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.33 </strong></span>b: Plots of defined mass intervals lower of 80% and the middle 80%</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-lower-part-3-2b_474cd6cd019b9b59d970ce3c864f3a53">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb58"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R Code Fig 3.2b Lower Part #############</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b, <span class="at">y =</span> posterior_samples_b)) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&lt;</span> q80), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;lower 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co"># upper right panel</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b, <span class="at">y =</span> posterior_samples_b)) <span class="sc">+</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&gt;</span> q10_q90[[<span class="dv">1</span>]] <span class="sc">&amp;</span> </span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>                    samples_b <span class="sc">&lt;</span> q10_q90[[<span class="dv">2</span>]]), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;middle 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-lower-part-3-2b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-lower-part-3-2b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.8: Lower part of SR2 Figure 3.2: Intervals of defined mass produced with {<strong>tidyverse</strong>} tools: Left: Lower 80% posterior probability exists below a parameter value of about 0.75. Right: Middle 80% posterior probability lies between the 10% and 90% quantiles.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Again we will demonstrate the misleading character of <a class='glossary' title='The set of divisions that produce exactly 100 equal parts in a series of continuous values, such as blood pressure, weight, height, etc. Thus a person with blood pressure above the 80th percentile has a greater blood pressure value than over 80% of the other recorded values.” (CDS, p.323)'>Percentile Intervals</a> (PIs) with a very skewed distribution.</p>
<p>We’ve already defined <code>p_grid_b</code> and <code>prior_b</code> within <code>d_b</code>, above. Here we’ll reuse them and create a new tibble by updating all the columns with the skewed parameters of three ‘Water’ in three tosses.</p>
<p>To see the difference how the skewed distribution is different to the Figure 3.2 lower part, I will draw the appropriate figure here myself.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-skewed-dist-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.34 </strong></span>b: Skewed posterior distribution observing three waters in three tosses and a uniform (flat) prior (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-layout-align="center" data-figh-height="5" data-hash="03-sampling-the-imaginary_cache/html/fig-skewed-dist-b_0d5029015408fd7a1b8098161d4aebf3">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.11b Skewed data #########################</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># here we update the `dbinom()` parameters </span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for values for a skewed distribution</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming three trials results in 3 W (Water)</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>n_samples_skewed_b <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>n_success_skewed_b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>n_trials_skewed_b  <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co"># update `d_b` to d_skewed_b</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>d_skewed_b <span class="ot">&lt;-</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  d_b <span class="sc">|&gt;</span> </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">likelihood_skewed_b =</span> </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        stats<span class="sc">::</span><span class="fu">dbinom</span>(n_success_skewed_b,</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> n_trials_skewed_b, <span class="at">prob =</span> p_grid_b)) <span class="sc">|&gt;</span> </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">posterior_skewed_b  =</span> </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>          (likelihood_skewed_b <span class="sc">*</span> prior_b) <span class="sc">/</span> </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sum</span>(likelihood_skewed_b <span class="sc">*</span> prior_b))</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co"># make the next part reproducible</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co"># here&#39;s our new samples tibble</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="ot">&lt;-</span> </span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples_skewed_b, </span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight_by =</span> posterior_skewed_b, <span class="at">replace =</span> T) <span class="sc">|&gt;</span> </span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">p_skewed_b =</span> p_grid_b,</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">prior_skewed_b =</span> prior_b)</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="co"># added to see the skewed distribution</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span>  </span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>( ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-skewed-dist-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-skewed-dist-b-1.png" class="img-fluid" style="width:50.0%" /></p>
<figcaption>Graph 3.9: Skewed posterior distribution observing three waters in three tosses and a uniform (flat) prior. The distribution is highly skewed, having its maximum value where p equals 1.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>To see how the skewed distribution is different to the book’s Figure 3.2 lower part, I will draw the appropriate figure here.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-prob-mass-skewed-dist" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.35 </strong></span>b: Lower 80% and middle 80% of probability mass intervals in the skewed distribution</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-prob-mass-skewed-dist_65d5d28cdcd1a7fead1c99718a93118f">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb60"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12b(2) PI &lt; 80 &amp; middle 80% #############################</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(p_skewed_b <span class="sc">&lt;</span> q80), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;lower 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co"># upper right panel</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(p_skewed_b <span class="sc">&gt;</span> q10_q90[[<span class="dv">1</span>]] <span class="sc">&amp;</span> </span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>                    p_skewed_b <span class="sc">&lt;</span> q10_q90[[<span class="dv">2</span>]]), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;middle 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-prob-mass-skewed-dist" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-prob-mass-skewed-dist-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.10: Probability mass intervals in a skewed distribution. Left: Lower 80%. right: Middle 80% = 80% Percentile Interval (PI)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="introducing-tidybayes" class="level5 unnumbered">
<h5 class="unnumbered">Introducing tidybayes</h5>
<div class="my-resource">
<div class="my-resource-header">
<p>Introducing the {<strong>tidybayes</strong>} package by Matthew Kay</p>
</div>
<div class="my-resource-container">
<p>The <a href="https://mjskay.github.io/tidybayes/">{<strong>tidybayes</strong>}</a> package by <a href="https://www.mjskay.com/">Matthew Kay</a> offers an array of convenience functions for summarizing Bayesian models.</p>
<blockquote>
<p>{<strong>tidybayes</strong>} is an R package that aims to make it easy to integrate popular Bayesian modeling methods into a tidy data + ggplot workflow. It builds on top of (and re-exports) several functions for visualizing uncertainty from its sister package, <a href="https://mjskay.github.io/ggdist/">{<strong>ggdist</strong>}</a>.</p>
</blockquote>
<ul>
<li><p>For an introduction using {<strong>tidybayes</strong>} with {<strong>brms</strong>} see <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html">Extracting and visualizing tidy draws from {<strong>brms</strong>} models</a>.</p></li>
<li><p>For a general introduction (not confined to {<strong>brms</strong>}) see <a href="https://mjskay.github.io/tidybayes/articles/tidybayes.html">Using tidy data with Bayesian models</a> but read also the start page <a href="https://mjskay.github.io/tidybayes/">tidybayes: Bayesian analysis + tidy data + geoms</a> of the package documentation.</p></li>
<li><p>Besides supporting many types of models there is an additional {<strong>tidybayes.rethinking</strong>} package <a href="https://mjskay.github.io/tidybayes.rethinking/">available on GitHub</a> that extends {<strong>tidybayes</strong>} to work with the {<strong>rethinking</strong>} package. I think this package is a new development because Kurz didn’t mention it. (As far as I know, because at the moment I have read his <a href="https://bookdown.org/content/4857/">version 0.40</a> only until chapter 4.)</p></li>
</ul>
<p>For the following parts the section on <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html#point-summaries-and-intervals">Point Summaries and Intervals</a> and the reference on <a href="https://mjskay.github.io/ggdist/reference/point_interval.html">Point and interval summaries for tidy data frames of draws from distributions</a> are especially important.</p>
<p>The mentioned vignettes above are long articles I haven’t read yet. I plan to do this in the next future but for now I am concentrating and trusting on Kurz’ text to apply and explain the most important function parallel to McElreath book chapters.</p>
</div>
</div>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>Many function names used by Kurz do not apply anymore</p>
</div>
<div class="my-watch-out-container">
<p>I had difficulties to use Kurz’s functions because there was an <a href="https://mjskay.github.io/tidybayes/reference/tidybayes-deprecated.html">overhaul in the naming scheme</a> of {<strong>tidybayes</strong>} version 1.0 and a deprecation of horizontal shortcut geoms and stats in {<strong>tidybayes</strong>} 2.1. Because {<strong>tidybayes</strong>} integrates function of the sister package {<strong>ggdist</strong>} the <a href="https://mjskay.github.io/ggdist/reference/index.html">function descriptions and references of {<strong>ggdist</strong>}</a> are also important to consult. For instance all the function on <a href="https://mjskay.github.io/ggdist/reference/point_interval.html">point and interval summaries</a> are now documented in {<strong>ggdist</strong>}.</p>
<p>There is a systematic change of the function names: The <code>h</code> (for ‘horizontal’) in parameter name of the point estimate was removed. For instance: Instead of <code>median_qih()</code>, <code>median_hdih()</code> and <code>median_hdcih()</code> it is now <code>tidybayes::median_qi()</code>, <code>tidybayes::median_hdi()</code> and <code>tidybayes::median_hdci()</code>. Similar with <code>point_inverhalh()</code>, <code>mean\_\*</code> and <code>mode\_\*</code>.</p>
<hr />
<p>There is another adaption compared to the Kurz’ version: I can’t reproduce the codes with his <code>samples</code> (my <code>samples_b</code>) data frame, because the data has changed values recently to the skewed sampling version. To get the same results as Kurz I have to use in my naming scheme the <code>skewed</code> version.</p>
</div>
</div>
<blockquote>
<p>The {<strong>tidybayes</strong>} package contains a <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html#point-summaries-and-intervals">family of functions</a> that make it easy to summarize a distribution with a measure of central tendency accompanied by intervals. With <code>tidybayes::median_qi()</code>, we will ask for the median and quantile-based intervals — just like we’ve been doing with <code>stats::quantile()</code>. (<a href="https://bookdown.org/content/4857/sampling-the-imaginary.html#intervals-of-defined-mass.">Kurz</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-median-qi" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.36 </strong></span>: Computing the median quantile interval with {<strong>tidybayes</strong>}</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/median-quantile-interval_4e6cf62891adca1869b35c9b291b8166">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;           y      ymin      ymax .width .point .interval
#&gt; 1 0.8428428 0.7087087 0.9349349    0.5 median        qi</code></pre>
</div>
</div>
<blockquote>
<p>Note how the <code>.width</code> argument within <code>tidybayes::median_qi()</code> worked the same way the <code>prob</code> argument did within <code>rethinking::PI()</code>. With <code>.width = .5</code>, we indicated we wanted a quantile-based 50% interval, which was returned in the <code>ymin</code> and <code>ymax</code> columns.</p>
</blockquote>
</div>
</div>
<div class="my-note">
<div class="my-note-header">
<div id="cor-point-interval-summaries" class="theorem corollary">
<p><span class="theorem-title"><strong>Note 3.4 </strong></span>: Point and interval summaries for tidy data frames of draws from distributions</p>
</div>
</div>
<div class="my-note-container">
<p>The <code>qi</code> in <code>tidybayes::median_qi()</code> stands for “quantile interval”. The explanation of this function family (<code>median_qi()</code>, <code>mean_qi()</code> and <code>mode_qi()</code>) is now documented in the {<strong>ggdist</strong>} package.</p>
<blockquote>
<p>The <code>qi</code>-variants is the short form of the function family of <code>tidybayes::point_interval(..., .point = median, .interval = qi)</code>.</p>
<p>There are several point intervals that {<strong>tidybayes</strong>} respectively {<strong>ggdist</strong>} computes:</p>
<ul>
<li><strong>qi</strong> yields the quantile interval (also known as the percentile interval or equi-tailed interval) as a 1x2 matrix.</li>
<li><strong>hdi</strong> yields the highest-density interval(s) (also known as the highest posterior density interval). Note: If the distribution is multimodal, hdi may return multiple intervals for each probability level (these will be spread over rows). You may wish to use hdci (below) instead if you want a single highest-density interval, with the caveat that when the distribution is multimodal hdci is not a highest-density interval.</li>
<li><strong>hdci</strong> yields the highest-density continuous interval, also known as the shortest probability interval. Note: If the distribution is multimodal, this may not actually be the highest-density interval (there may be a higher-density discontinuous interval, which can be found using hdi).</li>
<li><strong>ll and ul</strong> yield lower limits and upper limits, respectively (where the opposite limit is set to either Inf or -Inf). (<a href="https://mjskay.github.io/ggdist/reference/point_interval.html">ggdist reference</a>)</li>
</ul>
</blockquote>
</div>
</div>
<blockquote>
<p>The {<strong>tidybayes</strong>} framework makes it easy to request multiple types of intervals. In the following code chunk we’ll request 50%, 80%, and 99% intervals.</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-multiple-intervals-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.37 </strong></span>b: Requesting multiple type of intervals with {<strong>tidybayes</strong>}</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/multiple-intervals-b_e399434b2794763c461b3274996fd7c3">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb63"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12b(3) different PIs ##############</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">8</span>, .<span class="dv">99</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;           y      ymin      ymax .width .point .interval
#&gt; 1 0.8428428 0.7087087 0.9349349   0.50 median        qi
#&gt; 2 0.8428428 0.5705706 0.9749750   0.80 median        qi
#&gt; 3 0.8428428 0.2562563 0.9989990   0.99 median        qi</code></pre>
</div>
</div>
<blockquote>
<p>The .width column in the output indexed which line presented which interval. The value in the y column remained constant across rows. That’s because that column listed the measure of central tendency, the median in this case.</p>
</blockquote>
</div>
</div>
</section>
<section id="highest-posterior-density-interval-hpdi-1" class="level5" data-number="3.2.2.2.3">
<h5 data-number="3.2.2.2.3"><span class="header-section-number">3.2.2.2.3</span> Highest Posterior Density Interval (HPDI)</h5>
<blockquote>
<p>Now let’s use the <code>rethinking::HPDI()</code> function to return 50% highest posterior density intervals (HPDIs).</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-rethinking-hpdi-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.38 </strong></span>b: Compute Highest Posterior Density Interval (HPDI) (Rethinking / Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/rethinking-HPDI-b_cc3db276038e54fb4520c5c77a9c48a6">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(1) HPDI ###############################</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">prob =</span> .<span class="dv">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      |0.5      0.5| 
#&gt; 0.8418418 0.9989990</code></pre>
</div>
</div>
</div>
</div>
<blockquote>
<p>The reason I introduce {<strong>tidybayes</strong>} now is that the functions of the {<strong>brms</strong>} package only support percentile-based intervals of the type we computed with <code>quantile()</code> and <code>median_qi()</code>. But {<strong>tidybayes</strong>} also supports HPDIs.</p>
</blockquote>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>: Two Version for Highest Density Intervals</p>
</div>
<div class="my-watch-out-container">
<p>As already mentioned in <a href="#cor-point-interval-summaries" class="quarto-xref">Note <span class="quarto-unresolved-ref">cor-point-interval-summaries</span></a> there is <code>hdi</code>and <code>hcdi</code>. Both functions produce the same result in unimodal distributions.</p>
<p>But in the case of an extreme skewed distribution like our data frame with the observation of 3 ‘Water’ with 3 tosses the <code>tidybayes::hdi()</code> functions generates an error.</p>
<blockquote>
<p>Error in quantile.default(dist_y, probs = 1 - .width) :<br />
missing values and NaN’s not allowed if ‘na.rm’ is FALSE</p>
</blockquote>
<p>My error message with <code>hdi</code> is in contrast to Kurz’ version where this function seems to work. BTW: I got the same error message providing the vector <code>samples_skewed_a</code>. from the Base R version.</p>
</div>
</div>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-tidyverse-HPDI-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.39 </strong></span>: High Density Intervals with {<strong>tidybayes</strong>}</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">6 W, n=9</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">3 W, n=3</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/tidyverse-HPDI-b1_b149b776066d951da2633fb4d7edb755">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb67"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(2a) HPDI 6 Water, 9 tosses #####################</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdi</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;           y      ymin      ymax .width .point .interval
#&gt; 1 0.6508383 0.5685686 0.7597598    0.5   mode       hdi
#&gt;           y      ymin      ymax .width .point .interval
#&gt; 1 0.6508383 0.5685686 0.7597598    0.5   mode      hdci</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/tidyverse-HPDI-b2_066c5bc08c7652428a542b26146c78c4">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb69"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(2b) HPDI 3 Water, 3 tosses #####################</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tidybayes::mode_hdi(samples_skewed_b$p_skewed_b, .width = .5) # generates error</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;           y      ymin     ymax .width .point .interval
#&gt; 1 0.9995616 0.8418418 0.998999    0.5   mode      hdci</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>In contrast to <a href="#cnj-multiple-intervals-b" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-multiple-intervals-b</span></a> and <a href="#cnj-rethinking-hpdi-b" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-rethinking-hpdi-b</span></a> we used this time the mode as the measure of central tendency. With this family of {<strong>tidybayes</strong>} functions, you specify the measure of central tendency in the prefix (i.e., mean, median, or mode) and then the type of interval you’d like (i.e., <code>qi()</code> or <code>hdci()</code>).</p>
<p>If all you want are the intervals without the measure of central tendency or all that other technical information, {<strong>tidybayes</strong>} also offers the handy <code>qi()</code> and <code>hdi()</code> functions.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-pi-4" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.40 </strong></span>: Numbered R Code Title</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/pi-4_7c52e13b74873cf333162cfdf21d5124">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb71"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12b4 PI 0.5 ##############################</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;           [,1]      [,2]
#&gt; [1,] 0.7087087 0.9349349</code></pre>
</div>
</div>
</div>
</div>
<p>We have now all necessary skills to plot book’s Figure 3.3:</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-pi-hpdi" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.41 </strong></span>b: Plot the difference between percentile interval (PI) and highest posterior density intervals (HPDI)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-pi-hpdi_b99dbdd5fbdb4cf86b74756b578acd86">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code Figure 3.3 #######################</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># left panel</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check out our sweet `qi()` indexing</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(p_skewed_b <span class="sc">&gt;</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                tidybayes<span class="sc">::</span><span class="fu">qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">1</span>] <span class="sc">&amp;</span> </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                     p_skewed_b <span class="sc">&lt;</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                tidybayes<span class="sc">::</span><span class="fu">qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">2</span>]),</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;50% Percentile Interval&quot;</span>,</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co"># right panel</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(p_skewed_b <span class="sc">&gt;</span> </span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>                 tidybayes<span class="sc">::</span><span class="fu">hdci</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">1</span>] <span class="sc">&amp;</span> </span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>                       p_skewed_b <span class="sc">&lt;</span> </span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>                 tidybayes<span class="sc">::</span><span class="fu">hdci</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">2</span>]),</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;50% HPDI&quot;</span>,</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a><span class="co"># combine!</span></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pi-hpdi" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-pi-hpdi-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.11: Reproduction of Figure 3.3 (p.57): The difference between percentile and highest posterior density compatibility intervals. The posterior density here corresponds to a flat prior and observing three water samples in three total tosses of the globe. Left: 50% percentile interval. This interval assigns equal mass (25%) to both the left and right tail. As a result, it omits the most probable parameter value, where p equals 1. Right: 50% highest posterior density interval, HPDI. This interval finds the narrowest region with 50% of the posterior probability. Such a region always includes the most probable parameter value.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Comparing the two panels of the plot you can see that in contrast to the 50% HPDI the 50% of PI does not include the highest probability value.</p>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>{<strong>magrittr</strong>} and native R pipe</p>
</div>
<div class="my-watch-out-container">
<p>Kurz uses the {<strong>magrittr</strong>} paipe whereas I am using the native R pipe. These two pipes are not in every aspect equivalent. One difference is the dot (<code>.</code>) syntax, “since the dot syntax is a feature of {<strong>magrittr</strong>} and not of base R.” (<a href="https://ivelasq.rbind.io/blog/understanding-the-r-pipe/#how-the-native-r-pipe-works">Understanding the native R pipe</a>).</p>
<p>The native pipe is available starting with R 4.1.0. It is constructed with <code>|</code> followed by <code>&gt;</code> resulting in the symbol <code>|&gt;</code> to differentiate it from the {<strong>magrittr</strong>} pipe (<code>%&gt;%</code>). To understand the details of the differences of <code>|&gt;</code> and the native R pipe <code>|&gt;</code> read this elaborated <a href="https://ivelasq.rbind.io/blog/understanding-the-r-pipe/index.html">blog article by Isabella Velásquez</a>, an employee of <a href="https://posit.co/">Posit</a> (formerly RStudio).</p>
<p>So the following trick does not work with the native R pipe:</p>
<blockquote>
<p>In the geom_area() line for the HPDI plot, did you notice how we replaced <code>data = samples_skewed_b</code> with <code>data = .</code>? When using the pipe (i.e., <code>%&gt;%</code>), you can use the <code>.</code> as a placeholder for the original data object. It’s an odd and handy trick to know about.</p>
</blockquote>
<p>Therefore I had to replace the dot with the name of the data frame.</p>
<p>Learn more of the <a href="https://magrittr.tidyverse.org/reference/pipe.html">pipe function <code>%&gt;%</code> of the {<strong>magrittr</strong>} package</a> and about the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/pipeOp.html">base R native forward pipe operator</a>.</p>
</div>
</div>
<p>PI and HPDI are only different if you have a very skewed distribution. This means that in unimodal somewhat normal distribution <code>hdi</code> and <code>hdci</code> are exactly the same and pretty similar to <code>qi</code> calculation. In skewed distribution they differ. assertion:</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div>
<p>b: High Density Intervals with {<strong>tidybayes</strong>}</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">6 W, n=9</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">3 W, n=3</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/tidyverse-PI-HPDI-b1_41c2c7f200ac308e6a6e76a6965579d9">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb74"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(2a) HPDI 6 Water, 9 tosses #####################</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdi</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;           y      ymin      ymax .width .point .interval
#&gt; 1 0.6508383 0.5685686 0.7597598    0.5   mode       hdi
#&gt;           y      ymin      ymax .width .point .interval
#&gt; 1 0.6508383 0.5685686 0.7597598    0.5   mode      hdci
#&gt;           y      ymin      ymax .width .point .interval
#&gt; 1 0.6508383 0.5475475 0.7427427    0.5   mode        qi</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/tidyverse-PI-HPDI-b2_bf469faff3bfb4ddfc48237d9c1e7fc4">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb76"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(2b) HPDI 3 Water, 3 tosses #####################</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tidybayes::mode_hdi(samples_skewed_b$p_skewed_b, .width = .5) # generates error</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;           y      ymin     ymax .width .point .interval
#&gt; 1 0.9995616 0.8418418 0.998999    0.5   mode      hdci
#&gt;           y      ymin      ymax .width .point .interval
#&gt; 1 0.9995616 0.7087087 0.9349349    0.5   mode        qi</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Because of the disadvantages of <a class='glossary' title='Highest Posterior Density Interval (HPDI) is the Highest Density Interval (HDI) or Highest Density Region (HDR) of all possible regions of probability coverage, the HDR has the smallest region possible in the sample space. For a unimodal distribution it will include the mode (the maximum a posteriori, or MAP). (Cross Validated).'>HPDI</a> (more computationally intensive, greater simulation variance and harder to understand) Kurz will primarily stick to the PI-based intervals. And he will not use the 5.5% and 94.5% <a class='glossary' title='Quantiles are cut points dividing the range of a probability distribution into continuous intervals with equal probabilities (Wikipedia)'>quantiles</a> that are <a class='glossary' title='The set of divisions that produce exactly 100 equal parts in a series of continuous values, such as blood pressure, weight, height, etc. Thus a person with blood pressure above the 80th percentile has a greater blood pressure value than over 80% of the other recorded values.” (CDS, p.323)'>percentile intervals</a> boundaries, corresponding to an 89% <a class='glossary' title='Two parameter values that contain between them a specified amount of posterior probability, a probability mass, is usually know as confidence interval that may instead be called a credible interval. We’re going to call it a compatibility interval instead, in order to avoid the unwarranted implications of “confidence”” and “credibility.” What the interval indicates is a range of parameter values compatible with the model and data. The model and data themselves may not inspire confidence, in which case the interval will not either. (Chap.3)'>compatibility interval</a> but stick to the 95% standard (frequentist) <a class='glossary' title='A range of values, calculated from the sample observations, that is believed, with a particular probability, to contain the true parameter value. (Cambridge Dictionary of Statistics, 4th ed., p.98)'>confidence interval</a>.</p>
</section>
</section>
</section>
<section id="sec-chap-03-point-estimates" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3"><span class="header-section-number">3.2.3</span> Point Estimates</h3>
<section id="original-4" class="level4" data-number="3.2.3.1">
<h4 data-number="3.2.3.1"><span class="header-section-number">3.2.3.1</span> ORIGINAL</h4>
<section id="measures-of-central-tendency" class="level5" data-number="3.2.3.1.1">
<h5 data-number="3.2.3.1.1"><span class="header-section-number">3.2.3.1.1</span> Measures of Central Tendency</h5>
<blockquote>
<p>“Given the entire posterior distribution, what value should you report? This seems like an innocent question, but it is difficult to answer. The Bayesian parameter estimate is precisely the entire posterior distribution, which is not a single number, but instead a function that maps each unique parameter value onto a plausibility value. So really the most important thing to note is that you don’t have to choose a point estimate. It’s hardly ever necessary and often harmful. It discards information.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 58</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=77&amp;annotation=EVCFUS3F">pdf</a>)</p>
</blockquote>
<p>But whenever you have to do it, you must choose between mean, median and MAP (= the parameter value with highest posterior probability, a <em>maximum a posteriori</em>, essentially the “peak” or mode of the posterior distribution.</p>
<p>In the very skewed globe tossing example where we observed 3 waters out of 3 tosses they are all different.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-point-estimates-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.42 </strong></span>a: Compute MAP, median and mean</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/point-estimates-a_71f0f1b0438e135c58d7f40776faa901">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb78"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.14a MAP (from grid) ###############</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>map_skewed_a_1 <span class="ot">&lt;-</span> p_grid_skewed_a[<span class="fu">which.max</span>(posterior_skewed_a)]</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.15a MAP from posterior samples ################</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>map_skewed_a_2 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">chainmode</span>(samples_skewed_a, <span class="at">adj =</span> <span class="fl">0.01</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.16a mean and median #############</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>mean_skewed_a <span class="ot">&lt;-</span> <span class="fu">mean</span>(samples_skewed_a)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>median_skewed_a <span class="ot">&lt;-</span> <span class="fu">median</span>(samples_skewed_a)</span></code></pre></div>
</details>
</div>
<p><strong>Results:</strong></p>
<ul>
<li>MAP with <code>which.max()</code> = 1</li>
<li>MAP with <code>rethinking::chainmode()</code> = 0.9938226</li>
<li>Mean: 0.8027632</li>
<li>Median: 0.8428428</li>
</ul>
</div>
</div>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>Difference between MAP and mode calculation?</p>
</div>
<div class="my-watch-out-container">
<p>I have observed small differences between the MAP calculation in <a href="#cnj-point-estimates-a" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-point-estimates-a</span></a> and the mode calculation of other packages. I wonder why all these other methods give 0.95/0.96 whereas the MAP calculation results in 0.99/1.0.</p>
<p>One explanation I could think is that the mode is defined by the <em>maximum frequency</em> of observations, whereas the MAP is calculated from the <em>maximum of the weighted probability frequency</em> .</p>
<p>But I am not sure. One thing I can say with some certainty is that MAP seems <a href="https://web.stanford.edu/class/archive/cs/cs109/cs109.1216/lectures/22_map.pdf">a complicated theoretical construct</a> and a <a href="https://machinelearningmastery.com/maximum-a-posteriori-estimation/">difficult computational procedure</a>.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-map-mode" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.43 </strong></span>a: Compare MAP and mode calculation of different packages</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/different-modes_989d4a1eb57ac4288219b5ec2169d657">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb79"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>m_skewed_1 <span class="ot">&lt;-</span> modeest<span class="sc">::</span><span class="fu">mlv</span>(samples_skewed_a, <span class="at">method =</span> <span class="st">&quot;mfv&quot;</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>m_skewed_2 <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">Mode</span>(samples_skewed_a)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>m_skewed_3 <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">map_estimate</span>(samples_skewed_a)</span></code></pre></div>
</details>
</div>
<p>Results of mode calculation with several packages:</p>
<ul>
<li><code>modeest::mlv()</code>: 0.953954</li>
<li><code>DescTools::Mode()</code>: 0.953954</li>
<li><code>bayestestR::map_estimate()</code>: 0.9622849</li>
</ul>
</div>
</div>
</div>
</div>
<p>The graphical representation as shown in Figure 3.4 will be calculated in the tidyverse version of this section. See: <a href="#fig-left-panel-3-4-skewed-b" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-left-panel-3-4-skewed-b</span></a> for the left panel and <a href="#fig-prop-loss-b" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-prop-loss-b</span></a> for the right panel of Figure 3.4.</p>
</section>
<section id="loss-function-to-support-particular-decisions" class="level5" data-number="3.2.3.1.2">
<h5 data-number="3.2.3.1.2"><span class="header-section-number">3.2.3.1.2</span> Loss function to support particular decisions</h5>
<p>“One principled way to go beyond using the entire posterior as the estimate is to choose a <a class='glossary' title='A loss function is a rule that tells you the cost associated with using any particular point estimate. … The key insight is that different loss functions imply different point estimates. (SR2, p.59)'>loss function</a>.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 59</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=78&amp;annotation=42KE9FFZ">pdf</a>)</p>
<div class="my-important">
<div class="my-important-header">
<p>Different loss functions imply different point estimates. (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 59</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=78&amp;annotation=3X2FI82B">pdf</a>)</p>
</div>
</div>
<blockquote>
<p>“Here’s an example to help us work through the procedure. Suppose I offer you a bet. Tell me which value of p, the proportion of water on the Earth, you think is correct. I will pay you <span class="math inline">\(\$100\)</span>, if you get it exactly right. But I will subtract money from your gain, proportional to the distance of your decision from the correct value. Precisely, your loss is proportional to the absolute value of <span class="math inline">\(d − p\)</span>, where <span class="math inline">\(d\)</span> is your decision and <span class="math inline">\(p\)</span> is the correct answer. We could change the precise dollar values involved, without changing the important aspects of this // problem. What matters is that the loss is proportional to the distance of your decision from the true value. Now once you have the posterior distribution in hand, how should you use it to maximize your expected winnings? It turns out that the parameter value that maximizes expected winnings (minimizes expected loss) is the median of the posterior distribution.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 59/60</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=79&amp;annotation=59IS3PFL">pdf</a>)</p>
</blockquote>
<blockquote>
<p>“Calculating expected loss for any given decision means using the posterior to average over our uncertainty in the true value. Of course we don’t know the true value, in most cases. But if we are going to use our model’s information about the parameter, that means using the entire posterior distribution. So suppose we decide <span class="math inline">\(p = 0.5\)</span> will be our decision.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 60</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=79&amp;annotation=UTEYE7VX">pdf</a>).</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-expected-loss-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.44 </strong></span>a: Calculated expected loss for <span class="math inline">\(p = 0.5\)</span></p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/expected-loss-a_9980eaa36942804aa11ce90b1c62e2f1">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb80"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.17a weighted average loss ##################</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>loss_avg_a <span class="ot">&lt;-</span> <span class="fu">sum</span>(posterior_skewed_a <span class="sc">*</span> <span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> p_grid_skewed_a))</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.18a for every possible value #############################</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>loss_a <span class="ot">&lt;-</span> <span class="fu">sapply</span>(p_grid_skewed_a, </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>     <span class="cf">function</span>(d) <span class="fu">sum</span>(posterior_skewed_a <span class="sc">*</span> <span class="fu">abs</span>(d <span class="sc">-</span> p_grid_skewed_a)))</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.19a minimized loss value #############################</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>loss_min_a <span class="ot">&lt;-</span> p_grid_skewed_a[<span class="fu">which.min</span>(loss_a)]</span></code></pre></div>
</details>
</div>
<p><strong>Results:</strong></p>
<ul>
<li>Weighted average loss value = 0.3128752.</li>
<li>Parameter value that minimizes the loss = 0.8408408. This is the posterior median that we already have calculated in <a href="#cnj-point-estimates-a" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-point-estimates-a</span></a>. Because of sampling variation it is not identical but pretty close (0.8428428 versus 0.8408408).</li>
</ul>
</div>
</div>
<div class="my-important">
<div class="my-important-header">
<p>Learnings: Point estimates</p>
</div>
<div class="my-important-container">
<blockquote>
<p>“In order to decide upon a <em>point estimate</em>, a single-value summary of the posterior distribution, we need to pick a loss function. Different loss functions nominate different point estimates. The two most common examples are the absolute loss as above, which leads to the median as the point estimate, and the quadratic loss <span class="math inline">\((d − p)^{2}\)</span>, which leads to the posterior mean (<code>mean(samples_a)</code>) as the point estimate. When the posterior distribution is symmetrical and normal-looking, then the median and mean converge to the same point, which relaxes some anxiety we might have about choosing a loss function. For the original globe tossing data (6 waters in 9 tosses), for example, the mean and median are barely different.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 60</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=79&amp;annotation=JHGI3FVY">pdf</a>)</p>
</blockquote>
<blockquote>
<p>“Usually, research scientists don’t think about loss functions. And so any point estimate like the mean or MAP that they may report isn’t intended to support any particular decision, but rather to describe the shape of the posterior. You might argue that the decision to make is whether or not to accept an hypothesis. But the challenge then is to say what the relevant costs and benefits would be, in terms of the knowledge gained or lost. Usually it’s better to communicate as much as you can about the posterior distribution, as well as the data and the model itself, so that others can build upon your work. Premature decisions to accept or reject hypotheses can cost lives.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 61</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=80&amp;annotation=6GVPUF4Z">pdf</a>)</p>
</blockquote>
</div>
</div>
</section>
</section>
<section id="tidyverse-4" class="level4" data-number="3.2.3.2">
<h4 data-number="3.2.3.2"><span class="header-section-number">3.2.3.2</span> TIDYVERSE</h4>
<section id="measures-of-central-tendency-1" class="level5" data-number="3.2.3.2.1">
<h5 data-number="3.2.3.2.1"><span class="header-section-number">3.2.3.2.1</span> Measures of Central Tendency</h5>
<p>If we sort the posterior values of <code>d_skewed_b</code> (three tosses with three <code>W</code>) from highest to lowest values then the first row (= the maximum value of <code>posterior_skewed_b</code>) will give us the MAP as the corresponding <code>p_grid_b</code> value. Additionally the {<strong>tidybayes</strong>} has other options to compute the MAP. To calculate mean and median we will use the Base R functions. In the following code chunk I have collected all these different calculations.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-point-estimates-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.45 </strong></span>b: Compute MAP, median and mean</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/point-estimates-b_3160fca7da5557539cb06baf3d8148c2">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb81"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.14b MAP (from grid) ###############################</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;MAP computed with dplyr::arrange(dplyr::desc())</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>map_skewed_b <span class="ot">&lt;-</span> d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(posterior_skewed_b)) </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>map_skewed_b[<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)]</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.15b MAP (from posterior sample) ###############################</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;MAP computed with tidybayes::mode_qi()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(p_skewed_b)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;MAP computed with tidybayes::mode_hdci()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(p_skewed_b)</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;MAP computed with tidybayes::Mode()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">Mode</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b)</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.16b mean and median #############################</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Mean &amp; Median computed with mean() &amp; median()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean   =</span> <span class="fu">mean</span>(p_skewed_b),</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(p_skewed_b))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; MAP computed with dplyr::arrange(dplyr::desc())
#&gt; # A tibble: 1 × 2
#&gt;   p_grid_b posterior_skewed_b
#&gt;      &lt;dbl&gt;              &lt;dbl&gt;
#&gt; 1        1            0.00400
#&gt; #####################################################
#&gt; 
#&gt; MAP computed with tidybayes::mode_qi()
#&gt; # A tibble: 1 × 6
#&gt;   p_skewed_b .lower .upper .width .point .interval
#&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
#&gt; 1       1.00  0.399  0.994   0.95 mode   qi       
#&gt; #####################################################
#&gt; 
#&gt; MAP computed with tidybayes::mode_hdci()
#&gt; # A tibble: 1 × 6
#&gt;   p_skewed_b .lower .upper .width .point .interval
#&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
#&gt; 1       1.00  0.475      1   0.95 mode   hdci     
#&gt; #####################################################
#&gt; 
#&gt; MAP computed with tidybayes::Mode()
#&gt; [1] 0.9995616
#&gt; #####################################################
#&gt; 
#&gt; Mean &amp; Median computed with mean() &amp; median()
#&gt; # A tibble: 1 × 2
#&gt;    mean median
#&gt;   &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1 0.803  0.843</code></pre>
</div>
</div>
</div>
</div>
<p>We can now plot a graph to reproduce the left panel of the books Figure 3.4 where we will see the three different measures of central tendency. I will compare the skewed (three ‘W’, three tosses) with the somewhat normal version (six ‘W’, nine tosses).</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-left-panel-3-4-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.46 </strong></span>: Posterior density for skewed and symmetric distribution</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">3W, n=3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">6W, n=9</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-left-panel-3-4-skewed-b_c318b076e05ece78dea463aa246d2359">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb83"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. bundle three types of estimates into a tibble. #######</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>point_estimates_b1 <span class="ot">&lt;-</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mean_qi</span>(p_skewed_b),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>            samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(p_skewed_b),</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>            samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(p_skewed_b)) <span class="sc">|&gt;</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(p_skewed_b, .point) <span class="sc">|&gt;</span> </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. create two columns to annotate the plot #######</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">x =</span> p_skewed_b <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">03</span>, .<span class="dv">03</span>, <span class="sc">-</span>.<span class="dv">03</span>),</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">0005</span>, .<span class="dv">0012</span>, .<span class="dv">002</span>))</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. plot #######</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b)) <span class="sc">+</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> posterior_skewed_b),</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> point_estimates_b1<span class="sc">$</span>p_skewed_b) <span class="sc">+</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="at">data =</span> point_estimates_b1,</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>            ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> .point),</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">angle =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-left-panel-3-4-skewed-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-left-panel-3-4-skewed-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.12: Posterior distribution after observing 3 ‘water’ in 3 tosses of the globe. Vertical lines show the locations of the mode, median, and mean. All three measures of central tendency differ because of the skewness of the distribution. Therefore each point implies a different loss function.</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-left-panel-3-4-sym-b2_6be90295c559eed1ee47d3ab0eef455f">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb84"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 0. compute mode with different method</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>mode2_b <span class="ot">&lt;-</span> df_samples_b <span class="sc">|&gt;</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(posterior_samples_b)) <span class="sc">|&gt;</span> </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">.point =</span> prior_samples_b) <span class="sc">|&gt;</span> </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(samples_b, .point) <span class="sc">|&gt;</span> </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.point =</span> <span class="st">&quot;mode2&quot;</span>)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. bundle three types of estimates into a tibble ######</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>point_estimates_b2 <span class="ot">&lt;-</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(df_samples_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mean_qi</span>(samples_b),</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>            df_samples_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(samples_b),</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>            df_samples_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(samples_b)) <span class="sc">|&gt;</span> </span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(samples_b, .point) <span class="sc">|&gt;</span> </span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(mode2_b) <span class="sc">|&gt;</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. create two columns to annotate the plot #######</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">55</span>, .<span class="dv">55</span>, .<span class="dv">75</span>, .<span class="dv">75</span>),</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">0006</span>, .<span class="dv">0011</span>, .<span class="dv">0016</span>, .<span class="dv">0021</span>))</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. plot ##########################################</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b)) <span class="sc">+</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> posterior_samples_b),</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> point_estimates_b2<span class="sc">$</span>samples_b) <span class="sc">+</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="at">data =</span> point_estimates_b2,</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>            ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> .point)) <span class="sc">+</span></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a><span class="do">## 4. annotation (arrows &amp; text) ####################</span></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.4</span>, <span class="at">y =</span> .<span class="dv">0005</span>, <span class="at">xend =</span> point_estimates_b2<span class="sc">$</span>samples_b[[<span class="dv">1</span>]], <span class="at">yend =</span> .<span class="dv">0005</span>),</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.4</span>, <span class="at">y =</span> .<span class="dv">001</span>, <span class="at">xend =</span> point_estimates_b2<span class="sc">$</span>samples_b[[<span class="dv">2</span>]], <span class="at">yend =</span> .<span class="dv">001</span>),</span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span>  </span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.85</span>, <span class="at">y =</span> .<span class="dv">0015</span>, <span class="at">xend =</span> point_estimates_b2<span class="sc">$</span>samples_b[[<span class="dv">3</span>]], <span class="at">yend =</span> .<span class="dv">0015</span>),</span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.85</span>, <span class="at">y =</span> .<span class="dv">002</span>, <span class="at">xend =</span> point_estimates_b2<span class="sc">$</span>samples_b[[<span class="dv">4</span>]], <span class="at">yend =</span> .<span class="dv">002</span>),</span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-left-panel-3-4-sym-b2" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-left-panel-3-4-sym-b2-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.13: Point estimates in the almost symmetrical distribution of 6 ‘water’ in 9 tosses. Vertical lines show the locations of the mode, median, and mean. All three points are in a similar locatioon and have approximately the same loss function.</figcaption>
</figure>
</div>
</div>
</div>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>MAP (mode) is not the highest point in the more symmetric version (6 ‘W’, n=9)</p>
</div>
<div class="my-watch-out-container">
<p>I wounder if the calculation of the MAP of the somewhat symmetrical version is correct, because the MAP or mode is not the highest value in the distribution. In addition to calculate the mode with {<strong>tidybayes</strong>}, I have also used R code 3.14b from <a href="#cnj-point-estimates-b" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-point-estimates-b</span></a> to compute MAP with <code>dplyr::arrange(dplyr::desc())</code>.</p>
<p>It turns out that there is difference: In contrast to {<strong>tidybayes</strong>} arranging the data frame results in a MAP value (<code>mode2</code>) which is indeed the highest point of the distribution. I don’t know how to interpret this disparity.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="loss-function-to-support-particular-decisions-1" class="level5" data-number="3.2.3.2.2">
<h5 data-number="3.2.3.2.2"><span class="header-section-number">3.2.3.2.2</span> Loss function to support particular decisions</h5>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-expected-loss-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.47 </strong></span>b: Calculated expected loss for <span class="math inline">\(p = 0.5\)</span> with proportional and quadratic loss function</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><span class="math inline">\(d-p\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><span class="math inline">\((d−p)^{2}\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>The absolute proportional loss <span class="math inline">\(d-p\)</span> for the decision <span class="math inline">\(p = 0.5\)</span> results into the median.</p>
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/expected-prop-loss-b_5b4df455a8cfc9620f5b334cd4283643">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb85"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.17b weighted average loss ##################</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>loss_avg_b <span class="ot">&lt;-</span> d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">expected loss</span><span class="st">`</span> <span class="ot">=</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>               base<span class="sc">::</span><span class="fu">sum</span>(posterior_skewed_b <span class="sc">*</span> base<span class="sc">::</span><span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> p_grid_b)))</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.18b for every possible value #############################</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="do">## write function</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>make_loss_b <span class="ot">&lt;-</span> <span class="cf">function</span>(our_d) {</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">loss_b =</span> posterior_skewed_b <span class="sc">*</span> base<span class="sc">::</span><span class="fu">abs</span>(our_d <span class="sc">-</span> p_grid_b)) <span class="sc">|&gt;</span> </span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">weighted_average_loss_b =</span> base<span class="sc">::</span><span class="fu">sum</span>(loss_b))</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate loss for all possible values </span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Every possible loss values for decision 0.5 with proportional loss function</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>l_b <span class="ot">&lt;-</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(p_grid_b) <span class="sc">|&gt;</span> </span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">decision_b =</span> p_grid_b) <span class="sc">|&gt;</span> </span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">weighted_average_loss_b =</span> purrr<span class="sc">::</span><span class="fu">map</span>(decision_b, make_loss_b)) <span class="sc">|&gt;</span> </span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(weighted_average_loss_b) </span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(l_b)</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.19b minimized loss value #############################</span></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a><span class="co"># this will help us find the x and y coordinates for the minimum value</span></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>loss_min_b <span class="ot">&lt;-</span></span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>    l_b <span class="sc">|&gt;</span> </span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(weighted_average_loss_b <span class="sc">==</span> base<span class="sc">::</span><span class="fu">min</span>(weighted_average_loss_b)) <span class="sc">|&gt;</span> </span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">as.numeric</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Every possible loss values for decision 0.5 with proportional loss function
#&gt; # A tibble: 6 × 2
#&gt;   decision_b weighted_average_loss_b
#&gt;        &lt;dbl&gt;                   &lt;dbl&gt;
#&gt; 1    0                         0.800
#&gt; 2    0.00100                   0.799
#&gt; 3    0.00200                   0.798
#&gt; 4    0.00300                   0.797
#&gt; 5    0.00400                   0.796
#&gt; 6    0.00501                   0.795</code></pre>
</div>
</div>
<p><strong>Results:</strong></p>
<ul>
<li>Weighted average loss value = 0.3128752.</li>
<li>Parameter value that minimizes the loss = 0.8408408. This is the posterior median that we already have calculated in <a href="#cnj-point-estimates-b" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-point-estimates-b</span></a>. Because of sampling variation it is not identical but pretty close (0.8428428 versus 0.8408408).</li>
</ul>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>The quadratic loss <span class="math inline">\((d−p)^{2}\)</span> for the decision <span class="math inline">\(p = 0.5\)</span> suggests we should use the mean.</p>
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/expected-quad-loss-b_8aff1bdaad17476b29bf4fa07b034e99">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb87"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.17b weighted average loss ##################</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>loss_avg_b2 <span class="ot">&lt;-</span> d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">expected loss</span><span class="st">`</span> <span class="ot">=</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>               base<span class="sc">::</span><span class="fu">sum</span>(posterior_skewed_b <span class="sc">*</span> base<span class="sc">::</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> p_grid_b))))</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.18b for every possible value #############################</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co"># amend our loss function</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>make_loss2_b <span class="ot">&lt;-</span> <span class="cf">function</span>(our_d2) {</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">loss2_b =</span> posterior_skewed_b <span class="sc">*</span> (our_d2 <span class="sc">-</span> p_grid_b)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">weighted_average_loss2_b =</span> base<span class="sc">::</span><span class="fu">sum</span>(loss2_b))</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="co"># remake our `l` data</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Every possible loss values for decision 0.5 with quadratic loss function</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>l2_b <span class="ot">&lt;-</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(p_grid_b) <span class="sc">|&gt;</span> </span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">decision2_b =</span> p_grid_b) <span class="sc">|&gt;</span> </span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">weighted_average_loss2_b =</span> purrr<span class="sc">::</span><span class="fu">map</span>(decision2_b, make_loss2_b)) <span class="sc">|&gt;</span> </span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">unnest</span>(weighted_average_loss2_b)</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(l2_b)</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.19b minimized loss value #############################</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a><span class="co"># update to the new minimum loss coordinates</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>loss_min_b2 <span class="ot">&lt;-</span></span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>    l2_b <span class="sc">|&gt;</span> </span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(weighted_average_loss2_b <span class="sc">==</span> base<span class="sc">::</span><span class="fu">min</span>(weighted_average_loss2_b)) <span class="sc">|&gt;</span> </span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">as.numeric</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Every possible loss values for decision 0.5 with quadratic loss function
#&gt; # A tibble: 6 × 2
#&gt;   decision2_b weighted_average_loss2_b
#&gt;         &lt;dbl&gt;                    &lt;dbl&gt;
#&gt; 1     0                          0.667
#&gt; 2     0.00100                    0.666
#&gt; 3     0.00200                    0.664
#&gt; 4     0.00300                    0.663
#&gt; 5     0.00400                    0.661
#&gt; 6     0.00501                    0.659</code></pre>
</div>
</div>
<p><strong>Results:</strong></p>
<ul>
<li>Weighted average loss value = 0.5390867.</li>
<li>Parameter value that minimizes the loss = 0.8008008. This is the posterior mean that we already have calculated in <a href="#cnj-point-estimates-b" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-point-estimates-b</span></a>. Because of sampling variation it is not identical but pretty close (0.8027632 versus 0.8008008).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Now we’re ready to reproduce the right panel of Figure 3.4., e.g., displaying the the loss function and computing the minimum loss value. Remember: Different loss functions imply different point estimates.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-prop-loss-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.48 </strong></span>b: Plot expected loss for <span class="math inline">\(p = 0.5\)</span> with proportional and quadratic loss function</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><span class="math inline">\(d-p\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><span class="math inline">\((d−p)^{2}\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>The absolute proportional loss <span class="math inline">\(d-p\)</span> for the decision <span class="math inline">\(p = 0.5\)</span> results into the median.</p>
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-prop-loss-b_53ed4faba78d5504d75206c9d397a84b">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb89"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## right panel figure 3.4 ########################</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>l_b <span class="sc">|&gt;</span>   </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> decision_b, <span class="at">y =</span> weighted_average_loss_b)) <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> loss_min_b[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> loss_min_b[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;expected proportional loss&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-prop-loss-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-prop-loss-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.14: Expected loss under the rule that loss is proportional to absolute distance of decision (horizontal axis) from the true value. The point marks the value of <code>p</code> that minimizes the expected loss, the posterior median.</figcaption>
</figure>
</div>
</div>
</div>
<p>We saved the exact minimum value as <code>loss_min_b[1]</code>, which is 0.8408408. Within sampling error, this is the posterior median as depicted by our samples (0.8428428 versus 0.8408408).</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>The quadratic loss <span class="math inline">\((d−p)^{2}\)</span> for the decision <span class="math inline">\(p = 0.5\)</span> suggests we should use the mean.</p>
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-quad-loss-b_6cab62a00b7dc0e7d8cf5fb7536dff33">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb90"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># update the plot</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>l2_b <span class="sc">|&gt;</span>   </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> decision2_b, <span class="at">y =</span> weighted_average_loss2_b)) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> loss_min_b2[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> loss_min_b2[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;expected proportional loss&quot;</span>) <span class="sc">+</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-quad-loss-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-quad-loss-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.15: Expected loss under the rule that loss is quadratic to the distance of decision (horizontal axis) from the true value. The point marks the value of <code>p</code> that minimizes the expected loss, the posterior mean</figcaption>
</figure>
</div>
</div>
</div>
<p>Based on quadratic loss <span class="math inline">\((d−p)^{2}\)</span>, the exact minimum value is 0.8008008. Within sampling error, this is the posterior mean of our samples (0.8027632 versus 0.8008008).</p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="sampling-to-simulate-prediction" class="level2" data-number="3.3">
<h2 data-number="3.3"><span class="header-section-number">3.3</span> Sampling to simulate prediction</h2>
<section id="original-5" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1"><span class="header-section-number">3.3.1</span> ORIGINAL</h3>
<div class="my-procedure">
<div class="my-procedure-header">
<div id="prp-ease-sim" class="theorem proposition">
<p><span class="theorem-title"><strong>Procedure 3.2 </strong></span>: 5 Reasons to simulate implied observations</p>
</div>
</div>
<div class="my-procedure-container">
<blockquote>
<p>“Another common job for samples is to ease <strong>simulation</strong> of the model’s implied observations. Generating implied observations from a model is useful for at least <del>four</del> five reasons.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 61</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=80&amp;annotation=N8SBHXFN">pdf</a>)</p>
</blockquote>
<ol type="1">
<li>Model design</li>
<li>Model checking</li>
<li>Software validation</li>
<li>Research design</li>
<li>Forecasting</li>
</ol>
<blockquote>
<p>“We will call such simulated data <strong>dummy data</strong>, to indicate that it is a stand-in for actual data.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 62</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=81&amp;annotation=EG7YYPVK">pdf</a>)</p>
</blockquote>
</div>
</div>
<section id="dummy-data" class="level4" data-number="3.3.1.1">
<h4 data-number="3.3.1.1"><span class="header-section-number">3.3.1.1</span> Dummy data</h4>
<p>Likelihood functions work in both directions:</p>
<ul>
<li>They help to infer the plausibility of each possible value of <em>p</em>. “With the globe tossing model, the <a class='glossary' title='Simulated data are called dummy data to indicate that it is a stand-in for actual data. (SR2, p.62)'>dummy data</a> arises from a binomial likelihood:” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 62</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=81&amp;annotation=5PLAWZ8J">pdf</a>)</li>
<li>They can be used to simulate the observations that the model implies. “You could use <code>base::sample()</code> to do this, but R provides convenient sampling functions for all the ordinary probability distributions, like the binomial.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 62</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=81&amp;annotation=W69A2SQI">pdf</a>)</li>
</ul>
<blockquote>
<p>“Given a realized observation, the likelihood function says how plausible the observation is. And given only the parameters, the likelihood defines a distribution of possible observations that we can sample from, to simulate observation.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 62</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=81&amp;annotation=PNGM8F8P">pdf</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-two-tosses-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.49 </strong></span>a: Suppose <span class="math inline">\(N = 2\)</span>, two tosses of the globe with <span class="math inline">\(p = 0.7\)</span></p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Probability</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Simulation</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/two-tosses-prob-a_61a4dce897a2167de7ba19a42c01a1ee">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb91"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.20a #############################</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  two_tosses_prob_a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.09 0.42 0.49</code></pre>
</div>
</div>
<p><strong>Interpretation of the observed result of two tosses with a probability of</strong> <span class="math inline">\(p = 0.7\)</span></p>
<p>With <span class="math inline">\(N = 2\)</span> there are only three possibilities: 0, 1 or 2 water.</p>
<ul>
<li>9% chance of observing 0 water.</li>
<li>42% chance of observing 1 water.</li>
<li>49% chance of observing 2 water.</li>
</ul>
<p>With different <span class="math inline">\(p\)</span> you will get a different result.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/two-tosses-sim-a_a700de05292cfbdc024d1c755fd879a6">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb93"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>) <span class="co"># for reproducibility</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.21a #############################</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  two_tosses_sim_a <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 2</code></pre>
</div>
</div>
<p><strong>Interpretation of the simulated result of two tosses with a probability of</strong> <span class="math inline">\(p = 0.7\)</span></p>
<p>One simulation (trial) consists with <span class="math inline">\(N = 2\)</span> of two simulated tosses:</p>
<ul>
<li>In our simulation (trial) of two simulated tosses <span class="math inline">\(N = 2\)</span> we got 2 water.</li>
</ul>
<p>Without the <code>base::set.seed()</code> function the result will change. Try it.</p>
</div>
</div>
</div>
</div>
</div>
<p>With <code>rbinom()</code> you can also generate more than one simulation (trial) at a time.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-several-sims" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.50 </strong></span>a: Using <code>rbinom()</code> to simulate two tosses to generate 10 and 100,000 dummy observations</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">10 trials</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">1e5 trials</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/simulate-10-obs-a_26d624bfea26b655f982df3c668822ca">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb95"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.22a #############################</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] 2 1 2 2 1 1 2 2 1 1</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/simulate-1e5-obs-a_255320d1089287a289ef642ddb56a48e">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb97"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.23a #############################</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>dummy_w_a <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dummy_w_a) <span class="sc">/</span> <span class="fl">1e5</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; dummy_w_a
#&gt;       0       1       2 
#&gt; 0.09000 0.42051 0.48949</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Now let’s simulate the same amount of tosses (sample size = 9) as we have used previously. I will provide two kinds of R graphs: One for <code>rethinking::simplehist()</code> as in the book and one using base R with <code>graphics::hist()</code>.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-9-toss-fig-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.51 </strong></span>a: Distribution of simulated sample observations from 9 tosses of the globe</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Base R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Rethinking</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-plot-hist-figure-3.5-a_e187b22823179ca43f83e26f9c9c2362">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb99"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.24a with hist() ##############</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>dummy_w_a <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e5</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dummy_w_a, <span class="at">xlab =</span> <span class="st">&quot;dummy water count&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot-hist-figure-3.5-a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-plot-hist-figure-3.5-a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.16: Distribution of simulated sample observations from 9 tosses of the globe. These samples assume the proportion of water is 0.7. The plot uses the base R <code>hist()</code> function</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-plot-simplehist-figure-3.5-a_895cb63e2ef1282ac32702c4d3098b43">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.24a with simplehist() #############################</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>dummy_w_a <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="fl">1e5</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">simplehist</span>(dummy_w_a, <span class="at">xlab =</span> <span class="st">&quot;dummy water count&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot-simplehist-figure-3.5-a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-plot-simplehist-figure-3.5-a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.17: Distribution of simulated sample observations from 9 tosses of the globe. These samples assume the proportion of water is 0.7. the plot uses the `rethinking::simplehist()``` function</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Note that in our example using <code>base::set.seed(3)</code> the simulation does not generate the water in its true proportion of <span class="math inline">\(0.7\)</span>.</p>
<blockquote>
<p>“That’s the nature of observation: There is a one-to-many relationship between data and data-generating processes. You should [delete the <code>base::set.seed()</code> line and] experiment with sample size, the <code>size</code> input in the code above, as well as the <code>prob</code>, to see how the distribution of simulated samples changes shape and location.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 63</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=82&amp;annotation=2NRZ2EV9">pdf</a>)</p>
</blockquote>
</div>
</div>
<div class="my-important">
<div class="my-important-header">
<p>Sampling distributions versus Samples drawn from the posterior</p>
</div>
<div class="my-important-container">
<blockquote>
<p>“Many readers will already have seen simulated observations. <a class='glossary' title='“The most commonly used measure of the spread of a set of observations. Equal to the square root of the variance.” (CDS, p. 409)'>Sampling distributions</a> are the foundation of common non-Bayesian statistical traditions. In those approaches, inference about parameters is made through the sampling distribution. In this book, inference about parameters is never done directly through a sampling distribution. The posterior distribution is not sampled, but deduced logically. Then samples can be drawn from the posterior, as earlier in this chapter, to aid in inference. In neither case is ‘sampling’ a physical act. In both cases, it’s just a mathematical device and produces only <em>small world</em> (<a href="#sec-chap02" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap02</span></a>) numbers.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 63</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=82&amp;annotation=C7QLRFPI">pdf</a>)</p>
</blockquote>
</div>
</div>
</section>
<section id="model-checking" class="level4" data-number="3.3.1.2">
<h4 data-number="3.3.1.2"><span class="header-section-number">3.3.1.2</span> Model checking</h4>
<p>Two main purposes:</p>
<ol type="1">
<li>Checking if software is working correctly</li>
<li>Evaluation the adequacy of the model</li>
</ol>
<blockquote>
<p>“All that is required is averaging over the posterior density for <span class="math inline">\(p\)</span>, while computing the predictions. For each possible value of the parameter <span class="math inline">\(p\)</span>, there is an implied distribution of outcomes. So if you were to compute the sampling distribution of outcomes at each value of <span class="math inline">\(p\)</span>, then you could average all of these prediction distributions together, using the posterior probabilities of each value of <span class="math inline">\(p\)</span>, to get a <a class='glossary' title='An approach to assessing model fit. It is the distribution for future predicted data based on the data you have already seen. Measures of discrepancy between the estimated model and the data are constructed and their posterior predictive distribution compared to the discrepancy observed for the dataset. (CDS, p. 334)'>posterior predictive distribution</a>.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 65</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=84&amp;annotation=EZT523XH">pdf</a>)</p>
</blockquote>
<div class="my-procedure">
<div class="my-procedure-header">
<div id="prp-post-pred-sim-a" class="theorem proposition">
<p><span class="theorem-title"><strong>Procedure 3.3 </strong></span>a: How to generate the <a class='glossary' title='An approach to assessing model fit. It is the distribution for future predicted data based on the data you have already seen. Measures of discrepancy between the estimated model and the data are constructed and their posterior predictive distribution compared to the discrepancy observed for the dataset. (CDS, p. 334)'>posterior predictive distribution</a></p>
</div>
</div>
<div class="my-procedure-container">
<ol type="1">
<li>Use <code>rbinom()</code> to generate random binomial samples.</li>
<li>Use as <code>prob</code> value not a single value but samples from the posterior</li>
</ol>
<p>I will not reproduce Figure 3.6 in the upcoming section. The complex procedure to plot the graph does not add much understanding in Bayesian statistics. But the content of the picture itself is very important to understand how the posterior predictive distribution is generated.</p>
<hr />
<div id="fig-3-6" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="img/SR2-fig3_6.png" class="img-fluid" style="width:90.0%" alt="Top panel shows the posterior probability, middle panel the sampling distribution and the bottom panel the posterior predictive distribution" /></p>
<figcaption>Graph 3.18: “Simulating predictions from the total posterior. Top: The familiar posterior distribution for the globe tossing data. Ten example parameter values are marked by the vertical lines. Values with greater posterior probability indicated by thicker lines. Middle row: Each of the ten parameter values implies a unique sampling distribution of predictions. Bottom: Combining simulated observation distributions for all parameter values (not just the ten shown), each weighted by its posterior probability, produces the posterior predictive distribution. This distribution propagates uncertainty about parameter to uncertainty about prediction.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 65</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=84&amp;annotation=ZBMIA85F">pdf</a>)</figcaption>
</figure>
</div>
</div>
</div>
<p>We will generates 10,000 (1e4) simulated predictions of 9 globe tosses (size = 9)</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-post-pred-sim-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.52 </strong></span>a: Simulate predicted observations for a single value (<span class="math inline">\(p = 0.6\)</span>) and with samples of the posterior</p>
</div>
</div>
<div class="my-r-code-container">
<p>Generating 10,000 (1e4) simulated predictions of 9 globe tosses (size = 9).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">p = single value of 0.6</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">p = posterior samples</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-post-pred-sim-a1_fef559ac8ef2a307765bd531fcb375d8">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb101"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.25a #############################</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>w_a1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">simplehist</span>(w_a1)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-post-pred-sim-a1" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-post-pred-sim-a1-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.19: Simulate predicted observations for a single value p value of 0.6</figcaption>
</figure>
</div>
</div>
</div>
<p>The predictions are stored as counts of water, so the theoretical minimum is zero and the theoretical maximum is nine. Although our fix <code>prob</code> value = 0.6 the samples show 5 as the mode of the randomly generated distribution.</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-post-pred-sim-a2_f8f28078420f60fd4ccc9814bb41fc9d">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb102"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.26a #############################</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>w_a2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> samples_a)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">simplehist</span>(w_a2)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-post-pred-sim-a2" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-post-pred-sim-a2-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.20: Simulate predicted observations with samples of the posterior</figcaption>
</figure>
</div>
</div>
</div>
<p>The code propagate parameter uncertainty into the predictions by replacing a fixed <code>prob</code> value by the vector <code>samples_a</code>. The symbol <code>samples_a</code> is the same list of random samples from the posterior distribution that we have calculated in <a href="#cnj-sample-globe-tossing" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-sample-globe-tossing</span></a> and used in previous sections.</p>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<p>“For each sampled value, a random binomial observation is generated. Since the sampled values appear in proportion to their posterior probabilities, the resulting simulated observations are averaged over the posterior. You can manipulate these simulated observations just like you manipulate samples from the posterior—you can compute intervals and point statistics using the same procedures.” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 66</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=85&amp;annotation=BVUDPY9U">pdf</a>)</p>
</blockquote>
<p>But <a href="#fig-post-pred-sim-a2" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-post-pred-sim-a2</span></a> just predicts the posterior distribution as our model sees the data. To evaluate the adequacy of the model for certain purposes it is important to investigate it under different point of views. McElreath proposes two look at the data in additional two ways:</p>
<ol type="1">
<li>Plot the distribution of the longest run of either water or land.</li>
<li>Plot the distribution of the number of switches from water to land and reverse.</li>
</ol>
<p>The calculation and reproduction of Figure 3.7 is demonstrated in the next tidyverse section.</p>
</section>
</section>
<section id="tidyverse-5" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2"><span class="header-section-number">3.3.2</span> TIDYVERSE</h3>
<section id="dummy-data-1" class="level4" data-number="3.3.2.1">
<h4 data-number="3.3.2.1"><span class="header-section-number">3.3.2.1</span> Dummy data</h4>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-two-tosses-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.53 </strong></span>b: Suppose <span class="math inline">\(N = 2\)</span>, two tosses of the globe with <span class="math inline">\(p = 0.7\)</span></p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Probability</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Simulation</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/two-tosses-prob-b_7aa98d5f03a1e968ecee916ef930a106">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb103"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.20b ######################</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">n      =</span> <span class="dv">2</span>,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">`</span><span class="at">p(w)</span><span class="st">`</span> <span class="ot">=</span> .<span class="dv">7</span>,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">w      =</span> <span class="dv">0</span><span class="sc">:</span>n) <span class="sc">|&gt;</span> </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">density =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(w, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="st">`</span><span class="at">p(w)</span><span class="st">`</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 4
#&gt;       n `p(w)`     w density
#&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
#&gt; 1     2    0.7     0    0.09
#&gt; 2     2    0.7     1    0.42
#&gt; 3     2    0.7     2    0.49</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/two-tosses-sim-b_e1c074c13d1b5a524ae42dafb7195d07">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb105"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.21b = 3.21a ######################</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> .<span class="dv">7</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 2</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Compare the results with the calculation in <a href="#cnj-two-tosses-a" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-two-tosses-a</span></a>.</p>
</div>
</div>
<div class="my-r-code">
<div class="my-r-code-header">
<div>
<p>b: Using <code>stats::rbinom()</code> to simulate two tosses to generate 10 and 100,000 dummy observations</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">10 trials</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">1e5 trials</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/simulate-10-obs-b_4f213b266af8debecc337b17dd0d9e7d">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb107"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.22b = 3.22a #############################</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] 2 1 2 2 1 1 2 2 1 1</code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/simulate-1e5-obs-b_77ef52a215a11ed0e99084ab3d25ba15">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb109"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.23b ########################</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>n_draws_b <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>dummy_w_b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">draws =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(n_draws_b, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> .<span class="dv">7</span>)) </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>dummy_w_b <span class="sc">|&gt;</span> </span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(draws) <span class="sc">|&gt;</span> </span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> base<span class="sc">::</span><span class="fu">nrow</span>(dummy_w_b))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 3
#&gt;   draws     n proportion
#&gt;   &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
#&gt; 1     0  9000      0.09 
#&gt; 2     1 42051      0.421
#&gt; 3     2 48949      0.489</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The simulation updated to <span class="math inline">\(n=9\)</span> and plotting the tidyverse version of Figure 3.5.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-9-toss-fig-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.54 </strong></span>b: Distribution of simulated sample observations from 9 tosses of the globe</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-plot-ggplot2-figure-3.5-b_3111651416befc07f6843a34db938e02">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb111"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.24b with ggplot2 #########################</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>n_draws_b <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>dummy_w2_b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">draws =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(n_draws_b, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> .<span class="dv">7</span>))</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dummy_w2_b <span class="sc">|&gt;</span> </span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span> </span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># breaks = 0:10 * 2 = equivalent in Kurz&#39;s versions:  breaks = 0:4 * 2</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dummy_w2_b <span class="sc">|&gt;</span> </span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span> </span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>    <span class="do">## breaks = 0:10 * 2 = equivalent in Kurz&#39;s versions:  breaks = 0:4 * 2</span></span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>    <span class="do">## I decided to set a break at each of the draws: breaks = 0:9 * 1</span></span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">*</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>    <span class="do">## I did not zoom into the graph because doesn&#39;t look so nice</span></span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>    <span class="do">## for instance the last line in Kurz’ version is not visible</span></span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_cartesian(xlim = c(0, 9)) +</span></span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot-ggplot2-figure-3.5-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-plot-ggplot2-figure-3.5-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.21: Distribution of simulated sample observations from 9 tosses of the globe. These samples assume the proportion of water is 0.7. The plot uses the {<strong>ggplot2</strong>} functions. The left panel is Kurz’s original, the right one is my version slightly changed.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>McElreath suggested to play around with different values of <code>size</code> and <code>prob</code>. But instead of reproducing all codes block introduced by Kurz, I will just replicate the first chunk, because it has some interesting and (for me) unfamiliar functions.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-sim-9-cond" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.55 </strong></span>b: Simulated sample observations, using different sizes and probabilities</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Simulation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/simulate-9-conditions_9c2c04f51c55c50bfede1c4a4b83798b">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb112"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>simulate_binom <span class="ot">&lt;-</span> <span class="cf">function</span>(n, probability) {</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">rbinom</span>(n_draws, <span class="at">size =</span> n, <span class="at">prob =</span> probability) </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>d9_b <span class="ot">&lt;-</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">crossing</span>(<span class="at">n9_b           =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>),</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">probability9_b =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">6</span>, .<span class="dv">9</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">draws9_b =</span> purrr<span class="sc">::</span><span class="fu">map2</span>(n9_b, probability9_b, simulate_binom)) <span class="sc">|&gt;</span> </span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n           =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="st">&quot;n = &quot;</span>, n9_b),</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">probability =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="st">&quot;p = &quot;</span>, probability9_b)) <span class="sc">|&gt;</span> </span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(draws9_b)</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>d9_b <span class="sc">|&gt;</span> </span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(n9_b)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 5
#&gt;     n9_b probability9_b draws9_b n     probability
#&gt;    &lt;dbl&gt;          &lt;dbl&gt;    &lt;int&gt; &lt;chr&gt; &lt;chr&gt;      
#&gt;  1     3            0.3        2 n = 3 p = 0.3    
#&gt;  2     3            0.9        3 n = 3 p = 0.9    
#&gt;  3     3            0.9        3 n = 3 p = 0.9    
#&gt;  4     3            0.9        3 n = 3 p = 0.9    
#&gt;  5     3            0.6        3 n = 3 p = 0.6    
#&gt;  6     6            0.9        5 n = 6 p = 0.9    
#&gt;  7     6            0.9        5 n = 6 p = 0.9    
#&gt;  8     6            0.6        3 n = 6 p = 0.6    
#&gt;  9     9            0.6        7 n = 9 p = 0.6    
#&gt; 10     9            0.3        3 n = 9 p = 0.3</code></pre>
</div>
</div>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>Using <code>tidyr::crossing()</code> and <code>tidyr::unnest()</code></p>
</div>
<div class="my-watch-out-container">
<p>I am still not very experienced with <code>tidyr::crossing()</code> and <code>tidyr::unnest()</code>:</p>
<ul>
<li><strong><code>tidyr::crossing()</code></strong> is a wrapper around <code>tidyr::expand_grid()</code> (not to confuse with <code>base::expand.grid()</code>) and therefore creates a tibble from all combination of inputs. In addition to <code>tidyr::expand_grid()</code> it de-duplicates and sorts its input.</li>
<li><strong><code>tidyr::unnest()</code></strong> expands a list-column containing data frames into row and columns. In the above case <code>purrr::map2()</code> returns a list and stores the data in <code>draws9_b</code>.</li>
</ul>
<p>Instead of <code>utils::head()</code> I used <code>dplyr::slice_sample()</code> and ordered the result by the first column. I think this will get a better glimpse on the data as just the first 6 rows.</p>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-sim-plot-9-cond-b_e5c8c06b2d3877fd887d1e5c326b45d9">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb114"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>d9_b <span class="sc">|&gt;</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> draws9_b)) <span class="sc">+</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_grid</span>(n9_b <span class="sc">~</span> probability9_b)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-sim-plot-9-cond-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-sim-plot-9-cond-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.22: <strong>?(caption)</strong></figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="model-checking-1" class="level4" data-number="3.3.2.2">
<h4 data-number="3.3.2.2"><span class="header-section-number">3.3.2.2</span> Model checking</h4>
<div class="my-resource">
<div class="my-resource-header">
<p>Checking if the software works correctly</p>
</div>
<div class="my-resource-container">
<p>On software checking Kurz refers to some material, that is too special at the moment for me. I will it include here, even if I had not read it. Maybe I will come later here again and pick up these resources when I have more experiences with Bayesian statistics and the necessary tools.</p>
<ul>
<li><a href="https://youtu.be/pKZLJPrZLhU?t=26285">Esther Williams in the Harold Holt Memorial Swimming Pool</a> by <a href="https://twitter.com/dan_p_simpson">Dan Simpson</a></li>
<li><a href="https://www.youtube.com/watch?v=E8vdXoJId8M">Visualisation in Bayesian workflow</a>, YouTube video lecture at the Royal Statistics Society by Jonah Gabry &amp; Daniel Simpson</li>
<li><a href="https://statmodeling.stat.columbia.edu/2019/03/19/maybe-its-time-to-let-the-old-ways-die-or-we-broke-r-hat-so-now-we-have-to-fix-it/">Maybe it’s time to let the old ways die; or We broke R-hat so now we have to fix it</a>, blog post by Daniel Simpson</li>
<li>Vehtari, A., Gelman, A., Simpson, D., Carpenter, B., &amp; Bürkner, P.-C. (2021). Rank-normalization, folding, and localization: An improved <span class="math inline">\(\widehat{R}\)</span> for assessing convergence of MCMC. Bayesian Analysis, 16(2). https://doi.org/10.1214/20-BA1221</li>
</ul>
</div>
</div>
<p>There are three computing steps to reproduce the three levels of Figure 3.6 copied here as <a href="#fig-3-6" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-3-6</span></a>.</p>
<ol type="1">
<li>Posterior probability (top level)</li>
<li>Sampling distributions for nine values (0.1-0.9) (middle level)</li>
<li>Posterior predictive distribution (bottom level)</li>
</ol>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-3-6-top" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.56 </strong></span>b: Posterior probability</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Top</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Middle</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Bottom</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p><strong>Posterior probability</strong></p>
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-repr-figure-3.6-top-b_2ea15639b16c7ee22557b31af15bc721">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb115"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="do">## data wrangling ####################</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>n2_b <span class="ot">&lt;-</span> <span class="dv">1001</span>L</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>n_success <span class="ot">&lt;-</span> <span class="dv">6</span>L</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>n_trials  <span class="ot">&lt;-</span> <span class="dv">9</span>L</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>d2_b <span class="ot">&lt;-</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid2_b =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> n2_b),</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>         <span class="co"># note we&#39;re still using a flat uniform prior</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior2_b  =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">likelihood2_b =</span> </span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>                stats<span class="sc">::</span><span class="fu">dbinom</span>(n_success, <span class="at">size =</span> n_trials, <span class="at">prob =</span> p_grid2_b)) <span class="sc">|&gt;</span> </span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">posterior2_b =</span> </span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>                (likelihood2_b <span class="sc">*</span> prior2_b) <span class="sc">/</span> <span class="fu">sum</span>(likelihood2_b <span class="sc">*</span> prior2_b))</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d2_b)</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="do">## plot ##############################</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>d2_b <span class="sc">|&gt;</span> </span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid2_b, <span class="at">y =</span> posterior2_b)) <span class="sc">+</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">color =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(<span class="at">data =</span> d2_b <span class="sc">|&gt;</span>   </span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">filter</span>(p_grid2_b <span class="sc">%in%</span> </span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">1</span>, <span class="at">to =</span> .<span class="dv">9</span>, <span class="at">by =</span> .<span class="dv">1</span>), <span class="dv">3</span> <span class="sc">/</span> <span class="dv">10</span>)),</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>     <span class="do">## Note how we Wweight the widths of the vertical lines </span></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>     <span class="do">## by the posterior density `posterior2_b`</span></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>         ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xend =</span> p_grid2_b, <span class="at">yend =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> posterior2_b),</span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> d2_b <span class="sc">|&gt;</span>  </span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">filter</span>(p_grid2_b <span class="sc">%in%</span> </span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">1</span>, <span class="at">to =</span> .<span class="dv">9</span>, <span class="at">by =</span> .<span class="dv">1</span>), <span class="dv">3</span> <span class="sc">/</span> <span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> .<span class="dv">08</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;Posterior probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_linewidth_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;probability of water&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 6 × 4
#&gt;   p_grid2_b prior2_b likelihood2_b posterior2_b
#&gt;       &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
#&gt; 1     0            1      0            0       
#&gt; 2     0.001        1      8.37e-17     8.37e-19
#&gt; 3     0.002        1      5.34e-15     5.34e-17
#&gt; 4     0.003        1      6.07e-14     6.07e-16
#&gt; 5     0.004        1      3.40e-13     3.40e-15
#&gt; 6     0.005        1      1.29e-12     1.29e-14</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-repr-figure-3.6-top-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-repr-figure-3.6-top-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.23: Reproduction of the top part of figure 3.6</figcaption>
</figure>
</div>
</div>
</div>
<p>At first I thought I do not need to refresh the original grid approximation from <a href="#cnj-grid-globe-tossing-b" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-grid-globe-tossing-b</span></a> as I have it stored it with the unique name <code>d_b</code>. But it turned out that the above code with <code>n_grid_b = 1000L</code> does not work, because it draws no vertical lines by the posterior density. Instead one has to sample 1001 times.</p>
<p>I noticed that with most sample numbers the plot does not work correctly. It worked with 1071. The sequence 1011, 1021, 1031, 1041, 1051, 1061 misses just one vertical line at <span class="math inline">\(p = 0.7\)</span> An exception is 1041, which misses <span class="math inline">\(p = 0.6\)</span>. I do not know why this happens.</p>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-repr-figure-3.6-middle-b_a3e1d786394ab25dd7dc939dd50b2d1a">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb117"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="do">## data wrangling #####################</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>n_draws_b <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>simulate_binom <span class="ot">&lt;-</span> <span class="cf">function</span>(probability) {</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">rbinom</span>(n_draws_b, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> probability) </span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>d_small_b <span class="ot">&lt;-</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">probability =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">1</span>, <span class="at">to =</span> .<span class="dv">9</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">draws =</span> purrr<span class="sc">::</span><span class="fu">map</span>(probability, simulate_binom)) <span class="sc">|&gt;</span>  </span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(draws) <span class="sc">|&gt;</span> </span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">label =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="st">&quot;p = &quot;</span>, probability))</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(d_small_b)</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="do">## plot ###############################</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>d_small_b <span class="sc">|&gt;</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Sampling distributions&quot;</span>) <span class="sc">+</span></span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span> label, <span class="at">ncol =</span> <span class="dv">9</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 6 × 3
#&gt;   probability draws label  
#&gt;         &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;  
#&gt; 1         0.1     0 p = 0.1
#&gt; 2         0.1     2 p = 0.1
#&gt; 3         0.1     0 p = 0.1
#&gt; 4         0.1     0 p = 0.1
#&gt; 5         0.1     1 p = 0.1
#&gt; 6         0.1     1 p = 0.1</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-repr-figure-3.6-middle-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-repr-figure-3.6-middle-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.24: Reproduction of the middle part of figure 3.6</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-repr-figure-3.6-bottom-b_43d63b3e802a692864e9e1a2922ea2a8">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb119"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## data wrangling ########################################</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># how many samples would you like?</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>n_samples_b <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make it reproducible</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="ot">&lt;-</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  d2_b <span class="sc">|&gt;</span> </span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples_b, <span class="at">weight_by =</span> posterior2_b, <span class="at">replace =</span> T)  <span class="sc">|&gt;</span>  </span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">w =</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(p_grid2_b, stats<span class="sc">::</span>rbinom, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(d2_samples_b)</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="do">## plot ###################################</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> w)) <span class="sc">+</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of water samples&quot;</span>,</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Posterior predictive distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>),</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3000</span>)) <span class="sc">+</span></span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 10,000
#&gt; Columns: 5
#&gt; $ p_grid2_b     &lt;dbl&gt; 0.564, 0.651, 0.487, 0.592, 0.596, 0.787, 0.727, 0.490, …
#&gt; $ prior2_b      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
#&gt; $ likelihood2_b &lt;dbl&gt; 0.22408531, 0.27179502, 0.15128823, 0.24557832, 0.248256…
#&gt; $ posterior2_b  &lt;dbl&gt; 0.0022408531, 0.0027179502, 0.0015128823, 0.0024557832, …
#&gt; $ w             &lt;dbl&gt; 4, 7, 3, 3, 7, 6, 8, 2, 6, 4, 5, 5, 8, 6, 4, 6, 8, 2, 6,…</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-repr-figure-3.6-bottom-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-repr-figure-3.6-bottom-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.25: Reproduction of the bottom part of figure 3.6</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>In Figure 3.7, McElreath checked the adequacy of the model with</p>
<ol type="a">
<li>the longest sequence of the sample values and</li>
<li>number of switches between water and land.</li>
</ol>
<p>But he didn’t show who to calculate and produce his Figure 3.7. To compute these alternative views and replicate the graph Kurz used the (for me until now unknown) <code>base::rle()</code> function in a brilliant manner. Before we replicate his computation let’s look more into the details of <code>base::rle()</code></p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-rle-function" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.57 </strong></span>b: How the <code>base::rle()</code> function works for checking our model</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/rle-function_f5870f19a251945ee34a5ee4118b9a44">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb121"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>tosses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">rle</span>(tosses)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="do">## In the left panel of Figure 3.7 we are interested in maximal length</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rle</span>(tosses)<span class="sc">$</span>lengths  <span class="sc">|&gt;</span>  <span class="fu">max</span>()</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="do">## In the right panel of Figure 3.7 we are interested in maximal switches</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rle</span>(tosses)<span class="sc">$</span>lengths <span class="sc">|&gt;</span>  <span class="fu">length</span>() <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Run Length Encoding
#&gt;   lengths: int [1:7] 1 1 3 1 1 1 1
#&gt;   values : chr [1:7] &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot;
#&gt; [1] 3
#&gt; [1] 6</code></pre>
</div>
</div>
<p>The observed events in our globe tossing example are: <code>w,l,w,w,w,l,w,l,w</code>. The maximal length of consecutive water events is: <code>rle(tosses)$lengths  |&gt;  max()</code> = 3.</p>
<p>Because <code>rle()</code> aggregated the consecutive length of water and land we can use this result as the maximum length of switches between water and land: <code>rle(tosses)$lengths |&gt;  length() - 1</code> = 6</p>
<div class="my-typo">
<div class="my-typo-header">
<p>Different observations versus switches</p>
</div>
<div class="my-typo-container">
<p>I think there is a small miscalculation in Kurz’ text: The number of switches is the length of different observation minus one. There are 7 different observation but only 6 switches. This also conforms to the book.</p>
</div>
</div>
</div>
</div>
<p>Now we will follow Kurz’ procedure of calculating and plotting Figure 3.7.</p>
<div class="my-procedure">
<div class="my-procedure-header">
<div id="prp-rle-function" class="theorem proposition">
<p><span class="theorem-title"><strong>Procedure 3.4 </strong></span>: How the <code>base::rle()</code> function works</p>
</div>
</div>
<div class="my-procedure-container">
<p>He reasoned:</p>
<ol type="1">
<li>We’ve been using <code>stats::rbinom()</code> with the size parameter set to 9 for our simulations for a certain number of observation, e.g., 10 experiments á la 9 tosses each. This gives us the aggregated results of the number of water events: <code>rbinom(10, size = 9, prob = .6)</code> = 7, 5, 6, 8, 7, 5, 6, 3, 3, 4</li>
<li>But what we need is to simulate nine <em>individual</em> trials many times over: <code>rbinom(9, size = 1, prob = .6)</code> = 0, 1, 1, 1, 0, 0, 0, 0, 0</li>
<li>We simulate the result of individual trials many times and add their outcomes into a tibble <code>d2_samples_b</code>.</li>
</ol>
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/sim-indiv-trials_0d77aa1977788c9ecb74cacfc6d2ef35">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb123"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="ot">&lt;-</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  d2_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">iter  =</span> <span class="dv">1</span><span class="sc">:</span>dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">draws =</span> purrr<span class="sc">::</span><span class="fu">map</span>(p_grid2_b, rbinom, <span class="at">n =</span> <span class="dv">9</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(draws)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(d2_samples_b)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 90,000
#&gt; Columns: 7
#&gt; $ p_grid2_b     &lt;dbl&gt; 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, …
#&gt; $ prior2_b      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
#&gt; $ likelihood2_b &lt;dbl&gt; 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0…
#&gt; $ posterior2_b  &lt;dbl&gt; 0.002240853, 0.002240853, 0.002240853, 0.002240853, 0.00…
#&gt; $ w             &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 3,…
#&gt; $ iter          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3,…
#&gt; $ draws         &lt;int&gt; 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1,…</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Now we can use the <code>base:rle()</code>function to compute consecutive length and number of switches:</li>
</ol>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Length</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Switches</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-repl-fig-3.7-left" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.58 </strong></span>b: Replication of left panel of Figure 3.7</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-left-panel-3-7_1c9e69629016874648b71bde419aad17">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb125"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="sc">|&gt;</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(iter) <span class="sc">|&gt;</span> </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">longest_run_length =</span> base<span class="sc">::</span><span class="fu">rle</span>(draws)<span class="sc">$</span>lengths <span class="sc">|&gt;</span> </span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>              base<span class="sc">::</span><span class="fu">max</span>()) <span class="sc">|&gt;</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> longest_run_length)) <span class="sc">+</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">fill =</span> longest_run_length <span class="sc">==</span> <span class="dv">3</span>),</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;longest run length&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) </span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-left-panel-3-7" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-left-panel-3-7-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.26: The length of the maximum run of water or land</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div>
<p>b: Replication of right panel of Figure 3.7</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-right-panel-3-7_0a4e21bdb331cfe12421478e03edfb04">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb126"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="sc">|&gt;</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(iter) <span class="sc">|&gt;</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">number_of_switches =</span> base<span class="sc">::</span><span class="fu">rle</span>(draws)<span class="sc">$</span>lengths <span class="sc">|&gt;</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>                     base<span class="sc">::</span><span class="fu">length</span>()) <span class="sc">|&gt;</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> number_of_switches)) <span class="sc">+</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">fill =</span> number_of_switches <span class="sc">==</span> <span class="dv">6</span>),</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of switches&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-right-panel-3-7" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-right-panel-3-7-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.27: The number of switches between water and land samples</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="my-important">
<div class="my-important-header">
<p>Check model adequacy with alternative views of the same posterior predictive distribution</p>
</div>
<div class="my-important-container">
<p>For me there are two conclusion to draw from the section on model checking:</p>
<ol type="1">
<li>It is possible and also important to look at the data generated by the model from different angels.</li>
</ol>
<blockquote>
<p>“Instead of considering the data as the model saw it, as a sum of water samples, now we view the data as both the length of the maximum run of water or land (left) and the number of switches between water and land samples (right).” (<a href="zotero://select/groups/5243560/items/NFUEVASQ">McElreath, 2020, p. 67</a>) (<a href="zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=86&amp;annotation=W7II5H76">pdf</a>)</p>
</blockquote>
<ol start="2" type="1">
<li>To generate alternative views at the requires some ingenuity and an evaluation if the model is adequate. For instance: 6 switches in 9 tosses in not consistent with the distribution of the longest runs. There should be fewer switches.</li>
</ol>
</div>
</div>
</section>
<section id="lets-practice-with-brms" class="level4" data-number="3.3.2.3">
<h4 data-number="3.3.2.3"><span class="header-section-number">3.3.2.3</span> Let’s practice with {<strong>brms</strong>}</h4>
<p>The content of this section is more or less copied from Kurz without much knowledge of {<strong>brms</strong>}. The following code chunks are therefore my first acquaintance with the {<strong>brms</strong>} package and my reassurance that the package installation did work and to test if I get the same results as Kurz.</p>
<div class="my-resource">
<div class="my-resource-header">
<p>How to use <a class='glossary' title='brms stands for Bayesina Regression Models using Stan. brms provides an interface to fit Bayesian generalized (non-)linear multivariate multilevel models using Stan. The formula syntax is very similar to that of the package lme4 to provide a familiar and simple interface for performing regression analyses. (brms website)'>brms</a></p>
</div>
<div class="my-resource-container">
<p>I still have to read <a href="https://github.com/paul-buerkner/brms#how-to-use-brms">How to use {<strong>brms</strong>}</a> and the many <a href="https://paul-buerkner.github.io/brms/">packages vignettes</a> in the help file or at the website.</p>
</div>
</div>
<blockquote>
<p>With {<strong>brms</strong>}, we’ll fit the primary model of <span class="math inline">\(w=6\)</span> and <span class="math inline">\(n=9\)</span> much like we did at the end of <a href="#sec-chap02" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap02</span></a>.</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-b3.1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.59 </strong></span>b: Fit model and compute posterior summary for <code>b_Intercept</code>, the probability of a “w”</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/brms-model-fit-b_7dec9ba0a7ce22eaa9660fc6bee9e3b6">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb127"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>b3<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span>(<span class="at">data =</span> <span class="fu">list</span>(<span class="at">w =</span> <span class="dv">6</span>), </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>      w <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">9</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept,</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># this is a flat prior</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>      brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">lb =</span> <span class="dv">0</span>, <span class="at">ub =</span> <span class="dv">1</span>),</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">3</span>,</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b03.01&quot;</span>)</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">posterior_summary</span>(b3<span class="fl">.1</span>)[<span class="st">&quot;b_Intercept&quot;</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  Estimate Est.Error      Q2.5     Q97.5 
#&gt;      0.64      0.14      0.34      0.88</code></pre>
</div>
</div>
<p><strong>Explication of the result</strong></p>
<ul>
<li><code>Estimate</code> is the posterior mean,</li>
<li>the two <code>Q</code> columns are the quantile-based 95% intervals,</li>
<li>the <code>Est.Error</code> is the posterior standard deviation.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>I have already some experience with the beta distribution from my study of <a href="https://nostarch.com/learnbayes">Bayesian Statistics the Fun Way: Understanding Statistics and Probability With Star Wars, LEGO, and Rubber Ducks</a> by Will Kurt <span class="citation" data-cites="kurt2019">(<a href="#ref-kurt2019" role="doc-biblioref">Kurt 2019</a>)</span>. See also my <a href="https://bookdown.org/pbaumgartner/bayesian-fun/">Quarto book notes</a>. There is more about the beta distribution in <a href="#sec-chap12" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap12</span></a>.</p>
<p>But I will still have to learn about the syntax of the first three lines. The rest of the model description is more or less self-explanatory.</p>
</div>
</div>
<blockquote>
<p>Much like the way we used the <code>dplyr::slice_sample()</code> function to simulate probability values, above, we can do so with the <code>brms::fitted()</code> function. But we will have to specify <code>scale = "linear"</code> in order to return results in the probability metric. By default, <code>brms::fitted()</code> will return summary information. Since we want actual simulation draws, we’ll specify <code>summary = F</code>.</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-brms-sim-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.60 </strong></span>b: Simulation of probability values</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/sim-prob-values-b_e4ecf4397eee4cc897ce9300046a36cc">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb129"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">:::</span><span class="fu">fitted.brmsfit</span>(b3<span class="fl">.1</span>, </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F,</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  rlang<span class="sc">::</span><span class="fu">set_names</span>(<span class="st">&quot;p&quot;</span>)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(f)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 16,000
#&gt; Columns: 1
#&gt; $ p &lt;dbl&gt; 0.6318994, 0.8105015, 0.7677781, 0.7250286, 0.7265799, 0.7376768, 0.…</code></pre>
</div>
</div>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>How to use <a href="https://adv-r.hadley.nz/s3.html">S3 methods</a> without attached package?</p>
</div>
<div class="my-watch-out-container">
<p>I had problems with the following code chunk. See <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues/49">my postings at Kurz’s repo</a>.</p>
</div>
</div>
</div>
</div>
<p>Now we can display the density and the posterior predictive distribution</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Density</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Predictive</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-brms-3-6-top-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.61 </strong></span>b: Model b3.1: Density and posterior predictive distribution</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-brms-3-6-top-b_a94d2bf53c95a7167e61022ca6672fd1">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb131"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">|&gt;</span> </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p)) <span class="sc">+</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">08</span>, <span class="at">y =</span> <span class="fl">2.5</span>,</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Posterior probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>),</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-brms-3-6-top-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-brms-3-6-top-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.28: Density plot of the fittet {brms} model</figcaption>
</figure>
</div>
</div>
</div>
<p>The graphic should look like the top part of <a href="#fig-3-6" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-3-6</span></a>.</p>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-brms-3-6-bottom-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.62 </strong></span>b: Posterior predictive distribution for model b3.1</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-brms-3-6-bottom-b_ebc1dc56f81ff3c71fbc89b6f0379780">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb132"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  f <span class="sc">|&gt;</span> </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">w2 =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(dplyr<span class="sc">::</span><span class="fu">n</span>(), <span class="at">size =</span> <span class="dv">9</span>,  <span class="at">prob =</span> p))</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the plot</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>f <span class="sc">|&gt;</span> </span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> w2)) <span class="sc">+</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of water samples&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5000</span>)) <span class="sc">+</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Posterior predictive distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  ggplot2::coord_cartesian(xlim = c(0, 9)) +</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-brms-3-6-bottom-b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-brms-3-6-bottom-b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.29: Simulation to predict posterior distribution</figcaption>
</figure>
</div>
</div>
</div>
<blockquote>
<p>Much like we did with samples, we can use this distribution of probabilities to predict histograms of <span class="math inline">\(w\)</span> counts. With those in hand, we can make an analogue to the histogram in the bottom panel of Figure 3.6 (copied here into the text as <a href="#fig-3-6" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-3-6</span></a>)</p>
</blockquote>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="practice" class="level2" data-number="3.4">
<h2 data-number="3.4"><span class="header-section-number">3.4</span> Practice</h2>
<section id="easy" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1"><span class="header-section-number">3.4.1</span> Easy</h3>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-exercise-data-3.27" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.63 </strong></span>: Posterior distribution for the globe tossing example exercises</p>
</div>
</div>
<div class="my-r-code-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">Original</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Tidyverse</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-data-3.27a_c1beebfac575310ad5861cd9d15bbf0d">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb133"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.27a for exercises  #######################</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>p_grid_3ea <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>prior_3ea <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>likelihood_3ea <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid_3ea)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>posterior_3ea <span class="ot">&lt;-</span> likelihood_3ea <span class="sc">*</span> prior_3ea</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>posterior_3ea <span class="ot">&lt;-</span> posterior_3ea <span class="sc">/</span> <span class="fu">sum</span>(posterior_3ea)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>samples_3ea <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid_3ea, <span class="at">prob =</span> posterior_3ea, <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(samples_3ea,</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Probability&quot;</span>,</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span>,</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Posterior distribution for the globe tossing example&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="03-sampling-the-imaginary_files/figure-html/exercise-data-3.27a-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-data-3.27b_0ec419e599c2aa9502a097321f191f14">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb134"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.27b for exercises  #######################</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>df_3eb <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_3eb =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_3eb =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>),</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">likelihood_3eb =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid_3eb),</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">posterior_3eb =</span> likelihood_3eb <span class="sc">*</span> prior_3eb,</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">posterior_std_3eb =</span> posterior_3eb <span class="sc">/</span> <span class="fu">sum</span>(posterior_3eb))</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>samples_3eb <span class="ot">&lt;-</span> df_3eb <span class="sc">|&gt;</span> </span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>, </span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight_by =</span> posterior_std_3eb, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">p_samples_3eb =</span> p_grid_3eb)</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>samples_3eb <span class="sc">|&gt;</span> </span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_samples_3eb)) <span class="sc">+</span></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Propability&quot;</span>,</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>,</span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">&quot;Posterior distribution for the globe tossing example&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="03-sampling-the-imaginary_files/figure-html/exercise-data-3.27b-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
</div>
</div>
</div>
<p><strong>Original</strong>: 0.7137137, 0.3573574, 0.5985986, 0.7177177, 0.6296296, …</p>
<p><strong>Tidyerse</strong>: 0.7137137, 0.3573574, 0.5985986, 0.7177177, 0.6296296, …</p>
</div>
</div>
<section id="exercises-3e1---3e7" class="level4" data-number="3.4.1.1">
<h4 data-number="3.4.1.1"><span class="header-section-number">3.4.1.1</span> Exercises 3E1 - 3E7</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercises 3E1 - 3E7</p>
<ul>
<li><strong>3E1.</strong> How much posterior probability lies below <span class="math inline">\(p = 0.2\)</span>?</li>
<li><strong>3E2.</strong> How much posterior probability lies above <span class="math inline">\(p = 0.8\)</span>?</li>
<li><strong>3E3.</strong> How much posterior probability lies between <span class="math inline">\(p = 0.2\)</span> and <span class="math inline">\(p = 0.8\)</span>?</li>
<li><strong>3E4.</strong> <span class="math inline">\(20\%\)</span> of the posterior probability lies below which value of <span class="math inline">\(p\)</span>?</li>
<li><strong>3E5.</strong> <span class="math inline">\(20\%\)</span> of the posterior probability lies above which value of <span class="math inline">\(p\)</span>?</li>
<li><strong>3E6.</strong> Which values of <span class="math inline">\(p\)</span> contain the narrowest interval equal to <span class="math inline">\(66\%\)</span> of the posterior probability?</li>
<li><strong>3E7.</strong> Which values of <span class="math inline">\(p\)</span> contain <span class="math inline">\(66\%\)</span> of the posterior probability, assuming equal posterior probability both below and above the interval?</li>
</ul>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">Original</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Tidyverse</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-easy-03a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.64 </strong></span>a: Exercises 3E1 - 3E7 (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3ea_3b37e2ee884a6a0a3a927de2a9deaad5">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb135"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="do">## exercises 3E1a - 3E7a ####################</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(samples_3ea <span class="sc">&lt;</span> <span class="fl">0.2</span>) <span class="sc">/</span> <span class="fl">1e4</span>                            <span class="do">## 3.7a</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(samples_3ea <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">/</span> <span class="fl">1e4</span>                            <span class="do">## 3.7a</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(samples_3ea <span class="sc">&gt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> samples_3ea <span class="sc">&lt;</span> <span class="fl">0.8</span>) <span class="sc">/</span> <span class="fl">1e4</span>        <span class="do">## 3.8a</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples_3ea, <span class="fl">0.2</span>)                       <span class="do">## 3.9a</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples_3ea, <span class="fl">0.8</span>)                       <span class="do">## 3.10a</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3ea, <span class="at">prob =</span> <span class="fl">0.66</span>)              <span class="do">## 3.13a</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3ea, <span class="at">prob =</span> <span class="fl">0.66</span>)                <span class="do">## 3.12a1</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="do">## same as above</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="do">## quantile(samples_3ea, prob = c(.1667, .8333))    ## 3.12a2</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 4e-04
#&gt; [1] 0.1116
#&gt; [1] 0.888
#&gt;       20% 
#&gt; 0.5185185 
#&gt;       80% 
#&gt; 0.7557558 
#&gt;     |0.66     0.66| 
#&gt; 0.5085085 0.7737738 
#&gt;       17%       83% 
#&gt; 0.5025025 0.7697698</code></pre>
</div>
</div>
<hr />
<ul>
<li><strong>3E1.</strong> 0.04% of the posterior probability lies below <span class="math inline">\(p = 0.2\)</span>.</li>
<li><strong>3E2.</strong> 11.16% of the posterior probability lies above <span class="math inline">\(p = 0.8\)</span>.</li>
<li><strong>3E3.</strong> 88.8% posterior probability lies between <span class="math inline">\(p = 0.2\)</span> and <span class="math inline">\(p = 0.8\)</span>.</li>
<li><strong>3E4.</strong> <span class="math inline">\(20\%\)</span> of the posterior probability lies below <span class="math inline">\(p =\)</span> 0.519.</li>
<li><strong>3E5.</strong> <span class="math inline">\(20\%\)</span> of the posterior probability lies above <span class="math inline">\(p =\)</span> 0.756.</li>
<li><strong>3E6.</strong> <span class="math inline">\(66\%\)</span> of the narrowest interval lies between 0.509 and 0.774.</li>
<li><strong>3E7.</strong> The interval between 0.503 and 0.77 contains <span class="math inline">\(66\%\)</span> of the posterior probability, assuming equal posterior probability both below and above the interval.</li>
</ul>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-easy-03b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.65 </strong></span>b: Exercises 3E1 - 3E7 (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3eb_631182051e376851288b3bdc69543aa6">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb137"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="do">## exercises 3E1b - 3E7b ####################</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>(e3b1 <span class="ot">&lt;-</span> samples_3eb <span class="sc">|&gt;</span> </span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_samples_3eb <span class="sc">&lt;</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> <span class="fl">1e4</span>) <span class="sc">|&gt;</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>())  </span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>                                                        <span class="do">## 3.7b</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>(e3b2 <span class="ot">&lt;-</span> samples_3eb <span class="sc">|&gt;</span> </span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_samples_3eb <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span> </span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> <span class="fl">1e4</span>) <span class="sc">|&gt;</span>            <span class="do">## 3.7b</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>())</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>(e3b3 <span class="ot">&lt;-</span> samples_3eb <span class="sc">|&gt;</span> </span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_samples_3eb <span class="sc">&gt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> p_samples_3eb <span class="sc">&lt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span> </span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> <span class="fl">1e4</span>) <span class="sc">|&gt;</span>            <span class="do">## 3.8b</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>())</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>(e3b4 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">quantile</span>(samples_3eb<span class="sc">$</span>p_samples_3eb, <span class="at">probs =</span> .<span class="dv">2</span>))</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>(e3b5 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">quantile</span>(samples_3eb<span class="sc">$</span>p_samples_3eb, <span class="at">probs =</span> .<span class="dv">8</span>))</span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>(e3b6 <span class="ot">&lt;-</span> tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(samples_3eb<span class="sc">$</span>p_samples_3eb, <span class="at">.width =</span> .<span class="dv">66</span>))</span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a><span class="do">## tidybayes::mean_hdci(samples_3eb$p_samples_3eb, .width = .66)</span></span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a><span class="do">## same as above</span></span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a>(e3b7 <span class="ot">&lt;-</span> tidybayes<span class="sc">::</span><span class="fu">qi</span>(samples_3eb<span class="sc">$</span>p_samples_3eb, <span class="at">.width =</span> .<span class="dv">66</span>))</span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a><span class="do">### R Code 3.7b with alternative methods #########</span></span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a><span class="co">#base::sum(samples_3eb$p_samples_3eb &lt; 0.2) / 1e4           ## 3.7b</span></span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb137-35"><a href="#cb137-35" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_3eb |&gt; </span></span>
<span id="cb137-36"><a href="#cb137-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::summarize(sum = mean(p_samples_3eb &gt; .8))       ## 3.7b</span></span>
<span id="cb137-37"><a href="#cb137-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb137-38"><a href="#cb137-38" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_3eb |&gt; </span></span>
<span id="cb137-39"><a href="#cb137-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::count(p_samples_3eb &gt; .8) |&gt; </span></span>
<span id="cb137-40"><a href="#cb137-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::mutate(probability = 1e4 / base::sum(1e4))   ## 3.7b</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 4e-04
#&gt; [1] 0.1116
#&gt; [1] 0.888
#&gt;       20% 
#&gt; 0.5185185 
#&gt;       80% 
#&gt; 0.7557558 
#&gt;           y      ymin      ymax .width .point .interval
#&gt; 1 0.6559935 0.5205205 0.7877878   0.66   mode      hdci
#&gt;           [,1]      [,2]
#&gt; [1,] 0.5025025 0.7697698</code></pre>
</div>
</div>
<hr />
<ul>
<li><strong>3E1.</strong> 0.04% of the posterior probability lies below <span class="math inline">\(p = 0.2\)</span>.</li>
<li><strong>3E2.</strong> 11.16% of the posterior probability lies above <span class="math inline">\(p = 0.8\)</span>.</li>
<li><strong>3E3.</strong> 88.8% posterior probability lies between <span class="math inline">\(p = 0.2\)</span> and <span class="math inline">\(p = 0.8\)</span>.</li>
<li><strong>3E4.</strong> <span class="math inline">\(20\%\)</span> of the posterior probability lies below <span class="math inline">\(p =\)</span> 0.519.</li>
<li><strong>3E5.</strong> <span class="math inline">\(20\%\)</span> of the posterior probability lies above <span class="math inline">\(p =\)</span> 0.756.</li>
<li><strong>3E6.</strong> <span class="math inline">\(66\%\)</span> of the narrowest interval lies between 0.521 and 0.788.</li>
<li><strong>3E7.</strong> The interval between 0.503 and 0.77 contains <span class="math inline">\(66\%\)</span> of the posterior probability, assuming equal posterior probability both below and above the interval.</li>
</ul>
<div class="my-note">
<div class="my-note-header">
<div id="cor-3e3b" class="theorem corollary">
<p><span class="theorem-title"><strong>Note 3.5 </strong></span>: Using <code>dplyr::between()</code></p>
</div>
</div>
<div class="my-note-container">
<p>I learned from Jake Thompson that I could have used <code>dplyr::between()</code> for the exercise 3E3: <code>mean(dplyr::between(p_samples_3eb$samples_3eb, 0.2, 0.8))</code> = 0.888</p>
</div>
</div>
</div>
</div>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>Difference between <code>rethinking::HPDI()</code> and <code>tidybayes::mode_hdci()</code></p>
</div>
<div class="my-watch-out-container">
<p>There is a small difference between <code>rethinking::HPDI()</code> (0.5085085 resp. 0.7737738) and <code>tidybayes::mode_hdci()</code> (0.5205205 and 0.7877878).</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="middle-1" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2"><span class="header-section-number">3.4.2</span> Middle</h3>
<section id="sec-e3m1" class="level4" data-number="3.4.2.1">
<h4 data-number="3.4.2.1"><span class="header-section-number">3.4.2.1</span> 3M1</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3M1: Suppose the globe tossing data had turned out to be 8 water in 15 tosses. Construct the posterior distribution, using grid approximation. Use the same flat prior as before.</p>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">Original</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Tidyverse</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m1a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.66 </strong></span>: Exercise 3M1a (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3m1a_7408d49612f2f97db2121d290c15211f">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb139"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>p_grid_3m1a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>prior_3m1a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>likelihood_3m1a <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="dv">8</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> p_grid_3m1a)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>posterior_3m1a <span class="ot">&lt;-</span>  likelihood_3m1a <span class="sc">*</span> prior_3m1a</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>posterior_std_3m1a <span class="ot">&lt;-</span>  posterior_3m1a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m1a) </span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid_3m1a, posterior_std_3m1a, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Proportion of water (p)&quot;</span>,</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Posterior density&quot;</span>)</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>map_3m1a <span class="ot">&lt;-</span> p_grid_3m1a[<span class="fu">which.max</span>(posterior_std_3m1a)]</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-exercise-3m1a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3m1a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.30: Posterior distribution for 8 ‘W’ in 15 tosses (Original)</figcaption>
</figure>
</div>
</div>
</div>
<p>The modus (<a class='glossary' title='In Bayesian statistics a Maximum A Posteriori probability or MAP is essentially the mode of posterior distribution. (CDS, p.272)'>MAP</a>) is at p = 0.534 with a posterior density of 0.00325.</p>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m1a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.67 </strong></span>: Exercise 3M1b (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3m1b_16dced1ed184d9e36d14438337e6bc86">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb140"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>df_3m1b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_grid_3m1b =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_3m1b =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>),</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">likelihood_3m1b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">8</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> p_grid_3m1b),</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">posterior_3m1b =</span>  likelihood_3m1b <span class="sc">*</span> prior_3m1b,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">posterior_std_3m1b =</span> posterior_3m1b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m1b)</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>df_3m1b <span class="sc">|&gt;</span> </span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3m1b, <span class="at">y =</span> posterior_std_3m1b)) <span class="sc">+</span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Proportion of water (p)&quot;</span>,</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Posterior density&quot;</span>) <span class="sc">+</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>map_3m1b <span class="ot">&lt;-</span> df_3m1b <span class="sc">|&gt;</span> </span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(posterior_std_3m1b)) <span class="sc">|&gt;</span> </span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(dplyr<span class="sc">::</span><span class="fu">first</span>(p_grid_3m1b)) <span class="sc">|&gt;</span> </span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">1</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-exercise-3m1b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3m1b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.31: Posterior distribution for 8 ‘W’ in 15 tosses (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
<p>The modus (<a class='glossary' title='In Bayesian statistics a Maximum A Posteriori probability or MAP is essentially the mode of posterior distribution. (CDS, p.272)'>MAP</a>) is at p = 0.5335335 with a posterior density of 0.0032519.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="m2" class="level4" data-number="3.4.2.2">
<h4 data-number="3.4.2.2"><span class="header-section-number">3.4.2.2</span> 3M2</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3M2: Draw <span class="math inline">\(10,000\)</span> samples from the grid approximation from above. Then use the samples to calculate the <span class="math inline">\(90\%\)</span> and <span class="math inline">\(99\%\)</span> HPDI for <span class="math inline">\(p\)</span>.</p>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">Original</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Tidyverse</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m2a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.68 </strong></span>a: Exercise 3M2 (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3m2a_efd32d92c44a1ed8744dc9be9b8e0914">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb141"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1e4 samples #############</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>samples_3m2a <span class="ot">&lt;-</span>  <span class="fu">sample</span>(<span class="at">x =</span> p_grid_3m1a,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prob =</span> posterior_std_3m1a, </span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">size =</span> <span class="fl">1e4</span>,</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Density with rethinking::dens() ########</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(samples_3m2a, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameters #########</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>(pi_3m2a_1 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m2a, <span class="at">prob =</span> .<span class="dv">9</span>))</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>(pi_3m2a_2 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m2a, <span class="at">prob =</span> .<span class="dv">99</span>))</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>(hpdi_3m2a_1 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m2a, <span class="at">prob =</span> .<span class="dv">9</span>))</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>(hpdi_3m2a_2 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m2a, <span class="at">prob =</span> .<span class="dv">99</span>))</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>(mean_3m2a <span class="ot">&lt;-</span> <span class="fu">mean</span>(samples_3m2a))</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>(median_3m2a <span class="ot">&lt;-</span> <span class="fu">median</span>(samples_3m2a))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;        5%       95% 
#&gt; 0.3323323 0.7207708 
#&gt;        1%      100% 
#&gt; 0.2382382 0.8148148 
#&gt;      |0.9      0.9| 
#&gt; 0.3393393 0.7267267 
#&gt;     |0.99     0.99| 
#&gt; 0.2312312 0.8048048 
#&gt; [1] 0.5295147
#&gt; [1] 0.5305305</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exercise-3m2a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3m2a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.32: 10,000 samples from the grid approximation 8 water with 15 tosses (Original)</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Mean</strong>: 0.53</li>
<li><strong>Median</strong>: 0.531</li>
</ul>
<table>
<colgroup>
<col style="width: 10%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="header">
<th>Prior = 1</th>
<th>Low</th>
<th>High</th>
<th>Diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PI .90</td>
<td>0.3323323</td>
<td>0.7207708</td>
<td>0.3884384</td>
</tr>
<tr class="even">
<td>PI .99</td>
<td>0.2382382</td>
<td>0.8148148</td>
<td>0.3884384</td>
</tr>
<tr class="odd">
<td>HPDI .90</td>
<td>0.3393393</td>
<td>0.7267267</td>
<td>0.3873874</td>
</tr>
<tr class="even">
<td>HPDI .99</td>
<td>0.2312312</td>
<td>0.8048048</td>
<td>0.5735736</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m2b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.69 </strong></span>b: Exercise 3M2 (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3m2b_4a30d916795272a3cae20bbef3113261">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb143"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1e4 samples ##########</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="ot">&lt;-</span> df_3m1b <span class="sc">|&gt;</span> </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>, </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight_by =</span> posterior_std_3m1b, </span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">p_samples_3m2b =</span> p_grid_3m1b)  </span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Density with ggplot2</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_samples_3m2b)) <span class="sc">+</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">adjust =</span> <span class="fl">1.0</span>) <span class="sc">+</span> <span class="co"># 1.0 = default value</span></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;N = 10000, Bandwith = 1.0&quot;</span>,</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameters ########</span></span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>  param_3m2b <span class="ot">&lt;-</span>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">mean_qi</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>)),</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">median_qi</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>)),</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">mode_qi</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>)),</span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">mode_hdci</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>)),</span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">mode_hdi</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>))</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            y      ymin      ymax .width .point .interval
#&gt; 1  0.5295147 0.3323323 0.7207708   0.90   mean        qi
#&gt; 2  0.5295147 0.2382382 0.8148148   0.99   mean        qi
#&gt; 3  0.5305305 0.3323323 0.7207708   0.90 median        qi
#&gt; 4  0.5305305 0.2382382 0.8148148   0.99 median        qi
#&gt; 5  0.5117147 0.3323323 0.7207708   0.90   mode        qi
#&gt; 6  0.5117147 0.2382382 0.8148148   0.99   mode        qi
#&gt; 7  0.5117147 0.3333333 0.7217217   0.90   mode      hdci
#&gt; 8  0.5117147 0.2312312 0.8048048   0.99   mode      hdci
#&gt; 9  0.5117147 0.3333333 0.7217217   0.90   mode       hdi
#&gt; 10 0.5117147 0.2312312 0.8048048   0.99   mode       hdi</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exercise-3m2b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3m2b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.33: 10,000 samples from the grid approximation 8 water with 15 tosses (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="m3" class="level4" data-number="3.4.2.3">
<h4 data-number="3.4.2.3"><span class="header-section-number">3.4.2.3</span> 3M3</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3M3: Construct a posterior predictive check for this model and data. This means simulate the distribution of samples, averaging over the posterior uncertainty in <span class="math inline">\(p\)</span>. What is the probability of observing 8 water in 15 tosses?</p>
</div>
<div class="my-exercise-container">
<p>In the following set of tabs “Original” is abbreviated with “O” and Tidyverse with “T”.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">Data (O)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Plot (O)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false">Result (O)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-4" role="tab" aria-controls="tabset-20-4" aria-selected="false">Data (T)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-5" role="tab" aria-controls="tabset-20-5" aria-selected="false">Plot (T)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-6" role="tab" aria-controls="tabset-20-6" aria-selected="false">Result (T)</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m3a-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.70 </strong></span>a: Exercise 3M3 – Data (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-data-3m3a_1987825921e9c8e16fbbdc30b7881d93">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb145"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.23a #############################</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>dummy_3m3a <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> samples_3m2a)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">table</span>(dummy_3m3a))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;    dummy_3m3a Freq
#&gt; 1           0    3
#&gt; 2           1   45
#&gt; 3           2   99
#&gt; 4           3  289
#&gt; 5           4  540
#&gt; 6           5  829
#&gt; 7           6 1134
#&gt; 8           7 1421
#&gt; 9           8 1419
#&gt; 10          9 1356
#&gt; 11         10 1195
#&gt; 12         11  817
#&gt; 13         12  483
#&gt; 14         13  280
#&gt; 15         14   74
#&gt; 16         15   16</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m3a-plot" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.71 </strong></span>a: Exercise 3M3 – Histogram (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-plot-3m3a_dc082ae92d70f267d6a1cf8ef3ea66e4">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb147"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">simplehist</span>(dummy_3m3a, <span class="at">xlab =</span> <span class="st">&quot;Dummy water count&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="03-sampling-the-imaginary_files/figure-html/exercise-plot-3m3a-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m3a-result" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.72 </strong></span>a: Exercise 3M3 – Result (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-result-3m3a_fc2ee828688205abc5fa962994fda81d">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb148"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  mean_dummy_3m3a <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m3a <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.1419</code></pre>
</div>
</div>
</div>
</div>
<p>The probability of observing 8 water in 15 tosses = 14.19%.</p>
</div>
<div id="tabset-20-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m3b-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.73 </strong></span>b: Exercise 3M3 – Data (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-data-3m3b_8a478964277de5e3e38232673135cc85">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb150"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.23b #############################</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="ot">&lt;-</span> samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dummy_3m3b =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> p_samples_3m2b))</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(dummy_3m3b) <span class="sc">|&gt;</span> </span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">dummy_cnt =</span> dplyr<span class="sc">::</span><span class="fu">n</span>())</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 16 × 2
#&gt;    dummy_3m3b dummy_cnt
#&gt;         &lt;int&gt;     &lt;int&gt;
#&gt;  1          0         3
#&gt;  2          1        45
#&gt;  3          2        99
#&gt;  4          3       289
#&gt;  5          4       540
#&gt;  6          5       829
#&gt;  7          6      1134
#&gt;  8          7      1421
#&gt;  9          8      1419
#&gt; 10          9      1356
#&gt; 11         10      1195
#&gt; 12         11       817
#&gt; 13         12       483
#&gt; 14         13       280
#&gt; 15         14        74
#&gt; 16         15        16</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-20-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-5-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m3b-plot" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.74 </strong></span>b: Exercise 3M3 – Histogram (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-plot-3m3b_3703066a6de2d08dbda5da5edf07b246">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb152"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> dummy_3m3b)) <span class="sc">+</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">16</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dummy water count&quot;</span>,</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Frequnecy&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-exercise-plot-3m3b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-plot-3m3b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.34: Posterior predictive check for 8 water with 15 tosses</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-20-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-6-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m3b-result" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.75 </strong></span>b: Exercise 3M3 – Result (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-result-3m3b_f2b95e16b18856251ce8da2499b082cb">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb153"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  mean_dummy_3m3b <span class="ot">&lt;-</span> samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="fu">mean</span>(dummy_3m3b <span class="sc">==</span> <span class="dv">8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>()</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.1419</code></pre>
</div>
</div>
<p>The probability of observing 8 water in 15 tosses = 14.19%.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="m4" class="level4" data-number="3.4.2.4">
<h4 data-number="3.4.2.4"><span class="header-section-number">3.4.2.4</span> 3M4</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3M4: Using the posterior distribution constructed from the new (8/15) data, now calculate the probability of observing 6 water in 9 tosses.</p>
</div>
<div class="my-exercise-container">
<p>There are two possible approaches for the solution:</p>
<ul>
<li><strong>S1</strong>: Random generation of the binomial distribution with the probability of the sampling distribution.</li>
<li><strong>S2</strong>: Computing the density for 6/9 but with the posterior distribution from 8/15 as prior.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">Original S1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Original S2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false">Tidyverse S1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-4" role="tab" aria-controls="tabset-21-4" aria-selected="false">Tidyverse M2</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m4a1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.76 </strong></span>a: Exercise 3M4 (Original: Method S1)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m4a1_df7b23f6d6105bd48727c67c2bb28c2f">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb155"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>samples_3m4a <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> samples_3m2a)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples_3m4a <span class="sc">==</span> <span class="dv">6</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.1765</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m4a2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.77 </strong></span>a: Exercise 3M4 (Original: Method S2)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/unnamed-chunk-97_1d782df36b8d887ad2ad40f30daf83dd">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb157"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: exercise-3m4a2</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>likelihood_6of9_3m4a <span class="ot">&lt;-</span>  stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid_3m1a)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>prior_6of9_3m4a <span class="ot">&lt;-</span>  posterior_std_3m1a</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  posterior_6of9_3m4a <span class="ot">&lt;-</span> <span class="fu">sum</span>(likelihood_6of9_3m4a <span class="sc">*</span> prior_6of9_3m4a)</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.1763898</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m4b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.78 </strong></span>b: Exercise 3M4 (Tidyverse: Method S1)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m41b_9cfcff9b4b049bcfb66f733d253e5726">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb159"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_6of9_3m4b =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_samples_3m2b)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> base<span class="sc">::</span><span class="fu">mean</span>(p_6of9_3m4b <span class="sc">==</span> <span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.1765</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-21-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m4b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.79 </strong></span>b: Exercise 3M4 (Tidyverse Method S2)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m42b_ba0a5c08cae9148dde69aad15df7ac96">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb161"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>df_3m1b <span class="sc">|&gt;</span> </span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">likelihood_6of9_3m4b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid_3m1b),</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_6of9_3m4b =</span> posterior_std_3m1b) <span class="sc">|&gt;</span> </span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> base<span class="sc">::</span><span class="fu">sum</span>(likelihood_6of9_3m4b <span class="sc">*</span> prior_6of9_3m4b)) <span class="sc">|&gt;</span> </span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.1763898</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="m5" class="level4" data-number="3.4.2.5">
<h4 data-number="3.4.2.5"><span class="header-section-number">3.4.2.5</span> 3M5</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3M5: Start over at Exercise 3M1 (<a href="#sec-e3m1" class="quarto-xref"><span class="quarto-unresolved-ref">sec-e3m1</span></a>), but now use a prior that is zero below <span class="math inline">\(p = 0.5\)</span> and a constant above <span class="math inline">\(p = 0.5\)</span>. This corresponds to prior information that a majority of the Earth’s surface is water. Repeat each problem above and compare the inferences. What difference does the better prior make? If it helps, compare inferences (using both priors) to the true value <span class="math inline">\(p = 0.7\)</span>.</p>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">3M5.1a</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">3M5.2a</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false">3M5.3a</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-4" role="tab" aria-controls="tabset-22-4" aria-selected="false">3M5.1b</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-5" role="tab" aria-controls="tabset-22-5" aria-selected="false">3M5.2b</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-6" role="tab" aria-controls="tabset-22-6" aria-selected="false">3M5.3b</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m5a-1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.80 </strong></span>a: Exercise 3M5: Posterior Distribution (~ 3M1: Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3m5a-1_eb46d6a1fe848b6f2500a1491b88124b">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb163"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M1a ###########</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>p_grid_3m5a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>prior_3m5a <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_grid_3m5a <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>likelihood_3m5a <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="dv">8</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> p_grid_3m5a)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>posterior_3m5a <span class="ot">&lt;-</span>  likelihood_3m5a <span class="sc">*</span> prior_3m5a</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>posterior_std_3m5a <span class="ot">&lt;-</span>  posterior_3m5a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m5a) </span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid_3m5a, posterior_std_3m5a, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Proportion of water (p)&quot;</span>,</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Posterior density&quot;</span>)</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p_grid_3m1a, posterior_std_3m1a)</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> .<span class="dv">7</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-exercise-3m5a-1" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3m5a-1-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.35: Posterior distribution for 8 ‘W’ in 15 tosses with prior &lt; 0.5 = 0 otherwise prior = 1 (Original)</figcaption>
</figure>
</div>
</div>
</div>
<p>Compared with the true value of <span class="math inline">\(0.7\)</span> the new prior (<span class="math inline">\(0\)</span> under <span class="math inline">\(p = 0.5\)</span>, otherwise <span class="math inline">\(p = 1\)</span>) is better, but there is still a big difference between the true value and the mode of the probability density.</p>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m5a-2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.81 </strong></span>a: Exercise 3M5.2: HPDI of 90% from 1e4 samples (~3M2: Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m5a-2_db41fdd957d3de5e21a126cf19c48b8c">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb164"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M2a #############</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>samples_3m5a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> p_grid_3m5a, </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="fl">1e4</span>, </span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prob =</span> posterior_std_3m5a</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>hpdi_3m5a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m5a, .<span class="dv">9</span>)</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>max_3m2a <span class="ot">&lt;-</span> <span class="fu">max</span>(posterior_std_3m1a)</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>max_3m5a <span class="ot">&lt;-</span> <span class="fu">max</span>(posterior_std_3m5a)</span></code></pre></div>
</details>
</div>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 37%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="header">
<th>Prior</th>
<th>Low</th>
<th>High</th>
<th>Diff</th>
<th>Max Density</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0.3393393</td>
<td>0.7267267</td>
<td>0.3873874</td>
<td>0.0032519</td>
</tr>
<tr class="even">
<td>0/1</td>
<td>0.5005005</td>
<td>0.7117117</td>
<td>0.2112112</td>
<td>0.0054363</td>
</tr>
</tbody>
</table>
<p>The HPDI interval is smaller with the the new prior <span class="math inline">\(p &lt; .5 = 0 \operatorname{and} p &gt;= .5 = 1\)</span> than with a constant prior of <span class="math inline">\(1\)</span>. The new prior is better as it gives more precise information.</p>
<p>The maximum posterior density of the new prior <span class="math inline">\(0/1\)</span> is higher than the maximum with the prior of <span class="math inline">\(1\)</span>. Values of <span class="math inline">\(p &lt; 0.5\)</span> are no longer taking up posterior density because they are <span class="math inline">\(0\)</span>. This can also be seen in <a href="#fig-exercise-3m5a-1" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-exercise-3m5a-1</span></a>.</p>
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m5a-3" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.82 </strong></span>a: Exercise 3M5.3: Posterior predictive check (~3M3: Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m5a-3-4_6ee97f2fbc0fe3f84f51141fc33f757e">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb165"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M3a ##############</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>dummy_3m5a_1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">15</span>, samples_3m5a)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>mean_3m5a_1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5a_1 <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M4a ##############</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>dummy_3m5a_2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">9</span>, samples_3m5a)</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>mean_3m5a_2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5a_2 <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="do">## compare with p = 0.7 ##############</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>dummy_3m5a_3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">15</span>, <span class="fl">0.7</span>)</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>mean_3m5a_3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5a_3 <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>dummy_3m5a_4 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">9</span>, <span class="fl">0.7</span>)</span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>mean_3m5a_4 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5a_4 <span class="sc">==</span> <span class="dv">6</span>)</span></code></pre></div>
</details>
</div>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Mean of 15/08</th>
<th>Mean of 09/06</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Samples</td>
<td>0.1516</td>
<td>0.2401</td>
</tr>
<tr class="even">
<td>Value 0.7</td>
<td>0.0822</td>
<td>0.265</td>
</tr>
</tbody>
</table>
<p>The mean of the samples of 6 water observations with 9 tosses are higher than 8 water with 15 tosses. This represents the fact that the real value of 0.7 is nearer with 6/9 = 0.667 than with 8/15 = 0.533. Also note that a predictive check with the real value of <span class="math inline">\(0.7\)</span> shows a very small mean value with 15/8 but a much higher mean with 9/6.</p>
</div>
</div>
</div>
<div id="tabset-22-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m5b-1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.83 </strong></span>b: Exercise 3M5: Posterior Distribution (~ 3M1: Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3m5b-1_300dc28d53265bf2c66003d3fbdf6022">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb166"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M1b ##############</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>df_3m5b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_grid_3m5b =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_3m5b =</span> base<span class="sc">::</span><span class="fu">ifelse</span>(p_grid_3m5b <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">likelihood_3m5b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">8</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> p_grid_3m5b),</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">posterior_3m5b =</span>  likelihood_3m5b <span class="sc">*</span> prior_3m5b,</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">posterior_std_3m5b =</span> posterior_3m5b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m5b)</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> df_3m5b,</span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3m5b, <span class="at">y =</span> posterior_std_3m5b,</span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linetype =</span> <span class="st">&quot;ifelse(p &lt; 0.5, 0, 1)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> df_3m1b,</span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3m1b, <span class="at">y =</span> posterior_std_3m1b,</span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linetype =</span> <span class="st">&quot;1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">scale_linetype_manual</span>(<span class="st">&quot;Prior:&quot;</span>, </span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>)) <span class="sc">+</span></span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">7</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Proportion of water (p)&quot;</span>,</span>
<span id="cb166-21"><a href="#cb166-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="st">&quot;Posterior density&quot;</span>) <span class="sc">+</span></span>
<span id="cb166-22"><a href="#cb166-22" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-exercise-3m5b-1" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3m5b-1-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.36: Posterior distribution for 8 ‘W’ in 15 tosses with prior &lt; 0.5 = 0 otherwise prior = 1 (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
<p>Compared with the true value of <span class="math inline">\(0.7\)</span> the new prior (<span class="math inline">\(0\)</span> under <span class="math inline">\(p = 0.5\)</span>, otherwise <span class="math inline">\(p = 1\)</span>) is better, but there is still a big difference between the true value and the mode of the probability density.</p>
</div>
</div>
</div>
<div id="tabset-22-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-5-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m5b-2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.84 </strong></span>b: Exercise 3M5.2: HPDI of 90% from 1e4 samples (~3M2: Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m5b-2_daf99fb2cc530c1b99e5be6245c78432">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb167"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M2b ##############</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>samples_3m5b <span class="ot">&lt;-</span> df_3m5b <span class="sc">|&gt;</span> </span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight_by =</span> posterior_std_3m5b,</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">p_samples_3m5b =</span> p_grid_3m5b)</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>hpdi_3m2b <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, .<span class="dv">9</span>)</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>hpdi_3m5b <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m5b<span class="sc">$</span>p_samples_3m5b, .<span class="dv">9</span>)</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>max_3m2b <span class="ot">&lt;-</span> <span class="fu">max</span>(df_3m1b<span class="sc">$</span>posterior_std_3m1b)</span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>max_3m5b <span class="ot">&lt;-</span> <span class="fu">max</span>(df_3m5b<span class="sc">$</span>posterior_std_3m5b)</span></code></pre></div>
</details>
</div>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 37%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="header">
<th>Prior</th>
<th>Low</th>
<th>High</th>
<th>Diff</th>
<th>Max Density</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0.3393393</td>
<td>0.7267267</td>
<td>0.3873874</td>
<td>0.0032519</td>
</tr>
<tr class="even">
<td>0/1</td>
<td>0.5005005</td>
<td>0.7117117</td>
<td>0.2112112</td>
<td>0.0054363</td>
</tr>
</tbody>
</table>
<p>The HPDI interval is smaller with the the new prior <span class="math inline">\(p &lt; .5 = 0 \operatorname{and} p &gt;= .5 = 1\)</span> than with a constant prior of <span class="math inline">\(1\)</span>. The new prior is better as it gives more precise information.</p>
<p>The maximum posterior density of the new prior <span class="math inline">\(0/1\)</span> is higher than the maximum with the prior of <span class="math inline">\(1\)</span>. Values of <span class="math inline">\(p &lt; 0.5\)</span> are no longer taking up posterior density because they are <span class="math inline">\(0\)</span>. This can also be seen in <a href="#fig-exercise-3m5b-1" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-exercise-3m5b-1</span></a>.</p>
</div>
</div>
</div>
<div id="tabset-22-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-6-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m5b-3" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.85 </strong></span>b: Exercise 3M5.3: Posterior predictive check (~3M3: Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m5b-3-4_7463d4fe6b26c32052f9673ed0e9f9c3">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb168"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M3b ##############</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>dummy_3m5b_1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">15</span>, samples_3m5b<span class="sc">$</span>p_samples_3m5b)</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>mean_3m5b_1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5b_1 <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M4b ##############</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>dummy_3m5b_2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">9</span>, samples_3m5b<span class="sc">$</span>p_samples_3m5b)</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>mean_3m5b_2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5b_2 <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="do">## compare with p = 0.7 ##############</span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>dummy_3m5b_3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">15</span>, <span class="fl">0.7</span>)</span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>mean_3m5b_3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5b_3 <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>dummy_3m5b_4 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">9</span>, <span class="fl">0.7</span>)</span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>mean_3m5b_4 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5b_4 <span class="sc">==</span> <span class="dv">6</span>)</span></code></pre></div>
</details>
</div>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Mean of 15/08</th>
<th>Mean of 09/06</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Samples</td>
<td>0.1516</td>
<td>0.2401</td>
</tr>
<tr class="even">
<td>Value 0.7</td>
<td>0.0822</td>
<td>0.265</td>
</tr>
</tbody>
</table>
<p>The mean of the samples of 6 water observations with 9 tosses are higher than 8 water with 15 tosses. This represents the fact that the real value of 0.7 is nearer with 6/9 = 0.667 than with 8/15 = 0.533. Also note that a predictive check with the real value of <span class="math inline">\(0.7\)</span> shows a very small mean value with 15/8 but a much higher mean with 9/6.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="m6" class="level4" data-number="3.4.2.6">
<h4 data-number="3.4.2.6"><span class="header-section-number">3.4.2.6</span> 3M6</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3M6: Suppose you want to estimate the Earth’s proportion of water very precisely. Specifically, you want the 99% percentile interval of the posterior distribution of <span class="math inline">\(p\)</span> to be only <span class="math inline">\(0.05\)</span> wide. This means the distance between the upper and lower bound of the interval should be <span class="math inline">\(0.05\)</span>.</p>
<ul>
<li><strong>N tosses</strong>: How many times will you have to toss the globe to do this?</li>
<li><strong>Width</strong>: How influences the sample size the difference between samples?</li>
</ul>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">N tosses (O)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">Width (O)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false">N tosses (T)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-4" role="tab" aria-controls="tabset-23-4" aria-selected="false">Width (T)</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m6a-1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.86 </strong></span>a: Exercise 3M6-1: How many times will you have to toss the globe to get a <span class="math inline">\(0.05\)</span> wide interval with <span class="math inline">\(PI = .99\)</span>? (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<p>Although McElreath states explicitly that he won’t require an exact answer but rather wants to see the chosen approach (<a href="https://github.com/rmcelreath/statrethinking_winter2019/blob/master/homework/week01.pdf">Winter 2019 Homework</a>) I was curious about the figure and how to program this process. It turned out that the chosen <code>set.seed()</code> number has effects how many times one has to toss the globe.</p>
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m6a-1_484a43df77ad4f0d6c8cd9c5098f17c2">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb169"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>pi99_3m6a <span class="ot">&lt;-</span> <span class="cf">function</span>(N, seed) {</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  p_true <span class="ot">&lt;-</span>  <span class="fl">0.7</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">prob =</span> p_true)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  p_grid_3m6a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  prior_3m6a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  likelihood_3m6a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(W, <span class="at">size =</span> N, <span class="at">prob =</span> p_grid_3m6a)</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>  posterior_3m6a <span class="ot">&lt;-</span> likelihood_3m6a <span class="sc">*</span> prior_3m6a</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>  posterior_std_3m6a <span class="ot">&lt;-</span>  posterior_3m6a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m6a)</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>  samples_3m6a <span class="ot">&lt;-</span></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(p_grid_3m6a,</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">prob =</span> posterior_std_3m6a,</span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">1e4</span>,</span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>  rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m6a, <span class="fl">0.99</span>)</span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>my_seed <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">42</span>, <span class="dv">100</span>, <span class="dv">150</span>)</span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(my_seed)) {</span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a>  PI99 <span class="ot">&lt;-</span> <span class="fu">pi99_3m6a</span>(N, my_seed[i])</span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">as.numeric</span>(PI99[<span class="dv">2</span>] <span class="sc">-</span> PI99[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>)) {</span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> N <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a>    PI99 <span class="ot">&lt;-</span> <span class="fu">pi99_3m6a</span>(N, my_seed[i])</span>
<span id="cb169-30"><a href="#cb169-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb169-31"><a href="#cb169-31" aria-hidden="true" tabindex="-1"></a>  s[i] <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;With set.seed({my_seed[i]}) we need to toss the globe {N} times.</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb169-32"><a href="#cb169-32" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb169-33"><a href="#cb169-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-34"><a href="#cb169-34" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb169-35"><a href="#cb169-35" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] &quot;With set.seed(3) we need to toss the globe 2102 times.&quot;  
#&gt; [2] &quot;With set.seed(42) we need to toss the globe 2208 times.&quot; 
#&gt; [3] &quot;With set.seed(100) we need to toss the globe 2304 times.&quot;
#&gt; [4] &quot;With set.seed(150) we need to toss the globe 2115 times.&quot;
#&gt; 8.309 sec elapsed</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m6a-2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.87 </strong></span>a: Exercise 3M6-2: Demonstrate the variation of the interval width with different number of simulations (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m6a-2_d0ab6748f51b6972bbf0bdcf1d63e563">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb171"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>f_3m6a <span class="ot">&lt;-</span> <span class="cf">function</span>(N) {</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  p_true <span class="ot">&lt;-</span>  <span class="fl">0.7</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">prob =</span> p_true)</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  p_grid_3m6a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>  prior_3m6a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  likelihood_3m6a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(W, <span class="at">size =</span> N, <span class="at">prob =</span> p_grid_3m6a)</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  posterior_3m6a <span class="ot">&lt;-</span> likelihood_3m6a <span class="sc">*</span> prior_3m6a</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>  posterior_std_3m6a <span class="ot">&lt;-</span>  posterior_3m6a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m6a)</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>  samples_3m6a <span class="ot">&lt;-</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(p_grid_3m6a,</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">prob =</span> posterior_std_3m6a,</span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">1e4</span>,</span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>  pi_99_3m6a <span class="ot">&lt;-</span>  rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m6a, <span class="fl">0.99</span>)</span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(pi_99_3m6a[<span class="dv">2</span>] <span class="sc">-</span> pi_99_3m6a[<span class="dv">1</span>])</span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a>Nlist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>) </span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a>Nlist <span class="ot">&lt;-</span> <span class="fu">rep</span>(Nlist, <span class="at">each =</span> <span class="dv">100</span>) </span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a>width <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Nlist, f_3m6a) </span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Nlist, width) </span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="03-sampling-the-imaginary_files/figure-html/exercise-3m6a-2-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
<p>The difference between samples shrinks as the sample size increases.</p>
<blockquote>
<p>What are we looking at in this plot? The horizontal is sample size. The points are individual interval widths, one for each simulation. The red line is drawn at a width of <span class="math inline">\(0.05\)</span>. Looks like we need more than <span class="math inline">\(2000\)</span> tosses of the globe to get the interval to be that precise.</p>
<p>The above is a general feature of learning from data: The greatest returns on learning come early on. Each additional observation contributes less and less. So it takes very much effort to progressively reduce our uncertainty. So if your application requires a very precise estimate, be prepared to collect a lot of data. Or to change your approach. (<a href="https://github.com/rmcelreath/statrethinking_winter2019/blob/master/homework/week01_solutions.pdf">Solution, Week-01, Winter 2019</a>)</p>
</blockquote>
</div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m6b-1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.88 </strong></span>b: Exercise 3M6-1: How many times will you have to toss the globe to get a <span class="math inline">\(0.05\)</span> wide interval with <span class="math inline">\(PI = .99\)</span>? (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<p>Because of the slow performance of manipulating whole data frame, I am going to use here just one <code>set.seed()</code> function. This is only to show that we get the same result as in the first loop of <a href="#cnj-3m6a-1" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-3m6a-1</span></a>.</p>
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m6b-1_de0e4a19a0d473ce1bae59cfbe2733d2">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb172"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>pi99_3m6b <span class="ot">&lt;-</span> <span class="cf">function</span>(N, seed) {</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">set.seed</span>(seed)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  p_true <span class="ot">&lt;-</span>  <span class="fl">0.7</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">prob =</span> p_true)</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  df_3m6b <span class="ot">&lt;-</span>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_3m6b =</span> </span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>                            base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">prior_3m6b =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>),</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">likelihood_3m6b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(W, <span class="at">size =</span> N, <span class="at">prob =</span> p_grid_3m6b),</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_3m6b =</span> likelihood_3m6b <span class="sc">*</span> prior_3m6b,</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_std_3m6b =</span> posterior_3m6b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m6b))</span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>  samples_3m6b <span class="ot">&lt;-</span> df_3m6b <span class="sc">|&gt;</span> </span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weight_by =</span> posterior_std_3m6b,</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>  rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m6b<span class="sc">$</span>p_grid_3m6b, <span class="fl">0.99</span>)</span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>my_seed <span class="ot">=</span> <span class="dv">3</span> <span class="do">## just one loop!</span></span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-25"><a href="#cb172-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(my_seed)) {</span>
<span id="cb172-26"><a href="#cb172-26" aria-hidden="true" tabindex="-1"></a>  PI99_3m6b <span class="ot">&lt;-</span> <span class="fu">pi99_3m6b</span>(N, my_seed[i])</span>
<span id="cb172-27"><a href="#cb172-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">as.numeric</span>(PI99_3m6b[<span class="dv">2</span>] <span class="sc">-</span> PI99_3m6b[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>)) {</span>
<span id="cb172-28"><a href="#cb172-28" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> N <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb172-29"><a href="#cb172-29" aria-hidden="true" tabindex="-1"></a>    PI99_3m6b <span class="ot">&lt;-</span> <span class="fu">pi99_3m6b</span>(N, my_seed[i])</span>
<span id="cb172-30"><a href="#cb172-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb172-31"><a href="#cb172-31" aria-hidden="true" tabindex="-1"></a>  s[i] <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;With set.seed({my_seed[i]}) we need to toss the globe {N} times.</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb172-32"><a href="#cb172-32" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb172-33"><a href="#cb172-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb172-34"><a href="#cb172-34" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb172-35"><a href="#cb172-35" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] &quot;With set.seed(3) we need to toss the globe 2102 times.&quot;
#&gt; 35.169 sec elapsed</code></pre>
</div>
</div>
<p>Compare the execution time of just one set.seed() calculation with four in <a href="#cnj-3m6a-1" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-3m6a-1</span></a>. Using data frames turns out about 16(!) times slower the computation with vectors. (Already just one set.seed() computation with tibbles is 4 times slower than the processing time of 4 set.seed() loops with base R vectors.)</p>
</div>
</div>
</div>
<div id="tabset-23-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3m6b-2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.89 </strong></span>b: Exercise 3M6-2: Demonstrate the variation of the interval width with different number of simulations (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3m6b-2_6ed10364f8119d1931a1c0bab4017151">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb174"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>f_3m6b <span class="ot">&lt;-</span> <span class="cf">function</span>(N) {</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  p_true <span class="ot">&lt;-</span>  <span class="fl">0.7</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">prob =</span> p_true)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  df_3m6b <span class="ot">&lt;-</span>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_3m6b =</span> </span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>                            base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">prior_3m6b =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>),</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">likelihood_3m6b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(W, <span class="at">size =</span> N, <span class="at">prob =</span> p_grid_3m6b),</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_3m6b =</span> likelihood_3m6b <span class="sc">*</span> prior_3m6b,</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_std_3m6b =</span> posterior_3m6b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m6b))</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>  samples_3m6b <span class="ot">&lt;-</span> df_3m6b <span class="sc">|&gt;</span> </span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weight_by =</span> posterior_std_3m6b,</span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>  pi_99_3m6b <span class="ot">&lt;-</span>  rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m6b<span class="sc">$</span>p_grid_3m6b, <span class="fl">0.99</span>)</span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(pi_99_3m6b[<span class="dv">2</span>] <span class="sc">-</span> pi_99_3m6b[<span class="dv">1</span>])</span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a>Nlist_3m6b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>) </span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a>df_3m6b_2 <span class="ot">&lt;-</span> </span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">Nlist_3m6b =</span> base<span class="sc">::</span><span class="fu">rep</span>(Nlist_3m6b, <span class="at">each =</span> <span class="dv">100</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">width_3m6b =</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(Nlist_3m6b, f_3m6b))</span>
<span id="cb174-26"><a href="#cb174-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-27"><a href="#cb174-27" aria-hidden="true" tabindex="-1"></a>df_3m6b_2 <span class="sc">|&gt;</span> </span>
<span id="cb174-28"><a href="#cb174-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Nlist_3m6b,</span>
<span id="cb174-29"><a href="#cb174-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> width_3m6b)) <span class="sc">+</span></span>
<span id="cb174-30"><a href="#cb174-30" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb174-31"><a href="#cb174-31" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of samples&quot;</span>,</span>
<span id="cb174-32"><a href="#cb174-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Width of PI = 0.99&quot;</span>) <span class="sc">+</span></span>
<span id="cb174-33"><a href="#cb174-33" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">05</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb174-34"><a href="#cb174-34" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="03-sampling-the-imaginary_files/figure-html/exercise-3m6b-2-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
<p>The difference between samples shrinks as the sample size increases.</p>
<blockquote>
<p>What are we looking at in this plot? The horizontal is sample size. The points are individual interval widths, one for each simulation. The red line is drawn at a width of <span class="math inline">\(0.05\)</span>. Looks like we need more than <span class="math inline">\(2000\)</span> tosses of the globe to get the interval to be that precise.</p>
<p>The above is a general feature of learning from data: The greatest returns on learning come early on. Each additional observation contributes less and less. So it takes very much effort to progressively reduce our uncertainty. So if your application requires a very precise estimate, be prepared to collect a lot of data. Or to change your approach. (<a href="https://github.com/rmcelreath/statrethinking_winter2019/blob/master/homework/week01_solutions.pdf">Solution, Week-01, Winter 2019</a>)</p>
</blockquote>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
</section>
<section id="hard" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3"><span class="header-section-number">3.4.3</span> Hard</h3>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3h1-5" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.90 </strong></span>: Reported first and second born children in 100 two-child families</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/exercise-3h1-5_8d423ae0925fd9af78d5b590d07aeaa6">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb175"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.28 ###############</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>birth1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>birth2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.30 ###############</span></span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>n_boys <span class="ot">&lt;-</span> <span class="fu">sum</span>(birth1) <span class="sc">+</span> <span class="fu">sum</span>(birth2)</span></code></pre></div>
</details>
</div>
<p>200 Births of these are boys:</p>
<ul>
<li>1st born: 51</li>
<li>2nd born: 60,</li>
<li>total: 111</li>
</ul>
</div>
</div>
<section id="h1" class="level4" data-number="3.4.3.1">
<h4 data-number="3.4.3.1"><span class="header-section-number">3.4.3.1</span> 3H1</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3H1: Using grid approximation, compute the posterior distribution for the probability of a birth being a boy. Assume a uniform prior probability. Which parameter value maximizes the posterior probability?</p>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">Boys (Original)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">Boys (Tidyverse)</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3H1a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.91 </strong></span>a: Posterior distribution for the probability of a birth being a boy (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h1a_73941458d2cb0f63e4ecc71df5615127">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb176"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>p_grid_3h1a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>,</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="dv">1</span>,</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">length.out =</span> <span class="fl">1e3</span>)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>prior_3h1a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="fl">1e3</span>)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>likelihood_3h1a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="fu">sum</span>(birth1) <span class="sc">+</span> <span class="fu">sum</span>(birth2),</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="dv">200</span>,</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prob =</span> p_grid_3h1a)</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>posterior_3h1a <span class="ot">&lt;-</span>  prior_3h1a <span class="sc">*</span> likelihood_3h1a</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>posterior_std_3h1a <span class="ot">&lt;-</span> posterior_3h1a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3h1a)</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid_3h1a, posterior_std_3h1a, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>map_3h1a <span class="ot">&lt;-</span> p_grid_3h1a[<span class="fu">which.max</span>(posterior_std_3h1a)]</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-exercise-3h1a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h1a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.37: Posterior distribution of boys rate probability (Original)</figcaption>
</figure>
</div>
</div>
</div>
<p>The mode or <a class='glossary' title='In Bayesian statistics a Maximum A Posteriori probability or MAP is essentially the mode of posterior distribution. (CDS, p.272)'>MAP</a> is at 0.555, e.g. the birth ratio for boys is 55.5%.</p>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3h1b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.92 </strong></span>b: Posterior distribution for the probability of a birth being a boy (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h1b_d6f022cb10987a4f258c846e61b3df62">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb177"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>df_3h1b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_3h1b =</span> base<span class="sc">::</span><span class="fu">seq</span>(</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">from =</span> <span class="dv">0</span>,</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="dv">1</span>,</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">length.out =</span> <span class="fl">1e3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">prior_3h1b =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="fl">1e3</span>),</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">likelihood_3h1b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> base<span class="sc">::</span><span class="fu">sum</span>(birth1) <span class="sc">+</span> base<span class="sc">::</span><span class="fu">sum</span>(birth2),</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="dv">200</span>,</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prob =</span> p_grid_3h1b),</span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_3h1b =</span> prior_3h1b <span class="sc">*</span> likelihood_3h1b,</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_std_3h1b =</span> posterior_3h1b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3h1b))</span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>map_3h1b <span class="ot">&lt;-</span> df_3h1b <span class="sc">|&gt;</span> </span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(posterior_std_3h1b)) <span class="sc">|&gt;</span> </span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(dplyr<span class="sc">::</span><span class="fu">first</span>(p_grid_3h1b)) <span class="sc">|&gt;</span> </span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">1</span>)</span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a>df_3h1b <span class="sc">|&gt;</span> </span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3h1b,</span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> posterior_std_3h1b)) <span class="sc">+</span></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> map_3h1b, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Ratio of boy births&quot;</span>,</span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Posterior distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-exercise-3h1b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h1b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.38: Posterior distribution of boys rate probability (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
<p>The mode or <a class='glossary' title='In Bayesian statistics a Maximum A Posteriori probability or MAP is essentially the mode of posterior distribution. (CDS, p.272)'>MAP</a> is at 0.555, e.g. the birth ratio for boys is 55.5%.</p>
<div class="my-note">
<div class="my-note-header">
<p>Note: {<em>tidybayes</em>} point intervals needs samples</p>
</div>
<div class="my-note-container">
<p>I computed the mode by arranging the data frame with the highest value at the top. This is exactly the same value as in the book version. Another Base R solution would be <code>df_3h1b$p_grid_3h1b[which.max(df_3h1b$posterior_std_3h1b)]</code> = 55.4554555%.</p>
<p>I tried to calculate the mode also with the {<strong>tidybayes</strong>} package. But all mode values from this package (<code>mode_qi()</code>, <code>mode_hdci()</code>, <code>mode_hdi()</code> and <code>Mode())</code> result in smaller values, for instance <code>tidybayes::Mode(samples_3m2b$p_samples_3m2b)</code> = 51.2%.</p>
<p>After many trials and exerpiments I came to the conclusion that above mentioned functions of the {<strong>tidybayes</strong>} package work only with generated samples. Therefore I do not have to address two columns as with the <code>which.max()</code> (one outside and one inside the square brackets) and I have to supply vectors with the above mentioned family of function form the {<strong>tidybayes</strong>} package.</p>
<p>Furthermore I noticed that all point_intervals without <code>mode_</code>, <code>median_</code> and <code>mean_</code> in front of the <code>qi</code>, <code>ll</code>, <code>ul</code>, <code>hdi</code>, <code>hdci</code> is not in {<strong>tidybayes</strong>} but in the accompanying package {<strong>ggdist</strong>} and need therefore as prefix <code>ggdist::</code>. Furthermore these functions needs numerical vectors and can’t therfore used with the pipe.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="h2" class="level4" data-number="3.4.3.2">
<h4 data-number="3.4.3.2"><span class="header-section-number">3.4.3.2</span> 3H2</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3H2: Using the <code>sample()</code> function, draw <span class="math inline">\(10,000\)</span> random parameter values from the posterior distribution you calculated above. Use these samples to estimate the <span class="math inline">\(50\%\)</span>, <span class="math inline">\(89\%\)</span>, and <span class="math inline">\(97\%\)</span> highest posterior density intervals.</p>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">Sample (Original)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">Sample (Tidyverse)</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3h2a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.93 </strong></span>a: Draw <span class="math inline">\(10,000\)</span> random parameter values from the posterior distribution you calculated above (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h2a_62703c1cd7f24feb85862d479cd232cf">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb178"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>samples_3h2a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> p_grid_3h1a,</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">size =</span> <span class="fl">1e4</span>,</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prob =</span> posterior_std_3h1a)</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3h2a, <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">89</span>, .<span class="dv">97</span>))</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>map_3h2a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">chainmode</span>(samples_3h2a, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(samples_3h2a, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> map_3h2a, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;     |0.97     |0.89      |0.5      0.5|     0.89|     0.97| 
#&gt; 0.4824825 0.4994995 0.5265265 0.5725726 0.6076076 0.6296296</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exercise-3h2a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h2a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.39: 10.000 samples from the posterior distribution of the birth data (Original)</figcaption>
</figure>
</div>
</div>
</div>
<p>The red line is the density mode (0.555) calculated with <code>rethinking::chainmode()</code>.</p>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3h2b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.94 </strong></span>b: Draw <span class="math inline">\(10,000\)</span> random parameter values from the posterior distribution you calculated above (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h2b_c234b48dcb34f0dddbdb1dfcb123215d">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb180"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>samples_3h2b <span class="ot">&lt;-</span>  df_3h1b <span class="sc">|&gt;</span> </span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight_by =</span> posterior_std_3h1b)</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>  map_3h2b <span class="ot">&lt;-</span> samples_3h2b <span class="sc">|&gt;</span> </span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">mode_hdi</span>(p_grid_3h1b, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">89</span>, .<span class="dv">97</span>)) </span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>samples_3h2b <span class="sc">|&gt;</span> </span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3h1b)) <span class="sc">+</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> map_3h2b[[<span class="dv">1</span>, <span class="dv">1</span>]], <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Ratio of boy births&quot;</span>,</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Samples from the posterior distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 6
#&gt;   p_grid_3h1b .lower .upper .width .point .interval
#&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
#&gt; 1       0.555  0.531  0.577   0.5  mode   hdi      
#&gt; 2       0.555  0.504  0.613   0.89 mode   hdi      
#&gt; 3       0.555  0.483  0.632   0.97 mode   hdi</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exercise-3h2b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h2b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.40: 10.000 samples from the posterior distribution of the birth data (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
<p>The red line is the density mode (0.555) calculated with <code>tidybayes::mode_hdi()</code> and also displayed in the column <code>p_grid_3h1b</code>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="h3" class="level4" data-number="3.4.3.3">
<h4 data-number="3.4.3.3"><span class="header-section-number">3.4.3.3</span> 3H3</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3H3: Use <code>rbinom()</code> to simulate <span class="math inline">\(10,000\)</span> replicates of <span class="math inline">\(200\)</span> births. You should end up with <span class="math inline">\(10,000\)</span> numbers, each one a count of boys out of <span class="math inline">\(200\)</span> births. Compare the distribution of predicted numbers of boys to the actual count in the data (<span class="math inline">\(111\)</span> boys out of <span class="math inline">\(200\)</span> births). There are many good ways to visualize the simulations, but the <code>dens()</code> command (part of the {<strong>rethinking</strong>} package) is probably the easiest way in this case. Does it look like the model fits the data well? That is, does the distribution of predictions include the actual observation as a central, likely outcome?</p>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">3H3a</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">3H3b</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3h3a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.95 </strong></span>a: Posterior predictive distribution with 10,000 replicates of 200 births (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h3a_c355d6b30eb303aca6217f7a6c95859e">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb182"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>dummy_data_3h3a <span class="ot">&lt;-</span>  <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">200</span>,</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2a)</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dummy_data_3h3a, <span class="dv">10</span>)</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(dummy_data_3h3a, </span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">sum</span>(birth1 <span class="sc">+</span> birth2), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] 105 124  98 102  94  96  98 107 101 108</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exercise-3h3a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h3a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.41: Create posterior predictive distribution with 10,000 replicates of 200 births (Original)</figcaption>
</figure>
</div>
</div>
</div>
<p>The model appears to fit well, because the observed value of 111 boys is in the middle of the <a class='glossary' title='An approach to assessing model fit. It is the distribution for future predicted data based on the data you have already seen. Measures of discrepancy between the estimated model and the data are constructed and their posterior predictive distribution compared to the discrepancy observed for the dataset. (CDS, p. 334)'>posterior predictive distribution</a> which has a mean of 110.7847 and a median of 111.</p>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3h3b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.96 </strong></span>b: Posterior predictive distribution with 10,000 replicates of 200 births (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h3b_4658c2cb6900b28dd402d89e72a359a3">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb184"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>dummy_data_3h3b <span class="ot">&lt;-</span>  stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">200</span>,</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2b<span class="sc">$</span>p_grid_3h1b</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(dummy_data_3h3b, <span class="dv">10</span>)</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_slabinterval</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> dummy_data_3h3b),</span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.66</span>, <span class="fl">0.89</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">slab_fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">density =</span> <span class="st">&quot;bounded&quot;</span>) <span class="sc">+</span></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> n_boys), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of Boys&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] 105 124  98 102  94  96  98 107 101 108</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exercise-3h3b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h3b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.42: Create posterior predictive distribution with 10,000 replicates of 200 births (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
<p>I have used the graphic function from the {<strong>ggdist</strong>} resp. {<strong>tidybayes</strong>} package. I learned about this familiy of functions from the <a href="https://sr2-solutions.wjakethompson.com/bayesian-inference#chapter-3">solution by Jake Thompson</a>.</p>
<p>The model appears to fit well, because the observed value of 111 boys is in the middle of the <a class='glossary' title='An approach to assessing model fit. It is the distribution for future predicted data based on the data you have already seen. Measures of discrepancy between the estimated model and the data are constructed and their posterior predictive distribution compared to the discrepancy observed for the dataset. (CDS, p. 334)'>posterior predictive distribution</a> which has a mean of 110.7847 and a median of 111.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="h4" class="level4" data-number="3.4.3.4">
<h4 data-number="3.4.3.4"><span class="header-section-number">3.4.3.4</span> 3H4</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3H4: Now compare <span class="math inline">\(10,000\)</span> counts of boys from <span class="math inline">\(100\)</span> simulated first borns only to the number of boys in the first births, <code>birth1</code>. How does the model look in this light?</p>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">3H4a</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">3H4b</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3h4a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.97 </strong></span>a: Compare <span class="math inline">\(10,000\)</span> counts of boys from <span class="math inline">\(100\)</span> simulated first borns (Original)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h4a_f48dffab6835e16f5834354eb9d811a0">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb186"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>dummy_data_3h4a <span class="ot">&lt;-</span>  <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">100</span>,</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2a)</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(dummy_data_3h4a, <span class="dv">10</span>)</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>map_3h4a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">chainmode</span>(dummy_data_3h4a, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(dummy_data_3h4a, <span class="at">adj =</span> <span class="fl">0.7</span>)</span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">sum</span>(birth1), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> map_3h4a, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] 51 60 59 48 56 49 50 52 46 62</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exercise-3h4a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h4a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.43: Compare 10,000 counts of boys from 100 simulated first borns (Original)</figcaption>
</figure>
</div>
</div>
</div>
<p>Observed first born boys: 51</p>
<p>Simulation of first born boys:</p>
<ul>
<li>Mean: 55.3639</li>
<li>Median: 55</li>
<li>Mode: 54.961</li>
</ul>
<p>With the <a class='glossary' title='An approach to assessing model fit. It is the distribution for future predicted data based on the data you have already seen. Measures of discrepancy between the estimated model and the data are constructed and their posterior predictive distribution compared to the discrepancy observed for the dataset. (CDS, p. 334)'>posterior predictive distribution</a> for the first born boys the model does not appears to fit well, because the observed value of 51 boys (blue line) is not in the middle of the distribution.</p>
</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-3h4b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 3.98 </strong></span>b: Compare <span class="math inline">\(10,000\)</span> counts of boys from <span class="math inline">\(100\)</span> simulated first borns (Tidyverse)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h4b_13dbb9c574d4f2a46b510e6c10a9d56a">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb188"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>dummy_data_3h4b <span class="ot">&lt;-</span>  stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">100</span>,</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2b<span class="sc">$</span>p_grid_3h1b</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(dummy_data_3h4b, <span class="dv">10</span>)</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>map_3h4b <span class="ot">&lt;-</span> tidybayes<span class="sc">::</span><span class="fu">Mode</span>(dummy_data_3h4b)</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_slabinterval</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> dummy_data_3h4b),</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.66</span>, <span class="fl">0.89</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">slab_fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">density =</span> <span class="st">&quot;bounded&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">sum</span>(birth1)), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> map_3h4b), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of 1st born boys&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] 51 60 59 48 56 49 50 52 46 62</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exercise-3h4b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h4b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.44: Compare 10,000 counts of boys from 100 simulated first borns (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
<p>Observed first born boys: 51</p>
<p>Simulation of first born boys:</p>
<ul>
<li>Mean: 55.3639</li>
<li>Median: 55</li>
<li>Mode: 55</li>
</ul>
<p>With the <a class='glossary' title='An approach to assessing model fit. It is the distribution for future predicted data based on the data you have already seen. Measures of discrepancy between the estimated model and the data are constructed and their posterior predictive distribution compared to the discrepancy observed for the dataset. (CDS, p. 334)'>posterior predictive distribution</a> for the first born boys the model does not appears so well as for all boys in <a href="#cnj-3h3b" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-3h3b</span></a>, because the observed value of 51 boys (blue line) is not in the middle of the distribution. However, it does not appear to be a large discrepancy, as the observed value is still within the middle 66% interval.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="h5" class="level4" data-number="3.4.3.5">
<h4 data-number="3.4.3.5"><span class="header-section-number">3.4.3.5</span> 3H5</h4>
<div class="my-exercise">
<div class="my-exercise-header">
<p>Exercise 3H5: The model assumes that sex of first and second births are independent. To check this assumption, focus now on second births that followed female first borns. Compare 10,000 simulated counts of boys to only those second births that followed girls. To do this correctly, you need to count the number of first borns who were girls and simulate that many births, 10,000 times. Compare the counts of boys in your simulations to the actual observed count of boys following girls. How does the model look in this light? Any guesses what is going on in these data?</p>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true">3H5a</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false">3H5b</a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h5a_064979de2255a9481f18abe1177655a5">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb190"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>df_birth_3h5a <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(birth1, birth2))</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>df_birth_3h5a <span class="ot">&lt;-</span> <span class="fu">subset</span>(df_birth_3h5a, birth1 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>n_1st_girls_3h5a <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fu">sum</span>(birth1)</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>n_2nd_boys_3h5a <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_birth_3h5a<span class="sc">$</span>birth1) <span class="sc">+</span> <span class="fu">sum</span>(df_birth_3h5a<span class="sc">$</span>birth2)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>p_grid_3h5a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>,</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="dv">1</span>,</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">length.out =</span> <span class="fl">1e3</span>)</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>prior_3h5a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="fl">1e3</span>)</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>likelihood_3h5a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> n_2nd_boys_3h5a,</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> n_1st_girls_3h5a,</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">prob =</span> p_grid_3h5a)</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>posterior_3h5a <span class="ot">&lt;-</span>  prior_3h5a <span class="sc">*</span> likelihood_3h5a</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>posterior_std_3h5a <span class="ot">&lt;-</span> posterior_3h5a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3h5a)</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>dummy_data_3h5a <span class="ot">&lt;-</span>  <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> n_1st_girls_3h5a,</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2a)</span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(dummy_data_3h5a, </span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">adj =</span> <span class="dv">1</span>,</span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlab =</span> <span class="st">&quot;Number of 2nd born boys that follow a 1st born girl&quot;</span>)</span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> n_2nd_boys_3h5a, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-exercise-3h5a" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h5a-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.45: Second births of boys that followed female first borns (Original)</figcaption>
</figure>
</div>
</div>
</div>
<p>The model predicts 27 2nd born boys that follow a 1st born girl. But we have observed 39 boys. Our model underestimates the number of 2nd born boys so that our assumption that births are independent must be challenged.</p>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/fig-exercise-3h5b_ff34a5cf6b09c01cfd305536d5c5284c">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb191"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>n_1st_girls_3h5b <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fu">sum</span>(birth1)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>n_2nd_boys_3h5b <span class="ot">&lt;-</span> <span class="fu">sum</span>(birth2[<span class="fu">which</span>(birth1 <span class="sc">==</span> <span class="dv">0</span>)])</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>dummy_data_3h5b <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> n_1st_girls_3h5b, </span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">prob =</span> samples_3h2b<span class="sc">$</span>p_grid_3h1b)</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>map_3h5b <span class="ot">&lt;-</span>  tidybayes<span class="sc">::</span><span class="fu">Mode</span>(dummy_data_3h5b)</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_slabinterval</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> dummy_data_3h5b),</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.66</span>, <span class="fl">0.89</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">slab_fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">density =</span> <span class="st">&quot;bounded&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> n_2nd_boys_3h5b), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> map_3h5b), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of 2nd born boys that follow a 1st born girl&quot;</span>, </span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-exercise-3h5b" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="03-sampling-the-imaginary_files/figure-html/fig-exercise-3h5b-1.png" class="img-fluid" width="672" /></p>
<figcaption>Graph 3.46: Second births of boys that followed female first borns (Tidyverse)</figcaption>
</figure>
</div>
</div>
</div>
<p>The model predicts 27 2nd born boys that follow a 1st born girl. But we have observed 39 boys. Our model underestimates the number of 2nd born boys so that our assumption that births are independent appears to be violated. We have generally more 2nd born boys (60% versus 51%) but especially more 2nd born boys when the first born was a girl (79.59%).</p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="session-info" class="level2" data-number="3.5">
<h2 data-number="3.5"><span class="header-section-number">3.5</span> Session info</h2>
<div class="cell" data-hash="03-sampling-the-imaginary_cache/html/session-info_cb59a4a54b76de31d871c8ab9ede1f4d">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb192"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">sessionInfo</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; R version 4.3.2 (2023-10-31)
#&gt; Platform: x86_64-apple-darwin20 (64-bit)
#&gt; Running under: macOS Sonoma 14.1.1
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib 
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0
#&gt; 
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; time zone: Europe/Vienna
#&gt; tzcode source: internal
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt;  [1] brms_2.20.4         Rcpp_1.0.11         patchwork_1.1.3    
#&gt;  [4] lubridate_1.9.3     forcats_1.0.0       stringr_1.5.1      
#&gt;  [7] dplyr_1.1.4         purrr_1.0.2         readr_2.1.4        
#&gt; [10] tidyr_1.3.0         tibble_3.2.1        ggplot2_3.4.4      
#&gt; [13] tidyverse_2.0.0     glossary_1.0.0.9000
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;   [1] svUnit_1.0.6         shinythemes_1.2.0    splines_4.3.2       
#&gt;   [4] later_1.3.1          cellranger_1.1.0     xts_0.13.1          
#&gt;   [7] rpart_4.1.21         lifecycle_1.0.4      StanHeaders_2.26.28 
#&gt;  [10] processx_3.8.2       lattice_0.22-5       MASS_7.3-60         
#&gt;  [13] insight_0.19.6       crosstalk_1.2.0      ggdist_3.3.0        
#&gt;  [16] backports_1.4.1      magrittr_2.0.3       rmarkdown_2.25      
#&gt;  [19] yaml_2.3.7           httpuv_1.6.12        skimr_2.1.5         
#&gt;  [22] pkgbuild_1.4.2       gld_2.6.6            multcomp_1.4-25     
#&gt;  [25] abind_1.4-5          expm_0.999-7         tidybayes_3.0.6     
#&gt;  [28] TH.data_1.1-2        tensorA_0.36.2       sandwich_3.0-2      
#&gt;  [31] rmutil_1.1.10        inline_0.3.19        spatial_7.3-17      
#&gt;  [34] bridgesampling_1.1-2 commonmark_1.9.0     codetools_0.2-19    
#&gt;  [37] DT_0.30              xml2_1.3.5           tidyselect_1.2.0    
#&gt;  [40] shape_1.4.6          bayesplot_1.10.0     farver_2.1.1        
#&gt;  [43] stable_1.1.6         matrixStats_1.1.0    stats4_4.3.2        
#&gt;  [46] base64enc_0.1-3      jsonlite_1.8.7       e1071_1.7-13        
#&gt;  [49] ellipsis_0.3.2       survival_3.5-7       emmeans_1.8.9       
#&gt;  [52] tools_4.3.2          DescTools_0.99.50    glue_1.6.2          
#&gt;  [55] gridExtra_2.3        xfun_0.41            cmdstanr_0.5.3      
#&gt;  [58] distributional_0.3.2 loo_2.6.0            withr_2.5.2         
#&gt;  [61] timeSeries_4031.107  fastmap_1.1.1        boot_1.3-28.1       
#&gt;  [64] fansi_1.0.5          shinyjs_2.1.0        callr_3.7.3         
#&gt;  [67] digest_0.6.33        timechange_0.2.0     R6_2.5.1            
#&gt;  [70] mime_0.12            estimability_1.4.1   colorspace_2.1-0    
#&gt;  [73] gtools_3.9.4         markdown_1.11        threejs_0.3.3       
#&gt;  [76] modeest_2.4.0        utf8_1.2.4           generics_0.1.3      
#&gt;  [79] data.table_1.14.8    class_7.3-22         httr_1.4.7          
#&gt;  [82] prettyunits_1.2.0    htmlwidgets_1.6.2    pkgconfig_2.0.3     
#&gt;  [85] dygraphs_1.1.1.6     gtable_0.3.4         Exact_3.2           
#&gt;  [88] timeDate_4022.108    htmltools_0.5.7      clue_0.3-65         
#&gt;  [91] scales_1.2.1         rethinking_2.40      lmom_3.0            
#&gt;  [94] posterior_1.5.0      knitr_1.45           rstudioapi_0.15.0   
#&gt;  [97] tzdb_0.4.0           reshape2_1.4.4       statip_0.2.3        
#&gt; [100] coda_0.19-4          checkmate_2.3.0      nlme_3.1-163        
#&gt; [103] curl_5.1.0           repr_1.1.6           proxy_0.4-27        
#&gt; [106] zoo_1.8-12           rootSolve_1.8.2.4    parallel_4.3.2      
#&gt; [109] miniUI_0.1.1.1       fBasics_4032.96      pillar_1.9.0        
#&gt; [112] grid_4.3.2           vctrs_0.6.4          shinystan_2.6.0     
#&gt; [115] promises_1.2.1       arrayhelpers_1.1-0   xtable_1.8-4        
#&gt; [118] cluster_2.1.4        evaluate_0.23        mvtnorm_1.2-3       
#&gt; [121] cli_3.6.1            compiler_4.3.2       rlang_1.1.2         
#&gt; [124] crayon_1.5.2         rstantools_2.3.1.1   rversions_2.1.2     
#&gt; [127] labeling_0.4.3       ps_1.7.5             plyr_1.8.9          
#&gt; [130] stringi_1.8.1        rstan_2.32.3         viridisLite_0.4.2   
#&gt; [133] QuickJSR_1.0.7       munsell_0.5.0        colourpicker_1.3.0  
#&gt; [136] bayestestR_0.13.1    Brobdingnag_1.2-9    V8_4.4.0            
#&gt; [139] Matrix_1.6-3         hms_1.1.3            stabledist_0.7-1    
#&gt; [142] shiny_1.8.0          igraph_1.5.1         RcppParallel_5.1.7  
#&gt; [145] readxl_1.4.3</code></pre>
</div>
</div>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden" data-render-id="quarto-int-sidebar-title">Personal Notes: Statistical Rethinking (2nd ed)</span> <span class="hidden" data-render-id="quarto-int-navbar-title">Personal Notes: Statistical Rethinking (2nd ed)</span> <span class="hidden" data-render-id="quarto-int-next"><span class="chapter-number">4</span>  <span class="chapter-title">Geocentric Models</span></span> <span class="hidden" data-render-id="quarto-int-prev"><span class="chapter-number">2</span>  <span class="chapter-title">Small and Large Worlds</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/index.html">Preface</span> <span class="hidden" data-render-id="quarto-int-sidebar:/01-golem-of-prague.html"><span class="chapter-number">1</span>  <span class="chapter-title">Golem of Prague</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/02-small-and-large-worlds.html"><span class="chapter-number">2</span>  <span class="chapter-title">Small and Large Worlds</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/03-sampling-the-imaginary.html"><span class="chapter-number">3</span>  <span class="chapter-title">Sampling the Imaginary</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/04-geocentric-models.html"><span class="chapter-number">4</span>  <span class="chapter-title">Geocentric Models</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/05-many-variables.html"><span class="chapter-number">5</span>  <span class="chapter-title">The Many Variables &amp; The Spurious Waffles</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/95-references.html">References</span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-1">Appendices</span> <span class="hidden" data-render-id="quarto-int-sidebar:/96-quarto-notes.html"><span class="chapter-number">A</span>  <span class="chapter-title">Comments about using Quarto</span></span> <span class="hidden" data-render-id="quarto-breadcrumbs-8d8f6361097a8825fa37af16fe596c28"><span class="chapter-number">3</span>  <span class="chapter-title">Sampling the Imaginary</span></span></p>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden" data-render-id="quarto-metatitle">Personal Notes: Statistical Rethinking (2nd ed) - <span id="sec-chap03" class="quarto-section-identifier"><span class="chapter-number">3</span>  <span class="chapter-title">Sampling the Imaginary</span></span></span> <span class="hidden" data-render-id="quarto-twittercardtitle">Personal Notes: Statistical Rethinking (2nd ed) - <span id="sec-chap03" class="quarto-section-identifier"><span class="chapter-number">3</span>  <span class="chapter-title">Sampling the Imaginary</span></span></span> <span class="hidden" data-render-id="quarto-ogcardtitle">Personal Notes: Statistical Rethinking (2nd ed) - <span id="sec-chap03" class="quarto-section-identifier"><span class="chapter-number">3</span>  <span class="chapter-title">Sampling the Imaginary</span></span></span> <span class="hidden" data-render-id="quarto-metasitename">Personal Notes: Statistical Rethinking (2nd ed)</span> <span class="hidden" data-render-id="quarto-twittercarddesc"></span> <span class="hidden" data-render-id="quarto-ogcardddesc"></span></p>
</div>
<!-- -->
<div class="quarto-embedded-source-code">
<div class="sourceCode" id="cb194" data-shortcodes="false"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># Sampling the Imaginary {#sec-chap03}</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>::: my-objectives</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>::: my-objectives-header</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>Learning Objectives:</span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>::: my-objectives-container</span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>This chapter teaches the basic skills for working with samples from the</span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a>posterior distribution. We&#39;ll begin to use samples to summarize and</span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>simulate model output. The skills learned here will apply to every</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>problem in the remainder of the book, even though the details of the</span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a>models and how the samples are produced will vary.</span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a>The chapter exploits the fact that people are better in counts than in</span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a>probabilities. We will take the probability distributions from the</span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a>previous chapter and sampling from them to produce counts.</span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Vampire Example {.unnumbered}</span></span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a><span class="fu">### ORIGINAL {.unnumbered}</span></span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-32"><a href="#cb194-32" aria-hidden="true" tabindex="-1"></a>::: my-definition</span>
<span id="cb194-33"><a href="#cb194-33" aria-hidden="true" tabindex="-1"></a>::: my-definition-header</span>
<span id="cb194-34"><a href="#cb194-34" aria-hidden="true" tabindex="-1"></a>::: {#def-chap-03-1}</span>
<span id="cb194-35"><a href="#cb194-35" aria-hidden="true" tabindex="-1"></a>: Probability Notation</span>
<span id="cb194-36"><a href="#cb194-36" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-37"><a href="#cb194-37" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-38"><a href="#cb194-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-39"><a href="#cb194-39" aria-hidden="true" tabindex="-1"></a>::: my-definition-container</span>
<span id="cb194-40"><a href="#cb194-40" aria-hidden="true" tabindex="-1"></a>As a repetition and to get a better understanding of the following</span>
<span id="cb194-41"><a href="#cb194-41" aria-hidden="true" tabindex="-1"></a>formulae in this section I read a very [basic introduction into</span>
<span id="cb194-42"><a href="#cb194-42" aria-hidden="true" tabindex="-1"></a>probability</span>
<span id="cb194-43"><a href="#cb194-43" aria-hidden="true" tabindex="-1"></a>notation]((https://www.mathsisfun.com/data/probability-events-conditional.html))</span>
<span id="cb194-44"><a href="#cb194-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-45"><a href="#cb194-45" aria-hidden="true" tabindex="-1"></a>$P(A)$ means &quot;**Probability Of Event A**&quot;.</span>
<span id="cb194-46"><a href="#cb194-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-47"><a href="#cb194-47" aria-hidden="true" tabindex="-1"></a>::: my-example</span>
<span id="cb194-48"><a href="#cb194-48" aria-hidden="true" tabindex="-1"></a>::: my-example-header</span>
<span id="cb194-49"><a href="#cb194-49" aria-hidden="true" tabindex="-1"></a>Probability of an Event</span>
<span id="cb194-50"><a href="#cb194-50" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-51"><a href="#cb194-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-52"><a href="#cb194-52" aria-hidden="true" tabindex="-1"></a>::: my-example-container</span>
<span id="cb194-53"><a href="#cb194-53" aria-hidden="true" tabindex="-1"></a>What is the probability of $2$ after throwing a dice?</span>
<span id="cb194-54"><a href="#cb194-54" aria-hidden="true" tabindex="-1"></a>$$P(A) = \frac{1}{6}$$</span>
<span id="cb194-55"><a href="#cb194-55" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-56"><a href="#cb194-56" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-57"><a href="#cb194-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-58"><a href="#cb194-58" aria-hidden="true" tabindex="-1"></a>$P(B \mid A)$ means &quot;**Probability of Event B given A**&quot;.</span>
<span id="cb194-59"><a href="#cb194-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-60"><a href="#cb194-60" aria-hidden="true" tabindex="-1"></a>This is a conditional probability. After event $A$ has happened, what is</span>
<span id="cb194-61"><a href="#cb194-61" aria-hidden="true" tabindex="-1"></a>the probability of $B$? If the events are independent from each other</span>
<span id="cb194-62"><a href="#cb194-62" aria-hidden="true" tabindex="-1"></a>than the changes do not influence each other.</span>
<span id="cb194-63"><a href="#cb194-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-64"><a href="#cb194-64" aria-hidden="true" tabindex="-1"></a>::: my-example</span>
<span id="cb194-65"><a href="#cb194-65" aria-hidden="true" tabindex="-1"></a>::: my-example-header</span>
<span id="cb194-66"><a href="#cb194-66" aria-hidden="true" tabindex="-1"></a>Independent Conditional Events</span>
<span id="cb194-67"><a href="#cb194-67" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-68"><a href="#cb194-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-69"><a href="#cb194-69" aria-hidden="true" tabindex="-1"></a>::: my-example-container</span>
<span id="cb194-70"><a href="#cb194-70" aria-hidden="true" tabindex="-1"></a>The probability to throw $2$ in a second dice throw are still</span>
<span id="cb194-71"><a href="#cb194-71" aria-hidden="true" tabindex="-1"></a>$P(B \mid A) = \frac{1}{6}$. If the events are dependent of each other</span>
<span id="cb194-72"><a href="#cb194-72" aria-hidden="true" tabindex="-1"></a>then &quot;Probability of event A and event B equals the probability of event</span>
<span id="cb194-73"><a href="#cb194-73" aria-hidden="true" tabindex="-1"></a>A times the probability of event B given event A.&quot;</span>
<span id="cb194-74"><a href="#cb194-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-75"><a href="#cb194-75" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb194-76"><a href="#cb194-76" aria-hidden="true" tabindex="-1"></a>P(A \space and\space B) = P(A) \times P(B \mid A)</span>
<span id="cb194-77"><a href="#cb194-77" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb194-78"><a href="#cb194-78" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-79"><a href="#cb194-79" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-80"><a href="#cb194-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-81"><a href="#cb194-81" aria-hidden="true" tabindex="-1"></a>::: my-example</span>
<span id="cb194-82"><a href="#cb194-82" aria-hidden="true" tabindex="-1"></a>::: my-example-header</span>
<span id="cb194-83"><a href="#cb194-83" aria-hidden="true" tabindex="-1"></a>Dependent Conditional Events</span>
<span id="cb194-84"><a href="#cb194-84" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-85"><a href="#cb194-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-86"><a href="#cb194-86" aria-hidden="true" tabindex="-1"></a>::: my-example-container</span>
<span id="cb194-87"><a href="#cb194-87" aria-hidden="true" tabindex="-1"></a>Typical example is removing marble from a bag without replacement. Let&#39;s</span>
<span id="cb194-88"><a href="#cb194-88" aria-hidden="true" tabindex="-1"></a>take a red marble from a bag of $5$ red and $5$ blue marbles without</span>
<span id="cb194-89"><a href="#cb194-89" aria-hidden="true" tabindex="-1"></a>replacement. Here the probability of a red marble (in the second draw)</span>
<span id="cb194-90"><a href="#cb194-90" aria-hidden="true" tabindex="-1"></a>given the probability of a red marble (in the first draw) is</span>
<span id="cb194-91"><a href="#cb194-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-92"><a href="#cb194-92" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb194-93"><a href="#cb194-93" aria-hidden="true" tabindex="-1"></a>\frac{5}{10} \times \frac{4}{9} = \frac{2}{9}</span>
<span id="cb194-94"><a href="#cb194-94" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb194-95"><a href="#cb194-95" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-96"><a href="#cb194-96" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-97"><a href="#cb194-97" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-98"><a href="#cb194-98" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-99"><a href="#cb194-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-100"><a href="#cb194-100" aria-hidden="true" tabindex="-1"></a><span class="fu">#### a) Medical Test Scenario with Bayes theorem {.unnumbered}</span></span>
<span id="cb194-101"><a href="#cb194-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-102"><a href="#cb194-102" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;suppose there is a blood test that correctly detects vampirism 95% of</span></span>
<span id="cb194-103"><a href="#cb194-103" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the time. In more precise and mathematical notation,</span></span>
<span id="cb194-104"><a href="#cb194-104" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr(\text{positive test result} \mid vampire) = 0.95$. It&#39;s a very</span></span>
<span id="cb194-105"><a href="#cb194-105" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; accurate test, nearly always catching real vampires. It also make</span></span>
<span id="cb194-106"><a href="#cb194-106" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; mistakes, though, in the form of false positives. One percent of the</span></span>
<span id="cb194-107"><a href="#cb194-107" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; time, it incorrectly diagnoses normal people as vampires,</span></span>
<span id="cb194-108"><a href="#cb194-108" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $Pr(\text{positive test result}|mortal) = 0.01$. The final bit of</span></span>
<span id="cb194-109"><a href="#cb194-109" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; information we are told is that vampires are rather rare, being only</span></span>
<span id="cb194-110"><a href="#cb194-110" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $0.1\%$ of the population, implying $Pr(vampire) = 0.001$. Suppose now</span></span>
<span id="cb194-111"><a href="#cb194-111" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; that someone tests positive for vampirism. What&#39;s the probability that</span></span>
<span id="cb194-112"><a href="#cb194-112" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; he or she is a bloodsucking immortal?&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-113"><a href="#cb194-113" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 49](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-114"><a href="#cb194-114" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=68&amp;annotation=W9MU6VCZ)</span><span class="at">)</span></span>
<span id="cb194-115"><a href="#cb194-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-116"><a href="#cb194-116" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;The correct approach is just to use Bayes&#39; theorem to invert the</span></span>
<span id="cb194-117"><a href="#cb194-117" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probability, to compute $Pr(vampire|positive)$. The calculation can be</span></span>
<span id="cb194-118"><a href="#cb194-118" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; presented as:</span></span>
<span id="cb194-119"><a href="#cb194-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-120"><a href="#cb194-120" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb194-121"><a href="#cb194-121" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb194-122"><a href="#cb194-122" aria-hidden="true" tabindex="-1"></a>Pr(vampire\mid positive) = \frac{Pr(positive\mid vampire) Pr(vampire)}{Pr(positive)}<span class="sc">\\</span></span>
<span id="cb194-123"><a href="#cb194-123" aria-hidden="true" tabindex="-1"></a>\text{where Pr(positive) is the average probability of a positive test result, that is,}<span class="sc">\\</span> Pr(positive) = Pr(positive \mid vampire) Pr(vampire) <span class="sc">\\</span></span>
<span id="cb194-124"><a href="#cb194-124" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>Pr(positive \mid mortal) 1 − Pr(vampire)</span>
<span id="cb194-125"><a href="#cb194-125" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb194-126"><a href="#cb194-126" aria-hidden="true" tabindex="-1"></a>$$ {#eq-vampire} &quot; ([McElreath, 2020, p.</span>
<span id="cb194-127"><a href="#cb194-127" aria-hidden="true" tabindex="-1"></a>49](zotero://select/groups/5243560/items/NFUEVASQ))</span>
<span id="cb194-128"><a href="#cb194-128" aria-hidden="true" tabindex="-1"></a>(<span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=68&amp;annotation=X4KD33AT)</span>)</span>
<span id="cb194-129"><a href="#cb194-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-130"><a href="#cb194-130" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-131"><a href="#cb194-131" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-132"><a href="#cb194-132" aria-hidden="true" tabindex="-1"></a>::: {#cnj-vampire-bayes-a}</span>
<span id="cb194-133"><a href="#cb194-133" aria-hidden="true" tabindex="-1"></a>a: Performing vampire calculation with <span class="in">`r glossary(&quot;Bayes’ theorem&quot;)`</span> in</span>
<span id="cb194-134"><a href="#cb194-134" aria-hidden="true" tabindex="-1"></a>Base R</span>
<span id="cb194-135"><a href="#cb194-135" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-136"><a href="#cb194-136" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-137"><a href="#cb194-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-138"><a href="#cb194-138" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-139"><a href="#cb194-139" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-140"><a href="#cb194-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-141"><a href="#cb194-141" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-142"><a href="#cb194-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: vampire-bayes-a</span></span>
<span id="cb194-143"><a href="#cb194-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-144"><a href="#cb194-144" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.1a Vampire ##################</span></span>
<span id="cb194-145"><a href="#cb194-145" aria-hidden="true" tabindex="-1"></a>pr_positive_vampire_a <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb194-146"><a href="#cb194-146" aria-hidden="true" tabindex="-1"></a>pr_positive_mortal_a <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb194-147"><a href="#cb194-147" aria-hidden="true" tabindex="-1"></a>pr_vampire_a <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb194-148"><a href="#cb194-148" aria-hidden="true" tabindex="-1"></a>pr_positive_a <span class="ot">&lt;-</span> pr_positive_vampire_a <span class="sc">*</span> pr_vampire_a <span class="sc">+</span></span>
<span id="cb194-149"><a href="#cb194-149" aria-hidden="true" tabindex="-1"></a>  pr_positive_mortal_a <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pr_vampire_a)</span>
<span id="cb194-150"><a href="#cb194-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-151"><a href="#cb194-151" aria-hidden="true" tabindex="-1"></a>( </span>
<span id="cb194-152"><a href="#cb194-152" aria-hidden="true" tabindex="-1"></a>  pr_vampire_positive_a <span class="ot">&lt;-</span> pr_positive_vampire_a <span class="sc">*</span> pr_vampire_a <span class="sc">/</span> pr_positive_a</span>
<span id="cb194-153"><a href="#cb194-153" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-154"><a href="#cb194-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-155"><a href="#cb194-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-156"><a href="#cb194-156" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-157"><a href="#cb194-157" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-158"><a href="#cb194-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-159"><a href="#cb194-159" aria-hidden="true" tabindex="-1"></a>There is only an <span class="in">`r pr_vampire_positive_a`</span>% chance that the suspect is</span>
<span id="cb194-160"><a href="#cb194-160" aria-hidden="true" tabindex="-1"></a>actually a vampire.</span>
<span id="cb194-161"><a href="#cb194-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-162"><a href="#cb194-162" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Most people find this result counterintuitive. And it&#39;s a very</span></span>
<span id="cb194-163"><a href="#cb194-163" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; important result, because it mimics the structure of many realistic</span></span>
<span id="cb194-164"><a href="#cb194-164" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; testing contexts, such as HIV and DNA testing, criminal profiling, and</span></span>
<span id="cb194-165"><a href="#cb194-165" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; even statistical significance testing (see the Rethinking box at the</span></span>
<span id="cb194-166"><a href="#cb194-166" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; end of this section). Whenever the condition of interest is very rare,</span></span>
<span id="cb194-167"><a href="#cb194-167" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; having a test that finds all the true cases is still no guarantee that</span></span>
<span id="cb194-168"><a href="#cb194-168" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; a positive result carries much information at all. The reason is that</span></span>
<span id="cb194-169"><a href="#cb194-169" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; most positive results are false positives, even when all the true</span></span>
<span id="cb194-170"><a href="#cb194-170" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; positives are detected correctly&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-171"><a href="#cb194-171" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 49](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-172"><a href="#cb194-172" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=68&amp;annotation=CMMR49PQ)</span><span class="at">)</span></span>
<span id="cb194-173"><a href="#cb194-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-174"><a href="#cb194-174" aria-hidden="true" tabindex="-1"></a><span class="fu">#### b) Medical test scenario with natural frequencies {.unnumbered}</span></span>
<span id="cb194-175"><a href="#cb194-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-176"><a href="#cb194-176" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;There is a way to present the same problem that does make it more</span></span>
<span id="cb194-177"><a href="#cb194-177" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; intuitive&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-178"><a href="#cb194-178" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 50](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-179"><a href="#cb194-179" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=69&amp;annotation=2DWF7729)</span><span class="at">)</span></span>
<span id="cb194-180"><a href="#cb194-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-181"><a href="#cb194-181" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb194-182"><a href="#cb194-182" aria-hidden="true" tabindex="-1"></a><span class="in">(1)  In a population of 100,000 people, 100 of them are vampires.</span></span>
<span id="cb194-183"><a href="#cb194-183" aria-hidden="true" tabindex="-1"></a><span class="in">(2)  Of the 100 who are vampires, 95 of them will test positive for vampirism.</span></span>
<span id="cb194-184"><a href="#cb194-184" aria-hidden="true" tabindex="-1"></a><span class="in">(3)  Of the 99,900 mortals, 999 of them will test positive for vampirism.</span></span>
<span id="cb194-185"><a href="#cb194-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-186"><a href="#cb194-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-187"><a href="#cb194-187" aria-hidden="true" tabindex="-1"></a>There are 999 + 95 = <span class="in">`r 999 + 95`</span> people tested positive. But from these</span>
<span id="cb194-188"><a href="#cb194-188" aria-hidden="true" tabindex="-1"></a>people only 95 / (999 + 95) = <span class="in">`r (95 / (999 + 95)) * 100`</span> % are actually</span>
<span id="cb194-189"><a href="#cb194-189" aria-hidden="true" tabindex="-1"></a>vampires.</span>
<span id="cb194-190"><a href="#cb194-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-191"><a href="#cb194-191" aria-hidden="true" tabindex="-1"></a>Or with a slightly different wording it is still easier to understand:</span>
<span id="cb194-192"><a href="#cb194-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-193"><a href="#cb194-193" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>We can just count up the number of people who test positive:</span>
<span id="cb194-194"><a href="#cb194-194" aria-hidden="true" tabindex="-1"></a>    $95 + 999 = 1094$.</span>
<span id="cb194-195"><a href="#cb194-195" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Out of these $1094$ positive tests, $95$ of them are real vampires,</span>
<span id="cb194-196"><a href="#cb194-196" aria-hidden="true" tabindex="-1"></a>    so that implies:</span>
<span id="cb194-197"><a href="#cb194-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-198"><a href="#cb194-198" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb194-199"><a href="#cb194-199" aria-hidden="true" tabindex="-1"></a>Pr(positive \mid vampire) = \frac{95}{1094}</span>
<span id="cb194-200"><a href="#cb194-200" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb194-201"><a href="#cb194-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-202"><a href="#cb194-202" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-203"><a href="#cb194-203" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-204"><a href="#cb194-204" aria-hidden="true" tabindex="-1"></a>::: {#cnj-vampire-frequencies-a}</span>
<span id="cb194-205"><a href="#cb194-205" aria-hidden="true" tabindex="-1"></a>a: Performing vampire calculation with frequencies in Base R</span>
<span id="cb194-206"><a href="#cb194-206" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-207"><a href="#cb194-207" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-208"><a href="#cb194-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-209"><a href="#cb194-209" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-210"><a href="#cb194-210" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-211"><a href="#cb194-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-212"><a href="#cb194-212" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-213"><a href="#cb194-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: vampire-frequencies-a</span></span>
<span id="cb194-214"><a href="#cb194-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-215"><a href="#cb194-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-216"><a href="#cb194-216" aria-hidden="true" tabindex="-1"></a>pr_vampire_a2 <span class="ot">&lt;-</span>  <span class="dv">100</span> <span class="sc">/</span> <span class="dv">100000</span></span>
<span id="cb194-217"><a href="#cb194-217" aria-hidden="true" tabindex="-1"></a>pr_positive_vampire_a2 <span class="ot">&lt;-</span>  <span class="dv">95</span> <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb194-218"><a href="#cb194-218" aria-hidden="true" tabindex="-1"></a>pr_positive_mortal_a2  <span class="ot">&lt;-</span>  <span class="dv">999</span> <span class="sc">/</span> <span class="dv">99900</span></span>
<span id="cb194-219"><a href="#cb194-219" aria-hidden="true" tabindex="-1"></a>pr_positive_a2 <span class="ot">&lt;-</span>  <span class="dv">95</span> <span class="sc">+</span> <span class="dv">999</span></span>
<span id="cb194-220"><a href="#cb194-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-221"><a href="#cb194-221" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb194-222"><a href="#cb194-222" aria-hidden="true" tabindex="-1"></a>  pr_vampire_positive_a2 <span class="ot">&lt;-</span>  </span>
<span id="cb194-223"><a href="#cb194-223" aria-hidden="true" tabindex="-1"></a>    pr_positive_vampire_a2 <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> pr_positive_a2</span>
<span id="cb194-224"><a href="#cb194-224" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-225"><a href="#cb194-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-226"><a href="#cb194-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-227"><a href="#cb194-227" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-228"><a href="#cb194-228" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-229"><a href="#cb194-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-230"><a href="#cb194-230" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;The second presentation of the problem, using counts rather than</span></span>
<span id="cb194-231"><a href="#cb194-231" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probabilities, is often called the frequency format or natural</span></span>
<span id="cb194-232"><a href="#cb194-232" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; frequencies. Why a frequency format helps people intuit the correct</span></span>
<span id="cb194-233"><a href="#cb194-233" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; approach remains contentious. Some people think that human psychology</span></span>
<span id="cb194-234"><a href="#cb194-234" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; naturally works better when it receives information in the form a</span></span>
<span id="cb194-235"><a href="#cb194-235" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; person in a natural environment would receive it. In the real world,</span></span>
<span id="cb194-236"><a href="#cb194-236" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; we encounter counts only. No one has ever seen a probability, the</span></span>
<span id="cb194-237"><a href="#cb194-237" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; thinking goes. But everyone sees counts (&quot;frequencies&quot;) in their daily</span></span>
<span id="cb194-238"><a href="#cb194-238" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; lives.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-239"><a href="#cb194-239" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 50](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-240"><a href="#cb194-240" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=69&amp;annotation=G26ZTDUZ)</span><span class="at">)</span></span>
<span id="cb194-241"><a href="#cb194-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-242"><a href="#cb194-242" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;many scientists are uncomfortable with integral calculus, even though</span></span>
<span id="cb194-243"><a href="#cb194-243" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; they have strong and valid intuitions about how to summarize data.</span></span>
<span id="cb194-244"><a href="#cb194-244" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Working with samples transforms a problem in calculus into a problem</span></span>
<span id="cb194-245"><a href="#cb194-245" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; in data summary, into a frequency format problem. An integral in a</span></span>
<span id="cb194-246"><a href="#cb194-246" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; typical Bayesian context is just the total probability in some</span></span>
<span id="cb194-247"><a href="#cb194-247" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; interval. That can be a challenging calculus problem. But once you</span></span>
<span id="cb194-248"><a href="#cb194-248" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; have samples from the probability distribution, it&#39;s just a matter of</span></span>
<span id="cb194-249"><a href="#cb194-249" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; counting values in the interval. An empirical attack on the posterior</span></span>
<span id="cb194-250"><a href="#cb194-250" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; allows the scientist to ask and answer more questions about the model,</span></span>
<span id="cb194-251"><a href="#cb194-251" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; without relying upon a captive mathematician. For this reason, it is</span></span>
<span id="cb194-252"><a href="#cb194-252" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; easier and more intuitive to work with samples from the posterior,</span></span>
<span id="cb194-253"><a href="#cb194-253" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; than to work with probabilities and integrals directly.&quot; ([McElreath,</span></span>
<span id="cb194-254"><a href="#cb194-254" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 2020, p. 51](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-255"><a href="#cb194-255" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=70&amp;annotation=M7I2DV3C)</span><span class="at">)</span></span>
<span id="cb194-256"><a href="#cb194-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-257"><a href="#cb194-257" aria-hidden="true" tabindex="-1"></a><span class="fu">### TIDYVERSE {.unnumbered}</span></span>
<span id="cb194-258"><a href="#cb194-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-259"><a href="#cb194-259" aria-hidden="true" tabindex="-1"></a><span class="fu">#### a) Medical Test Scenario with Bayes theorem {.unnumbered}</span></span>
<span id="cb194-260"><a href="#cb194-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-261"><a href="#cb194-261" aria-hidden="true" tabindex="-1"></a>::: my-important</span>
<span id="cb194-262"><a href="#cb194-262" aria-hidden="true" tabindex="-1"></a>::: my-important-header</span>
<span id="cb194-263"><a href="#cb194-263" aria-hidden="true" tabindex="-1"></a>Vectors in Base R are tibble columns in tidyverse</span>
<span id="cb194-264"><a href="#cb194-264" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-265"><a href="#cb194-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-266"><a href="#cb194-266" aria-hidden="true" tabindex="-1"></a>::: my-important-container</span>
<span id="cb194-267"><a href="#cb194-267" aria-hidden="true" tabindex="-1"></a>Whenever there is a calculation with vectors the pendant in tidyverse</span>
<span id="cb194-268"><a href="#cb194-268" aria-hidden="true" tabindex="-1"></a>mode is to generate columns in a tibble with <span class="in">`tibble::tibble()`</span> or if</span>
<span id="cb194-269"><a href="#cb194-269" aria-hidden="true" tabindex="-1"></a>there is already a data frame with <span class="in">`dplyr::mutate()`</span> and to do the</span>
<span id="cb194-270"><a href="#cb194-270" aria-hidden="true" tabindex="-1"></a>appropriate calculation with these columns.</span>
<span id="cb194-271"><a href="#cb194-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-272"><a href="#cb194-272" aria-hidden="true" tabindex="-1"></a>The following @cnj-vampire-bayes-a transformed the Base R calculation</span>
<span id="cb194-273"><a href="#cb194-273" aria-hidden="true" tabindex="-1"></a>@cnj-vampire-bayes-b into a computation using the tidyverse approach.</span>
<span id="cb194-274"><a href="#cb194-274" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-275"><a href="#cb194-275" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-276"><a href="#cb194-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-277"><a href="#cb194-277" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-278"><a href="#cb194-278" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-279"><a href="#cb194-279" aria-hidden="true" tabindex="-1"></a>::: {#cnj-vampire-bayes-b}</span>
<span id="cb194-280"><a href="#cb194-280" aria-hidden="true" tabindex="-1"></a>b: Performing the calculation using Bayes&#39; theorem with tidyverse</span>
<span id="cb194-281"><a href="#cb194-281" aria-hidden="true" tabindex="-1"></a>approach in R</span>
<span id="cb194-282"><a href="#cb194-282" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-283"><a href="#cb194-283" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-284"><a href="#cb194-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-285"><a href="#cb194-285" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-286"><a href="#cb194-286" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-287"><a href="#cb194-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-288"><a href="#cb194-288" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-289"><a href="#cb194-289" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: vampire-bayes-b</span></span>
<span id="cb194-290"><a href="#cb194-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-291"><a href="#cb194-291" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.1b Vampire ##########</span></span>
<span id="cb194-292"><a href="#cb194-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-293"><a href="#cb194-293" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">pr_positive_vampire_b =</span> .<span class="dv">95</span>,</span>
<span id="cb194-294"><a href="#cb194-294" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_positive_mortal_b  =</span> .<span class="dv">01</span>,</span>
<span id="cb194-295"><a href="#cb194-295" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_vampire_b          =</span> .<span class="dv">001</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-296"><a href="#cb194-296" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr_positive_b =</span> pr_positive_vampire_b <span class="sc">*</span> pr_vampire_b</span>
<span id="cb194-297"><a href="#cb194-297" aria-hidden="true" tabindex="-1"></a>         <span class="sc">+</span> pr_positive_mortal_b <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pr_vampire_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-298"><a href="#cb194-298" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr_vampire_positive_b =</span> </span>
<span id="cb194-299"><a href="#cb194-299" aria-hidden="true" tabindex="-1"></a>           pr_positive_vampire_b <span class="sc">*</span> pr_vampire_b <span class="sc">/</span> pr_positive_b) <span class="sc">|&gt;</span> </span>
<span id="cb194-300"><a href="#cb194-300" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span>
<span id="cb194-301"><a href="#cb194-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-302"><a href="#cb194-302" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-303"><a href="#cb194-303" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-304"><a href="#cb194-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-305"><a href="#cb194-305" aria-hidden="true" tabindex="-1"></a><span class="fu">#### b) Medical test scenario with natural frequencies {.unnumbered}</span></span>
<span id="cb194-306"><a href="#cb194-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-307"><a href="#cb194-307" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-308"><a href="#cb194-308" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-309"><a href="#cb194-309" aria-hidden="true" tabindex="-1"></a>::: {#cnj-vampire-frequencies-b}</span>
<span id="cb194-310"><a href="#cb194-310" aria-hidden="true" tabindex="-1"></a>b: Performing the calculation using frequencies with tidyverse approach</span>
<span id="cb194-311"><a href="#cb194-311" aria-hidden="true" tabindex="-1"></a>in R</span>
<span id="cb194-312"><a href="#cb194-312" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-313"><a href="#cb194-313" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-314"><a href="#cb194-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-315"><a href="#cb194-315" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-316"><a href="#cb194-316" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-317"><a href="#cb194-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-318"><a href="#cb194-318" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-319"><a href="#cb194-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: vampire-frequencies-b</span></span>
<span id="cb194-320"><a href="#cb194-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-321"><a href="#cb194-321" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">pr_vampire_b2          =</span> <span class="dv">100</span> <span class="sc">/</span> <span class="dv">100000</span>,</span>
<span id="cb194-322"><a href="#cb194-322" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_positive_vampire_b2 =</span> <span class="dv">95</span> <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb194-323"><a href="#cb194-323" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_positive_mortal_b2  =</span> <span class="dv">999</span> <span class="sc">/</span> <span class="dv">99900</span>)  <span class="sc">|&gt;</span>  </span>
<span id="cb194-324"><a href="#cb194-324" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr_positive_b2 =</span> <span class="dv">95</span> <span class="sc">+</span> <span class="dv">999</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-325"><a href="#cb194-325" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr_vampire_positive_b2 =</span> </span>
<span id="cb194-326"><a href="#cb194-326" aria-hidden="true" tabindex="-1"></a>                  pr_positive_vampire_b2 <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> pr_positive_b2) <span class="sc">|&gt;</span> </span>
<span id="cb194-327"><a href="#cb194-327" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span>
<span id="cb194-328"><a href="#cb194-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-329"><a href="#cb194-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-330"><a href="#cb194-330" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-331"><a href="#cb194-331" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-332"><a href="#cb194-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-333"><a href="#cb194-333" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sampling from a grid-approximate posterior {#sec-chap-03-sampling-grid}</span></span>
<span id="cb194-334"><a href="#cb194-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-335"><a href="#cb194-335" aria-hidden="true" tabindex="-1"></a><span class="fu">### ORIGINAL</span></span>
<span id="cb194-336"><a href="#cb194-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-337"><a href="#cb194-337" aria-hidden="true" tabindex="-1"></a>Before we are going to draw samples from the posterior distribution we</span>
<span id="cb194-338"><a href="#cb194-338" aria-hidden="true" tabindex="-1"></a>need to compute the distribution similar as we had done in the globe</span>
<span id="cb194-339"><a href="#cb194-339" aria-hidden="true" tabindex="-1"></a>tossing example.</span>
<span id="cb194-340"><a href="#cb194-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-341"><a href="#cb194-341" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Here&#39;s a reminder for how to compute the posterior for the globe</span></span>
<span id="cb194-342"><a href="#cb194-342" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; tossing model, using grid approximation. Remember, the posterior here</span></span>
<span id="cb194-343"><a href="#cb194-343" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; means the probability of p conditional on the data.&quot; ([McElreath,</span></span>
<span id="cb194-344"><a href="#cb194-344" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 2020, p. 52](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-345"><a href="#cb194-345" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=71&amp;annotation=KKQLR3FL)</span><span class="at">)</span></span>
<span id="cb194-346"><a href="#cb194-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-347"><a href="#cb194-347" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-348"><a href="#cb194-348" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-349"><a href="#cb194-349" aria-hidden="true" tabindex="-1"></a>::: {#cnj-grid-globe-tossing-a}</span>
<span id="cb194-350"><a href="#cb194-350" aria-hidden="true" tabindex="-1"></a>a: Generate the posterior distribution form the globe-tossing example</span>
<span id="cb194-351"><a href="#cb194-351" aria-hidden="true" tabindex="-1"></a>(Base R)</span>
<span id="cb194-352"><a href="#cb194-352" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-353"><a href="#cb194-353" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-354"><a href="#cb194-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-355"><a href="#cb194-355" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-356"><a href="#cb194-356" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-357"><a href="#cb194-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-358"><a href="#cb194-358" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-359"><a href="#cb194-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: grid-globe-tossing-a</span></span>
<span id="cb194-360"><a href="#cb194-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-361"><a href="#cb194-361" aria-hidden="true" tabindex="-1"></a><span class="do">### R code 3.2a Grid Globe ##########################</span></span>
<span id="cb194-362"><a href="#cb194-362" aria-hidden="true" tabindex="-1"></a><span class="co"># change prob_b to prior</span></span>
<span id="cb194-363"><a href="#cb194-363" aria-hidden="true" tabindex="-1"></a><span class="co"># change prob_data to likelihood</span></span>
<span id="cb194-364"><a href="#cb194-364" aria-hidden="true" tabindex="-1"></a><span class="co"># added variables: n_grid_a, n_success_a, n_trials_a</span></span>
<span id="cb194-365"><a href="#cb194-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-366"><a href="#cb194-366" aria-hidden="true" tabindex="-1"></a>n_grid_a <span class="ot">&lt;-</span> <span class="dv">1000</span>L <span class="co"># number of grid points</span></span>
<span id="cb194-367"><a href="#cb194-367" aria-hidden="true" tabindex="-1"></a>n_success_a <span class="ot">&lt;-</span> <span class="dv">6</span>L <span class="co"># observed water</span></span>
<span id="cb194-368"><a href="#cb194-368" aria-hidden="true" tabindex="-1"></a>n_trials_a <span class="ot">&lt;-</span>  <span class="dv">9</span>L <span class="co"># number of trials</span></span>
<span id="cb194-369"><a href="#cb194-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-370"><a href="#cb194-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-371"><a href="#cb194-371" aria-hidden="true" tabindex="-1"></a>p_grid_a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> n_grid_a)</span>
<span id="cb194-372"><a href="#cb194-372" aria-hidden="true" tabindex="-1"></a>prior_a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, n_grid_a) <span class="co"># = prior, = uniform distribution, 1000 times 1</span></span>
<span id="cb194-373"><a href="#cb194-373" aria-hidden="true" tabindex="-1"></a>likelihood_a <span class="ot">&lt;-</span> </span>
<span id="cb194-374"><a href="#cb194-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbinom</span>(n_success_a, <span class="at">size =</span> n_trials_a, <span class="at">prob =</span> p_grid_a) <span class="co"># = likelihood</span></span>
<span id="cb194-375"><a href="#cb194-375" aria-hidden="true" tabindex="-1"></a>posterior_a <span class="ot">&lt;-</span> likelihood_a <span class="sc">*</span> prior_a</span>
<span id="cb194-376"><a href="#cb194-376" aria-hidden="true" tabindex="-1"></a>posterior_a <span class="ot">&lt;-</span> posterior_a <span class="sc">/</span> <span class="fu">sum</span>(posterior_a)</span>
<span id="cb194-377"><a href="#cb194-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-378"><a href="#cb194-378" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-379"><a href="#cb194-379" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-380"><a href="#cb194-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-381"><a href="#cb194-381" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Now we wish to draw 10,000 samples from this posterior. Imagine the</span></span>
<span id="cb194-382"><a href="#cb194-382" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; posterior is a bucket full of parameter values, numbers such as</span></span>
<span id="cb194-383"><a href="#cb194-383" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $0.1, 0.7, 0.5, 1,$ etc. Within the bucket, each value exists in</span></span>
<span id="cb194-384"><a href="#cb194-384" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; proportion to its posterior probability, such that values near the</span></span>
<span id="cb194-385"><a href="#cb194-385" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; peak are much more common than those in the tails. We&#39;re going to</span></span>
<span id="cb194-386"><a href="#cb194-386" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; scoop out 10,000 values from the bucket. Provided the bucket is well</span></span>
<span id="cb194-387"><a href="#cb194-387" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; mixed, the resulting samples will have the same proportions as the</span></span>
<span id="cb194-388"><a href="#cb194-388" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; exact posterior density. Therefore the individual values of $p$ will</span></span>
<span id="cb194-389"><a href="#cb194-389" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; appear in our samples in proportion to the posterior plausibility of</span></span>
<span id="cb194-390"><a href="#cb194-390" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; each value.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-391"><a href="#cb194-391" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 52](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-392"><a href="#cb194-392" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=71&amp;annotation=GS5GCASA)</span><span class="at">)</span></span>
<span id="cb194-393"><a href="#cb194-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-394"><a href="#cb194-394" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-395"><a href="#cb194-395" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-396"><a href="#cb194-396" aria-hidden="true" tabindex="-1"></a>::: {#cnj-sample-globe-tossing}</span>
<span id="cb194-397"><a href="#cb194-397" aria-hidden="true" tabindex="-1"></a>a: Draw 1000 samples from the posterior distribution (Base R)</span>
<span id="cb194-398"><a href="#cb194-398" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-399"><a href="#cb194-399" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-400"><a href="#cb194-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-401"><a href="#cb194-401" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-402"><a href="#cb194-402" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-403"><a href="#cb194-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-404"><a href="#cb194-404" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-405"><a href="#cb194-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sample-globe-tossing-a</span></span>
<span id="cb194-406"><a href="#cb194-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-407"><a href="#cb194-407" aria-hidden="true" tabindex="-1"></a>n_samples_a <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb194-408"><a href="#cb194-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-409"><a href="#cb194-409" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>) <span class="co"># for reproducibility</span></span>
<span id="cb194-410"><a href="#cb194-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-411"><a href="#cb194-411" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.3a Sample Globe ##########################################</span></span>
<span id="cb194-412"><a href="#cb194-412" aria-hidden="true" tabindex="-1"></a>samples_a <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid_a, </span>
<span id="cb194-413"><a href="#cb194-413" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> posterior_a, <span class="co"># from previous code chunk</span></span>
<span id="cb194-414"><a href="#cb194-414" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> n_samples_a, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-415"><a href="#cb194-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-416"><a href="#cb194-416" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-417"><a href="#cb194-417" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-418"><a href="#cb194-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-419"><a href="#cb194-419" aria-hidden="true" tabindex="-1"></a>The probability of each value is given by <span class="in">`posterior_a`</span>, which we</span>
<span id="cb194-420"><a href="#cb194-420" aria-hidden="true" tabindex="-1"></a>computed with @cnj-grid-globe-tossing-a.</span>
<span id="cb194-421"><a href="#cb194-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-422"><a href="#cb194-422" aria-hidden="true" tabindex="-1"></a>::: my-note</span>
<span id="cb194-423"><a href="#cb194-423" aria-hidden="true" tabindex="-1"></a>::: my-note-header</span>
<span id="cb194-424"><a href="#cb194-424" aria-hidden="true" tabindex="-1"></a>::: {#cor-excursion-a}</span>
<span id="cb194-425"><a href="#cb194-425" aria-hidden="true" tabindex="-1"></a>: Details for a better understanding and comparison with the tidyverse</span>
<span id="cb194-426"><a href="#cb194-426" aria-hidden="true" tabindex="-1"></a>version</span>
<span id="cb194-427"><a href="#cb194-427" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-428"><a href="#cb194-428" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-429"><a href="#cb194-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-430"><a href="#cb194-430" aria-hidden="true" tabindex="-1"></a>::: my-note-container</span>
<span id="cb194-431"><a href="#cb194-431" aria-hidden="true" tabindex="-1"></a>To compare with the tidyverse version, I collected the three vectors</span>
<span id="cb194-432"><a href="#cb194-432" aria-hidden="true" tabindex="-1"></a>with <span class="in">`base::cbind()`</span> into a matrix and displayed the first six lines</span>
<span id="cb194-433"><a href="#cb194-433" aria-hidden="true" tabindex="-1"></a>with <span class="in">`utils::head()`</span>. Additionally I also displayed the first 10 values</span>
<span id="cb194-434"><a href="#cb194-434" aria-hidden="true" tabindex="-1"></a>of <span class="in">`samples_a`</span> vector.</span>
<span id="cb194-435"><a href="#cb194-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-436"><a href="#cb194-436" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-437"><a href="#cb194-437" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-438"><a href="#cb194-438" aria-hidden="true" tabindex="-1"></a>::: {#cnj-excursion-a}</span>
<span id="cb194-439"><a href="#cb194-439" aria-hidden="true" tabindex="-1"></a>a: Excursion for better comparison (Base R)</span>
<span id="cb194-440"><a href="#cb194-440" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-441"><a href="#cb194-441" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-442"><a href="#cb194-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-443"><a href="#cb194-443" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-444"><a href="#cb194-444" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-445"><a href="#cb194-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-446"><a href="#cb194-446" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-447"><a href="#cb194-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: excursion_a</span></span>
<span id="cb194-448"><a href="#cb194-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-449"><a href="#cb194-449" aria-hidden="true" tabindex="-1"></a><span class="co"># display grid results to compare with variant b</span></span>
<span id="cb194-450"><a href="#cb194-450" aria-hidden="true" tabindex="-1"></a>d_a <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_grid_a, prior_a, likelihood_a, posterior_a) </span>
<span id="cb194-451"><a href="#cb194-451" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d_a, <span class="dv">10</span>)</span>
<span id="cb194-452"><a href="#cb194-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-453"><a href="#cb194-453" aria-hidden="true" tabindex="-1"></a><span class="co"># display sample results to compare with variant b</span></span>
<span id="cb194-454"><a href="#cb194-454" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(samples_a, <span class="dv">10</span>)</span>
<span id="cb194-455"><a href="#cb194-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-456"><a href="#cb194-456" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-457"><a href="#cb194-457" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-458"><a href="#cb194-458" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-459"><a href="#cb194-459" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-460"><a href="#cb194-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-461"><a href="#cb194-461" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-462"><a href="#cb194-462" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-463"><a href="#cb194-463" aria-hidden="true" tabindex="-1"></a>::: {#cnj-globe-glossing-scatterplot-a}</span>
<span id="cb194-464"><a href="#cb194-464" aria-hidden="true" tabindex="-1"></a>a: Scatterplot of the drawn samples (Base R)</span>
<span id="cb194-465"><a href="#cb194-465" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-466"><a href="#cb194-466" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-467"><a href="#cb194-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-468"><a href="#cb194-468" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-469"><a href="#cb194-469" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-470"><a href="#cb194-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-471"><a href="#cb194-471" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-472"><a href="#cb194-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-globe-tossing-scatterplot-a</span></span>
<span id="cb194-473"><a href="#cb194-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Scatterplot of the drawn samples (Base R)&quot;</span></span>
<span id="cb194-474"><a href="#cb194-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-475"><a href="#cb194-475" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.4a Globe Scatterplot #############</span></span>
<span id="cb194-476"><a href="#cb194-476" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samples_a)</span>
<span id="cb194-477"><a href="#cb194-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-478"><a href="#cb194-478" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-479"><a href="#cb194-479" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-480"><a href="#cb194-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-481"><a href="#cb194-481" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In fig-globe-glossing-plot-a &quot;it&#39;s as if you are flying over the</span></span>
<span id="cb194-482"><a href="#cb194-482" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; posterior distribution, looking down on it. There are many more</span></span>
<span id="cb194-483"><a href="#cb194-483" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; samples from the dense region near 0.6 and very few samples below</span></span>
<span id="cb194-484"><a href="#cb194-484" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 0.25. On the right, the plot shows the density estimate computed from</span></span>
<span id="cb194-485"><a href="#cb194-485" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; these samples.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-486"><a href="#cb194-486" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 53](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-487"><a href="#cb194-487" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=72&amp;annotation=4WVLNZBT)</span><span class="at">)</span></span>
<span id="cb194-488"><a href="#cb194-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-489"><a href="#cb194-489" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-490"><a href="#cb194-490" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-491"><a href="#cb194-491" aria-hidden="true" tabindex="-1"></a>::: {#cnj-globe-tossing-density-plot-a}</span>
<span id="cb194-492"><a href="#cb194-492" aria-hidden="true" tabindex="-1"></a>a: Density estimate of the drawn samples (Rethinking)</span>
<span id="cb194-493"><a href="#cb194-493" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-494"><a href="#cb194-494" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-495"><a href="#cb194-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-496"><a href="#cb194-496" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-497"><a href="#cb194-497" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-498"><a href="#cb194-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-499"><a href="#cb194-499" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-500"><a href="#cb194-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-globe-tossing-density-plot-a</span></span>
<span id="cb194-501"><a href="#cb194-501" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Density estimate of the drawn samples (Rethinking)&quot;</span></span>
<span id="cb194-502"><a href="#cb194-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-503"><a href="#cb194-503" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.5a Globe Density plot #############</span></span>
<span id="cb194-504"><a href="#cb194-504" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(samples_a)</span>
<span id="cb194-505"><a href="#cb194-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-506"><a href="#cb194-506" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-507"><a href="#cb194-507" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-508"><a href="#cb194-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-509"><a href="#cb194-509" aria-hidden="true" tabindex="-1"></a><span class="fu">### TIDYVERSE</span></span>
<span id="cb194-510"><a href="#cb194-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-511"><a href="#cb194-511" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-512"><a href="#cb194-512" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-513"><a href="#cb194-513" aria-hidden="true" tabindex="-1"></a>::: {#cnj-grid-globe-tossing-b}</span>
<span id="cb194-514"><a href="#cb194-514" aria-hidden="true" tabindex="-1"></a>b: Generate the posterior distribution form the globe-tossing example</span>
<span id="cb194-515"><a href="#cb194-515" aria-hidden="true" tabindex="-1"></a>(Tidyverse)</span>
<span id="cb194-516"><a href="#cb194-516" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-517"><a href="#cb194-517" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-518"><a href="#cb194-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-519"><a href="#cb194-519" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-520"><a href="#cb194-520" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-521"><a href="#cb194-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-522"><a href="#cb194-522" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-523"><a href="#cb194-523" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: grid-globe-tossing-b</span></span>
<span id="cb194-524"><a href="#cb194-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-525"><a href="#cb194-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-526"><a href="#cb194-526" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.2b Grid Globe #####################</span></span>
<span id="cb194-527"><a href="#cb194-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-528"><a href="#cb194-528" aria-hidden="true" tabindex="-1"></a><span class="co"># how many grid points would you like?</span></span>
<span id="cb194-529"><a href="#cb194-529" aria-hidden="true" tabindex="-1"></a>n_grid_b <span class="ot">&lt;-</span> <span class="dv">1000</span>L</span>
<span id="cb194-530"><a href="#cb194-530" aria-hidden="true" tabindex="-1"></a>n_success_b <span class="ot">&lt;-</span> <span class="dv">6</span>L</span>
<span id="cb194-531"><a href="#cb194-531" aria-hidden="true" tabindex="-1"></a>n_trials_b  <span class="ot">&lt;-</span> <span class="dv">9</span>L</span>
<span id="cb194-532"><a href="#cb194-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-533"><a href="#cb194-533" aria-hidden="true" tabindex="-1"></a>d_b <span class="ot">&lt;-</span></span>
<span id="cb194-534"><a href="#cb194-534" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_b =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> n_grid_b),</span>
<span id="cb194-535"><a href="#cb194-535" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_b  =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span>  <span class="co"># flat uniform prior, vector 1L recycling</span></span>
<span id="cb194-536"><a href="#cb194-536" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">likelihood_b =</span> </span>
<span id="cb194-537"><a href="#cb194-537" aria-hidden="true" tabindex="-1"></a>                  stats<span class="sc">::</span><span class="fu">dbinom</span>(n_success_b, <span class="at">size =</span> n_trials_b, <span class="at">prob =</span> p_grid_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-538"><a href="#cb194-538" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">posterior_b =</span> </span>
<span id="cb194-539"><a href="#cb194-539" aria-hidden="true" tabindex="-1"></a>                  (likelihood_b <span class="sc">*</span> prior_b) <span class="sc">/</span> <span class="fu">sum</span>(likelihood_b <span class="sc">*</span> prior_b))</span>
<span id="cb194-540"><a href="#cb194-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-541"><a href="#cb194-541" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d_b)</span>
<span id="cb194-542"><a href="#cb194-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-543"><a href="#cb194-543" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-544"><a href="#cb194-544" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-545"><a href="#cb194-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-546"><a href="#cb194-546" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb194-547"><a href="#cb194-547" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb194-548"><a href="#cb194-548" aria-hidden="true" tabindex="-1"></a>Variable names changed</span>
<span id="cb194-549"><a href="#cb194-549" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-550"><a href="#cb194-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-551"><a href="#cb194-551" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb194-552"><a href="#cb194-552" aria-hidden="true" tabindex="-1"></a>I have changed McElreath&#39;s variable name <span class="in">`prob_p`</span> and <span class="in">`prob_data`</span> as</span>
<span id="cb194-553"><a href="#cb194-553" aria-hidden="true" tabindex="-1"></a><span class="in">`prior_x`</span> and <span class="in">`likelihood_x`</span>, where <span class="in">`x`</span> stands for <span class="in">`a`</span> (Base R) or <span class="in">`b`</span></span>
<span id="cb194-554"><a href="#cb194-554" aria-hidden="true" tabindex="-1"></a>(Tidyverse).</span>
<span id="cb194-555"><a href="#cb194-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-556"><a href="#cb194-556" aria-hidden="true" tabindex="-1"></a>To see the difference between grid and samples I will add &quot;<span class="sc">\_</span>sample&quot; to</span>
<span id="cb194-557"><a href="#cb194-557" aria-hidden="true" tabindex="-1"></a>all the other variable names.</span>
<span id="cb194-558"><a href="#cb194-558" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-559"><a href="#cb194-559" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-560"><a href="#cb194-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-561"><a href="#cb194-561" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-562"><a href="#cb194-562" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-563"><a href="#cb194-563" aria-hidden="true" tabindex="-1"></a>::: {#cnj-sample-globe-tossing-b}</span>
<span id="cb194-564"><a href="#cb194-564" aria-hidden="true" tabindex="-1"></a>b: Draw 1000 samples from the posterior distribution (Tidyverse)</span>
<span id="cb194-565"><a href="#cb194-565" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-566"><a href="#cb194-566" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-567"><a href="#cb194-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-568"><a href="#cb194-568" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-569"><a href="#cb194-569" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-570"><a href="#cb194-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-571"><a href="#cb194-571" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-572"><a href="#cb194-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sample-globe-tossing-b</span></span>
<span id="cb194-573"><a href="#cb194-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-574"><a href="#cb194-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-575"><a href="#cb194-575" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.3b Sample Globe #####################</span></span>
<span id="cb194-576"><a href="#cb194-576" aria-hidden="true" tabindex="-1"></a><span class="co"># how many samples would you like?</span></span>
<span id="cb194-577"><a href="#cb194-577" aria-hidden="true" tabindex="-1"></a>n_samples_b <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb194-578"><a href="#cb194-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-579"><a href="#cb194-579" aria-hidden="true" tabindex="-1"></a><span class="co"># make it reproducible</span></span>
<span id="cb194-580"><a href="#cb194-580" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-581"><a href="#cb194-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-582"><a href="#cb194-582" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="ot">&lt;-</span></span>
<span id="cb194-583"><a href="#cb194-583" aria-hidden="true" tabindex="-1"></a>  d_b <span class="sc">|&gt;</span> </span>
<span id="cb194-584"><a href="#cb194-584" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples_b, <span class="at">weight_by =</span> posterior_b, <span class="at">replace =</span> T)</span>
<span id="cb194-585"><a href="#cb194-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-586"><a href="#cb194-586" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="ot">&lt;-</span> df_samples_b <span class="sc">|&gt;</span></span>
<span id="cb194-587"><a href="#cb194-587" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">samples_b =</span> p_grid_b,</span>
<span id="cb194-588"><a href="#cb194-588" aria-hidden="true" tabindex="-1"></a>           <span class="at">likelihood_samples_b =</span> likelihood_b,</span>
<span id="cb194-589"><a href="#cb194-589" aria-hidden="true" tabindex="-1"></a>           <span class="at">prior_samples_b =</span> prior_b,</span>
<span id="cb194-590"><a href="#cb194-590" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_samples_b =</span> posterior_b)</span>
<span id="cb194-591"><a href="#cb194-591" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_samples_b)</span>
<span id="cb194-592"><a href="#cb194-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-593"><a href="#cb194-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-594"><a href="#cb194-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-595"><a href="#cb194-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-596"><a href="#cb194-596" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-597"><a href="#cb194-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-598"><a href="#cb194-598" aria-hidden="true" tabindex="-1"></a><span class="in">`identical(samples_a, df_samples_b$samples_b)`</span> = <span class="in">`r identical(samples_a, df_samples_b$samples_b)`</span>.</span>
<span id="cb194-599"><a href="#cb194-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-600"><a href="#cb194-600" aria-hidden="true" tabindex="-1"></a>The column <span class="in">`samples_b`</span> is identical with vector <span class="in">`samples_a`</span>, because I</span>
<span id="cb194-601"><a href="#cb194-601" aria-hidden="true" tabindex="-1"></a>have used in both sampling processes <span class="in">`base::set.seed(3)`</span>, so that I (and</span>
<span id="cb194-602"><a href="#cb194-602" aria-hidden="true" tabindex="-1"></a>you) could reproduce the data.</span>
<span id="cb194-603"><a href="#cb194-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-604"><a href="#cb194-604" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-605"><a href="#cb194-605" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-606"><a href="#cb194-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-607"><a href="#cb194-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-608"><a href="#cb194-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-609"><a href="#cb194-609" aria-hidden="true" tabindex="-1"></a>There are different possibilities to display data frames respectively</span>
<span id="cb194-610"><a href="#cb194-610" aria-hidden="true" tabindex="-1"></a>tibbles:</span>
<span id="cb194-611"><a href="#cb194-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-612"><a href="#cb194-612" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>You can use the internal print facility of tibbles. It shows only</span>
<span id="cb194-613"><a href="#cb194-613" aria-hidden="true" tabindex="-1"></a>    the first ten rows and all columns that fit on the screen. You see</span>
<span id="cb194-614"><a href="#cb194-614" aria-hidden="true" tabindex="-1"></a>    an example in @cnj-sample-globe-tossing-b.</span>
<span id="cb194-615"><a href="#cb194-615" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>With the <span class="in">`utils::str()`</span> function you will get a result with shorter</span>
<span id="cb194-616"><a href="#cb194-616" aria-hidden="true" tabindex="-1"></a>    figures that is better adapted to a small screen.</span>
<span id="cb194-617"><a href="#cb194-617" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Another alternative is the tidyverse approach of <span class="in">`dplyr::glimpse()`</span>.</span>
<span id="cb194-618"><a href="#cb194-618" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>With <span class="in">`skimr::skim()`</span> you will get a compact summary of all data.</span>
<span id="cb194-619"><a href="#cb194-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-620"><a href="#cb194-620" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-621"><a href="#cb194-621" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-622"><a href="#cb194-622" aria-hidden="true" tabindex="-1"></a>::: {#cnj-excursion-b}</span>
<span id="cb194-623"><a href="#cb194-623" aria-hidden="true" tabindex="-1"></a>b: Excursion: Printing varieties for better comparison (Tidyverse)</span>
<span id="cb194-624"><a href="#cb194-624" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-625"><a href="#cb194-625" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-626"><a href="#cb194-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-627"><a href="#cb194-627" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-628"><a href="#cb194-628" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-629"><a href="#cb194-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-630"><a href="#cb194-630" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-631"><a href="#cb194-631" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: excursion-b</span></span>
<span id="cb194-632"><a href="#cb194-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-633"><a href="#cb194-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-634"><a href="#cb194-634" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;USING THE str() FUNCTION:&#39;</span>)</span>
<span id="cb194-635"><a href="#cb194-635" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">str</span>(df_samples_b)</span>
<span id="cb194-636"><a href="#cb194-636" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-637"><a href="#cb194-637" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;USING THE dplyr::glimpse() FUNCTION:&#39;</span>)</span>
<span id="cb194-638"><a href="#cb194-638" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(df_samples_b)</span>
<span id="cb194-639"><a href="#cb194-639" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-640"><a href="#cb194-640" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;USING THE skimr::skim() FUNCTION:&#39;</span>)</span>
<span id="cb194-641"><a href="#cb194-641" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(df_samples_b)</span>
<span id="cb194-642"><a href="#cb194-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-643"><a href="#cb194-643" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-644"><a href="#cb194-644" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-645"><a href="#cb194-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-646"><a href="#cb194-646" aria-hidden="true" tabindex="-1"></a>We can plot the left panel of Figure 3.1 from the book with</span>
<span id="cb194-647"><a href="#cb194-647" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2::geom_point()`</span>. But before we do, we&#39;ll need to add a variable</span>
<span id="cb194-648"><a href="#cb194-648" aria-hidden="true" tabindex="-1"></a>numbering the samples. This is necessary as the x-parameter of the plot.</span>
<span id="cb194-649"><a href="#cb194-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-650"><a href="#cb194-650" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-651"><a href="#cb194-651" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-652"><a href="#cb194-652" aria-hidden="true" tabindex="-1"></a>::: {#cnj-globe-tossing-scatterplot-b}</span>
<span id="cb194-653"><a href="#cb194-653" aria-hidden="true" tabindex="-1"></a>b: Scatterplot of the drawn samples (Tidyverse)</span>
<span id="cb194-654"><a href="#cb194-654" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-655"><a href="#cb194-655" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-656"><a href="#cb194-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-657"><a href="#cb194-657" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-658"><a href="#cb194-658" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-659"><a href="#cb194-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-660"><a href="#cb194-660" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-661"><a href="#cb194-661" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-globe-tossing-scatterplot-b</span></span>
<span id="cb194-662"><a href="#cb194-662" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Scatterplot of the drawn samples (Tidyverse)&quot;</span></span>
<span id="cb194-663"><a href="#cb194-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-664"><a href="#cb194-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-665"><a href="#cb194-665" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.4b Globe Scatterplot ########################</span></span>
<span id="cb194-666"><a href="#cb194-666" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-667"><a href="#cb194-667" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sample_number =</span> <span class="dv">1</span><span class="sc">:</span>dplyr<span class="sc">::</span><span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb194-668"><a href="#cb194-668" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-669"><a href="#cb194-669" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> sample_number, <span class="at">y =</span> samples_b)) <span class="sc">+</span></span>
<span id="cb194-670"><a href="#cb194-670" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-671"><a href="#cb194-671" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-672"><a href="#cb194-672" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">&quot;sample number&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-673"><a href="#cb194-673" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-674"><a href="#cb194-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-675"><a href="#cb194-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-676"><a href="#cb194-676" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-677"><a href="#cb194-677" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-678"><a href="#cb194-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-679"><a href="#cb194-679" aria-hidden="true" tabindex="-1"></a>If you hover over this link from @fig-globe-tossing-scatterplot-a you</span>
<span id="cb194-680"><a href="#cb194-680" aria-hidden="true" tabindex="-1"></a>can compare the Base R version with the tidyverse result.</span>
<span id="cb194-681"><a href="#cb194-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-682"><a href="#cb194-682" aria-hidden="true" tabindex="-1"></a>Instead of the <span class="in">`rethinking::dens()`</span> we&#39;ll plot the density in the right</span>
<span id="cb194-683"><a href="#cb194-683" aria-hidden="true" tabindex="-1"></a>panel of the books Figure 3.1 with <span class="in">`ggplot2::geom_density()`</span>.</span>
<span id="cb194-684"><a href="#cb194-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-685"><a href="#cb194-685" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-686"><a href="#cb194-686" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-687"><a href="#cb194-687" aria-hidden="true" tabindex="-1"></a>::: {#cnj-globe-tossing-densitiy-plot-b1}</span>
<span id="cb194-688"><a href="#cb194-688" aria-hidden="true" tabindex="-1"></a>b: Density estimate of the drawn samples with 1e4 grid points</span>
<span id="cb194-689"><a href="#cb194-689" aria-hidden="true" tabindex="-1"></a>(Tidyverse)</span>
<span id="cb194-690"><a href="#cb194-690" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-691"><a href="#cb194-691" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-692"><a href="#cb194-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-693"><a href="#cb194-693" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-694"><a href="#cb194-694" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-695"><a href="#cb194-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-696"><a href="#cb194-696" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-697"><a href="#cb194-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-globe-tossing-density-plot-b1</span></span>
<span id="cb194-698"><a href="#cb194-698" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Density estimate of the drawn samples with 1e4 grid points (Tidyverse)&quot;</span></span>
<span id="cb194-699"><a href="#cb194-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-700"><a href="#cb194-700" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.5b(1) Globe Density ###########################</span></span>
<span id="cb194-701"><a href="#cb194-701" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-702"><a href="#cb194-702" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b)) <span class="sc">+</span></span>
<span id="cb194-703"><a href="#cb194-703" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-704"><a href="#cb194-704" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-705"><a href="#cb194-705" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-706"><a href="#cb194-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-707"><a href="#cb194-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-708"><a href="#cb194-708" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-709"><a href="#cb194-709" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-710"><a href="#cb194-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-711"><a href="#cb194-711" aria-hidden="true" tabindex="-1"></a>Compare this somewhat smoother tidyverse plot with</span>
<span id="cb194-712"><a href="#cb194-712" aria-hidden="true" tabindex="-1"></a>@fig-globe-tossing-density-plot-a.</span>
<span id="cb194-713"><a href="#cb194-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-714"><a href="#cb194-714" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;You can see that the estimated density is very similar to ideal</span></span>
<span id="cb194-715"><a href="#cb194-715" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; posterior you computed via grid approximation. If you draw even more</span></span>
<span id="cb194-716"><a href="#cb194-716" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; samples, maybe 1e5 or 1e6, the density estimate will get more and more</span></span>
<span id="cb194-717"><a href="#cb194-717" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; similar to the ideal.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-718"><a href="#cb194-718" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 53](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-719"><a href="#cb194-719" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=72&amp;annotation=EXBQWX2M)</span><span class="at">)</span></span>
<span id="cb194-720"><a href="#cb194-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-721"><a href="#cb194-721" aria-hidden="true" tabindex="-1"></a>Here&#39;s what it looks like with <span class="in">`1e6`</span>.</span>
<span id="cb194-722"><a href="#cb194-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-723"><a href="#cb194-723" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-724"><a href="#cb194-724" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-725"><a href="#cb194-725" aria-hidden="true" tabindex="-1"></a>::: {#cnj-ID-text}</span>
<span id="cb194-726"><a href="#cb194-726" aria-hidden="true" tabindex="-1"></a>b: Density estimate of the drawn samples with 1e6 grid points</span>
<span id="cb194-727"><a href="#cb194-727" aria-hidden="true" tabindex="-1"></a>(Tidyverse)</span>
<span id="cb194-728"><a href="#cb194-728" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-729"><a href="#cb194-729" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-730"><a href="#cb194-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-731"><a href="#cb194-731" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-732"><a href="#cb194-732" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-733"><a href="#cb194-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-734"><a href="#cb194-734" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-735"><a href="#cb194-735" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-globe-tossing-density-plot-b2</span></span>
<span id="cb194-736"><a href="#cb194-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Density estimate of the drawn samples with 1e6 grid points (Tidyverse)&quot;</span></span>
<span id="cb194-737"><a href="#cb194-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-738"><a href="#cb194-738" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-739"><a href="#cb194-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-740"><a href="#cb194-740" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.5b(2) Globe Density ###########################</span></span>
<span id="cb194-741"><a href="#cb194-741" aria-hidden="true" tabindex="-1"></a>d_b <span class="sc">|&gt;</span> </span>
<span id="cb194-742"><a href="#cb194-742" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e6</span>, <span class="at">weight_by =</span> posterior_b, <span class="at">replace =</span> T) <span class="sc">|&gt;</span></span>
<span id="cb194-743"><a href="#cb194-743" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-744"><a href="#cb194-744" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_b)) <span class="sc">+</span></span>
<span id="cb194-745"><a href="#cb194-745" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-746"><a href="#cb194-746" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-747"><a href="#cb194-747" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-748"><a href="#cb194-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-749"><a href="#cb194-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-750"><a href="#cb194-750" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-751"><a href="#cb194-751" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-752"><a href="#cb194-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-753"><a href="#cb194-753" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sampling to Summarize {#sec-sampling-to-summarize}</span></span>
<span id="cb194-754"><a href="#cb194-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-755"><a href="#cb194-755" aria-hidden="true" tabindex="-1"></a>All we have done so far is crudely replicate the posterior density we</span>
<span id="cb194-756"><a href="#cb194-756" aria-hidden="true" tabindex="-1"></a>had already computed in the previous chapter. Now it is time to use</span>
<span id="cb194-757"><a href="#cb194-757" aria-hidden="true" tabindex="-1"></a>these samples to describe and understand the posterior.</span>
<span id="cb194-758"><a href="#cb194-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-759"><a href="#cb194-759" aria-hidden="true" tabindex="-1"></a>The description to understand the posterior can be divided into three</span>
<span id="cb194-760"><a href="#cb194-760" aria-hidden="true" tabindex="-1"></a>inquiries:</span>
<span id="cb194-761"><a href="#cb194-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-762"><a href="#cb194-762" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Questions about intervals of *defined boundaries*. See @sec-chap-03-defined-boundaries.</span>
<span id="cb194-763"><a href="#cb194-763" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Questions about intervals of *defined probability mass*. See @sec-chap-03-probability-mass.</span>
<span id="cb194-764"><a href="#cb194-764" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Questions about *point estimates*. See: @sec-chap-03-point-estimates.</span>
<span id="cb194-765"><a href="#cb194-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-766"><a href="#cb194-766" aria-hidden="true" tabindex="-1"></a><span class="fu">### Intervals of Defined Boundaries {#sec-chap-03-defined-boundaries}</span></span>
<span id="cb194-767"><a href="#cb194-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-768"><a href="#cb194-768" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ORIGINAL</span></span>
<span id="cb194-769"><a href="#cb194-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-770"><a href="#cb194-770" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Grid-approximate Posterior</span></span>
<span id="cb194-771"><a href="#cb194-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-772"><a href="#cb194-772" aria-hidden="true" tabindex="-1"></a>For instance: What is the probability that the proportion of water is</span>
<span id="cb194-773"><a href="#cb194-773" aria-hidden="true" tabindex="-1"></a>less than 0.5?</span>
<span id="cb194-774"><a href="#cb194-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-775"><a href="#cb194-775" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Using the grid-approximate posterior, you can just add up all of the</span></span>
<span id="cb194-776"><a href="#cb194-776" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probabilities, where the corresponding parameter value is less than</span></span>
<span id="cb194-777"><a href="#cb194-777" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 0.5:&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-778"><a href="#cb194-778" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 53](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-779"><a href="#cb194-779" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=72&amp;annotation=Z7XSZ6WT)</span><span class="at">)</span></span>
<span id="cb194-780"><a href="#cb194-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-781"><a href="#cb194-781" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-782"><a href="#cb194-782" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-783"><a href="#cb194-783" aria-hidden="true" tabindex="-1"></a>::: {#cnj-grid-posterior-a}</span>
<span id="cb194-784"><a href="#cb194-784" aria-hidden="true" tabindex="-1"></a>a: Define boundaries using the grid-approximate posterior (Base R)</span>
<span id="cb194-785"><a href="#cb194-785" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-786"><a href="#cb194-786" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-787"><a href="#cb194-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-788"><a href="#cb194-788" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-789"><a href="#cb194-789" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-790"><a href="#cb194-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-791"><a href="#cb194-791" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-792"><a href="#cb194-792" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: grid-posterior-a</span></span>
<span id="cb194-793"><a href="#cb194-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-794"><a href="#cb194-794" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.6a Grid Posterior Boundary ##############################</span></span>
<span id="cb194-795"><a href="#cb194-795" aria-hidden="true" tabindex="-1"></a><span class="co"># add up posterior probability where p &lt; 0.5</span></span>
<span id="cb194-796"><a href="#cb194-796" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(posterior_a[p_grid_a <span class="sc">&lt;</span> <span class="fl">0.5</span>])</span>
<span id="cb194-797"><a href="#cb194-797" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-798"><a href="#cb194-798" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-799"><a href="#cb194-799" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-800"><a href="#cb194-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-801"><a href="#cb194-801" aria-hidden="true" tabindex="-1"></a>About 17% of the posterior probability is below 0.5.</span>
<span id="cb194-802"><a href="#cb194-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-803"><a href="#cb194-803" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Samples from the Posterior</span></span>
<span id="cb194-804"><a href="#cb194-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-805"><a href="#cb194-805" aria-hidden="true" tabindex="-1"></a>But this easy calculation based on grid approximation is often not</span>
<span id="cb194-806"><a href="#cb194-806" aria-hidden="true" tabindex="-1"></a>practical when there are more parameters. In this case you can draw</span>
<span id="cb194-807"><a href="#cb194-807" aria-hidden="true" tabindex="-1"></a>samples from the posterior. But this approach requires a different</span>
<span id="cb194-808"><a href="#cb194-808" aria-hidden="true" tabindex="-1"></a>calculation:</span>
<span id="cb194-809"><a href="#cb194-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-810"><a href="#cb194-810" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;This approach does generalize to complex models with many parameters,</span></span>
<span id="cb194-811"><a href="#cb194-811" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; and so you can use it everywhere. All you have to do is similarly add</span></span>
<span id="cb194-812"><a href="#cb194-812" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; up all of the samples below 0.5, but also // divide the resulting</span></span>
<span id="cb194-813"><a href="#cb194-813" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; count by the total number of samples. In other words, find the</span></span>
<span id="cb194-814"><a href="#cb194-814" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; frequency of parameter values below 0.5&quot; (McElreath, 2020, p. 53/54)&quot;</span></span>
<span id="cb194-815"><a href="#cb194-815" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ([McElreath, 2020, p.</span></span>
<span id="cb194-816"><a href="#cb194-816" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 53](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-817"><a href="#cb194-817" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=72&amp;annotation=SMQ6B78K)</span><span class="at">)</span></span>
<span id="cb194-818"><a href="#cb194-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-819"><a href="#cb194-819" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-820"><a href="#cb194-820" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-821"><a href="#cb194-821" aria-hidden="true" tabindex="-1"></a>::: {#cnj-sample-boundary-a}</span>
<span id="cb194-822"><a href="#cb194-822" aria-hidden="true" tabindex="-1"></a>a: Compute posterior probability below 0.5 using the sampling approach</span>
<span id="cb194-823"><a href="#cb194-823" aria-hidden="true" tabindex="-1"></a>(Base R)</span>
<span id="cb194-824"><a href="#cb194-824" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-825"><a href="#cb194-825" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-826"><a href="#cb194-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-827"><a href="#cb194-827" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-828"><a href="#cb194-828" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-829"><a href="#cb194-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-830"><a href="#cb194-830" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-831"><a href="#cb194-831" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sample-boundary-a</span></span>
<span id="cb194-832"><a href="#cb194-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-833"><a href="#cb194-833" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.7a Sample Boundary #############################</span></span>
<span id="cb194-834"><a href="#cb194-834" aria-hidden="true" tabindex="-1"></a>(p_boundary_a <span class="ot">&lt;-</span> <span class="fu">sum</span>(samples_a <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fl">1e4</span>)</span>
<span id="cb194-835"><a href="#cb194-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-836"><a href="#cb194-836" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-837"><a href="#cb194-837" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-838"><a href="#cb194-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-839"><a href="#cb194-839" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb194-840"><a href="#cb194-840" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb194-841"><a href="#cb194-841" aria-hidden="true" tabindex="-1"></a>Different values with samples from the posterior</span>
<span id="cb194-842"><a href="#cb194-842" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-843"><a href="#cb194-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-844"><a href="#cb194-844" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb194-845"><a href="#cb194-845" aria-hidden="true" tabindex="-1"></a>In comparison with the value of the posterior probability below 0.5 in</span>
<span id="cb194-846"><a href="#cb194-846" aria-hidden="true" tabindex="-1"></a>the book of 0.1726 the result in <span class="in">`r p_boundary_a`</span> from</span>
<span id="cb194-847"><a href="#cb194-847" aria-hidden="true" tabindex="-1"></a>@cnj-sample-boundary-a is quite different.</span>
<span id="cb194-848"><a href="#cb194-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-849"><a href="#cb194-849" aria-hidden="true" tabindex="-1"></a>The reason for the difference is that you can&#39;t get the same values in a</span>
<span id="cb194-850"><a href="#cb194-850" aria-hidden="true" tabindex="-1"></a>sampling processes. This is the nature of randomness. And McElreath did</span>
<span id="cb194-851"><a href="#cb194-851" aria-hidden="true" tabindex="-1"></a>not include the <span class="in">`base::set.seed()`</span> function for (exact) reproducibility.</span>
<span id="cb194-852"><a href="#cb194-852" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-853"><a href="#cb194-853" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-854"><a href="#cb194-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-855"><a href="#cb194-855" aria-hidden="true" tabindex="-1"></a>Using the same approach, you can ask how much posterior probability lies</span>
<span id="cb194-856"><a href="#cb194-856" aria-hidden="true" tabindex="-1"></a>between 0.5 and 0.75:</span>
<span id="cb194-857"><a href="#cb194-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-858"><a href="#cb194-858" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-859"><a href="#cb194-859" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-860"><a href="#cb194-860" aria-hidden="true" tabindex="-1"></a>::: {#cnj-sample-interval-a}</span>
<span id="cb194-861"><a href="#cb194-861" aria-hidden="true" tabindex="-1"></a>a: Compute posterior probability between 0.5 and 0.75 using the sampling</span>
<span id="cb194-862"><a href="#cb194-862" aria-hidden="true" tabindex="-1"></a>approach (Base R)</span>
<span id="cb194-863"><a href="#cb194-863" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-864"><a href="#cb194-864" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-865"><a href="#cb194-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-866"><a href="#cb194-866" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-867"><a href="#cb194-867" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-868"><a href="#cb194-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-869"><a href="#cb194-869" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-870"><a href="#cb194-870" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sample-interval-a</span></span>
<span id="cb194-871"><a href="#cb194-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-872"><a href="#cb194-872" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.8a Sample Interval #############################</span></span>
<span id="cb194-873"><a href="#cb194-873" aria-hidden="true" tabindex="-1"></a>(p_boundary_a8 <span class="ot">&lt;-</span> <span class="fu">sum</span>(samples_a <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> samples_a <span class="sc">&lt;</span> <span class="fl">0.75</span>) <span class="sc">/</span> <span class="fl">1e4</span>)</span>
<span id="cb194-874"><a href="#cb194-874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-875"><a href="#cb194-875" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-876"><a href="#cb194-876" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-877"><a href="#cb194-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-878"><a href="#cb194-878" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TIDYVERSE</span></span>
<span id="cb194-879"><a href="#cb194-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-880"><a href="#cb194-880" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Grid-approximate Posterior</span></span>
<span id="cb194-881"><a href="#cb194-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-882"><a href="#cb194-882" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; To get the proportion of water less than some value of </span><span class="in">`p_grid_b`</span></span>
<span id="cb194-883"><a href="#cb194-883" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; within the {**tidyverse}**, you might first </span><span class="in">`filter()`</span><span class="at"> by that value</span></span>
<span id="cb194-884"><a href="#cb194-884" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; and then take the </span><span class="in">`sum()`</span><span class="at"> within </span><span class="in">`summarise()`</span><span class="at">.</span></span>
<span id="cb194-885"><a href="#cb194-885" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">Kurz</span><span class="co">](https://bookdown.org/content/4857/sampling-the-imaginary.html#intervals-of-defined-boundaries.)</span><span class="at">)</span></span>
<span id="cb194-886"><a href="#cb194-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-887"><a href="#cb194-887" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-888"><a href="#cb194-888" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-889"><a href="#cb194-889" aria-hidden="true" tabindex="-1"></a>::: {#cnj-grid-boundary-b}</span>
<span id="cb194-890"><a href="#cb194-890" aria-hidden="true" tabindex="-1"></a>b: Compute posterior probability below 0.5 using the grid approach</span>
<span id="cb194-891"><a href="#cb194-891" aria-hidden="true" tabindex="-1"></a>(Tidyverse)</span>
<span id="cb194-892"><a href="#cb194-892" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-893"><a href="#cb194-893" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-894"><a href="#cb194-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-895"><a href="#cb194-895" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-896"><a href="#cb194-896" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-897"><a href="#cb194-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-898"><a href="#cb194-898" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-899"><a href="#cb194-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: grid-boundary-b</span></span>
<span id="cb194-900"><a href="#cb194-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-901"><a href="#cb194-901" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.6b Grid Boundary ######################</span></span>
<span id="cb194-902"><a href="#cb194-902" aria-hidden="true" tabindex="-1"></a><span class="co"># add up posterior probability where p &lt; 0.5</span></span>
<span id="cb194-903"><a href="#cb194-903" aria-hidden="true" tabindex="-1"></a>d_b <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(p_grid_b <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-904"><a href="#cb194-904" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> base<span class="sc">::</span><span class="fu">sum</span>(posterior_b))</span>
<span id="cb194-905"><a href="#cb194-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-906"><a href="#cb194-906" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-907"><a href="#cb194-907" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-908"><a href="#cb194-908" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-909"><a href="#cb194-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-910"><a href="#cb194-910" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Samples from the Posterior</span></span>
<span id="cb194-911"><a href="#cb194-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-912"><a href="#cb194-912" aria-hidden="true" tabindex="-1"></a>Kurz offers several methods to calculate the posterior probability below</span>
<span id="cb194-913"><a href="#cb194-913" aria-hidden="true" tabindex="-1"></a>0.5:</span>
<span id="cb194-914"><a href="#cb194-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-915"><a href="#cb194-915" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Method**: <span class="in">`filter()`</span> &amp; <span class="in">`n()`</span> within <span class="in">`summarize()`</span></span>
<span id="cb194-916"><a href="#cb194-916" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Method**: <span class="in">`count()`</span> followed by <span class="in">`mutate()`</span></span>
<span id="cb194-917"><a href="#cb194-917" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Method**: Logical condition within <span class="in">`mean()`</span></span>
<span id="cb194-918"><a href="#cb194-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-919"><a href="#cb194-919" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-920"><a href="#cb194-920" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-921"><a href="#cb194-921" aria-hidden="true" tabindex="-1"></a>::: {#cnj-sample-boundary}</span>
<span id="cb194-922"><a href="#cb194-922" aria-hidden="true" tabindex="-1"></a>b: Compute posterior probability below 0.5 using the sampling approach</span>
<span id="cb194-923"><a href="#cb194-923" aria-hidden="true" tabindex="-1"></a>with different methods (Tidyverse)</span>
<span id="cb194-924"><a href="#cb194-924" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-925"><a href="#cb194-925" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-926"><a href="#cb194-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-927"><a href="#cb194-927" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-928"><a href="#cb194-928" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-929"><a href="#cb194-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-930"><a href="#cb194-930" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-931"><a href="#cb194-931" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sample-boundary-b</span></span>
<span id="cb194-932"><a href="#cb194-932" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-933"><a href="#cb194-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-934"><a href="#cb194-934" aria-hidden="true" tabindex="-1"></a><span class="co"># add up all posterior probabilities of samples under .5</span></span>
<span id="cb194-935"><a href="#cb194-935" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.7b Sample Boundary #########################</span></span>
<span id="cb194-936"><a href="#cb194-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-937"><a href="#cb194-937" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (1) #######</span></span>
<span id="cb194-938"><a href="#cb194-938" aria-hidden="true" tabindex="-1"></a>method_1 <span class="ot">&lt;-</span> </span>
<span id="cb194-939"><a href="#cb194-939" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-940"><a href="#cb194-940" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&lt;</span> .<span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-941"><a href="#cb194-941" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> n_samples_b)</span>
<span id="cb194-942"><a href="#cb194-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-943"><a href="#cb194-943" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 1:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-944"><a href="#cb194-944" aria-hidden="true" tabindex="-1"></a>method_1</span>
<span id="cb194-945"><a href="#cb194-945" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;##################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-946"><a href="#cb194-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-947"><a href="#cb194-947" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (2) #######</span></span>
<span id="cb194-948"><a href="#cb194-948" aria-hidden="true" tabindex="-1"></a>method_2 <span class="ot">&lt;-</span> </span>
<span id="cb194-949"><a href="#cb194-949" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-950"><a href="#cb194-950" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(samples_b <span class="sc">&lt;</span> .<span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-951"><a href="#cb194-951" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">probability =</span> n_samples_b <span class="sc">/</span> base<span class="sc">::</span><span class="fu">sum</span>(n_samples_b))</span>
<span id="cb194-952"><a href="#cb194-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-953"><a href="#cb194-953" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 2:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-954"><a href="#cb194-954" aria-hidden="true" tabindex="-1"></a>method_2</span>
<span id="cb194-955"><a href="#cb194-955" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;##################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-956"><a href="#cb194-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-957"><a href="#cb194-957" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (3) #######</span></span>
<span id="cb194-958"><a href="#cb194-958" aria-hidden="true" tabindex="-1"></a>method_3 <span class="ot">&lt;-</span> </span>
<span id="cb194-959"><a href="#cb194-959" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-960"><a href="#cb194-960" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> <span class="fu">mean</span>(samples_b <span class="sc">&lt;</span> .<span class="dv">5</span>))</span>
<span id="cb194-961"><a href="#cb194-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-962"><a href="#cb194-962" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 3:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-963"><a href="#cb194-963" aria-hidden="true" tabindex="-1"></a>method_3</span>
<span id="cb194-964"><a href="#cb194-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-965"><a href="#cb194-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-966"><a href="#cb194-966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-967"><a href="#cb194-967" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-968"><a href="#cb194-968" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-969"><a href="#cb194-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-970"><a href="#cb194-970" aria-hidden="true" tabindex="-1"></a>To determine the posterior probability between 0.5 and 0.75, you can use</span>
<span id="cb194-971"><a href="#cb194-971" aria-hidden="true" tabindex="-1"></a><span class="in">`&amp;`</span> within <span class="in">`filter()`</span>. Just multiply that result by 100 to get the value</span>
<span id="cb194-972"><a href="#cb194-972" aria-hidden="true" tabindex="-1"></a>in percent.</span>
<span id="cb194-973"><a href="#cb194-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-974"><a href="#cb194-974" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-975"><a href="#cb194-975" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-976"><a href="#cb194-976" aria-hidden="true" tabindex="-1"></a>::: {#cnj-sample-interval-b}</span>
<span id="cb194-977"><a href="#cb194-977" aria-hidden="true" tabindex="-1"></a>b: Compute posterior probability between 0.5 and 0.75 using the sampling</span>
<span id="cb194-978"><a href="#cb194-978" aria-hidden="true" tabindex="-1"></a>approach (Tidyverse)</span>
<span id="cb194-979"><a href="#cb194-979" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-980"><a href="#cb194-980" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-981"><a href="#cb194-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-982"><a href="#cb194-982" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-983"><a href="#cb194-983" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-984"><a href="#cb194-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-985"><a href="#cb194-985" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-986"><a href="#cb194-986" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sample-interval-b</span></span>
<span id="cb194-987"><a href="#cb194-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-988"><a href="#cb194-988" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.8b Sample Interval ##############</span></span>
<span id="cb194-989"><a href="#cb194-989" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-990"><a href="#cb194-990" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&gt;</span> .<span class="dv">5</span> <span class="sc">&amp;</span> samples_b <span class="sc">&lt;</span> .<span class="dv">75</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-991"><a href="#cb194-991" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> n_samples_b)</span>
<span id="cb194-992"><a href="#cb194-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-993"><a href="#cb194-993" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-994"><a href="#cb194-994" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-995"><a href="#cb194-995" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-996"><a href="#cb194-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-997"><a href="#cb194-997" aria-hidden="true" tabindex="-1"></a>And, of course, you can do this calculation with the other methods as</span>
<span id="cb194-998"><a href="#cb194-998" aria-hidden="true" tabindex="-1"></a>well.</span>
<span id="cb194-999"><a href="#cb194-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1000"><a href="#cb194-1000" aria-hidden="true" tabindex="-1"></a>To produce the top part of Figure 3.2 of the book we apply following</span>
<span id="cb194-1001"><a href="#cb194-1001" aria-hidden="true" tabindex="-1"></a>code lines:</span>
<span id="cb194-1002"><a href="#cb194-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1003"><a href="#cb194-1003" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1004"><a href="#cb194-1004" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1005"><a href="#cb194-1005" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-upper-part-3-2}</span>
<span id="cb194-1006"><a href="#cb194-1006" aria-hidden="true" tabindex="-1"></a>b: Posterior distribution produced with {**tidyverse**} approach</span>
<span id="cb194-1007"><a href="#cb194-1007" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1008"><a href="#cb194-1008" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1009"><a href="#cb194-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1010"><a href="#cb194-1010" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1011"><a href="#cb194-1011" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1012"><a href="#cb194-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1013"><a href="#cb194-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1014"><a href="#cb194-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-upper-part-3.2-b</span></span>
<span id="cb194-1015"><a href="#cb194-1015" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Upper part of SR2 Figure 3.2: Intervals of defined boundaries produced with {**tidyverse**} tools: Left: The blue area is the posterior probability below a parameter value of 0.5. Right: The posterior probability between 0.5 and 0.75.&quot;</span></span>
<span id="cb194-1016"><a href="#cb194-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1017"><a href="#cb194-1017" aria-hidden="true" tabindex="-1"></a><span class="do">## R Code Fig 3.2 Upper Part #############</span></span>
<span id="cb194-1018"><a href="#cb194-1018" aria-hidden="true" tabindex="-1"></a><span class="co"># upper left panel</span></span>
<span id="cb194-1019"><a href="#cb194-1019" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb194-1020"><a href="#cb194-1020" aria-hidden="true" tabindex="-1"></a>  df_samples_b  <span class="sc">|&gt;</span>  </span>
<span id="cb194-1021"><a href="#cb194-1021" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b, <span class="at">y =</span> posterior_samples_b)) <span class="sc">+</span></span>
<span id="cb194-1022"><a href="#cb194-1022" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-1023"><a href="#cb194-1023" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_samples_b  <span class="sc">|&gt;</span>  </span>
<span id="cb194-1024"><a href="#cb194-1024" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&lt;</span> .<span class="dv">5</span>), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1025"><a href="#cb194-1025" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)  <span class="sc">+</span></span>
<span id="cb194-1026"><a href="#cb194-1026" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-1027"><a href="#cb194-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1028"><a href="#cb194-1028" aria-hidden="true" tabindex="-1"></a><span class="co"># upper right panel</span></span>
<span id="cb194-1029"><a href="#cb194-1029" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb194-1030"><a href="#cb194-1030" aria-hidden="true" tabindex="-1"></a>  df_samples_b  <span class="sc">|&gt;</span>  </span>
<span id="cb194-1031"><a href="#cb194-1031" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b, <span class="at">y =</span> posterior_samples_b)) <span class="sc">+</span></span>
<span id="cb194-1032"><a href="#cb194-1032" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-1033"><a href="#cb194-1033" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_samples_b  <span class="sc">|&gt;</span>  </span>
<span id="cb194-1034"><a href="#cb194-1034" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&gt;</span> .<span class="dv">5</span> <span class="sc">&amp;</span> samples_b <span class="sc">&lt;</span> .<span class="dv">75</span>), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1035"><a href="#cb194-1035" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1036"><a href="#cb194-1036" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-1037"><a href="#cb194-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1038"><a href="#cb194-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb194-1039"><a href="#cb194-1039" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb194-1040"><a href="#cb194-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1041"><a href="#cb194-1041" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1042"><a href="#cb194-1042" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1043"><a href="#cb194-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1044"><a href="#cb194-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">### Intervals of Defined Probability Mass {#sec-chap-03-probability-mass}</span></span>
<span id="cb194-1045"><a href="#cb194-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1046"><a href="#cb194-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ORIGINAL</span></span>
<span id="cb194-1047"><a href="#cb194-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1048"><a href="#cb194-1048" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Quantiles</span></span>
<span id="cb194-1049"><a href="#cb194-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1050"><a href="#cb194-1050" aria-hidden="true" tabindex="-1"></a>::: my-definition</span>
<span id="cb194-1051"><a href="#cb194-1051" aria-hidden="true" tabindex="-1"></a>::: my-definition-header</span>
<span id="cb194-1052"><a href="#cb194-1052" aria-hidden="true" tabindex="-1"></a>::: {#def-probability-mass-intervals}</span>
<span id="cb194-1053"><a href="#cb194-1053" aria-hidden="true" tabindex="-1"></a>: Several Terms for Intervals of Defined Probability Mass</span>
<span id="cb194-1054"><a href="#cb194-1054" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1055"><a href="#cb194-1055" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1056"><a href="#cb194-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1057"><a href="#cb194-1057" aria-hidden="true" tabindex="-1"></a>::: my-definition-container</span>
<span id="cb194-1058"><a href="#cb194-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`r glossary(&quot;Confidence Interval&quot;)`</span>: Term chiefly used in</span>
<span id="cb194-1059"><a href="#cb194-1059" aria-hidden="true" tabindex="-1"></a>    frequentist statistics.</span>
<span id="cb194-1060"><a href="#cb194-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`r glossary(&quot;Credible Interval&quot;)`</span>: Term predominantly used in Bayesian</span>
<span id="cb194-1061"><a href="#cb194-1061" aria-hidden="true" tabindex="-1"></a>    statistics.</span>
<span id="cb194-1062"><a href="#cb194-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`r glossary(&quot;Compatibility Interval&quot;)`</span>: Term preferably used by</span>
<span id="cb194-1063"><a href="#cb194-1063" aria-hidden="true" tabindex="-1"></a>    Richard McElreath.</span>
<span id="cb194-1064"><a href="#cb194-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1065"><a href="#cb194-1065" aria-hidden="true" tabindex="-1"></a>The abbreviation for all three versions of probability mass intervals is</span>
<span id="cb194-1066"><a href="#cb194-1066" aria-hidden="true" tabindex="-1"></a>&quot;CI&quot;.</span>
<span id="cb194-1067"><a href="#cb194-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1068"><a href="#cb194-1068" aria-hidden="true" tabindex="-1"></a>McElreath tries to avoid the semantic of &quot;confidence&quot; or &quot;credibility&quot;</span>
<span id="cb194-1069"><a href="#cb194-1069" aria-hidden="true" tabindex="-1"></a>because</span>
<span id="cb194-1070"><a href="#cb194-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1071"><a href="#cb194-1071" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;What the interval indicates is a range of parameter values compatible</span></span>
<span id="cb194-1072"><a href="#cb194-1072" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; with the model and data. The model and data themselves may not inspire</span></span>
<span id="cb194-1073"><a href="#cb194-1073" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; confidence, in which case the interval will not either.&quot; ([McElreath,</span></span>
<span id="cb194-1074"><a href="#cb194-1074" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 2020, p. 54](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-1075"><a href="#cb194-1075" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=73&amp;annotation=BHMW5CJ4)</span><span class="at">)</span></span>
<span id="cb194-1076"><a href="#cb194-1076" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1077"><a href="#cb194-1077" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1078"><a href="#cb194-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1079"><a href="#cb194-1079" aria-hidden="true" tabindex="-1"></a>The values of these intervals can be found easier by using samples</span>
<span id="cb194-1080"><a href="#cb194-1080" aria-hidden="true" tabindex="-1"></a>from the posterior than by using a grid approximation.</span>
<span id="cb194-1081"><a href="#cb194-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1082"><a href="#cb194-1082" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Suppose for example you want to know the boundaries of the lower</span></span>
<span id="cb194-1083"><a href="#cb194-1083" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $80\%$ posterior probability. You know this interval starts at</span></span>
<span id="cb194-1084"><a href="#cb194-1084" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $p = 0$. To find out where it stops, think of the samples as data and</span></span>
<span id="cb194-1085"><a href="#cb194-1085" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ask where the $80th$ percentile lies:&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-1086"><a href="#cb194-1086" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 54](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-1087"><a href="#cb194-1087" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=73&amp;annotation=3SA8YJWX)</span><span class="at">)</span></span>
<span id="cb194-1088"><a href="#cb194-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1089"><a href="#cb194-1089" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1090"><a href="#cb194-1090" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1091"><a href="#cb194-1091" aria-hidden="true" tabindex="-1"></a>::: {#cnj-quantiles-a}</span>
<span id="cb194-1092"><a href="#cb194-1092" aria-hidden="true" tabindex="-1"></a>a: Compute posterior probability intervals lower $80\%$ and from 10th to</span>
<span id="cb194-1093"><a href="#cb194-1093" aria-hidden="true" tabindex="-1"></a>90th percentile</span>
<span id="cb194-1094"><a href="#cb194-1094" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1095"><a href="#cb194-1095" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1096"><a href="#cb194-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1097"><a href="#cb194-1097" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1098"><a href="#cb194-1098" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1099"><a href="#cb194-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1100"><a href="#cb194-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1101"><a href="#cb194-1101" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: quantiles-a</span></span>
<span id="cb194-1102"><a href="#cb194-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1103"><a href="#cb194-1103" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.9a Quantile 0.8 #######################</span></span>
<span id="cb194-1104"><a href="#cb194-1104" aria-hidden="true" tabindex="-1"></a>q8 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples_a, <span class="fl">0.8</span>)</span>
<span id="cb194-1105"><a href="#cb194-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1106"><a href="#cb194-1106" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.10a PI = Quantile 0.1-0.9 ###################</span></span>
<span id="cb194-1107"><a href="#cb194-1107" aria-hidden="true" tabindex="-1"></a>q1_9 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples_a, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span>
<span id="cb194-1108"><a href="#cb194-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1109"><a href="#cb194-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1110"><a href="#cb194-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1111"><a href="#cb194-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lower $80\%$ = <span class="in">`r q8`</span></span>
<span id="cb194-1112"><a href="#cb194-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Between $10\%$ = <span class="in">`r q1_9[1]`</span> and $90\%$ = <span class="in">`r q1_9[2]`</span></span>
<span id="cb194-1113"><a href="#cb194-1113" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1114"><a href="#cb194-1114" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1115"><a href="#cb194-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1116"><a href="#cb194-1116" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Percentile Interval (PI)</span></span>
<span id="cb194-1117"><a href="#cb194-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1118"><a href="#cb194-1118" aria-hidden="true" tabindex="-1"></a>The second calculation returns the middle 80% of the distribution</span>
<span id="cb194-1119"><a href="#cb194-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1120"><a href="#cb194-1120" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Intervals of this sort, which assign equal probability mass to each</span></span>
<span id="cb194-1121"><a href="#cb194-1121" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; tail, are very common in the scientific literature. We&#39;ll call them</span></span>
<span id="cb194-1122"><a href="#cb194-1122" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`r glossary(&quot;percentile&quot;, &quot;percentile intervals&quot;)`</span><span class="at"> (PI). These</span></span>
<span id="cb194-1123"><a href="#cb194-1123" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; intervals do a good job of communicating the shape of a distribution,</span></span>
<span id="cb194-1124"><a href="#cb194-1124" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; as long as the distribution isn&#39;t too asymmetrical. But in terms of</span></span>
<span id="cb194-1125"><a href="#cb194-1125" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; supporting inferences about which parameters are consistent with the</span></span>
<span id="cb194-1126"><a href="#cb194-1126" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; data, they are not perfect.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-1127"><a href="#cb194-1127" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 55](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-1128"><a href="#cb194-1128" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=74&amp;annotation=5GPNVTUH)</span><span class="at">)</span></span>
<span id="cb194-1129"><a href="#cb194-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1130"><a href="#cb194-1130" aria-hidden="true" tabindex="-1"></a>But they do not work well with highly skewed data. See</span>
<span id="cb194-1131"><a href="#cb194-1131" aria-hidden="true" tabindex="-1"></a>@fig-skewed-dist-a where the posterior is consistent with observing</span>
<span id="cb194-1132"><a href="#cb194-1132" aria-hidden="true" tabindex="-1"></a>three waters in three tosses and a uniform (flat) prior.</span>
<span id="cb194-1133"><a href="#cb194-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1134"><a href="#cb194-1134" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1135"><a href="#cb194-1135" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1136"><a href="#cb194-1136" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-skewed-dist-a}</span>
<span id="cb194-1137"><a href="#cb194-1137" aria-hidden="true" tabindex="-1"></a>a: Skewed posterior distribution observing three waters in three tosses</span>
<span id="cb194-1138"><a href="#cb194-1138" aria-hidden="true" tabindex="-1"></a>and a uniform (flat) prior (Base R)</span>
<span id="cb194-1139"><a href="#cb194-1139" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1140"><a href="#cb194-1140" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1141"><a href="#cb194-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1142"><a href="#cb194-1142" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1143"><a href="#cb194-1143" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1144"><a href="#cb194-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1145"><a href="#cb194-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1146"><a href="#cb194-1146" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-skewed-dist-a</span></span>
<span id="cb194-1147"><a href="#cb194-1147" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Skewed posterior distribution observing three waters in three tosses and a uniform (flat) prior. It is highly skewed, having its maximum value at the boundary where p equals 1.&quot;</span></span>
<span id="cb194-1148"><a href="#cb194-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1149"><a href="#cb194-1149" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.11a Skewed data #####################</span></span>
<span id="cb194-1150"><a href="#cb194-1150" aria-hidden="true" tabindex="-1"></a>p_grid_skewed_a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb194-1151"><a href="#cb194-1151" aria-hidden="true" tabindex="-1"></a>prior_skewed_a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb194-1152"><a href="#cb194-1152" aria-hidden="true" tabindex="-1"></a>likelihood_skewed_a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">3</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">prob =</span> p_grid_skewed_a)</span>
<span id="cb194-1153"><a href="#cb194-1153" aria-hidden="true" tabindex="-1"></a>posterior_skewed_a <span class="ot">&lt;-</span> likelihood_skewed_a <span class="sc">*</span> prior_skewed_a</span>
<span id="cb194-1154"><a href="#cb194-1154" aria-hidden="true" tabindex="-1"></a>posterior_skewed_a <span class="ot">&lt;-</span> posterior_skewed_a <span class="sc">/</span> <span class="fu">sum</span>(posterior_skewed_a)</span>
<span id="cb194-1155"><a href="#cb194-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1156"><a href="#cb194-1156" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>) <span class="co"># added to make sampling distribution reproducible (pb)</span></span>
<span id="cb194-1157"><a href="#cb194-1157" aria-hidden="true" tabindex="-1"></a>samples_skewed_a <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid_skewed_a, </span>
<span id="cb194-1158"><a href="#cb194-1158" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> posterior_skewed_a)</span>
<span id="cb194-1159"><a href="#cb194-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1160"><a href="#cb194-1160" aria-hidden="true" tabindex="-1"></a><span class="co"># added to show the skewed posterior distribution (pb)</span></span>
<span id="cb194-1161"><a href="#cb194-1161" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(samples_skewed_a)</span>
<span id="cb194-1162"><a href="#cb194-1162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1163"><a href="#cb194-1163" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1164"><a href="#cb194-1164" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1165"><a href="#cb194-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1166"><a href="#cb194-1166" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;</span><span class="sc">\[</span><span class="at">The </span><span class="in">`r glossary(&quot;percentile&quot;, &quot;percentile interval&quot;)`</span><span class="sc">\]</span><span class="at"> assigns 25%</span></span>
<span id="cb194-1167"><a href="#cb194-1167" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; of the probability mass above and below the interval. So it provides</span></span>
<span id="cb194-1168"><a href="#cb194-1168" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the central 50% probability. But in this example, it ends up excluding</span></span>
<span id="cb194-1169"><a href="#cb194-1169" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the most probable parameter values, near p = 1. So in terms of</span></span>
<span id="cb194-1170"><a href="#cb194-1170" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; describing the shape of the posterior distribution---which is really</span></span>
<span id="cb194-1171"><a href="#cb194-1171" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; all these intervals are asked to do---the percentile interval can be</span></span>
<span id="cb194-1172"><a href="#cb194-1172" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; misleading.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-1173"><a href="#cb194-1173" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 56](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-1174"><a href="#cb194-1174" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=75&amp;annotation=96JZPRGW)</span><span class="at">)</span></span>
<span id="cb194-1175"><a href="#cb194-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1176"><a href="#cb194-1176" aria-hidden="true" tabindex="-1"></a><span class="in">`rethinking::PI()`</span> is just a shorthand for the base R</span>
<span id="cb194-1177"><a href="#cb194-1177" aria-hidden="true" tabindex="-1"></a><span class="in">`stats::quantile()`</span> function.</span>
<span id="cb194-1178"><a href="#cb194-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1179"><a href="#cb194-1179" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1180"><a href="#cb194-1180" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1181"><a href="#cb194-1181" aria-hidden="true" tabindex="-1"></a>::: {#cnj-pi-a1}</span>
<span id="cb194-1182"><a href="#cb194-1182" aria-hidden="true" tabindex="-1"></a>a: Computing the Percentile Interval (PI)</span>
<span id="cb194-1183"><a href="#cb194-1183" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1184"><a href="#cb194-1184" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1185"><a href="#cb194-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1186"><a href="#cb194-1186" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1187"><a href="#cb194-1187" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1188"><a href="#cb194-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1189"><a href="#cb194-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1190"><a href="#cb194-1190" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pi-a1</span></span>
<span id="cb194-1191"><a href="#cb194-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1192"><a href="#cb194-1192" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12a(1) PI ############################</span></span>
<span id="cb194-1193"><a href="#cb194-1193" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_skewed_a, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb194-1194"><a href="#cb194-1194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1195"><a href="#cb194-1195" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1196"><a href="#cb194-1196" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1197"><a href="#cb194-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1198"><a href="#cb194-1198" aria-hidden="true" tabindex="-1"></a>::: my-procedure</span>
<span id="cb194-1199"><a href="#cb194-1199" aria-hidden="true" tabindex="-1"></a>::: my-procedure-header</span>
<span id="cb194-1200"><a href="#cb194-1200" aria-hidden="true" tabindex="-1"></a>::: {#prp-pi-a1}</span>
<span id="cb194-1201"><a href="#cb194-1201" aria-hidden="true" tabindex="-1"></a>: Probability mass (PI) <span class="in">`prob = 0.6`</span> equals the interval between</span>
<span id="cb194-1202"><a href="#cb194-1202" aria-hidden="true" tabindex="-1"></a>$20-80\%$</span>
<span id="cb194-1203"><a href="#cb194-1203" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1204"><a href="#cb194-1204" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1205"><a href="#cb194-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1206"><a href="#cb194-1206" aria-hidden="true" tabindex="-1"></a>::: my-procedure-container</span>
<span id="cb194-1207"><a href="#cb194-1207" aria-hidden="true" tabindex="-1"></a><span class="in">`rethinking::PI()`</span> is just a shorthand for the base R</span>
<span id="cb194-1208"><a href="#cb194-1208" aria-hidden="true" tabindex="-1"></a><span class="in">`stats::quantile()`</span> function. Instead of providing the interval</span>
<span id="cb194-1209"><a href="#cb194-1209" aria-hidden="true" tabindex="-1"></a>explicitly (for instance $20-80\%$) we just say that we want the central</span>
<span id="cb194-1210"><a href="#cb194-1210" aria-hidden="true" tabindex="-1"></a>$60\%$ = PI of <span class="in">`prob = 0.6`</span>.</span>
<span id="cb194-1211"><a href="#cb194-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1212"><a href="#cb194-1212" aria-hidden="true" tabindex="-1"></a><span class="in">`rethinking::PI()`</span> simplifies the following three steps:</span>
<span id="cb194-1213"><a href="#cb194-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1214"><a href="#cb194-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>We divide always the percentage assigned to the <span class="in">`prob`</span> value by 2:</span>
<span id="cb194-1215"><a href="#cb194-1215" aria-hidden="true" tabindex="-1"></a>    60% / 2 = 30\%$</span>
<span id="cb194-1216"><a href="#cb194-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>We subtract, respectively add this value to 50: 50% - 30% = 20% and</span>
<span id="cb194-1217"><a href="#cb194-1217" aria-hidden="true" tabindex="-1"></a>    50% + 30% = 80%</span>
<span id="cb194-1218"><a href="#cb194-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>The result is the probability mass between 20-80%.</span>
<span id="cb194-1219"><a href="#cb194-1219" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1220"><a href="#cb194-1220" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1221"><a href="#cb194-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1222"><a href="#cb194-1222" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1223"><a href="#cb194-1223" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1224"><a href="#cb194-1224" aria-hidden="true" tabindex="-1"></a>::: {#cnj-pi-a2}</span>
<span id="cb194-1225"><a href="#cb194-1225" aria-hidden="true" tabindex="-1"></a>a: Compute PI between $20-80\%$ (Rethinking and Base R)</span>
<span id="cb194-1226"><a href="#cb194-1226" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1227"><a href="#cb194-1227" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1228"><a href="#cb194-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1229"><a href="#cb194-1229" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1230"><a href="#cb194-1230" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1231"><a href="#cb194-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1232"><a href="#cb194-1232" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1233"><a href="#cb194-1233" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pi-a2</span></span>
<span id="cb194-1234"><a href="#cb194-1234" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-1235"><a href="#cb194-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1236"><a href="#cb194-1236" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12a(2) PI ############################</span></span>
<span id="cb194-1237"><a href="#cb194-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1238"><a href="#cb194-1238" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Central Propbability Mass calculated with rethinking::PI()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-1239"><a href="#cb194-1239" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_skewed_a, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb194-1240"><a href="#cb194-1240" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;########################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-1241"><a href="#cb194-1241" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Central Propbability Mass calculated with stats::quantile()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-1242"><a href="#cb194-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples_skewed_a, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">20</span>, .<span class="dv">80</span>))</span>
<span id="cb194-1243"><a href="#cb194-1243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1244"><a href="#cb194-1244" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1245"><a href="#cb194-1245" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1246"><a href="#cb194-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1247"><a href="#cb194-1247" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Highest Posterior Density Interval (HPDI)</span></span>
<span id="cb194-1248"><a href="#cb194-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1249"><a href="#cb194-1249" aria-hidden="true" tabindex="-1"></a>To include the most probable parameter value, the modus or</span>
<span id="cb194-1250"><a href="#cb194-1250" aria-hidden="true" tabindex="-1"></a><span class="in">`r glossary(&quot;MAP&quot;)`</span> we should calculate the <span class="in">`r glossary(&quot;HPDI&quot;)`</span>:</span>
<span id="cb194-1251"><a href="#cb194-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1252"><a href="#cb194-1252" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;The HPDI is the narrowest interval containing the specified</span></span>
<span id="cb194-1253"><a href="#cb194-1253" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probability mass. If you think about it, there must be an infinite</span></span>
<span id="cb194-1254"><a href="#cb194-1254" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; number of posterior intervals // with the same mass. But if you want</span></span>
<span id="cb194-1255"><a href="#cb194-1255" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; an interval that best represents the parameter values most consistent</span></span>
<span id="cb194-1256"><a href="#cb194-1256" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; with the data, then you want the densest of these intervals. That&#39;s</span></span>
<span id="cb194-1257"><a href="#cb194-1257" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; what the HPDI is.&quot; (McElreath, 2020, p. 56/57)</span></span>
<span id="cb194-1258"><a href="#cb194-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1259"><a href="#cb194-1259" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1260"><a href="#cb194-1260" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1261"><a href="#cb194-1261" aria-hidden="true" tabindex="-1"></a>::: {#cnj-hpdi-a}</span>
<span id="cb194-1262"><a href="#cb194-1262" aria-hidden="true" tabindex="-1"></a>a: Compute Highest Posterior Density Interval (HPDI) (Rethinking / Base</span>
<span id="cb194-1263"><a href="#cb194-1263" aria-hidden="true" tabindex="-1"></a>R)</span>
<span id="cb194-1264"><a href="#cb194-1264" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1265"><a href="#cb194-1265" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1266"><a href="#cb194-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1267"><a href="#cb194-1267" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1268"><a href="#cb194-1268" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1269"><a href="#cb194-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1270"><a href="#cb194-1270" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1271"><a href="#cb194-1271" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rethinking-HPDI-a</span></span>
<span id="cb194-1272"><a href="#cb194-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1273"><a href="#cb194-1273" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13a HPDI ###############################</span></span>
<span id="cb194-1274"><a href="#cb194-1274" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_skewed_a, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb194-1275"><a href="#cb194-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1276"><a href="#cb194-1276" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1277"><a href="#cb194-1277" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1278"><a href="#cb194-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1279"><a href="#cb194-1279" aria-hidden="true" tabindex="-1"></a>::: my-note</span>
<span id="cb194-1280"><a href="#cb194-1280" aria-hidden="true" tabindex="-1"></a>::: my-note-header</span>
<span id="cb194-1281"><a href="#cb194-1281" aria-hidden="true" tabindex="-1"></a>::: {#cor-pi-hpdo}</span>
<span id="cb194-1282"><a href="#cb194-1282" aria-hidden="true" tabindex="-1"></a>: HPDI versus PI</span>
<span id="cb194-1283"><a href="#cb194-1283" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1284"><a href="#cb194-1284" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1285"><a href="#cb194-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1286"><a href="#cb194-1286" aria-hidden="true" tabindex="-1"></a>::: my-note-container</span>
<span id="cb194-1287"><a href="#cb194-1287" aria-hidden="true" tabindex="-1"></a>**Advantages of HPDI**</span>
<span id="cb194-1288"><a href="#cb194-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1289"><a href="#cb194-1289" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>HPDI captures the parameters with highest posterior probability</span>
<span id="cb194-1290"><a href="#cb194-1290" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>HPDI is noticeably narrower than PI. In our example</span>
<span id="cb194-1291"><a href="#cb194-1291" aria-hidden="true" tabindex="-1"></a>    <span class="in">`r round(rethinking::HPDI(samples_skewed_a, prob = 0.5)[[2]] - rethinking::HPDI(samples_skewed_a, prob = 0.5)[[1]], 3)`</span></span>
<span id="cb194-1292"><a href="#cb194-1292" aria-hidden="true" tabindex="-1"></a>    versus <span class="in">`r`</span>round(rethinking::PI(samples_skewed_a, prob =</span>
<span id="cb194-1293"><a href="#cb194-1293" aria-hidden="true" tabindex="-1"></a>    0.5)<span class="sc">\[\[</span>2<span class="sc">\]\]</span> - rethinking::PI(samples_skewed_a, prob =</span>
<span id="cb194-1294"><a href="#cb194-1294" aria-hidden="true" tabindex="-1"></a>    0.5)<span class="sc">\[\[</span>1<span class="sc">\]\]</span>, 3)<span class="sc">\`</span>.</span>
<span id="cb194-1295"><a href="#cb194-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1296"><a href="#cb194-1296" aria-hidden="true" tabindex="-1"></a>But this is only valid if we have a very skewed distribution.</span>
<span id="cb194-1297"><a href="#cb194-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1298"><a href="#cb194-1298" aria-hidden="true" tabindex="-1"></a>**Disadvantages of HPDI**</span>
<span id="cb194-1299"><a href="#cb194-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1300"><a href="#cb194-1300" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>HPDI is more computationally intensive than PI</span>
<span id="cb194-1301"><a href="#cb194-1301" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>HPDI is sensitive of the number of samples drawn (= greater</span>
<span id="cb194-1302"><a href="#cb194-1302" aria-hidden="true" tabindex="-1"></a>    simulation variance)</span>
<span id="cb194-1303"><a href="#cb194-1303" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>HPDI is more difficult to understand</span>
<span id="cb194-1304"><a href="#cb194-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1305"><a href="#cb194-1305" aria-hidden="true" tabindex="-1"></a>**Remember, the entire posterior distribution is the Bayesian estimate**</span>
<span id="cb194-1306"><a href="#cb194-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1307"><a href="#cb194-1307" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Overall, if the choice of interval type makes a big difference, then</span></span>
<span id="cb194-1308"><a href="#cb194-1308" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; you shouldn&#39;t be using intervals to summarize the posterior. Remember,</span></span>
<span id="cb194-1309"><a href="#cb194-1309" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the entire posterior distribution is the Bayesian &#39;estimate.&#39; It</span></span>
<span id="cb194-1310"><a href="#cb194-1310" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; summarizes the relative plausibilities of each possible value of the</span></span>
<span id="cb194-1311"><a href="#cb194-1311" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; parameter. Intervals of the distribution are just helpful for</span></span>
<span id="cb194-1312"><a href="#cb194-1312" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; summarizing it. If choice of interval leads to different inferences,</span></span>
<span id="cb194-1313"><a href="#cb194-1313" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; then you&#39;d be better off just plotting the entire posterior</span></span>
<span id="cb194-1314"><a href="#cb194-1314" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; distribution.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-1315"><a href="#cb194-1315" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 58](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-1316"><a href="#cb194-1316" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=77&amp;annotation=XGHNSWCG)</span><span class="at">)</span></span>
<span id="cb194-1317"><a href="#cb194-1317" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1318"><a href="#cb194-1318" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1319"><a href="#cb194-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1320"><a href="#cb194-1320" aria-hidden="true" tabindex="-1"></a>&quot;<span class="sc">\[</span>I<span class="sc">\]</span>n most cases, these two types of interval are very similar.58 They</span>
<span id="cb194-1321"><a href="#cb194-1321" aria-hidden="true" tabindex="-1"></a>only look so different in this case because the posterior distribution</span>
<span id="cb194-1322"><a href="#cb194-1322" aria-hidden="true" tabindex="-1"></a>is highly skewed.&quot; ([McElreath, 2020, p.</span>
<span id="cb194-1323"><a href="#cb194-1323" aria-hidden="true" tabindex="-1"></a>57](zotero://select/groups/5243560/items/NFUEVASQ))</span>
<span id="cb194-1324"><a href="#cb194-1324" aria-hidden="true" tabindex="-1"></a>(<span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=76&amp;annotation=FQPNEVHV)</span>)n</span>
<span id="cb194-1325"><a href="#cb194-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1326"><a href="#cb194-1326" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1327"><a href="#cb194-1327" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1328"><a href="#cb194-1328" aria-hidden="true" tabindex="-1"></a>::: {#cnj-pi-hpdi-symmetric-dist-a}</span>
<span id="cb194-1329"><a href="#cb194-1329" aria-hidden="true" tabindex="-1"></a>a: Compare PI and HPDI of symmetric distributions: Six &#39;Water&#39;, 9 tosses</span>
<span id="cb194-1330"><a href="#cb194-1330" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1331"><a href="#cb194-1331" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1332"><a href="#cb194-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1333"><a href="#cb194-1333" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1334"><a href="#cb194-1334" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1335"><a href="#cb194-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1336"><a href="#cb194-1336" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1337"><a href="#cb194-1337" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pi-hpdi-symmetric-dist-a</span></span>
<span id="cb194-1338"><a href="#cb194-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1339"><a href="#cb194-1339" aria-hidden="true" tabindex="-1"></a>pi8a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_a, <span class="at">prob =</span> <span class="fl">0.8</span>)</span>
<span id="cb194-1340"><a href="#cb194-1340" aria-hidden="true" tabindex="-1"></a>hpdi8a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_a, <span class="at">prob =</span> <span class="fl">0.8</span>)</span>
<span id="cb194-1341"><a href="#cb194-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1342"><a href="#cb194-1342" aria-hidden="true" tabindex="-1"></a>pi95a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_a, <span class="at">prob =</span> <span class="fl">0.95</span>)</span>
<span id="cb194-1343"><a href="#cb194-1343" aria-hidden="true" tabindex="-1"></a>hpdi95a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_a, <span class="at">prob =</span> <span class="fl">0.95</span>)</span>
<span id="cb194-1344"><a href="#cb194-1344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1345"><a href="#cb194-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1346"><a href="#cb194-1346" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>PI 80% = <span class="in">`r pi8a`</span> versus HPDI 80% = <span class="in">`r hpdi8a`</span>.</span>
<span id="cb194-1347"><a href="#cb194-1347" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>PI 95% = <span class="in">`r pi95a`</span> versus HPDI 95% = <span class="in">`r hpdi95a`</span>.</span>
<span id="cb194-1348"><a href="#cb194-1348" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1349"><a href="#cb194-1349" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1350"><a href="#cb194-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1351"><a href="#cb194-1351" aria-hidden="true" tabindex="-1"></a>The 95% interval in frequentist statistics is just a convention, there</span>
<span id="cb194-1352"><a href="#cb194-1352" aria-hidden="true" tabindex="-1"></a>are no analytical reasons why you should choose exactly this interval.</span>
<span id="cb194-1353"><a href="#cb194-1353" aria-hidden="true" tabindex="-1"></a>But convenience is not a serious criterion. So what to do instead?</span>
<span id="cb194-1354"><a href="#cb194-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1355"><a href="#cb194-1355" aria-hidden="true" tabindex="-1"></a>::: my-tip</span>
<span id="cb194-1356"><a href="#cb194-1356" aria-hidden="true" tabindex="-1"></a>::: my-tip-header</span>
<span id="cb194-1357"><a href="#cb194-1357" aria-hidden="true" tabindex="-1"></a>Instead of 95% intervals use the widest interval that excludes the value</span>
<span id="cb194-1358"><a href="#cb194-1358" aria-hidden="true" tabindex="-1"></a>you want to report or provide a series of nested intervals</span>
<span id="cb194-1359"><a href="#cb194-1359" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1360"><a href="#cb194-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1361"><a href="#cb194-1361" aria-hidden="true" tabindex="-1"></a>::: my-tip-container</span>
<span id="cb194-1362"><a href="#cb194-1362" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;If you are trying to say that an interval doesn&#39;t include some value,</span></span>
<span id="cb194-1363"><a href="#cb194-1363" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; then you might use the widest interval that excludes the value. Often,</span></span>
<span id="cb194-1364"><a href="#cb194-1364" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; all compatibility intervals do is communicate the shape of a</span></span>
<span id="cb194-1365"><a href="#cb194-1365" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; distribution. In that case, a series of nested intervals may be more</span></span>
<span id="cb194-1366"><a href="#cb194-1366" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; useful than any one interval. For example, why not present 67%, 89%,</span></span>
<span id="cb194-1367"><a href="#cb194-1367" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; and 97% intervals, along with the median? Why these values? No reason.</span></span>
<span id="cb194-1368"><a href="#cb194-1368" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; They are prime numbers, which makes them easy to remember. But all</span></span>
<span id="cb194-1369"><a href="#cb194-1369" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; that matters is they be spaced enough to illustrate the shape of the</span></span>
<span id="cb194-1370"><a href="#cb194-1370" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; posterior. And these values avoid 95%, since conventional 95%</span></span>
<span id="cb194-1371"><a href="#cb194-1371" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; intervals encourage many readers to conduct unconscious hypothesis</span></span>
<span id="cb194-1372"><a href="#cb194-1372" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; tests.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-1373"><a href="#cb194-1373" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 56](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-1374"><a href="#cb194-1374" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=75&amp;annotation=TG2LCZAG)</span><span class="at">)</span></span>
<span id="cb194-1375"><a href="#cb194-1375" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1376"><a href="#cb194-1376" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1377"><a href="#cb194-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1378"><a href="#cb194-1378" aria-hidden="true" tabindex="-1"></a>::: my-note</span>
<span id="cb194-1379"><a href="#cb194-1379" aria-hidden="true" tabindex="-1"></a>::: my-note-header</span>
<span id="cb194-1380"><a href="#cb194-1380" aria-hidden="true" tabindex="-1"></a>Boundaries versus Probability Mass Intervals</span>
<span id="cb194-1381"><a href="#cb194-1381" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1382"><a href="#cb194-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1383"><a href="#cb194-1383" aria-hidden="true" tabindex="-1"></a>::: my-note-container</span>
<span id="cb194-1384"><a href="#cb194-1384" aria-hidden="true" tabindex="-1"></a>**Boundaries**:</span>
<span id="cb194-1385"><a href="#cb194-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1386"><a href="#cb194-1386" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We ask for a **probability of frequencies**.</span>
<span id="cb194-1387"><a href="#cb194-1387" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Result is a **percentage of probability**.</span>
<span id="cb194-1388"><a href="#cb194-1388" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boundaries are grounded on the **probability (<span class="in">`prob`</span>) values</span>
<span id="cb194-1389"><a href="#cb194-1389" aria-hidden="true" tabindex="-1"></a>    (**$0-1$).</span>
<span id="cb194-1390"><a href="#cb194-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1391"><a href="#cb194-1391" aria-hidden="true" tabindex="-1"></a>**Probability Mass**:</span>
<span id="cb194-1392"><a href="#cb194-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1393"><a href="#cb194-1393" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We ask for a specified **amount of posterior probability**.</span>
<span id="cb194-1394"><a href="#cb194-1394" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Result is the probability value of the **percentage of frequencies**</span>
<span id="cb194-1395"><a href="#cb194-1395" aria-hidden="true" tabindex="-1"></a>    we looked for.</span>
<span id="cb194-1396"><a href="#cb194-1396" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Probability Mass is grounded on the **percentage of probabilities</span>
<span id="cb194-1397"><a href="#cb194-1397" aria-hidden="true" tabindex="-1"></a>    (**$0-100\%$).</span>
<span id="cb194-1398"><a href="#cb194-1398" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1399"><a href="#cb194-1399" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1400"><a href="#cb194-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1401"><a href="#cb194-1401" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TIDYVERSE</span></span>
<span id="cb194-1402"><a href="#cb194-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1403"><a href="#cb194-1403" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Quantiles</span></span>
<span id="cb194-1404"><a href="#cb194-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1405"><a href="#cb194-1405" aria-hidden="true" tabindex="-1"></a>Kurz offers again different methods --- this time to calculate</span>
<span id="cb194-1406"><a href="#cb194-1406" aria-hidden="true" tabindex="-1"></a>probability mass:</span>
<span id="cb194-1407"><a href="#cb194-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1408"><a href="#cb194-1408" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Method**: Since we saved our <span class="in">`samples_b`</span> samples within the</span>
<span id="cb194-1409"><a href="#cb194-1409" aria-hidden="true" tabindex="-1"></a>    <span class="in">`df_samples_b`</span> tibble, we&#39;ll have to index with <span class="in">`$`</span> within</span>
<span id="cb194-1410"><a href="#cb194-1410" aria-hidden="true" tabindex="-1"></a>    <span class="in">`stats::quantile()`</span>.</span>
<span id="cb194-1411"><a href="#cb194-1411" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Method**: For an alternative approach, we could <span class="in">`dplyr::select()`</span></span>
<span id="cb194-1412"><a href="#cb194-1412" aria-hidden="true" tabindex="-1"></a>    the <span class="in">`samples_b`</span> vector, extract it from the tibble with</span>
<span id="cb194-1413"><a href="#cb194-1413" aria-hidden="true" tabindex="-1"></a>    <span class="in">`dplyr::pull()`</span>, and then pump it into <span class="in">`stats::quantile()`</span>.</span>
<span id="cb194-1414"><a href="#cb194-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1415"><a href="#cb194-1415" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`pull()`</span><span class="at"> is similar to </span><span class="in">`$`</span><span class="at">. It&#39;s mostly useful because it looks a</span></span>
<span id="cb194-1416"><a href="#cb194-1416" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; little nicer in pipes, it also works with remote data frames, and it</span></span>
<span id="cb194-1417"><a href="#cb194-1417" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; can optionally name the output. ([</span><span class="in">`dplyr::pull()`</span><span class="at"> help file &quot;Extract a</span></span>
<span id="cb194-1418"><a href="#cb194-1418" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; single column&quot;](https://dplyr.tidyverse.org/reference/pull.html))</span></span>
<span id="cb194-1419"><a href="#cb194-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1420"><a href="#cb194-1420" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Method**: We might also use <span class="in">`stats::quantile()`</span> within</span>
<span id="cb194-1421"><a href="#cb194-1421" aria-hidden="true" tabindex="-1"></a>    <span class="in">`dplyr::summarize()`</span>.</span>
<span id="cb194-1422"><a href="#cb194-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1423"><a href="#cb194-1423" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1424"><a href="#cb194-1424" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1425"><a href="#cb194-1425" aria-hidden="true" tabindex="-1"></a>::: {#cnj-quantiles-b1}</span>
<span id="cb194-1426"><a href="#cb194-1426" aria-hidden="true" tabindex="-1"></a>b: Compute posterior probability mass intervals of $80\%$ with different</span>
<span id="cb194-1427"><a href="#cb194-1427" aria-hidden="true" tabindex="-1"></a>methods</span>
<span id="cb194-1428"><a href="#cb194-1428" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1429"><a href="#cb194-1429" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1430"><a href="#cb194-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1431"><a href="#cb194-1431" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1432"><a href="#cb194-1432" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1433"><a href="#cb194-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1434"><a href="#cb194-1434" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1435"><a href="#cb194-1435" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: quantiles-b1</span></span>
<span id="cb194-1436"><a href="#cb194-1436" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-1437"><a href="#cb194-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1438"><a href="#cb194-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1439"><a href="#cb194-1439" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.9b Quantile 0.8 diff. approaches   #######################</span></span>
<span id="cb194-1440"><a href="#cb194-1440" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (1) #######</span></span>
<span id="cb194-1441"><a href="#cb194-1441" aria-hidden="true" tabindex="-1"></a>method_1 <span class="ot">&lt;-</span> q80 <span class="ot">&lt;-</span> </span>
<span id="cb194-1442"><a href="#cb194-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">probs =</span> .<span class="dv">8</span>)</span>
<span id="cb194-1443"><a href="#cb194-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1444"><a href="#cb194-1444" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 1:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-1445"><a href="#cb194-1445" aria-hidden="true" tabindex="-1"></a>method_1</span>
<span id="cb194-1446"><a href="#cb194-1446" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;##################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-1447"><a href="#cb194-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1448"><a href="#cb194-1448" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (2) #######</span></span>
<span id="cb194-1449"><a href="#cb194-1449" aria-hidden="true" tabindex="-1"></a>method_2 <span class="ot">&lt;-</span> </span>
<span id="cb194-1450"><a href="#cb194-1450" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1451"><a href="#cb194-1451" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">pull</span>(samples_b) <span class="sc">|&gt;</span> </span>
<span id="cb194-1452"><a href="#cb194-1452" aria-hidden="true" tabindex="-1"></a>    <span class="fu">quantile</span>(<span class="at">probs =</span> .<span class="dv">8</span>)</span>
<span id="cb194-1453"><a href="#cb194-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1454"><a href="#cb194-1454" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 2:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-1455"><a href="#cb194-1455" aria-hidden="true" tabindex="-1"></a>method_2</span>
<span id="cb194-1456"><a href="#cb194-1456" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;##################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-1457"><a href="#cb194-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1458"><a href="#cb194-1458" aria-hidden="true" tabindex="-1"></a><span class="do">###### Method (3) #######</span></span>
<span id="cb194-1459"><a href="#cb194-1459" aria-hidden="true" tabindex="-1"></a>method_3 <span class="ot">&lt;-</span> </span>
<span id="cb194-1460"><a href="#cb194-1460" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1461"><a href="#cb194-1461" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">q80_2 =</span> <span class="fu">quantile</span>(samples_b, <span class="at">probs =</span> .<span class="dv">8</span>))</span>
<span id="cb194-1462"><a href="#cb194-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1463"><a href="#cb194-1463" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Method 3:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-1464"><a href="#cb194-1464" aria-hidden="true" tabindex="-1"></a>method_3</span>
<span id="cb194-1465"><a href="#cb194-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1466"><a href="#cb194-1466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1467"><a href="#cb194-1467" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1468"><a href="#cb194-1468" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1469"><a href="#cb194-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1470"><a href="#cb194-1470" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Percentile Interval (PI)</span></span>
<span id="cb194-1471"><a href="#cb194-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1472"><a href="#cb194-1472" aria-hidden="true" tabindex="-1"></a>Here&#39;s the <span class="in">`summarize()`</span> approach with two probabilities returning the</span>
<span id="cb194-1473"><a href="#cb194-1473" aria-hidden="true" tabindex="-1"></a><span class="in">`r glossary(&quot;percentile&quot;, &quot;percentile interval&quot;)`</span> (PI).</span>
<span id="cb194-1474"><a href="#cb194-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1475"><a href="#cb194-1475" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1476"><a href="#cb194-1476" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1477"><a href="#cb194-1477" aria-hidden="true" tabindex="-1"></a>::: {#cnj-pi-b1}</span>
<span id="cb194-1478"><a href="#cb194-1478" aria-hidden="true" tabindex="-1"></a>b: Compute probability mass of 80% with summarize method</span>
<span id="cb194-1479"><a href="#cb194-1479" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1480"><a href="#cb194-1480" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1481"><a href="#cb194-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1482"><a href="#cb194-1482" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1483"><a href="#cb194-1483" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1484"><a href="#cb194-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1485"><a href="#cb194-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1486"><a href="#cb194-1486" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pi-b1</span></span>
<span id="cb194-1487"><a href="#cb194-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1488"><a href="#cb194-1488" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.10b(1) PI = Quantile 0.1-0.9 ###################</span></span>
<span id="cb194-1489"><a href="#cb194-1489" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1490"><a href="#cb194-1490" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">q10 =</span> <span class="fu">quantile</span>(samples_b, <span class="at">probs =</span> .<span class="dv">1</span>),</span>
<span id="cb194-1491"><a href="#cb194-1491" aria-hidden="true" tabindex="-1"></a>              <span class="at">q90 =</span> <span class="fu">quantile</span>(samples_b, <span class="at">probs =</span> .<span class="dv">9</span>))</span>
<span id="cb194-1492"><a href="#cb194-1492" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-1493"><a href="#cb194-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1494"><a href="#cb194-1494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1495"><a href="#cb194-1495" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1496"><a href="#cb194-1496" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1497"><a href="#cb194-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1498"><a href="#cb194-1498" aria-hidden="true" tabindex="-1"></a>Kurz refers also to a now deprecated calculation using the vector</span>
<span id="cb194-1499"><a href="#cb194-1499" aria-hidden="true" tabindex="-1"></a>feature of R to summarize different quantiles with one line.</span>
<span id="cb194-1500"><a href="#cb194-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1501"><a href="#cb194-1501" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-1502"><a href="#cb194-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1503"><a href="#cb194-1503" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb194-1504"><a href="#cb194-1504" aria-hidden="true" tabindex="-1"></a><span class="in">samples_b |&gt; dplyr::summarize(q10_90 = quantile(samples_b, probs = c(.1, .9)))</span></span>
<span id="cb194-1505"><a href="#cb194-1505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1506"><a href="#cb194-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1507"><a href="#cb194-1507" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-1508"><a href="#cb194-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1509"><a href="#cb194-1509" aria-hidden="true" tabindex="-1"></a>This produces nowadays the following warning message:</span>
<span id="cb194-1510"><a href="#cb194-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1511"><a href="#cb194-1511" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb194-1512"><a href="#cb194-1512" aria-hidden="true" tabindex="-1"></a>Warning: Returning more (or less) than 1 row per <span class="in">`summarise()`</span> group was</span>
<span id="cb194-1513"><a href="#cb194-1513" aria-hidden="true" tabindex="-1"></a>deprecated in dplyr 1.1.0.</span>
<span id="cb194-1514"><a href="#cb194-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1515"><a href="#cb194-1515" aria-hidden="true" tabindex="-1"></a>Please use <span class="in">`reframe()`</span> instead.</span>
<span id="cb194-1516"><a href="#cb194-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1517"><a href="#cb194-1517" aria-hidden="true" tabindex="-1"></a>When switching from <span class="in">`summarise()`</span> to <span class="in">`reframe()`</span>, remember that</span>
<span id="cb194-1518"><a href="#cb194-1518" aria-hidden="true" tabindex="-1"></a><span class="in">`reframe()`</span> always returns an ungrouped data frame and adjust</span>
<span id="cb194-1519"><a href="#cb194-1519" aria-hidden="true" tabindex="-1"></a>accordingly.</span>
<span id="cb194-1520"><a href="#cb194-1520" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1521"><a href="#cb194-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1522"><a href="#cb194-1522" aria-hidden="true" tabindex="-1"></a>Therefore I am going to change <span class="in">`dplyr::summarize()`</span> to</span>
<span id="cb194-1523"><a href="#cb194-1523" aria-hidden="true" tabindex="-1"></a><span class="in">`dplyr::reframe()`</span>.</span>
<span id="cb194-1524"><a href="#cb194-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1525"><a href="#cb194-1525" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1526"><a href="#cb194-1526" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1527"><a href="#cb194-1527" aria-hidden="true" tabindex="-1"></a>::: {#cnj-reframe}</span>
<span id="cb194-1528"><a href="#cb194-1528" aria-hidden="true" tabindex="-1"></a>b: Using <span class="in">`dplyr::reframe()`</span> to compute probability mass intervals of 80%</span>
<span id="cb194-1529"><a href="#cb194-1529" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1530"><a href="#cb194-1530" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1531"><a href="#cb194-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1532"><a href="#cb194-1532" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1533"><a href="#cb194-1533" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1534"><a href="#cb194-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1535"><a href="#cb194-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1536"><a href="#cb194-1536" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: quantile-reframe</span></span>
<span id="cb194-1537"><a href="#cb194-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1538"><a href="#cb194-1538" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.10b(2) PI = Quantile 0.1-0.9 ###################</span></span>
<span id="cb194-1539"><a href="#cb194-1539" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1540"><a href="#cb194-1540" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">reframe</span>(<span class="at">q10_90 =</span> <span class="fu">quantile</span>(samples_b, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>)))</span>
<span id="cb194-1541"><a href="#cb194-1541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1542"><a href="#cb194-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1543"><a href="#cb194-1543" aria-hidden="true" tabindex="-1"></a>::: my-note</span>
<span id="cb194-1544"><a href="#cb194-1544" aria-hidden="true" tabindex="-1"></a>::: my-note-header</span>
<span id="cb194-1545"><a href="#cb194-1545" aria-hidden="true" tabindex="-1"></a>::: {#cor-reframe}</span>
<span id="cb194-1546"><a href="#cb194-1546" aria-hidden="true" tabindex="-1"></a>: Excursion: Using <span class="in">`dplyr::reframe()`</span> and friends</span>
<span id="cb194-1547"><a href="#cb194-1547" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1548"><a href="#cb194-1548" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1549"><a href="#cb194-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1550"><a href="#cb194-1550" aria-hidden="true" tabindex="-1"></a>::: my-note-container</span>
<span id="cb194-1551"><a href="#cb194-1551" aria-hidden="true" tabindex="-1"></a>From the help file of <span class="in">`dplyr::reframe()`</span>:</span>
<span id="cb194-1552"><a href="#cb194-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1553"><a href="#cb194-1553" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; While </span><span class="in">`summarise()`</span><span class="at"> requires that each argument returns a single</span></span>
<span id="cb194-1554"><a href="#cb194-1554" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; value, and </span><span class="in">`mutate()`</span><span class="at"> requires that each argument returns the same</span></span>
<span id="cb194-1555"><a href="#cb194-1555" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; number of rows as the input, </span><span class="in">`reframe()`</span><span class="at"> is a more general workhorse</span></span>
<span id="cb194-1556"><a href="#cb194-1556" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; with no requirements on the number of rows returned per group.</span></span>
<span id="cb194-1557"><a href="#cb194-1557" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb194-1558"><a href="#cb194-1558" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`reframe()`</span><span class="at"> creates a new data frame by applying functions to columns</span></span>
<span id="cb194-1559"><a href="#cb194-1559" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; of an existing data frame. It is most similar to </span><span class="in">`summarise()`</span><span class="at">, with</span></span>
<span id="cb194-1560"><a href="#cb194-1560" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; two big differences:</span></span>
<span id="cb194-1561"><a href="#cb194-1561" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb194-1562"><a href="#cb194-1562" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; -   </span><span class="in">`reframe()`</span><span class="at"> can return an arbitrary number of rows per group,</span></span>
<span id="cb194-1563"><a href="#cb194-1563" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     while </span><span class="in">`summarise()`</span><span class="at"> reduces each group down to a single row.</span></span>
<span id="cb194-1564"><a href="#cb194-1564" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; -   </span><span class="in">`reframe()`</span><span class="at"> always returns an ungrouped data frame, while</span></span>
<span id="cb194-1565"><a href="#cb194-1565" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     </span><span class="in">`summarise()`</span><span class="at"> might return a grouped or rowwise data frame,</span></span>
<span id="cb194-1566"><a href="#cb194-1566" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     depending on the scenario.</span></span>
<span id="cb194-1567"><a href="#cb194-1567" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb194-1568"><a href="#cb194-1568" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; We expect that you&#39;ll use </span><span class="in">`summarise()`</span><span class="at"> much more often than</span></span>
<span id="cb194-1569"><a href="#cb194-1569" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`reframe()`</span><span class="at">, but </span><span class="in">`reframe()`</span><span class="at"> can be particularly helpful when you need</span></span>
<span id="cb194-1570"><a href="#cb194-1570" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; to apply a complex function that doesn&#39;t return a single summary</span></span>
<span id="cb194-1571"><a href="#cb194-1571" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; value.</span></span>
<span id="cb194-1572"><a href="#cb194-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1573"><a href="#cb194-1573" aria-hidden="true" tabindex="-1"></a>See also the appropriate [section in the blog</span>
<span id="cb194-1574"><a href="#cb194-1574" aria-hidden="true" tabindex="-1"></a>post](https://www.tidyverse.org/blog/2023/02/dplyr-1-1-0-pick-reframe-arrange/#reframe)</span>
<span id="cb194-1575"><a href="#cb194-1575" aria-hidden="true" tabindex="-1"></a>about changes in {**dplyr**} 1.1.0. The name <span class="in">`reframe()`</span> is in</span>
<span id="cb194-1576"><a href="#cb194-1576" aria-hidden="true" tabindex="-1"></a>accordance with <span class="in">`tibble::enframe()`</span> and <span class="in">`tibble::deframe()`</span>:</span>
<span id="cb194-1577"><a href="#cb194-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1578"><a href="#cb194-1578" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`enframe()`</span>: Takes a vector, returns a data frame</span>
<span id="cb194-1579"><a href="#cb194-1579" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`deframe()`</span>: Takes a data frame, returns a vector</span>
<span id="cb194-1580"><a href="#cb194-1580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`reframe()`</span>: Takes a data frame, returns a data frame</span>
<span id="cb194-1581"><a href="#cb194-1581" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1582"><a href="#cb194-1582" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1583"><a href="#cb194-1583" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1584"><a href="#cb194-1584" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1585"><a href="#cb194-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1586"><a href="#cb194-1586" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The functions of the tidyverse approach typically returns a data</span></span>
<span id="cb194-1587"><a href="#cb194-1587" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; frame. But sometimes you just want your values in a numeric vector for</span></span>
<span id="cb194-1588"><a href="#cb194-1588" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the sake of quick indexing. In that case, base R </span><span class="in">`stats::quantile()`</span></span>
<span id="cb194-1589"><a href="#cb194-1589" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; shines: (Kurz in the section: [Intervals of defined</span></span>
<span id="cb194-1590"><a href="#cb194-1590" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; mass](https://bookdown.org/content/4857/sampling-the-imaginary.html#intervals-of-defined-mass.))</span></span>
<span id="cb194-1591"><a href="#cb194-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1592"><a href="#cb194-1592" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1593"><a href="#cb194-1593" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1594"><a href="#cb194-1594" aria-hidden="true" tabindex="-1"></a>::: {#cnj-pi-b2}</span>
<span id="cb194-1595"><a href="#cb194-1595" aria-hidden="true" tabindex="-1"></a>b: Using <span class="in">`stats::quantile()`</span> to get a vector of a probability mass</span>
<span id="cb194-1596"><a href="#cb194-1596" aria-hidden="true" tabindex="-1"></a>calculation</span>
<span id="cb194-1597"><a href="#cb194-1597" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1598"><a href="#cb194-1598" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1599"><a href="#cb194-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1600"><a href="#cb194-1600" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1601"><a href="#cb194-1601" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1602"><a href="#cb194-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1603"><a href="#cb194-1603" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1604"><a href="#cb194-1604" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pi-b2</span></span>
<span id="cb194-1605"><a href="#cb194-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1606"><a href="#cb194-1606" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12b(1) PI = Quantile 0.1-0.9#############################</span></span>
<span id="cb194-1607"><a href="#cb194-1607" aria-hidden="true" tabindex="-1"></a>(<span class="at">q10_q90 =</span> <span class="fu">quantile</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>)))</span>
<span id="cb194-1608"><a href="#cb194-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1609"><a href="#cb194-1609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1610"><a href="#cb194-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1611"><a href="#cb194-1611" aria-hidden="true" tabindex="-1"></a>This is the same method as in R base with the difference that we are</span>
<span id="cb194-1612"><a href="#cb194-1612" aria-hidden="true" tabindex="-1"></a>working with tibbles and need therefore to use the <span class="in">`$`</span> operator.</span>
<span id="cb194-1613"><a href="#cb194-1613" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1614"><a href="#cb194-1614" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1615"><a href="#cb194-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1616"><a href="#cb194-1616" aria-hidden="true" tabindex="-1"></a>To produce the bottom part of Figure 3.2 of the book we apply following</span>
<span id="cb194-1617"><a href="#cb194-1617" aria-hidden="true" tabindex="-1"></a>code lines.</span>
<span id="cb194-1618"><a href="#cb194-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1619"><a href="#cb194-1619" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1620"><a href="#cb194-1620" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1621"><a href="#cb194-1621" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-lower-part-3-2b}</span>
<span id="cb194-1622"><a href="#cb194-1622" aria-hidden="true" tabindex="-1"></a>b: Plots of defined mass intervals lower of 80% and the middle 80%</span>
<span id="cb194-1623"><a href="#cb194-1623" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1624"><a href="#cb194-1624" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1625"><a href="#cb194-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1626"><a href="#cb194-1626" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1627"><a href="#cb194-1627" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1628"><a href="#cb194-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1629"><a href="#cb194-1629" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1630"><a href="#cb194-1630" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lower-part-3-2b</span></span>
<span id="cb194-1631"><a href="#cb194-1631" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Lower part of SR2 Figure 3.2: Intervals of defined mass produced with {**tidyverse**} tools: Left: Lower 80% posterior probability exists below a parameter value of about 0.75. Right: Middle 80% posterior probability lies between the 10% and 90% quantiles.&quot;</span></span>
<span id="cb194-1632"><a href="#cb194-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1633"><a href="#cb194-1633" aria-hidden="true" tabindex="-1"></a><span class="do">## R Code Fig 3.2b Lower Part #############</span></span>
<span id="cb194-1634"><a href="#cb194-1634" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb194-1635"><a href="#cb194-1635" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1636"><a href="#cb194-1636" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b, <span class="at">y =</span> posterior_samples_b)) <span class="sc">+</span></span>
<span id="cb194-1637"><a href="#cb194-1637" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-1638"><a href="#cb194-1638" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1639"><a href="#cb194-1639" aria-hidden="true" tabindex="-1"></a>                dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&lt;</span> q80), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1640"><a href="#cb194-1640" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb194-1641"><a href="#cb194-1641" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb194-1642"><a href="#cb194-1642" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;lower 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1643"><a href="#cb194-1643" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb194-1644"><a href="#cb194-1644" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1645"><a href="#cb194-1645" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-1646"><a href="#cb194-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1647"><a href="#cb194-1647" aria-hidden="true" tabindex="-1"></a><span class="co"># upper right panel</span></span>
<span id="cb194-1648"><a href="#cb194-1648" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb194-1649"><a href="#cb194-1649" aria-hidden="true" tabindex="-1"></a>  df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1650"><a href="#cb194-1650" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b, <span class="at">y =</span> posterior_samples_b)) <span class="sc">+</span></span>
<span id="cb194-1651"><a href="#cb194-1651" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-1652"><a href="#cb194-1652" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1653"><a href="#cb194-1653" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(samples_b <span class="sc">&gt;</span> q10_q90[[<span class="dv">1</span>]] <span class="sc">&amp;</span> </span>
<span id="cb194-1654"><a href="#cb194-1654" aria-hidden="true" tabindex="-1"></a>                    samples_b <span class="sc">&lt;</span> q10_q90[[<span class="dv">2</span>]]), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1655"><a href="#cb194-1655" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb194-1656"><a href="#cb194-1656" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb194-1657"><a href="#cb194-1657" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;middle 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1658"><a href="#cb194-1658" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb194-1659"><a href="#cb194-1659" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1660"><a href="#cb194-1660" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-1661"><a href="#cb194-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1662"><a href="#cb194-1662" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb194-1663"><a href="#cb194-1663" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb194-1664"><a href="#cb194-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1665"><a href="#cb194-1665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1666"><a href="#cb194-1666" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1667"><a href="#cb194-1667" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1668"><a href="#cb194-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1669"><a href="#cb194-1669" aria-hidden="true" tabindex="-1"></a>Again we will demonstrate the misleading character of</span>
<span id="cb194-1670"><a href="#cb194-1670" aria-hidden="true" tabindex="-1"></a><span class="in">`r glossary(&quot;Percentile&quot;, &quot;Percentile Intervals&quot;)`</span> (PIs) with a very</span>
<span id="cb194-1671"><a href="#cb194-1671" aria-hidden="true" tabindex="-1"></a>skewed distribution.</span>
<span id="cb194-1672"><a href="#cb194-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1673"><a href="#cb194-1673" aria-hidden="true" tabindex="-1"></a>We&#39;ve already defined <span class="in">`p_grid_b`</span> and <span class="in">`prior_b`</span> within <span class="in">`d_b`</span>, above. Here</span>
<span id="cb194-1674"><a href="#cb194-1674" aria-hidden="true" tabindex="-1"></a>we&#39;ll reuse them and create a new tibble by updating all the columns</span>
<span id="cb194-1675"><a href="#cb194-1675" aria-hidden="true" tabindex="-1"></a>with the skewed parameters of three &#39;Water&#39; in three tosses.</span>
<span id="cb194-1676"><a href="#cb194-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1677"><a href="#cb194-1677" aria-hidden="true" tabindex="-1"></a>To see the difference how the skewed distribution is different to the</span>
<span id="cb194-1678"><a href="#cb194-1678" aria-hidden="true" tabindex="-1"></a>Figure 3.2 lower part, I will draw the appropriate figure here myself.</span>
<span id="cb194-1679"><a href="#cb194-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1680"><a href="#cb194-1680" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1681"><a href="#cb194-1681" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1682"><a href="#cb194-1682" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-skewed-dist-b}</span>
<span id="cb194-1683"><a href="#cb194-1683" aria-hidden="true" tabindex="-1"></a>b: Skewed posterior distribution observing three waters in three tosses</span>
<span id="cb194-1684"><a href="#cb194-1684" aria-hidden="true" tabindex="-1"></a>and a uniform (flat) prior (Tidyverse)</span>
<span id="cb194-1685"><a href="#cb194-1685" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1686"><a href="#cb194-1686" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1687"><a href="#cb194-1687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1688"><a href="#cb194-1688" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1689"><a href="#cb194-1689" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1690"><a href="#cb194-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1691"><a href="#cb194-1691" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1692"><a href="#cb194-1692" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-skewed-dist-b</span></span>
<span id="cb194-1693"><a href="#cb194-1693" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Skewed posterior distribution observing three waters in three tosses and a uniform (flat) prior. The distribution is highly skewed, having its maximum value where p equals 1.&quot;</span></span>
<span id="cb194-1694"><a href="#cb194-1694" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb194-1695"><a href="#cb194-1695" aria-hidden="true" tabindex="-1"></a><span class="co">#| figh-height: 5</span></span>
<span id="cb194-1696"><a href="#cb194-1696" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: &quot;50%&quot;</span></span>
<span id="cb194-1697"><a href="#cb194-1697" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: &quot;center&quot;</span></span>
<span id="cb194-1698"><a href="#cb194-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1699"><a href="#cb194-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1700"><a href="#cb194-1700" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.11b Skewed data #########################</span></span>
<span id="cb194-1701"><a href="#cb194-1701" aria-hidden="true" tabindex="-1"></a><span class="co"># here we update the `dbinom()` parameters </span></span>
<span id="cb194-1702"><a href="#cb194-1702" aria-hidden="true" tabindex="-1"></a><span class="co"># for values for a skewed distribution</span></span>
<span id="cb194-1703"><a href="#cb194-1703" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming three trials results in 3 W (Water)</span></span>
<span id="cb194-1704"><a href="#cb194-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1705"><a href="#cb194-1705" aria-hidden="true" tabindex="-1"></a>n_samples_skewed_b <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb194-1706"><a href="#cb194-1706" aria-hidden="true" tabindex="-1"></a>n_success_skewed_b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb194-1707"><a href="#cb194-1707" aria-hidden="true" tabindex="-1"></a>n_trials_skewed_b  <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb194-1708"><a href="#cb194-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1709"><a href="#cb194-1709" aria-hidden="true" tabindex="-1"></a><span class="co"># update `d_b` to d_skewed_b</span></span>
<span id="cb194-1710"><a href="#cb194-1710" aria-hidden="true" tabindex="-1"></a>d_skewed_b <span class="ot">&lt;-</span></span>
<span id="cb194-1711"><a href="#cb194-1711" aria-hidden="true" tabindex="-1"></a>  d_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1712"><a href="#cb194-1712" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">likelihood_skewed_b =</span> </span>
<span id="cb194-1713"><a href="#cb194-1713" aria-hidden="true" tabindex="-1"></a>        stats<span class="sc">::</span><span class="fu">dbinom</span>(n_success_skewed_b,</span>
<span id="cb194-1714"><a href="#cb194-1714" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> n_trials_skewed_b, <span class="at">prob =</span> p_grid_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-1715"><a href="#cb194-1715" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">posterior_skewed_b  =</span> </span>
<span id="cb194-1716"><a href="#cb194-1716" aria-hidden="true" tabindex="-1"></a>          (likelihood_skewed_b <span class="sc">*</span> prior_b) <span class="sc">/</span> </span>
<span id="cb194-1717"><a href="#cb194-1717" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sum</span>(likelihood_skewed_b <span class="sc">*</span> prior_b))</span>
<span id="cb194-1718"><a href="#cb194-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1719"><a href="#cb194-1719" aria-hidden="true" tabindex="-1"></a><span class="co"># make the next part reproducible</span></span>
<span id="cb194-1720"><a href="#cb194-1720" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-1721"><a href="#cb194-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1722"><a href="#cb194-1722" aria-hidden="true" tabindex="-1"></a><span class="co"># here&#39;s our new samples tibble</span></span>
<span id="cb194-1723"><a href="#cb194-1723" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="ot">&lt;-</span> </span>
<span id="cb194-1724"><a href="#cb194-1724" aria-hidden="true" tabindex="-1"></a>    d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1725"><a href="#cb194-1725" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples_skewed_b, </span>
<span id="cb194-1726"><a href="#cb194-1726" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight_by =</span> posterior_skewed_b, <span class="at">replace =</span> T) <span class="sc">|&gt;</span> </span>
<span id="cb194-1727"><a href="#cb194-1727" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">p_skewed_b =</span> p_grid_b,</span>
<span id="cb194-1728"><a href="#cb194-1728" aria-hidden="true" tabindex="-1"></a>           <span class="at">prior_skewed_b =</span> prior_b)</span>
<span id="cb194-1729"><a href="#cb194-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1730"><a href="#cb194-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1731"><a href="#cb194-1731" aria-hidden="true" tabindex="-1"></a><span class="co"># added to see the skewed distribution</span></span>
<span id="cb194-1732"><a href="#cb194-1732" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span>  </span>
<span id="cb194-1733"><a href="#cb194-1733" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>( ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb194-1734"><a href="#cb194-1734" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-1735"><a href="#cb194-1735" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-1736"><a href="#cb194-1736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1737"><a href="#cb194-1737" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1738"><a href="#cb194-1738" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1739"><a href="#cb194-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1740"><a href="#cb194-1740" aria-hidden="true" tabindex="-1"></a>To see how the skewed distribution is different to the book&#39;s Figure 3.2</span>
<span id="cb194-1741"><a href="#cb194-1741" aria-hidden="true" tabindex="-1"></a>lower part, I will draw the appropriate figure here.</span>
<span id="cb194-1742"><a href="#cb194-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1743"><a href="#cb194-1743" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1744"><a href="#cb194-1744" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1745"><a href="#cb194-1745" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-prob-mass-skewed-dist}</span>
<span id="cb194-1746"><a href="#cb194-1746" aria-hidden="true" tabindex="-1"></a>b: Lower 80% and middle 80% of probability mass intervals in the skewed</span>
<span id="cb194-1747"><a href="#cb194-1747" aria-hidden="true" tabindex="-1"></a>distribution</span>
<span id="cb194-1748"><a href="#cb194-1748" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1749"><a href="#cb194-1749" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1750"><a href="#cb194-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1751"><a href="#cb194-1751" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1752"><a href="#cb194-1752" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1753"><a href="#cb194-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1754"><a href="#cb194-1754" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1755"><a href="#cb194-1755" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-prob-mass-skewed-dist</span></span>
<span id="cb194-1756"><a href="#cb194-1756" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Probability mass intervals in a skewed distribution. Left: Lower 80%. right: Middle 80% = 80% Percentile Interval (PI)&quot;</span></span>
<span id="cb194-1757"><a href="#cb194-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1758"><a href="#cb194-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1759"><a href="#cb194-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1760"><a href="#cb194-1760" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12b(2) PI &lt; 80 &amp; middle 80% #############################</span></span>
<span id="cb194-1761"><a href="#cb194-1761" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb194-1762"><a href="#cb194-1762" aria-hidden="true" tabindex="-1"></a>  samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1763"><a href="#cb194-1763" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb194-1764"><a href="#cb194-1764" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-1765"><a href="#cb194-1765" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1766"><a href="#cb194-1766" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(p_skewed_b <span class="sc">&lt;</span> q80), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1767"><a href="#cb194-1767" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb194-1768"><a href="#cb194-1768" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb194-1769"><a href="#cb194-1769" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;lower 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1770"><a href="#cb194-1770" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb194-1771"><a href="#cb194-1771" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1772"><a href="#cb194-1772" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-1773"><a href="#cb194-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1774"><a href="#cb194-1774" aria-hidden="true" tabindex="-1"></a><span class="co"># upper right panel</span></span>
<span id="cb194-1775"><a href="#cb194-1775" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb194-1776"><a href="#cb194-1776" aria-hidden="true" tabindex="-1"></a>  samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1777"><a href="#cb194-1777" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb194-1778"><a href="#cb194-1778" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-1779"><a href="#cb194-1779" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-1780"><a href="#cb194-1780" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(p_skewed_b <span class="sc">&gt;</span> q10_q90[[<span class="dv">1</span>]] <span class="sc">&amp;</span> </span>
<span id="cb194-1781"><a href="#cb194-1781" aria-hidden="true" tabindex="-1"></a>                    p_skewed_b <span class="sc">&lt;</span> q10_q90[[<span class="dv">2</span>]]), <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1782"><a href="#cb194-1782" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb194-1783"><a href="#cb194-1783" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb194-1784"><a href="#cb194-1784" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;middle 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1785"><a href="#cb194-1785" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb194-1786"><a href="#cb194-1786" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-1787"><a href="#cb194-1787" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-1788"><a href="#cb194-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1789"><a href="#cb194-1789" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb194-1790"><a href="#cb194-1790" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb194-1791"><a href="#cb194-1791" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1792"><a href="#cb194-1792" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1793"><a href="#cb194-1793" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1794"><a href="#cb194-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1795"><a href="#cb194-1795" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Introducing tidybayes {.unnumbered}</span></span>
<span id="cb194-1796"><a href="#cb194-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1797"><a href="#cb194-1797" aria-hidden="true" tabindex="-1"></a>::: my-resource</span>
<span id="cb194-1798"><a href="#cb194-1798" aria-hidden="true" tabindex="-1"></a>::: my-resource-header</span>
<span id="cb194-1799"><a href="#cb194-1799" aria-hidden="true" tabindex="-1"></a>Introducing the {**tidybayes**} package by Matthew Kay</span>
<span id="cb194-1800"><a href="#cb194-1800" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1801"><a href="#cb194-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1802"><a href="#cb194-1802" aria-hidden="true" tabindex="-1"></a>::: my-resource-container</span>
<span id="cb194-1803"><a href="#cb194-1803" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">{**tidybayes**}</span><span class="co">](https://mjskay.github.io/tidybayes/)</span> package by</span>
<span id="cb194-1804"><a href="#cb194-1804" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Matthew Kay</span><span class="co">](https://www.mjskay.com/)</span> offers an array of convenience</span>
<span id="cb194-1805"><a href="#cb194-1805" aria-hidden="true" tabindex="-1"></a>functions for summarizing Bayesian models.</span>
<span id="cb194-1806"><a href="#cb194-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1807"><a href="#cb194-1807" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; {**tidybayes**} is an R package that aims to make it easy to integrate</span></span>
<span id="cb194-1808"><a href="#cb194-1808" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; popular Bayesian modeling methods into a tidy data + ggplot workflow.</span></span>
<span id="cb194-1809"><a href="#cb194-1809" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; It builds on top of (and re-exports) several functions for visualizing</span></span>
<span id="cb194-1810"><a href="#cb194-1810" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; uncertainty from its sister package,</span></span>
<span id="cb194-1811"><a href="#cb194-1811" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">{**ggdist**}</span><span class="co">](https://mjskay.github.io/ggdist/)</span><span class="at">.</span></span>
<span id="cb194-1812"><a href="#cb194-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1813"><a href="#cb194-1813" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For an introduction using {**tidybayes**} with {**brms**} see</span>
<span id="cb194-1814"><a href="#cb194-1814" aria-hidden="true" tabindex="-1"></a>    [Extracting and visualizing tidy draws from {**brms**}</span>
<span id="cb194-1815"><a href="#cb194-1815" aria-hidden="true" tabindex="-1"></a>    models](https://mjskay.github.io/tidybayes/articles/tidy-brms.html).</span>
<span id="cb194-1816"><a href="#cb194-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1817"><a href="#cb194-1817" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For a general introduction (not confined to {**brms**}) see [Using</span>
<span id="cb194-1818"><a href="#cb194-1818" aria-hidden="true" tabindex="-1"></a>    tidy data with Bayesian</span>
<span id="cb194-1819"><a href="#cb194-1819" aria-hidden="true" tabindex="-1"></a>    models](https://mjskay.github.io/tidybayes/articles/tidybayes.html)</span>
<span id="cb194-1820"><a href="#cb194-1820" aria-hidden="true" tabindex="-1"></a>    but read also the start page [tidybayes: Bayesian analysis + tidy</span>
<span id="cb194-1821"><a href="#cb194-1821" aria-hidden="true" tabindex="-1"></a>    data + geoms](https://mjskay.github.io/tidybayes/) of the package</span>
<span id="cb194-1822"><a href="#cb194-1822" aria-hidden="true" tabindex="-1"></a>    documentation.</span>
<span id="cb194-1823"><a href="#cb194-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1824"><a href="#cb194-1824" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Besides supporting many types of models there is an additional</span>
<span id="cb194-1825"><a href="#cb194-1825" aria-hidden="true" tabindex="-1"></a>    {**tidybayes.rethinking**} package [available on</span>
<span id="cb194-1826"><a href="#cb194-1826" aria-hidden="true" tabindex="-1"></a>    GitHub](https://mjskay.github.io/tidybayes.rethinking/) that extends</span>
<span id="cb194-1827"><a href="#cb194-1827" aria-hidden="true" tabindex="-1"></a>    {**tidybayes**} to work with the {**rethinking**} package. I think</span>
<span id="cb194-1828"><a href="#cb194-1828" aria-hidden="true" tabindex="-1"></a>    this package is a new development because Kurz didn&#39;t mention it.</span>
<span id="cb194-1829"><a href="#cb194-1829" aria-hidden="true" tabindex="-1"></a>    (As far as I know, because at the moment I have read his [version</span>
<span id="cb194-1830"><a href="#cb194-1830" aria-hidden="true" tabindex="-1"></a>    0.40](https://bookdown.org/content/4857/) only until chapter 4.)</span>
<span id="cb194-1831"><a href="#cb194-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1832"><a href="#cb194-1832" aria-hidden="true" tabindex="-1"></a>For the following parts the section on [Point Summaries and</span>
<span id="cb194-1833"><a href="#cb194-1833" aria-hidden="true" tabindex="-1"></a>Intervals](https://mjskay.github.io/tidybayes/articles/tidy-brms.html#point-summaries-and-intervals)</span>
<span id="cb194-1834"><a href="#cb194-1834" aria-hidden="true" tabindex="-1"></a>and the reference on [Point and interval summaries for tidy data frames</span>
<span id="cb194-1835"><a href="#cb194-1835" aria-hidden="true" tabindex="-1"></a>of draws from</span>
<span id="cb194-1836"><a href="#cb194-1836" aria-hidden="true" tabindex="-1"></a>distributions](https://mjskay.github.io/ggdist/reference/point_interval.html)</span>
<span id="cb194-1837"><a href="#cb194-1837" aria-hidden="true" tabindex="-1"></a>are especially important.</span>
<span id="cb194-1838"><a href="#cb194-1838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1839"><a href="#cb194-1839" aria-hidden="true" tabindex="-1"></a>The mentioned vignettes above are long articles I haven&#39;t read yet. I</span>
<span id="cb194-1840"><a href="#cb194-1840" aria-hidden="true" tabindex="-1"></a>plan to do this in the next future but for now I am concentrating and</span>
<span id="cb194-1841"><a href="#cb194-1841" aria-hidden="true" tabindex="-1"></a>trusting on Kurz&#39; text to apply and explain the most important function</span>
<span id="cb194-1842"><a href="#cb194-1842" aria-hidden="true" tabindex="-1"></a>parallel to McElreath book chapters.</span>
<span id="cb194-1843"><a href="#cb194-1843" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1844"><a href="#cb194-1844" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1845"><a href="#cb194-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1846"><a href="#cb194-1846" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb194-1847"><a href="#cb194-1847" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb194-1848"><a href="#cb194-1848" aria-hidden="true" tabindex="-1"></a>Many function names used by Kurz do not apply anymore</span>
<span id="cb194-1849"><a href="#cb194-1849" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1850"><a href="#cb194-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1851"><a href="#cb194-1851" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb194-1852"><a href="#cb194-1852" aria-hidden="true" tabindex="-1"></a>I had difficulties to use Kurz&#39;s functions because there was an</span>
<span id="cb194-1853"><a href="#cb194-1853" aria-hidden="true" tabindex="-1"></a>[overhaul in the naming</span>
<span id="cb194-1854"><a href="#cb194-1854" aria-hidden="true" tabindex="-1"></a>scheme](https://mjskay.github.io/tidybayes/reference/tidybayes-deprecated.html)</span>
<span id="cb194-1855"><a href="#cb194-1855" aria-hidden="true" tabindex="-1"></a>of {**tidybayes**} version 1.0 and a deprecation of horizontal shortcut</span>
<span id="cb194-1856"><a href="#cb194-1856" aria-hidden="true" tabindex="-1"></a>geoms and stats in {**tidybayes**} 2.1. Because {**tidybayes**}</span>
<span id="cb194-1857"><a href="#cb194-1857" aria-hidden="true" tabindex="-1"></a>integrates function of the sister package {**ggdist**} the [function</span>
<span id="cb194-1858"><a href="#cb194-1858" aria-hidden="true" tabindex="-1"></a>descriptions and references of</span>
<span id="cb194-1859"><a href="#cb194-1859" aria-hidden="true" tabindex="-1"></a>{**ggdist**}](https://mjskay.github.io/ggdist/reference/index.html) are</span>
<span id="cb194-1860"><a href="#cb194-1860" aria-hidden="true" tabindex="-1"></a>also important to consult. For instance all the function on [point and</span>
<span id="cb194-1861"><a href="#cb194-1861" aria-hidden="true" tabindex="-1"></a>interval</span>
<span id="cb194-1862"><a href="#cb194-1862" aria-hidden="true" tabindex="-1"></a>summaries](https://mjskay.github.io/ggdist/reference/point_interval.html)</span>
<span id="cb194-1863"><a href="#cb194-1863" aria-hidden="true" tabindex="-1"></a>are now documented in {**ggdist**}.</span>
<span id="cb194-1864"><a href="#cb194-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1865"><a href="#cb194-1865" aria-hidden="true" tabindex="-1"></a>There is a systematic change of the function names: The <span class="in">`h`</span> (for</span>
<span id="cb194-1866"><a href="#cb194-1866" aria-hidden="true" tabindex="-1"></a>&#39;horizontal&#39;) in parameter name of the point estimate was removed. For</span>
<span id="cb194-1867"><a href="#cb194-1867" aria-hidden="true" tabindex="-1"></a>instance: Instead of <span class="in">`median_qih()`</span>, <span class="in">`median_hdih()`</span> and <span class="in">`median_hdcih()`</span> it is now</span>
<span id="cb194-1868"><a href="#cb194-1868" aria-hidden="true" tabindex="-1"></a><span class="in">`tidybayes::median_qi()`</span>, <span class="in">`tidybayes::median_hdi()`</span> and</span>
<span id="cb194-1869"><a href="#cb194-1869" aria-hidden="true" tabindex="-1"></a><span class="in">`tidybayes::median_hdci()`</span>. Similar with <span class="in">`point_inverhalh()`</span>, <span class="in">`mean\_\*`</span> and</span>
<span id="cb194-1870"><a href="#cb194-1870" aria-hidden="true" tabindex="-1"></a><span class="in">`mode\_\*`</span>.</span>
<span id="cb194-1871"><a href="#cb194-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1872"><a href="#cb194-1872" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-1873"><a href="#cb194-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1874"><a href="#cb194-1874" aria-hidden="true" tabindex="-1"></a>There is another adaption compared to the Kurz&#39; version: I can&#39;t</span>
<span id="cb194-1875"><a href="#cb194-1875" aria-hidden="true" tabindex="-1"></a>reproduce the codes with his <span class="in">`samples`</span> (my <span class="in">`samples_b`</span>) data frame,</span>
<span id="cb194-1876"><a href="#cb194-1876" aria-hidden="true" tabindex="-1"></a>because the data has changed values recently to the skewed sampling</span>
<span id="cb194-1877"><a href="#cb194-1877" aria-hidden="true" tabindex="-1"></a>version. To get the same results as Kurz I have to use in my naming</span>
<span id="cb194-1878"><a href="#cb194-1878" aria-hidden="true" tabindex="-1"></a>scheme the <span class="in">`skewed`</span> version.</span>
<span id="cb194-1879"><a href="#cb194-1879" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1880"><a href="#cb194-1880" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1881"><a href="#cb194-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1882"><a href="#cb194-1882" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The {**tidybayes**} package contains a [family of</span></span>
<span id="cb194-1883"><a href="#cb194-1883" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; functions](https://mjskay.github.io/tidybayes/articles/tidy-brms.html#point-summaries-and-intervals)</span></span>
<span id="cb194-1884"><a href="#cb194-1884" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; that make it easy to summarize a distribution with a measure of</span></span>
<span id="cb194-1885"><a href="#cb194-1885" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; central tendency accompanied by intervals. With</span></span>
<span id="cb194-1886"><a href="#cb194-1886" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`tidybayes::median_qi()`</span><span class="at">, we will ask for the median and</span></span>
<span id="cb194-1887"><a href="#cb194-1887" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; quantile-based intervals --- just like we&#39;ve been doing with</span></span>
<span id="cb194-1888"><a href="#cb194-1888" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`stats::quantile()`</span><span class="at">.</span></span>
<span id="cb194-1889"><a href="#cb194-1889" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">Kurz</span><span class="co">](https://bookdown.org/content/4857/sampling-the-imaginary.html#intervals-of-defined-mass.)</span><span class="at">)</span></span>
<span id="cb194-1890"><a href="#cb194-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1891"><a href="#cb194-1891" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1892"><a href="#cb194-1892" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1893"><a href="#cb194-1893" aria-hidden="true" tabindex="-1"></a>::: {#cnj-median-qi}</span>
<span id="cb194-1894"><a href="#cb194-1894" aria-hidden="true" tabindex="-1"></a>: Computing the median quantile interval with {**tidybayes**}</span>
<span id="cb194-1895"><a href="#cb194-1895" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1896"><a href="#cb194-1896" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1897"><a href="#cb194-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1898"><a href="#cb194-1898" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1899"><a href="#cb194-1899" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1900"><a href="#cb194-1900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1901"><a href="#cb194-1901" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1902"><a href="#cb194-1902" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: median-quantile-interval</span></span>
<span id="cb194-1903"><a href="#cb194-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1904"><a href="#cb194-1904" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-1905"><a href="#cb194-1905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1906"><a href="#cb194-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1907"><a href="#cb194-1907" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Note how the </span><span class="in">`.width`</span><span class="at"> argument within </span><span class="in">`tidybayes::median_qi()`</span><span class="at"> worked</span></span>
<span id="cb194-1908"><a href="#cb194-1908" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the same way the </span><span class="in">`prob`</span><span class="at"> argument did within </span><span class="in">`rethinking::PI()`</span><span class="at">. With</span></span>
<span id="cb194-1909"><a href="#cb194-1909" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`.width = .5`</span><span class="at">, we indicated we wanted a quantile-based 50% interval,</span></span>
<span id="cb194-1910"><a href="#cb194-1910" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; which was returned in the </span><span class="in">`ymin`</span><span class="at"> and </span><span class="in">`ymax`</span><span class="at"> columns.</span></span>
<span id="cb194-1911"><a href="#cb194-1911" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1912"><a href="#cb194-1912" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1913"><a href="#cb194-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1914"><a href="#cb194-1914" aria-hidden="true" tabindex="-1"></a>::: my-note</span>
<span id="cb194-1915"><a href="#cb194-1915" aria-hidden="true" tabindex="-1"></a>::: my-note-header</span>
<span id="cb194-1916"><a href="#cb194-1916" aria-hidden="true" tabindex="-1"></a>::: {#cor-point-interval-summaries}</span>
<span id="cb194-1917"><a href="#cb194-1917" aria-hidden="true" tabindex="-1"></a>: Point and interval summaries for tidy data frames of draws from</span>
<span id="cb194-1918"><a href="#cb194-1918" aria-hidden="true" tabindex="-1"></a>distributions</span>
<span id="cb194-1919"><a href="#cb194-1919" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1920"><a href="#cb194-1920" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1921"><a href="#cb194-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1922"><a href="#cb194-1922" aria-hidden="true" tabindex="-1"></a>::: my-note-container</span>
<span id="cb194-1923"><a href="#cb194-1923" aria-hidden="true" tabindex="-1"></a>The <span class="in">`qi`</span> in <span class="in">`tidybayes::median_qi()`</span> stands for &quot;quantile interval&quot;. The</span>
<span id="cb194-1924"><a href="#cb194-1924" aria-hidden="true" tabindex="-1"></a>explanation of this function family (<span class="in">`median_qi()`</span>, <span class="in">`mean_qi()`</span> and</span>
<span id="cb194-1925"><a href="#cb194-1925" aria-hidden="true" tabindex="-1"></a><span class="in">`mode_qi()`</span>) is now documented in the {**ggdist**} package.</span>
<span id="cb194-1926"><a href="#cb194-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1927"><a href="#cb194-1927" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The </span><span class="in">`qi`</span><span class="at">-variants is the short form of the function family of</span></span>
<span id="cb194-1928"><a href="#cb194-1928" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`tidybayes::point_interval(..., .point = median, .interval = qi)`</span><span class="at">.</span></span>
<span id="cb194-1929"><a href="#cb194-1929" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb194-1930"><a href="#cb194-1930" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; There are several point intervals that {**tidybayes**} respectively</span></span>
<span id="cb194-1931"><a href="#cb194-1931" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; {**ggdist**} computes:</span></span>
<span id="cb194-1932"><a href="#cb194-1932" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb194-1933"><a href="#cb194-1933" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; -   **qi** yields the quantile interval (also known as the percentile</span></span>
<span id="cb194-1934"><a href="#cb194-1934" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     interval or equi-tailed interval) as a 1x2 matrix.</span></span>
<span id="cb194-1935"><a href="#cb194-1935" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; -   **hdi** yields the highest-density interval(s) (also known as the</span></span>
<span id="cb194-1936"><a href="#cb194-1936" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     highest posterior density interval). Note: If the distribution is</span></span>
<span id="cb194-1937"><a href="#cb194-1937" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     multimodal, hdi may return multiple intervals for each probability</span></span>
<span id="cb194-1938"><a href="#cb194-1938" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     level (these will be spread over rows). You may wish to use hdci</span></span>
<span id="cb194-1939"><a href="#cb194-1939" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     (below) instead if you want a single highest-density interval,</span></span>
<span id="cb194-1940"><a href="#cb194-1940" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     with the caveat that when the distribution is multimodal hdci is</span></span>
<span id="cb194-1941"><a href="#cb194-1941" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     not a highest-density interval.</span></span>
<span id="cb194-1942"><a href="#cb194-1942" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; -   **hdci** yields the highest-density continuous interval, also</span></span>
<span id="cb194-1943"><a href="#cb194-1943" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     known as the shortest probability interval. Note: If the</span></span>
<span id="cb194-1944"><a href="#cb194-1944" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     distribution is multimodal, this may not actually be the</span></span>
<span id="cb194-1945"><a href="#cb194-1945" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     highest-density interval (there may be a higher-density</span></span>
<span id="cb194-1946"><a href="#cb194-1946" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     discontinuous interval, which can be found using hdi).</span></span>
<span id="cb194-1947"><a href="#cb194-1947" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; -   **ll and ul** yield lower limits and upper limits, respectively</span></span>
<span id="cb194-1948"><a href="#cb194-1948" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     (where the opposite limit is set to either Inf or -Inf). ([ggdist</span></span>
<span id="cb194-1949"><a href="#cb194-1949" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     reference](https://mjskay.github.io/ggdist/reference/point_interval.html))</span></span>
<span id="cb194-1950"><a href="#cb194-1950" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1951"><a href="#cb194-1951" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1952"><a href="#cb194-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1953"><a href="#cb194-1953" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The {**tidybayes**} framework makes it easy to request multiple types</span></span>
<span id="cb194-1954"><a href="#cb194-1954" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; of intervals. In the following code chunk we&#39;ll request 50%, 80%, and</span></span>
<span id="cb194-1955"><a href="#cb194-1955" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 99% intervals.</span></span>
<span id="cb194-1956"><a href="#cb194-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1957"><a href="#cb194-1957" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1958"><a href="#cb194-1958" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1959"><a href="#cb194-1959" aria-hidden="true" tabindex="-1"></a>::: {#cnj-multiple-intervals-b}</span>
<span id="cb194-1960"><a href="#cb194-1960" aria-hidden="true" tabindex="-1"></a>b: Requesting multiple type of intervals with {**tidybayes**}</span>
<span id="cb194-1961"><a href="#cb194-1961" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1962"><a href="#cb194-1962" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1963"><a href="#cb194-1963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1964"><a href="#cb194-1964" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1965"><a href="#cb194-1965" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1966"><a href="#cb194-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1967"><a href="#cb194-1967" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1968"><a href="#cb194-1968" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: multiple-intervals-b</span></span>
<span id="cb194-1969"><a href="#cb194-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1970"><a href="#cb194-1970" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12b(3) different PIs ##############</span></span>
<span id="cb194-1971"><a href="#cb194-1971" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">8</span>, .<span class="dv">99</span>))</span>
<span id="cb194-1972"><a href="#cb194-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1973"><a href="#cb194-1973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-1974"><a href="#cb194-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1975"><a href="#cb194-1975" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The .width column in the output indexed which line presented which</span></span>
<span id="cb194-1976"><a href="#cb194-1976" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; interval. The value in the y column remained constant across rows.</span></span>
<span id="cb194-1977"><a href="#cb194-1977" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; That&#39;s because that column listed the measure of central tendency, the</span></span>
<span id="cb194-1978"><a href="#cb194-1978" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; median in this case.</span></span>
<span id="cb194-1979"><a href="#cb194-1979" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1980"><a href="#cb194-1980" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-1981"><a href="#cb194-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1982"><a href="#cb194-1982" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Highest Posterior Density Interval (HPDI)</span></span>
<span id="cb194-1983"><a href="#cb194-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1984"><a href="#cb194-1984" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Now let&#39;s use the </span><span class="in">`rethinking::HPDI()`</span><span class="at"> function to return 50% highest</span></span>
<span id="cb194-1985"><a href="#cb194-1985" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; posterior density intervals (HPDIs).</span></span>
<span id="cb194-1986"><a href="#cb194-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1987"><a href="#cb194-1987" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-1988"><a href="#cb194-1988" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-1989"><a href="#cb194-1989" aria-hidden="true" tabindex="-1"></a>::: {#cnj-rethinking-hpdi-b}</span>
<span id="cb194-1990"><a href="#cb194-1990" aria-hidden="true" tabindex="-1"></a>b: Compute Highest Posterior Density Interval (HPDI) (Rethinking /</span>
<span id="cb194-1991"><a href="#cb194-1991" aria-hidden="true" tabindex="-1"></a>Tidyverse)</span>
<span id="cb194-1992"><a href="#cb194-1992" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1993"><a href="#cb194-1993" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-1994"><a href="#cb194-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1995"><a href="#cb194-1995" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-1996"><a href="#cb194-1996" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-1997"><a href="#cb194-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-1998"><a href="#cb194-1998" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-1999"><a href="#cb194-1999" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rethinking-HPDI-b</span></span>
<span id="cb194-2000"><a href="#cb194-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2001"><a href="#cb194-2001" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(1) HPDI ###############################</span></span>
<span id="cb194-2002"><a href="#cb194-2002" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">prob =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2003"><a href="#cb194-2003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2004"><a href="#cb194-2004" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2005"><a href="#cb194-2005" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2006"><a href="#cb194-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2007"><a href="#cb194-2007" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The reason I introduce {**tidybayes**} now is that the functions of</span></span>
<span id="cb194-2008"><a href="#cb194-2008" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the {**brms**} package only support percentile-based intervals of the</span></span>
<span id="cb194-2009"><a href="#cb194-2009" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; type we computed with </span><span class="in">`quantile()`</span><span class="at"> and </span><span class="in">`median_qi()`</span><span class="at">. But</span></span>
<span id="cb194-2010"><a href="#cb194-2010" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; {**tidybayes**} also supports HPDIs.</span></span>
<span id="cb194-2011"><a href="#cb194-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2012"><a href="#cb194-2012" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb194-2013"><a href="#cb194-2013" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb194-2014"><a href="#cb194-2014" aria-hidden="true" tabindex="-1"></a>: Two Version for Highest Density Intervals</span>
<span id="cb194-2015"><a href="#cb194-2015" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2016"><a href="#cb194-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2017"><a href="#cb194-2017" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb194-2018"><a href="#cb194-2018" aria-hidden="true" tabindex="-1"></a>As already mentioned in @cor-point-interval-summaries there is <span class="in">`hdi`</span>and</span>
<span id="cb194-2019"><a href="#cb194-2019" aria-hidden="true" tabindex="-1"></a><span class="in">`hcdi`</span>. Both functions produce the same result in unimodal</span>
<span id="cb194-2020"><a href="#cb194-2020" aria-hidden="true" tabindex="-1"></a>distributions.</span>
<span id="cb194-2021"><a href="#cb194-2021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2022"><a href="#cb194-2022" aria-hidden="true" tabindex="-1"></a>But in the case of an extreme skewed distribution like our data frame</span>
<span id="cb194-2023"><a href="#cb194-2023" aria-hidden="true" tabindex="-1"></a>with the observation of 3 &#39;Water&#39; with 3 tosses the <span class="in">`tidybayes::hdi()`</span></span>
<span id="cb194-2024"><a href="#cb194-2024" aria-hidden="true" tabindex="-1"></a>functions generates an error.</span>
<span id="cb194-2025"><a href="#cb194-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2026"><a href="#cb194-2026" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Error in quantile.default(dist_y, probs = 1 - .width) :\</span></span>
<span id="cb194-2027"><a href="#cb194-2027" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; missing values and NaN&#39;s not allowed if &#39;na.rm&#39; is FALSE</span></span>
<span id="cb194-2028"><a href="#cb194-2028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2029"><a href="#cb194-2029" aria-hidden="true" tabindex="-1"></a>My error message with <span class="in">`hdi`</span> is in contrast to Kurz’ version where this function seems to work. BTW: I got the same error message providing the vector <span class="in">`samples_skewed_a`</span>.</span>
<span id="cb194-2030"><a href="#cb194-2030" aria-hidden="true" tabindex="-1"></a>from the Base R version.</span>
<span id="cb194-2031"><a href="#cb194-2031" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2032"><a href="#cb194-2032" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2033"><a href="#cb194-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2034"><a href="#cb194-2034" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2035"><a href="#cb194-2035" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2036"><a href="#cb194-2036" aria-hidden="true" tabindex="-1"></a>::: {#cnj-tidyverse-HPDI-b}</span>
<span id="cb194-2037"><a href="#cb194-2037" aria-hidden="true" tabindex="-1"></a>: High Density Intervals with {**tidybayes**}</span>
<span id="cb194-2038"><a href="#cb194-2038" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2039"><a href="#cb194-2039" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2040"><a href="#cb194-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2041"><a href="#cb194-2041" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2042"><a href="#cb194-2042" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-2043"><a href="#cb194-2043" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 6 W, n=9</span></span>
<span id="cb194-2044"><a href="#cb194-2044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2045"><a href="#cb194-2045" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2046"><a href="#cb194-2046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2047"><a href="#cb194-2047" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2048"><a href="#cb194-2048" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tidyverse-HPDI-b1</span></span>
<span id="cb194-2049"><a href="#cb194-2049" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-2050"><a href="#cb194-2050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2051"><a href="#cb194-2051" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(2a) HPDI 6 Water, 9 tosses #####################</span></span>
<span id="cb194-2052"><a href="#cb194-2052" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdi</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2053"><a href="#cb194-2053" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2054"><a href="#cb194-2054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2055"><a href="#cb194-2055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2056"><a href="#cb194-2056" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3 W, n=3</span></span>
<span id="cb194-2057"><a href="#cb194-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2058"><a href="#cb194-2058" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2059"><a href="#cb194-2059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2060"><a href="#cb194-2060" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2061"><a href="#cb194-2061" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tidyverse-HPDI-b2</span></span>
<span id="cb194-2062"><a href="#cb194-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2063"><a href="#cb194-2063" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(2b) HPDI 3 Water, 3 tosses #####################</span></span>
<span id="cb194-2064"><a href="#cb194-2064" aria-hidden="true" tabindex="-1"></a><span class="co"># tidybayes::mode_hdi(samples_skewed_b$p_skewed_b, .width = .5) # generates error</span></span>
<span id="cb194-2065"><a href="#cb194-2065" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2066"><a href="#cb194-2066" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2067"><a href="#cb194-2067" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2068"><a href="#cb194-2068" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2069"><a href="#cb194-2069" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2070"><a href="#cb194-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2071"><a href="#cb194-2071" aria-hidden="true" tabindex="-1"></a>In contrast to @cnj-multiple-intervals-b and @cnj-rethinking-hpdi-b we</span>
<span id="cb194-2072"><a href="#cb194-2072" aria-hidden="true" tabindex="-1"></a>used this time the mode as the measure of central tendency. With this</span>
<span id="cb194-2073"><a href="#cb194-2073" aria-hidden="true" tabindex="-1"></a>family of {**tidybayes**} functions, you specify the measure of central</span>
<span id="cb194-2074"><a href="#cb194-2074" aria-hidden="true" tabindex="-1"></a>tendency in the prefix (i.e., mean, median, or mode) and then the type</span>
<span id="cb194-2075"><a href="#cb194-2075" aria-hidden="true" tabindex="-1"></a>of interval you&#39;d like (i.e., <span class="in">`qi()`</span> or <span class="in">`hdci()`</span>).</span>
<span id="cb194-2076"><a href="#cb194-2076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2077"><a href="#cb194-2077" aria-hidden="true" tabindex="-1"></a>If all you want are the intervals without the measure of central</span>
<span id="cb194-2078"><a href="#cb194-2078" aria-hidden="true" tabindex="-1"></a>tendency or all that other technical information, {**tidybayes**} also</span>
<span id="cb194-2079"><a href="#cb194-2079" aria-hidden="true" tabindex="-1"></a>offers the handy <span class="in">`qi()`</span> and <span class="in">`hdi()`</span> functions.</span>
<span id="cb194-2080"><a href="#cb194-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2081"><a href="#cb194-2081" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2082"><a href="#cb194-2082" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2083"><a href="#cb194-2083" aria-hidden="true" tabindex="-1"></a>::: {#cnj-pi-4}</span>
<span id="cb194-2084"><a href="#cb194-2084" aria-hidden="true" tabindex="-1"></a>: Numbered R Code Title</span>
<span id="cb194-2085"><a href="#cb194-2085" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2086"><a href="#cb194-2086" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2087"><a href="#cb194-2087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2088"><a href="#cb194-2088" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2089"><a href="#cb194-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2090"><a href="#cb194-2090" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2091"><a href="#cb194-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2092"><a href="#cb194-2092" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2093"><a href="#cb194-2093" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pi-4</span></span>
<span id="cb194-2094"><a href="#cb194-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2095"><a href="#cb194-2095" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.12b4 PI 0.5 ##############################</span></span>
<span id="cb194-2096"><a href="#cb194-2096" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2097"><a href="#cb194-2097" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2098"><a href="#cb194-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2099"><a href="#cb194-2099" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2100"><a href="#cb194-2100" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2101"><a href="#cb194-2101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2102"><a href="#cb194-2102" aria-hidden="true" tabindex="-1"></a>We have now all necessary skills to plot book&#39;s Figure 3.3:</span>
<span id="cb194-2103"><a href="#cb194-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2104"><a href="#cb194-2104" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2105"><a href="#cb194-2105" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2106"><a href="#cb194-2106" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-pi-hpdi}</span>
<span id="cb194-2107"><a href="#cb194-2107" aria-hidden="true" tabindex="-1"></a>b: Plot the difference between percentile interval (PI) and highest</span>
<span id="cb194-2108"><a href="#cb194-2108" aria-hidden="true" tabindex="-1"></a>posterior density intervals (HPDI)</span>
<span id="cb194-2109"><a href="#cb194-2109" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2110"><a href="#cb194-2110" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2111"><a href="#cb194-2111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2112"><a href="#cb194-2112" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2113"><a href="#cb194-2113" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2114"><a href="#cb194-2114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2115"><a href="#cb194-2115" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2116"><a href="#cb194-2116" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pi-hpdi</span></span>
<span id="cb194-2117"><a href="#cb194-2117" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Reproduction of Figure 3.3 (p.57): The difference between percentile and highest posterior density compatibility intervals. The posterior density here corresponds to a flat prior and observing three water samples in three total tosses of the globe. Left: 50% percentile interval. This interval assigns equal mass (25%) to both the left and right tail. As a result, it omits the most probable parameter value, where p equals 1. Right: 50% highest posterior density interval, HPDI. This interval finds the narrowest region with 50% of the posterior probability. Such a region always includes the most probable parameter value.&quot;</span></span>
<span id="cb194-2118"><a href="#cb194-2118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2119"><a href="#cb194-2119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2120"><a href="#cb194-2120" aria-hidden="true" tabindex="-1"></a><span class="do">## R code Figure 3.3 #######################</span></span>
<span id="cb194-2121"><a href="#cb194-2121" aria-hidden="true" tabindex="-1"></a><span class="co"># left panel</span></span>
<span id="cb194-2122"><a href="#cb194-2122" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb194-2123"><a href="#cb194-2123" aria-hidden="true" tabindex="-1"></a>  samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2124"><a href="#cb194-2124" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb194-2125"><a href="#cb194-2125" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check out our sweet `qi()` indexing</span></span>
<span id="cb194-2126"><a href="#cb194-2126" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2127"><a href="#cb194-2127" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(p_skewed_b <span class="sc">&gt;</span></span>
<span id="cb194-2128"><a href="#cb194-2128" aria-hidden="true" tabindex="-1"></a>                tidybayes<span class="sc">::</span><span class="fu">qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">1</span>] <span class="sc">&amp;</span> </span>
<span id="cb194-2129"><a href="#cb194-2129" aria-hidden="true" tabindex="-1"></a>                     p_skewed_b <span class="sc">&lt;</span></span>
<span id="cb194-2130"><a href="#cb194-2130" aria-hidden="true" tabindex="-1"></a>                tidybayes<span class="sc">::</span><span class="fu">qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">2</span>]),</span>
<span id="cb194-2131"><a href="#cb194-2131" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2132"><a href="#cb194-2132" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-2133"><a href="#cb194-2133" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;50% Percentile Interval&quot;</span>,</span>
<span id="cb194-2134"><a href="#cb194-2134" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb194-2135"><a href="#cb194-2135" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2136"><a href="#cb194-2136" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-2137"><a href="#cb194-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2138"><a href="#cb194-2138" aria-hidden="true" tabindex="-1"></a><span class="co"># right panel</span></span>
<span id="cb194-2139"><a href="#cb194-2139" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb194-2140"><a href="#cb194-2140" aria-hidden="true" tabindex="-1"></a>  samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2141"><a href="#cb194-2141" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b, <span class="at">y =</span> posterior_skewed_b)) <span class="sc">+</span></span>
<span id="cb194-2142"><a href="#cb194-2142" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2143"><a href="#cb194-2143" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(p_skewed_b <span class="sc">&gt;</span> </span>
<span id="cb194-2144"><a href="#cb194-2144" aria-hidden="true" tabindex="-1"></a>                 tidybayes<span class="sc">::</span><span class="fu">hdci</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">1</span>] <span class="sc">&amp;</span> </span>
<span id="cb194-2145"><a href="#cb194-2145" aria-hidden="true" tabindex="-1"></a>                       p_skewed_b <span class="sc">&lt;</span> </span>
<span id="cb194-2146"><a href="#cb194-2146" aria-hidden="true" tabindex="-1"></a>                 tidybayes<span class="sc">::</span><span class="fu">hdci</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">2</span>]),</span>
<span id="cb194-2147"><a href="#cb194-2147" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2148"><a href="#cb194-2148" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-2149"><a href="#cb194-2149" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;50% HPDI&quot;</span>,</span>
<span id="cb194-2150"><a href="#cb194-2150" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb194-2151"><a href="#cb194-2151" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2152"><a href="#cb194-2152" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-2153"><a href="#cb194-2153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2154"><a href="#cb194-2154" aria-hidden="true" tabindex="-1"></a><span class="co"># combine!</span></span>
<span id="cb194-2155"><a href="#cb194-2155" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb194-2156"><a href="#cb194-2156" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span>
<span id="cb194-2157"><a href="#cb194-2157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2158"><a href="#cb194-2158" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2159"><a href="#cb194-2159" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2160"><a href="#cb194-2160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2161"><a href="#cb194-2161" aria-hidden="true" tabindex="-1"></a>Comparing the two panels of the plot you can see that in contrast to the</span>
<span id="cb194-2162"><a href="#cb194-2162" aria-hidden="true" tabindex="-1"></a>50% HPDI the 50% of PI does not include the highest probability value.</span>
<span id="cb194-2163"><a href="#cb194-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2164"><a href="#cb194-2164" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb194-2165"><a href="#cb194-2165" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb194-2166"><a href="#cb194-2166" aria-hidden="true" tabindex="-1"></a>{**magrittr**} and native R pipe</span>
<span id="cb194-2167"><a href="#cb194-2167" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2168"><a href="#cb194-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2169"><a href="#cb194-2169" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb194-2170"><a href="#cb194-2170" aria-hidden="true" tabindex="-1"></a>Kurz uses the {**magrittr**} paipe whereas I am using the native R pipe.</span>
<span id="cb194-2171"><a href="#cb194-2171" aria-hidden="true" tabindex="-1"></a>These two pipes are not in every aspect equivalent. One difference is</span>
<span id="cb194-2172"><a href="#cb194-2172" aria-hidden="true" tabindex="-1"></a>the dot (<span class="in">`.`</span>) syntax, &quot;since the dot syntax is a feature of</span>
<span id="cb194-2173"><a href="#cb194-2173" aria-hidden="true" tabindex="-1"></a>{**magrittr**} and not of base R.&quot; ([Understanding the native R</span>
<span id="cb194-2174"><a href="#cb194-2174" aria-hidden="true" tabindex="-1"></a>pipe](https://ivelasq.rbind.io/blog/understanding-the-r-pipe/#how-the-native-r-pipe-works)).</span>
<span id="cb194-2175"><a href="#cb194-2175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2176"><a href="#cb194-2176" aria-hidden="true" tabindex="-1"></a>The native pipe is available starting with R 4.1.0. It is constructed</span>
<span id="cb194-2177"><a href="#cb194-2177" aria-hidden="true" tabindex="-1"></a>with <span class="in">`|`</span> followed by <span class="in">`&gt;`</span> resulting in the symbol <span class="in">`|&gt;`</span> to differentiate</span>
<span id="cb194-2178"><a href="#cb194-2178" aria-hidden="true" tabindex="-1"></a>it from the {**magrittr**} pipe (<span class="in">`%&gt;%`</span>). To understand the details of</span>
<span id="cb194-2179"><a href="#cb194-2179" aria-hidden="true" tabindex="-1"></a>the differences of <span class="in">`|&gt;`</span> and the native R pipe <span class="in">`|&gt;`</span> read this elaborated</span>
<span id="cb194-2180"><a href="#cb194-2180" aria-hidden="true" tabindex="-1"></a>[blog article by Isabella</span>
<span id="cb194-2181"><a href="#cb194-2181" aria-hidden="true" tabindex="-1"></a>Velásquez](https://ivelasq.rbind.io/blog/understanding-the-r-pipe/index.html),</span>
<span id="cb194-2182"><a href="#cb194-2182" aria-hidden="true" tabindex="-1"></a>an employee of <span class="co">[</span><span class="ot">Posit</span><span class="co">](https://posit.co/)</span> (formerly RStudio).</span>
<span id="cb194-2183"><a href="#cb194-2183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2184"><a href="#cb194-2184" aria-hidden="true" tabindex="-1"></a>So the following trick does not work with the native R pipe:</span>
<span id="cb194-2185"><a href="#cb194-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2186"><a href="#cb194-2186" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In the geom_area() line for the HPDI plot, did you notice how we</span></span>
<span id="cb194-2187"><a href="#cb194-2187" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; replaced </span><span class="in">`data = samples_skewed_b`</span><span class="at"> with </span><span class="in">`data = .`</span><span class="at">? When using the</span></span>
<span id="cb194-2188"><a href="#cb194-2188" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; pipe (i.e., </span><span class="in">`%&gt;%`</span><span class="at">), you can use the </span><span class="in">`.`</span><span class="at"> as a placeholder for the</span></span>
<span id="cb194-2189"><a href="#cb194-2189" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; original data object. It&#39;s an odd and handy trick to know about.</span></span>
<span id="cb194-2190"><a href="#cb194-2190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2191"><a href="#cb194-2191" aria-hidden="true" tabindex="-1"></a>Therefore I had to replace the dot with the name of the data frame.</span>
<span id="cb194-2192"><a href="#cb194-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2193"><a href="#cb194-2193" aria-hidden="true" tabindex="-1"></a>Learn more of the [pipe function <span class="in">`%&gt;%`</span> of the {**magrittr**}</span>
<span id="cb194-2194"><a href="#cb194-2194" aria-hidden="true" tabindex="-1"></a>package](https://magrittr.tidyverse.org/reference/pipe.html) and about</span>
<span id="cb194-2195"><a href="#cb194-2195" aria-hidden="true" tabindex="-1"></a>the [base R native forward pipe</span>
<span id="cb194-2196"><a href="#cb194-2196" aria-hidden="true" tabindex="-1"></a>operator](https://stat.ethz.ch/R-manual/R-devel/library/base/html/pipeOp.html).</span>
<span id="cb194-2197"><a href="#cb194-2197" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2198"><a href="#cb194-2198" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2199"><a href="#cb194-2199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2200"><a href="#cb194-2200" aria-hidden="true" tabindex="-1"></a>PI and HPDI are only different if you have a very skewed distribution.</span>
<span id="cb194-2201"><a href="#cb194-2201" aria-hidden="true" tabindex="-1"></a>This means that in unimodal somewhat normal distribution <span class="in">`hdi`</span> and</span>
<span id="cb194-2202"><a href="#cb194-2202" aria-hidden="true" tabindex="-1"></a><span class="in">`hdci`</span> are exactly the same and pretty similar to <span class="in">`qi`</span> calculation. In</span>
<span id="cb194-2203"><a href="#cb194-2203" aria-hidden="true" tabindex="-1"></a>skewed distribution they differ. assertion:</span>
<span id="cb194-2204"><a href="#cb194-2204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2205"><a href="#cb194-2205" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2206"><a href="#cb194-2206" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2207"><a href="#cb194-2207" aria-hidden="true" tabindex="-1"></a>&lt;div&gt;</span>
<span id="cb194-2208"><a href="#cb194-2208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2209"><a href="#cb194-2209" aria-hidden="true" tabindex="-1"></a>b: High Density Intervals with {**tidybayes**}</span>
<span id="cb194-2210"><a href="#cb194-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2211"><a href="#cb194-2211" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb194-2212"><a href="#cb194-2212" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2213"><a href="#cb194-2213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2214"><a href="#cb194-2214" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2215"><a href="#cb194-2215" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-2216"><a href="#cb194-2216" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 6 W, n=9</span></span>
<span id="cb194-2217"><a href="#cb194-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2218"><a href="#cb194-2218" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2219"><a href="#cb194-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2220"><a href="#cb194-2220" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2221"><a href="#cb194-2221" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tidyverse-PI-HPDI-b1</span></span>
<span id="cb194-2222"><a href="#cb194-2222" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-2223"><a href="#cb194-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2224"><a href="#cb194-2224" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(2a) HPDI 6 Water, 9 tosses #####################</span></span>
<span id="cb194-2225"><a href="#cb194-2225" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdi</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2226"><a href="#cb194-2226" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2227"><a href="#cb194-2227" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(df_samples_b<span class="sc">$</span>samples_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2228"><a href="#cb194-2228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2229"><a href="#cb194-2229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2230"><a href="#cb194-2230" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3 W, n=3</span></span>
<span id="cb194-2231"><a href="#cb194-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2232"><a href="#cb194-2232" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2233"><a href="#cb194-2233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2234"><a href="#cb194-2234" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2235"><a href="#cb194-2235" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tidyverse-PI-HPDI-b2</span></span>
<span id="cb194-2236"><a href="#cb194-2236" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-2237"><a href="#cb194-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2238"><a href="#cb194-2238" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.13b(2b) HPDI 3 Water, 3 tosses #####################</span></span>
<span id="cb194-2239"><a href="#cb194-2239" aria-hidden="true" tabindex="-1"></a><span class="co"># tidybayes::mode_hdi(samples_skewed_b$p_skewed_b, .width = .5) # generates error</span></span>
<span id="cb194-2240"><a href="#cb194-2240" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2241"><a href="#cb194-2241" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b, <span class="at">.width =</span> .<span class="dv">5</span>)</span>
<span id="cb194-2242"><a href="#cb194-2242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2243"><a href="#cb194-2243" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2244"><a href="#cb194-2244" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2245"><a href="#cb194-2245" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2246"><a href="#cb194-2246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2247"><a href="#cb194-2247" aria-hidden="true" tabindex="-1"></a>Because of the disadvantages of <span class="in">`r glossary(&quot;HPDI&quot;)`</span> (more</span>
<span id="cb194-2248"><a href="#cb194-2248" aria-hidden="true" tabindex="-1"></a>computationally intensive, greater simulation variance and harder to</span>
<span id="cb194-2249"><a href="#cb194-2249" aria-hidden="true" tabindex="-1"></a>understand) Kurz will primarily stick to the PI-based intervals. And he</span>
<span id="cb194-2250"><a href="#cb194-2250" aria-hidden="true" tabindex="-1"></a>will not use the 5.5% and 94.5% <span class="in">`r glossary(&quot;quantile&quot;, &quot;quantiles&quot;)`</span></span>
<span id="cb194-2251"><a href="#cb194-2251" aria-hidden="true" tabindex="-1"></a>that are <span class="in">`r glossary(&quot;percentile&quot;, &quot;percentile intervals&quot;)`</span> boundaries,</span>
<span id="cb194-2252"><a href="#cb194-2252" aria-hidden="true" tabindex="-1"></a>corresponding to an 89% <span class="in">`r glossary(&quot;compatibility interval&quot;)`</span> but stick</span>
<span id="cb194-2253"><a href="#cb194-2253" aria-hidden="true" tabindex="-1"></a>to the 95% standard (frequentist) <span class="in">`r glossary(&quot;confidence interval&quot;)`</span>.</span>
<span id="cb194-2254"><a href="#cb194-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2255"><a href="#cb194-2255" aria-hidden="true" tabindex="-1"></a><span class="fu">### Point Estimates {#sec-chap-03-point-estimates}</span></span>
<span id="cb194-2256"><a href="#cb194-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2257"><a href="#cb194-2257" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ORIGINAL</span></span>
<span id="cb194-2258"><a href="#cb194-2258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2259"><a href="#cb194-2259" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Measures of Central Tendency</span></span>
<span id="cb194-2260"><a href="#cb194-2260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2261"><a href="#cb194-2261" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Given the entire posterior distribution, what value should you</span></span>
<span id="cb194-2262"><a href="#cb194-2262" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; report? This seems like an innocent question, but it is difficult to</span></span>
<span id="cb194-2263"><a href="#cb194-2263" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; answer. The Bayesian parameter estimate is precisely the entire</span></span>
<span id="cb194-2264"><a href="#cb194-2264" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; posterior distribution, which is not a single number, but instead a</span></span>
<span id="cb194-2265"><a href="#cb194-2265" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; function that maps each unique parameter value onto a plausibility</span></span>
<span id="cb194-2266"><a href="#cb194-2266" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; value. So really the most important thing to note is that you don&#39;t</span></span>
<span id="cb194-2267"><a href="#cb194-2267" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; have to choose a point estimate. It&#39;s hardly ever necessary and often</span></span>
<span id="cb194-2268"><a href="#cb194-2268" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; harmful. It discards information.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-2269"><a href="#cb194-2269" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 58](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-2270"><a href="#cb194-2270" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=77&amp;annotation=EVCFUS3F)</span><span class="at">)</span></span>
<span id="cb194-2271"><a href="#cb194-2271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2272"><a href="#cb194-2272" aria-hidden="true" tabindex="-1"></a>But whenever you have to do it, you must choose between mean, median and</span>
<span id="cb194-2273"><a href="#cb194-2273" aria-hidden="true" tabindex="-1"></a>MAP (= the parameter value with highest posterior probability, a</span>
<span id="cb194-2274"><a href="#cb194-2274" aria-hidden="true" tabindex="-1"></a>*maximum a posteriori*, essentially the &quot;peak&quot; or mode of the posterior</span>
<span id="cb194-2275"><a href="#cb194-2275" aria-hidden="true" tabindex="-1"></a>distribution.</span>
<span id="cb194-2276"><a href="#cb194-2276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2277"><a href="#cb194-2277" aria-hidden="true" tabindex="-1"></a>In the very skewed globe tossing example where we observed 3 waters out</span>
<span id="cb194-2278"><a href="#cb194-2278" aria-hidden="true" tabindex="-1"></a>of 3 tosses they are all different.</span>
<span id="cb194-2279"><a href="#cb194-2279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2280"><a href="#cb194-2280" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2281"><a href="#cb194-2281" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2282"><a href="#cb194-2282" aria-hidden="true" tabindex="-1"></a>::: {#cnj-point-estimates-a}</span>
<span id="cb194-2283"><a href="#cb194-2283" aria-hidden="true" tabindex="-1"></a>a: Compute MAP, median and mean</span>
<span id="cb194-2284"><a href="#cb194-2284" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2285"><a href="#cb194-2285" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2286"><a href="#cb194-2286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2287"><a href="#cb194-2287" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2288"><a href="#cb194-2288" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2289"><a href="#cb194-2289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2290"><a href="#cb194-2290" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2291"><a href="#cb194-2291" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: point-estimates-a</span></span>
<span id="cb194-2292"><a href="#cb194-2292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2293"><a href="#cb194-2293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2294"><a href="#cb194-2294" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.14a MAP (from grid) ###############</span></span>
<span id="cb194-2295"><a href="#cb194-2295" aria-hidden="true" tabindex="-1"></a>map_skewed_a_1 <span class="ot">&lt;-</span> p_grid_skewed_a[<span class="fu">which.max</span>(posterior_skewed_a)]</span>
<span id="cb194-2296"><a href="#cb194-2296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2297"><a href="#cb194-2297" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.15a MAP from posterior samples ################</span></span>
<span id="cb194-2298"><a href="#cb194-2298" aria-hidden="true" tabindex="-1"></a>map_skewed_a_2 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">chainmode</span>(samples_skewed_a, <span class="at">adj =</span> <span class="fl">0.01</span>)</span>
<span id="cb194-2299"><a href="#cb194-2299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2300"><a href="#cb194-2300" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.16a mean and median #############</span></span>
<span id="cb194-2301"><a href="#cb194-2301" aria-hidden="true" tabindex="-1"></a>mean_skewed_a <span class="ot">&lt;-</span> <span class="fu">mean</span>(samples_skewed_a)</span>
<span id="cb194-2302"><a href="#cb194-2302" aria-hidden="true" tabindex="-1"></a>median_skewed_a <span class="ot">&lt;-</span> <span class="fu">median</span>(samples_skewed_a)</span>
<span id="cb194-2303"><a href="#cb194-2303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2304"><a href="#cb194-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2305"><a href="#cb194-2305" aria-hidden="true" tabindex="-1"></a>**Results:**</span>
<span id="cb194-2306"><a href="#cb194-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2307"><a href="#cb194-2307" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MAP with <span class="in">`which.max()`</span> = <span class="in">`r map_skewed_a_1`</span></span>
<span id="cb194-2308"><a href="#cb194-2308" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MAP with <span class="in">`rethinking::chainmode()`</span> = <span class="in">`r map_skewed_a_2`</span></span>
<span id="cb194-2309"><a href="#cb194-2309" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mean: <span class="in">`r mean_skewed_a`</span></span>
<span id="cb194-2310"><a href="#cb194-2310" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Median: <span class="in">`r median_skewed_a`</span></span>
<span id="cb194-2311"><a href="#cb194-2311" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2312"><a href="#cb194-2312" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2313"><a href="#cb194-2313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2314"><a href="#cb194-2314" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb194-2315"><a href="#cb194-2315" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb194-2316"><a href="#cb194-2316" aria-hidden="true" tabindex="-1"></a>Difference between MAP and mode calculation?</span>
<span id="cb194-2317"><a href="#cb194-2317" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2318"><a href="#cb194-2318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2319"><a href="#cb194-2319" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb194-2320"><a href="#cb194-2320" aria-hidden="true" tabindex="-1"></a>I have observed small differences between the MAP calculation in</span>
<span id="cb194-2321"><a href="#cb194-2321" aria-hidden="true" tabindex="-1"></a>@cnj-point-estimates-a and the mode calculation of other packages. I</span>
<span id="cb194-2322"><a href="#cb194-2322" aria-hidden="true" tabindex="-1"></a>wonder why all these other methods give 0.95/0.96 whereas the MAP</span>
<span id="cb194-2323"><a href="#cb194-2323" aria-hidden="true" tabindex="-1"></a>calculation results in 0.99/1.0.</span>
<span id="cb194-2324"><a href="#cb194-2324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2325"><a href="#cb194-2325" aria-hidden="true" tabindex="-1"></a>One explanation I could think is that the mode is defined by the</span>
<span id="cb194-2326"><a href="#cb194-2326" aria-hidden="true" tabindex="-1"></a>*maximum frequency* of observations, whereas the MAP is calculated from</span>
<span id="cb194-2327"><a href="#cb194-2327" aria-hidden="true" tabindex="-1"></a>the *maximum of the weighted probability frequency* .</span>
<span id="cb194-2328"><a href="#cb194-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2329"><a href="#cb194-2329" aria-hidden="true" tabindex="-1"></a>But I am not sure. One thing I can say with some certainty is that MAP</span>
<span id="cb194-2330"><a href="#cb194-2330" aria-hidden="true" tabindex="-1"></a>seems [a complicated theoretical</span>
<span id="cb194-2331"><a href="#cb194-2331" aria-hidden="true" tabindex="-1"></a>construct](https://web.stanford.edu/class/archive/cs/cs109/cs109.1216/lectures/22_map.pdf)</span>
<span id="cb194-2332"><a href="#cb194-2332" aria-hidden="true" tabindex="-1"></a>and a [difficult computational</span>
<span id="cb194-2333"><a href="#cb194-2333" aria-hidden="true" tabindex="-1"></a>procedure](https://machinelearningmastery.com/maximum-a-posteriori-estimation/).</span>
<span id="cb194-2334"><a href="#cb194-2334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2335"><a href="#cb194-2335" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2336"><a href="#cb194-2336" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2337"><a href="#cb194-2337" aria-hidden="true" tabindex="-1"></a>::: {#cnj-map-mode}</span>
<span id="cb194-2338"><a href="#cb194-2338" aria-hidden="true" tabindex="-1"></a>a: Compare MAP and mode calculation of different packages</span>
<span id="cb194-2339"><a href="#cb194-2339" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2340"><a href="#cb194-2340" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2341"><a href="#cb194-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2342"><a href="#cb194-2342" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2343"><a href="#cb194-2343" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2344"><a href="#cb194-2344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2345"><a href="#cb194-2345" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2346"><a href="#cb194-2346" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: different-modes</span></span>
<span id="cb194-2347"><a href="#cb194-2347" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb194-2348"><a href="#cb194-2348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2349"><a href="#cb194-2349" aria-hidden="true" tabindex="-1"></a>m_skewed_1 <span class="ot">&lt;-</span> modeest<span class="sc">::</span><span class="fu">mlv</span>(samples_skewed_a, <span class="at">method =</span> <span class="st">&quot;mfv&quot;</span>)</span>
<span id="cb194-2350"><a href="#cb194-2350" aria-hidden="true" tabindex="-1"></a>m_skewed_2 <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">Mode</span>(samples_skewed_a)</span>
<span id="cb194-2351"><a href="#cb194-2351" aria-hidden="true" tabindex="-1"></a>m_skewed_3 <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">map_estimate</span>(samples_skewed_a)</span>
<span id="cb194-2352"><a href="#cb194-2352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2353"><a href="#cb194-2353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2354"><a href="#cb194-2354" aria-hidden="true" tabindex="-1"></a>Results of mode calculation with several packages:</span>
<span id="cb194-2355"><a href="#cb194-2355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2356"><a href="#cb194-2356" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`modeest::mlv()`</span>: <span class="in">`r m_skewed_1`</span></span>
<span id="cb194-2357"><a href="#cb194-2357" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`DescTools::Mode()`</span>: <span class="in">`r m_skewed_2`</span></span>
<span id="cb194-2358"><a href="#cb194-2358" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`bayestestR::map_estimate()`</span>: <span class="in">`r m_skewed_3`</span></span>
<span id="cb194-2359"><a href="#cb194-2359" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2360"><a href="#cb194-2360" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2361"><a href="#cb194-2361" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2362"><a href="#cb194-2362" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2363"><a href="#cb194-2363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2364"><a href="#cb194-2364" aria-hidden="true" tabindex="-1"></a>The graphical representation as shown in Figure 3.4 will be calculated</span>
<span id="cb194-2365"><a href="#cb194-2365" aria-hidden="true" tabindex="-1"></a>in the tidyverse version of this section. See:</span>
<span id="cb194-2366"><a href="#cb194-2366" aria-hidden="true" tabindex="-1"></a>@fig-left-panel-3-4-skewed-b for the left panel and @fig-prop-loss-b for</span>
<span id="cb194-2367"><a href="#cb194-2367" aria-hidden="true" tabindex="-1"></a>the right panel of Figure 3.4.</span>
<span id="cb194-2368"><a href="#cb194-2368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2369"><a href="#cb194-2369" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Loss function to support particular decisions</span></span>
<span id="cb194-2370"><a href="#cb194-2370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2371"><a href="#cb194-2371" aria-hidden="true" tabindex="-1"></a>&quot;One principled way to go beyond using the entire posterior as the</span>
<span id="cb194-2372"><a href="#cb194-2372" aria-hidden="true" tabindex="-1"></a>estimate is to choose a <span class="in">`r glossary(&quot;loss function&quot;)`</span>.&quot; ([McElreath,</span>
<span id="cb194-2373"><a href="#cb194-2373" aria-hidden="true" tabindex="-1"></a>2020, p. 59](zotero://select/groups/5243560/items/NFUEVASQ))</span>
<span id="cb194-2374"><a href="#cb194-2374" aria-hidden="true" tabindex="-1"></a>(<span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=78&amp;annotation=42KE9FFZ)</span>)</span>
<span id="cb194-2375"><a href="#cb194-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2376"><a href="#cb194-2376" aria-hidden="true" tabindex="-1"></a>::: my-important</span>
<span id="cb194-2377"><a href="#cb194-2377" aria-hidden="true" tabindex="-1"></a>::: my-important-header</span>
<span id="cb194-2378"><a href="#cb194-2378" aria-hidden="true" tabindex="-1"></a>Different loss functions imply different point estimates. ([McElreath,</span>
<span id="cb194-2379"><a href="#cb194-2379" aria-hidden="true" tabindex="-1"></a>2020, p. 59](zotero://select/groups/5243560/items/NFUEVASQ))</span>
<span id="cb194-2380"><a href="#cb194-2380" aria-hidden="true" tabindex="-1"></a>(<span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=78&amp;annotation=3X2FI82B)</span>)</span>
<span id="cb194-2381"><a href="#cb194-2381" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2382"><a href="#cb194-2382" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2383"><a href="#cb194-2383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2384"><a href="#cb194-2384" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Here&#39;s an example to help us work through the procedure. Suppose I</span></span>
<span id="cb194-2385"><a href="#cb194-2385" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; offer you a bet. Tell me which value of p, the proportion of water on</span></span>
<span id="cb194-2386"><a href="#cb194-2386" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the Earth, you think is correct. I will pay you $\$100$, if you get it</span></span>
<span id="cb194-2387"><a href="#cb194-2387" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; exactly right. But I will subtract money from your gain, proportional</span></span>
<span id="cb194-2388"><a href="#cb194-2388" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; to the distance of your decision from the correct value. Precisely,</span></span>
<span id="cb194-2389"><a href="#cb194-2389" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; your loss is proportional to the absolute value of $d − p$, where $d$</span></span>
<span id="cb194-2390"><a href="#cb194-2390" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; is your decision and $p$ is the correct answer. We could change the</span></span>
<span id="cb194-2391"><a href="#cb194-2391" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; precise dollar values involved, without changing the important aspects</span></span>
<span id="cb194-2392"><a href="#cb194-2392" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; of this // problem. What matters is that the loss is proportional to</span></span>
<span id="cb194-2393"><a href="#cb194-2393" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the distance of your decision from the true value. Now once you have</span></span>
<span id="cb194-2394"><a href="#cb194-2394" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the posterior distribution in hand, how should you use it to maximize</span></span>
<span id="cb194-2395"><a href="#cb194-2395" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; your expected winnings? It turns out that the parameter value that</span></span>
<span id="cb194-2396"><a href="#cb194-2396" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; maximizes expected winnings (minimizes expected loss) is the median of</span></span>
<span id="cb194-2397"><a href="#cb194-2397" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the posterior distribution.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-2398"><a href="#cb194-2398" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 59/60](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-2399"><a href="#cb194-2399" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=79&amp;annotation=59IS3PFL)</span><span class="at">)</span></span>
<span id="cb194-2400"><a href="#cb194-2400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2401"><a href="#cb194-2401" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Calculating expected loss for any given decision means using the</span></span>
<span id="cb194-2402"><a href="#cb194-2402" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; posterior to average over our uncertainty in the true value. Of course</span></span>
<span id="cb194-2403"><a href="#cb194-2403" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; we don&#39;t know the true value, in most cases. But if we are going to</span></span>
<span id="cb194-2404"><a href="#cb194-2404" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; use our model&#39;s information about the parameter, that means using the</span></span>
<span id="cb194-2405"><a href="#cb194-2405" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; entire posterior distribution. So suppose we decide $p = 0.5$ will be</span></span>
<span id="cb194-2406"><a href="#cb194-2406" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; our decision.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-2407"><a href="#cb194-2407" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 60](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-2408"><a href="#cb194-2408" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=79&amp;annotation=UTEYE7VX)</span><span class="at">).</span></span>
<span id="cb194-2409"><a href="#cb194-2409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2410"><a href="#cb194-2410" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2411"><a href="#cb194-2411" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2412"><a href="#cb194-2412" aria-hidden="true" tabindex="-1"></a>::: {#cnj-expected-loss-a}</span>
<span id="cb194-2413"><a href="#cb194-2413" aria-hidden="true" tabindex="-1"></a>a: Calculated expected loss for $p = 0.5$</span>
<span id="cb194-2414"><a href="#cb194-2414" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2415"><a href="#cb194-2415" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2416"><a href="#cb194-2416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2417"><a href="#cb194-2417" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2418"><a href="#cb194-2418" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2419"><a href="#cb194-2419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2420"><a href="#cb194-2420" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2421"><a href="#cb194-2421" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: expected-loss-a</span></span>
<span id="cb194-2422"><a href="#cb194-2422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2423"><a href="#cb194-2423" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.17a weighted average loss ##################</span></span>
<span id="cb194-2424"><a href="#cb194-2424" aria-hidden="true" tabindex="-1"></a>loss_avg_a <span class="ot">&lt;-</span> <span class="fu">sum</span>(posterior_skewed_a <span class="sc">*</span> <span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> p_grid_skewed_a))</span>
<span id="cb194-2425"><a href="#cb194-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2426"><a href="#cb194-2426" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.18a for every possible value #############################</span></span>
<span id="cb194-2427"><a href="#cb194-2427" aria-hidden="true" tabindex="-1"></a>loss_a <span class="ot">&lt;-</span> <span class="fu">sapply</span>(p_grid_skewed_a, </span>
<span id="cb194-2428"><a href="#cb194-2428" aria-hidden="true" tabindex="-1"></a>     <span class="cf">function</span>(d) <span class="fu">sum</span>(posterior_skewed_a <span class="sc">*</span> <span class="fu">abs</span>(d <span class="sc">-</span> p_grid_skewed_a)))</span>
<span id="cb194-2429"><a href="#cb194-2429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2430"><a href="#cb194-2430" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.19a minimized loss value #############################</span></span>
<span id="cb194-2431"><a href="#cb194-2431" aria-hidden="true" tabindex="-1"></a>loss_min_a <span class="ot">&lt;-</span> p_grid_skewed_a[<span class="fu">which.min</span>(loss_a)]</span>
<span id="cb194-2432"><a href="#cb194-2432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2433"><a href="#cb194-2433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2434"><a href="#cb194-2434" aria-hidden="true" tabindex="-1"></a>**Results:**</span>
<span id="cb194-2435"><a href="#cb194-2435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2436"><a href="#cb194-2436" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Weighted average loss value = <span class="in">`r loss_avg_a`</span>.</span>
<span id="cb194-2437"><a href="#cb194-2437" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter value that minimizes the loss = <span class="in">`r loss_min_a`</span>. This is</span>
<span id="cb194-2438"><a href="#cb194-2438" aria-hidden="true" tabindex="-1"></a>    the posterior median that we already have calculated in @cnj-point-estimates-a. Because of sampling variation it is not identical but pretty close (<span class="in">`r median_skewed_a`</span> versus</span>
<span id="cb194-2439"><a href="#cb194-2439" aria-hidden="true" tabindex="-1"></a>    <span class="in">`r loss_min_a`</span>).</span>
<span id="cb194-2440"><a href="#cb194-2440" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2441"><a href="#cb194-2441" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2442"><a href="#cb194-2442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2443"><a href="#cb194-2443" aria-hidden="true" tabindex="-1"></a>::: my-important</span>
<span id="cb194-2444"><a href="#cb194-2444" aria-hidden="true" tabindex="-1"></a>::: my-important-header</span>
<span id="cb194-2445"><a href="#cb194-2445" aria-hidden="true" tabindex="-1"></a>Learnings: Point estimates</span>
<span id="cb194-2446"><a href="#cb194-2446" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2447"><a href="#cb194-2447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2448"><a href="#cb194-2448" aria-hidden="true" tabindex="-1"></a>::: my-important-container</span>
<span id="cb194-2449"><a href="#cb194-2449" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;In order to decide upon a *point estimate*, a single-value summary of</span></span>
<span id="cb194-2450"><a href="#cb194-2450" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the posterior distribution, we need to pick a loss function. Different</span></span>
<span id="cb194-2451"><a href="#cb194-2451" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; loss functions nominate different point estimates. The two most common</span></span>
<span id="cb194-2452"><a href="#cb194-2452" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; examples are the absolute loss as above, which leads to the median as</span></span>
<span id="cb194-2453"><a href="#cb194-2453" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the point estimate, and the quadratic loss $(d − p)^{2}$, which leads</span></span>
<span id="cb194-2454"><a href="#cb194-2454" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; to the posterior mean (</span><span class="in">`mean(samples_a)`</span><span class="at">) as the point estimate. When</span></span>
<span id="cb194-2455"><a href="#cb194-2455" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the posterior distribution is symmetrical and normal-looking, then the</span></span>
<span id="cb194-2456"><a href="#cb194-2456" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; median and mean converge to the same point, which relaxes some anxiety</span></span>
<span id="cb194-2457"><a href="#cb194-2457" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; we might have about choosing a loss function. For the original globe</span></span>
<span id="cb194-2458"><a href="#cb194-2458" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; tossing data (6 waters in 9 tosses), for example, the mean and median</span></span>
<span id="cb194-2459"><a href="#cb194-2459" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; are barely different.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-2460"><a href="#cb194-2460" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 60](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-2461"><a href="#cb194-2461" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=79&amp;annotation=JHGI3FVY)</span><span class="at">)</span></span>
<span id="cb194-2462"><a href="#cb194-2462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2463"><a href="#cb194-2463" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Usually, research scientists don&#39;t think about loss functions. And so</span></span>
<span id="cb194-2464"><a href="#cb194-2464" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; any point estimate like the mean or MAP that they may report isn&#39;t</span></span>
<span id="cb194-2465"><a href="#cb194-2465" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; intended to support any particular decision, but rather to describe</span></span>
<span id="cb194-2466"><a href="#cb194-2466" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the shape of the posterior. You might argue that the decision to make</span></span>
<span id="cb194-2467"><a href="#cb194-2467" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; is whether or not to accept an hypothesis. But the challenge then is</span></span>
<span id="cb194-2468"><a href="#cb194-2468" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; to say what the relevant costs and benefits would be, in terms of the</span></span>
<span id="cb194-2469"><a href="#cb194-2469" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; knowledge gained or lost. Usually it&#39;s better to communicate as much</span></span>
<span id="cb194-2470"><a href="#cb194-2470" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; as you can about the posterior distribution, as well as the data and</span></span>
<span id="cb194-2471"><a href="#cb194-2471" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the model itself, so that others can build upon your work. Premature</span></span>
<span id="cb194-2472"><a href="#cb194-2472" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; decisions to accept or reject hypotheses can cost lives.&quot; ([McElreath,</span></span>
<span id="cb194-2473"><a href="#cb194-2473" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 2020, p. 61](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-2474"><a href="#cb194-2474" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=80&amp;annotation=6GVPUF4Z)</span><span class="at">)</span></span>
<span id="cb194-2475"><a href="#cb194-2475" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-2476"><a href="#cb194-2476" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-2477"><a href="#cb194-2477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2478"><a href="#cb194-2478" aria-hidden="true" tabindex="-1"></a><span class="fu">#### TIDYVERSE</span></span>
<span id="cb194-2479"><a href="#cb194-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2480"><a href="#cb194-2480" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Measures of Central Tendency</span></span>
<span id="cb194-2481"><a href="#cb194-2481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2482"><a href="#cb194-2482" aria-hidden="true" tabindex="-1"></a>If we sort the posterior values of <span class="in">`d_skewed_b`</span> (three tosses with three</span>
<span id="cb194-2483"><a href="#cb194-2483" aria-hidden="true" tabindex="-1"></a><span class="in">`W`</span>) from highest to lowest values then the first row (= the maximum</span>
<span id="cb194-2484"><a href="#cb194-2484" aria-hidden="true" tabindex="-1"></a>value of <span class="in">`posterior_skewed_b`</span>) will give us the MAP as the corresponding</span>
<span id="cb194-2485"><a href="#cb194-2485" aria-hidden="true" tabindex="-1"></a><span class="in">`p_grid_b`</span> value. Additionally the {**tidybayes**} has other options to</span>
<span id="cb194-2486"><a href="#cb194-2486" aria-hidden="true" tabindex="-1"></a>compute the MAP. To calculate mean and median we will use the Base R</span>
<span id="cb194-2487"><a href="#cb194-2487" aria-hidden="true" tabindex="-1"></a>functions. In the following code chunk I have collected all these</span>
<span id="cb194-2488"><a href="#cb194-2488" aria-hidden="true" tabindex="-1"></a>different calculations.</span>
<span id="cb194-2489"><a href="#cb194-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2490"><a href="#cb194-2490" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2491"><a href="#cb194-2491" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2492"><a href="#cb194-2492" aria-hidden="true" tabindex="-1"></a>::: {#cnj-point-estimates-b}</span>
<span id="cb194-2493"><a href="#cb194-2493" aria-hidden="true" tabindex="-1"></a>b: Compute MAP, median and mean</span>
<span id="cb194-2494"><a href="#cb194-2494" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2495"><a href="#cb194-2495" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2496"><a href="#cb194-2496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2497"><a href="#cb194-2497" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2498"><a href="#cb194-2498" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2499"><a href="#cb194-2499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2500"><a href="#cb194-2500" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2501"><a href="#cb194-2501" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: point-estimates-b</span></span>
<span id="cb194-2502"><a href="#cb194-2502" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-2503"><a href="#cb194-2503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2504"><a href="#cb194-2504" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.14b MAP (from grid) ###############################</span></span>
<span id="cb194-2505"><a href="#cb194-2505" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;MAP computed with dplyr::arrange(dplyr::desc())</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-2506"><a href="#cb194-2506" aria-hidden="true" tabindex="-1"></a>map_skewed_b <span class="ot">&lt;-</span> d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2507"><a href="#cb194-2507" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(posterior_skewed_b)) </span>
<span id="cb194-2508"><a href="#cb194-2508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2509"><a href="#cb194-2509" aria-hidden="true" tabindex="-1"></a>map_skewed_b[<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)]</span>
<span id="cb194-2510"><a href="#cb194-2510" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-2511"><a href="#cb194-2511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2512"><a href="#cb194-2512" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.15b MAP (from posterior sample) ###############################</span></span>
<span id="cb194-2513"><a href="#cb194-2513" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;MAP computed with tidybayes::mode_qi()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-2514"><a href="#cb194-2514" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(p_skewed_b)</span>
<span id="cb194-2515"><a href="#cb194-2515" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-2516"><a href="#cb194-2516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2517"><a href="#cb194-2517" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;MAP computed with tidybayes::mode_hdci()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-2518"><a href="#cb194-2518" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(p_skewed_b)</span>
<span id="cb194-2519"><a href="#cb194-2519" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-2520"><a href="#cb194-2520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2521"><a href="#cb194-2521" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;MAP computed with tidybayes::Mode()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-2522"><a href="#cb194-2522" aria-hidden="true" tabindex="-1"></a>tidybayes<span class="sc">::</span><span class="fu">Mode</span>(samples_skewed_b<span class="sc">$</span>p_skewed_b)</span>
<span id="cb194-2523"><a href="#cb194-2523" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;#####################################################</span><span class="sc">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-2524"><a href="#cb194-2524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2525"><a href="#cb194-2525" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.16b mean and median #############################</span></span>
<span id="cb194-2526"><a href="#cb194-2526" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;Mean &amp; Median computed with mean() &amp; median()</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-2527"><a href="#cb194-2527" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2528"><a href="#cb194-2528" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean   =</span> <span class="fu">mean</span>(p_skewed_b),</span>
<span id="cb194-2529"><a href="#cb194-2529" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(p_skewed_b))</span>
<span id="cb194-2530"><a href="#cb194-2530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2531"><a href="#cb194-2531" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2532"><a href="#cb194-2532" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2533"><a href="#cb194-2533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2534"><a href="#cb194-2534" aria-hidden="true" tabindex="-1"></a>We can now plot a graph to reproduce the left panel of the books Figure</span>
<span id="cb194-2535"><a href="#cb194-2535" aria-hidden="true" tabindex="-1"></a>3.4 where we will see the three different measures of central tendency.</span>
<span id="cb194-2536"><a href="#cb194-2536" aria-hidden="true" tabindex="-1"></a>I will compare the skewed (three &#39;W&#39;, three tosses) with the somewhat</span>
<span id="cb194-2537"><a href="#cb194-2537" aria-hidden="true" tabindex="-1"></a>normal version (six &#39;W&#39;, nine tosses).</span>
<span id="cb194-2538"><a href="#cb194-2538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2539"><a href="#cb194-2539" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2540"><a href="#cb194-2540" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2541"><a href="#cb194-2541" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-left-panel-3-4-b}</span>
<span id="cb194-2542"><a href="#cb194-2542" aria-hidden="true" tabindex="-1"></a>: Posterior density for skewed and symmetric distribution</span>
<span id="cb194-2543"><a href="#cb194-2543" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2544"><a href="#cb194-2544" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2545"><a href="#cb194-2545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2546"><a href="#cb194-2546" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2547"><a href="#cb194-2547" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-2548"><a href="#cb194-2548" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3W, n=3</span></span>
<span id="cb194-2549"><a href="#cb194-2549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2550"><a href="#cb194-2550" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2551"><a href="#cb194-2551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2552"><a href="#cb194-2552" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2553"><a href="#cb194-2553" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-left-panel-3-4-skewed-b</span></span>
<span id="cb194-2554"><a href="#cb194-2554" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Posterior distribution after observing 3 &#39;water&#39; in 3 tosses of the globe. Vertical lines show the locations of the mode, median, and mean. All three measures of central tendency differ because of the skewness of the distribution. Therefore each point implies a different loss function. &quot;</span></span>
<span id="cb194-2555"><a href="#cb194-2555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2556"><a href="#cb194-2556" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. bundle three types of estimates into a tibble. #######</span></span>
<span id="cb194-2557"><a href="#cb194-2557" aria-hidden="true" tabindex="-1"></a>point_estimates_b1 <span class="ot">&lt;-</span></span>
<span id="cb194-2558"><a href="#cb194-2558" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mean_qi</span>(p_skewed_b),</span>
<span id="cb194-2559"><a href="#cb194-2559" aria-hidden="true" tabindex="-1"></a>            samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(p_skewed_b),</span>
<span id="cb194-2560"><a href="#cb194-2560" aria-hidden="true" tabindex="-1"></a>            samples_skewed_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(p_skewed_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2561"><a href="#cb194-2561" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(p_skewed_b, .point) <span class="sc">|&gt;</span> </span>
<span id="cb194-2562"><a href="#cb194-2562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2563"><a href="#cb194-2563" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. create two columns to annotate the plot #######</span></span>
<span id="cb194-2564"><a href="#cb194-2564" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">x =</span> p_skewed_b <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">03</span>, .<span class="dv">03</span>, <span class="sc">-</span>.<span class="dv">03</span>),</span>
<span id="cb194-2565"><a href="#cb194-2565" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">0005</span>, .<span class="dv">0012</span>, .<span class="dv">002</span>))</span>
<span id="cb194-2566"><a href="#cb194-2566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2567"><a href="#cb194-2567" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. plot #######</span></span>
<span id="cb194-2568"><a href="#cb194-2568" aria-hidden="true" tabindex="-1"></a>samples_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2569"><a href="#cb194-2569" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_skewed_b)) <span class="sc">+</span></span>
<span id="cb194-2570"><a href="#cb194-2570" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> posterior_skewed_b),</span>
<span id="cb194-2571"><a href="#cb194-2571" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2572"><a href="#cb194-2572" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> point_estimates_b1<span class="sc">$</span>p_skewed_b) <span class="sc">+</span></span>
<span id="cb194-2573"><a href="#cb194-2573" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="at">data =</span> point_estimates_b1,</span>
<span id="cb194-2574"><a href="#cb194-2574" aria-hidden="true" tabindex="-1"></a>            ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> .point),</span>
<span id="cb194-2575"><a href="#cb194-2575" aria-hidden="true" tabindex="-1"></a>            <span class="at">angle =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb194-2576"><a href="#cb194-2576" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb194-2577"><a href="#cb194-2577" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2578"><a href="#cb194-2578" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-2579"><a href="#cb194-2579" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-2580"><a href="#cb194-2580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2581"><a href="#cb194-2581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2582"><a href="#cb194-2582" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 6W, n=9</span></span>
<span id="cb194-2583"><a href="#cb194-2583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2584"><a href="#cb194-2584" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2585"><a href="#cb194-2585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2586"><a href="#cb194-2586" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2587"><a href="#cb194-2587" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-left-panel-3-4-sym-b</span></span>
<span id="cb194-2588"><a href="#cb194-2588" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Point estimates in the almost symmetrical distribution of 6 &#39;water&#39; in 9 tosses. Vertical lines show the locations of the mode, median, and mean. All three points are in a similar locatioon and have approximately the same loss function.&quot;</span></span>
<span id="cb194-2589"><a href="#cb194-2589" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb194-2590"><a href="#cb194-2590" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb194-2591"><a href="#cb194-2591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2592"><a href="#cb194-2592" aria-hidden="true" tabindex="-1"></a><span class="do">## 0. compute mode with different method</span></span>
<span id="cb194-2593"><a href="#cb194-2593" aria-hidden="true" tabindex="-1"></a>mode2_b <span class="ot">&lt;-</span> df_samples_b <span class="sc">|&gt;</span></span>
<span id="cb194-2594"><a href="#cb194-2594" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(posterior_samples_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2595"><a href="#cb194-2595" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-2596"><a href="#cb194-2596" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">.point =</span> prior_samples_b) <span class="sc">|&gt;</span> </span>
<span id="cb194-2597"><a href="#cb194-2597" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(samples_b, .point) <span class="sc">|&gt;</span> </span>
<span id="cb194-2598"><a href="#cb194-2598" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.point =</span> <span class="st">&quot;mode2&quot;</span>)</span>
<span id="cb194-2599"><a href="#cb194-2599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2600"><a href="#cb194-2600" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. bundle three types of estimates into a tibble ######</span></span>
<span id="cb194-2601"><a href="#cb194-2601" aria-hidden="true" tabindex="-1"></a>point_estimates_b2 <span class="ot">&lt;-</span></span>
<span id="cb194-2602"><a href="#cb194-2602" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(df_samples_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mean_qi</span>(samples_b),</span>
<span id="cb194-2603"><a href="#cb194-2603" aria-hidden="true" tabindex="-1"></a>            df_samples_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(samples_b),</span>
<span id="cb194-2604"><a href="#cb194-2604" aria-hidden="true" tabindex="-1"></a>            df_samples_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(samples_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2605"><a href="#cb194-2605" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(samples_b, .point) <span class="sc">|&gt;</span> </span>
<span id="cb194-2606"><a href="#cb194-2606" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(mode2_b) <span class="sc">|&gt;</span></span>
<span id="cb194-2607"><a href="#cb194-2607" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-2608"><a href="#cb194-2608" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. create two columns to annotate the plot #######</span></span>
<span id="cb194-2609"><a href="#cb194-2609" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">55</span>, .<span class="dv">55</span>, .<span class="dv">75</span>, .<span class="dv">75</span>),</span>
<span id="cb194-2610"><a href="#cb194-2610" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">0006</span>, .<span class="dv">0011</span>, .<span class="dv">0016</span>, .<span class="dv">0021</span>),</span>
<span id="cb194-2611"><a href="#cb194-2611" aria-hidden="true" tabindex="-1"></a>         <span class="at">x_start =</span> <span class="fu">c</span>(.<span class="dv">4</span>, .<span class="dv">4</span>, .<span class="dv">85</span>, .<span class="dv">85</span>),</span>
<span id="cb194-2612"><a href="#cb194-2612" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_line =</span> <span class="fu">c</span>(.<span class="dv">0005</span>, .<span class="dv">0010</span>, .<span class="dv">0015</span>, .<span class="dv">0020</span>),</span>
<span id="cb194-2613"><a href="#cb194-2613" aria-hidden="true" tabindex="-1"></a>         <span class="at">x_end =</span> point_estimates_b2<span class="sc">$</span>samples_b)</span>
<span id="cb194-2614"><a href="#cb194-2614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2615"><a href="#cb194-2615" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. plot #########</span></span>
<span id="cb194-2616"><a href="#cb194-2616" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2617"><a href="#cb194-2617" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b)) <span class="sc">+</span></span>
<span id="cb194-2618"><a href="#cb194-2618" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> posterior_samples_b),</span>
<span id="cb194-2619"><a href="#cb194-2619" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2620"><a href="#cb194-2620" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> point_estimates_b2<span class="sc">$</span>samples_b) <span class="sc">+</span></span>
<span id="cb194-2621"><a href="#cb194-2621" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="at">data =</span> point_estimates_b2,</span>
<span id="cb194-2622"><a href="#cb194-2622" aria-hidden="true" tabindex="-1"></a>            ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> .point)) <span class="sc">+</span></span>
<span id="cb194-2623"><a href="#cb194-2623" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb194-2624"><a href="#cb194-2624" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2625"><a href="#cb194-2625" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-2626"><a href="#cb194-2626" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb194-2627"><a href="#cb194-2627" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb194-2628"><a href="#cb194-2628" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(\(x) <span class="at">x =</span> point_estimates_b2<span class="sc">$</span>x_start[[<span class="dv">1</span>]],</span>
<span id="cb194-2629"><a href="#cb194-2629" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> point_estimates_b2<span class="sc">$</span>y_line[[<span class="dv">1</span>]], </span>
<span id="cb194-2630"><a href="#cb194-2630" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xend =</span> point_estimates_b2<span class="sc">$</span>samples_b[[<span class="dv">1</span>]], </span>
<span id="cb194-2631"><a href="#cb194-2631" aria-hidden="true" tabindex="-1"></a>                 <span class="at">yend =</span> point_estimates_b2<span class="sc">$</span>y_line[[<span class="dv">1</span>]]),</span>
<span id="cb194-2632"><a href="#cb194-2632" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>)))</span>
<span id="cb194-2633"><a href="#cb194-2633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2634"><a href="#cb194-2634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2635"><a href="#cb194-2635" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2636"><a href="#cb194-2636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2637"><a href="#cb194-2637" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2638"><a href="#cb194-2638" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-left-panel-3-4-sym-b2</span></span>
<span id="cb194-2639"><a href="#cb194-2639" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Point estimates in the almost symmetrical distribution of 6 &#39;water&#39; in 9 tosses. Vertical lines show the locations of the mode, median, and mean. All three points are in a similar locatioon and have approximately the same loss function.&quot;</span></span>
<span id="cb194-2640"><a href="#cb194-2640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2641"><a href="#cb194-2641" aria-hidden="true" tabindex="-1"></a><span class="do">## 0. compute mode with different method</span></span>
<span id="cb194-2642"><a href="#cb194-2642" aria-hidden="true" tabindex="-1"></a>mode2_b <span class="ot">&lt;-</span> df_samples_b <span class="sc">|&gt;</span></span>
<span id="cb194-2643"><a href="#cb194-2643" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(posterior_samples_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2644"><a href="#cb194-2644" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-2645"><a href="#cb194-2645" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">.point =</span> prior_samples_b) <span class="sc">|&gt;</span> </span>
<span id="cb194-2646"><a href="#cb194-2646" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(samples_b, .point) <span class="sc">|&gt;</span> </span>
<span id="cb194-2647"><a href="#cb194-2647" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.point =</span> <span class="st">&quot;mode2&quot;</span>)</span>
<span id="cb194-2648"><a href="#cb194-2648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2649"><a href="#cb194-2649" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. bundle three types of estimates into a tibble ######</span></span>
<span id="cb194-2650"><a href="#cb194-2650" aria-hidden="true" tabindex="-1"></a>point_estimates_b2 <span class="ot">&lt;-</span></span>
<span id="cb194-2651"><a href="#cb194-2651" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(df_samples_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mean_qi</span>(samples_b),</span>
<span id="cb194-2652"><a href="#cb194-2652" aria-hidden="true" tabindex="-1"></a>            df_samples_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(samples_b),</span>
<span id="cb194-2653"><a href="#cb194-2653" aria-hidden="true" tabindex="-1"></a>            df_samples_b <span class="sc">|&gt;</span> tidybayes<span class="sc">::</span><span class="fu">mode_qi</span>(samples_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2654"><a href="#cb194-2654" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(samples_b, .point) <span class="sc">|&gt;</span> </span>
<span id="cb194-2655"><a href="#cb194-2655" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(mode2_b) <span class="sc">|&gt;</span></span>
<span id="cb194-2656"><a href="#cb194-2656" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-2657"><a href="#cb194-2657" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. create two columns to annotate the plot #######</span></span>
<span id="cb194-2658"><a href="#cb194-2658" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">55</span>, .<span class="dv">55</span>, .<span class="dv">75</span>, .<span class="dv">75</span>),</span>
<span id="cb194-2659"><a href="#cb194-2659" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">0006</span>, .<span class="dv">0011</span>, .<span class="dv">0016</span>, .<span class="dv">0021</span>))</span>
<span id="cb194-2660"><a href="#cb194-2660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2661"><a href="#cb194-2661" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. plot ##########################################</span></span>
<span id="cb194-2662"><a href="#cb194-2662" aria-hidden="true" tabindex="-1"></a>df_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2663"><a href="#cb194-2663" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> samples_b)) <span class="sc">+</span></span>
<span id="cb194-2664"><a href="#cb194-2664" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> posterior_samples_b),</span>
<span id="cb194-2665"><a href="#cb194-2665" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2666"><a href="#cb194-2666" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> point_estimates_b2<span class="sc">$</span>samples_b) <span class="sc">+</span></span>
<span id="cb194-2667"><a href="#cb194-2667" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="at">data =</span> point_estimates_b2,</span>
<span id="cb194-2668"><a href="#cb194-2668" aria-hidden="true" tabindex="-1"></a>            ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> .point)) <span class="sc">+</span></span>
<span id="cb194-2669"><a href="#cb194-2669" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb194-2670"><a href="#cb194-2670" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2671"><a href="#cb194-2671" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-2672"><a href="#cb194-2672" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb194-2673"><a href="#cb194-2673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2674"><a href="#cb194-2674" aria-hidden="true" tabindex="-1"></a><span class="do">## 4. annotation (arrows &amp; text) ####################</span></span>
<span id="cb194-2675"><a href="#cb194-2675" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb194-2676"><a href="#cb194-2676" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.4</span>, <span class="at">y =</span> .<span class="dv">0005</span>, <span class="at">xend =</span> point_estimates_b2<span class="sc">$</span>samples_b[[<span class="dv">1</span>]], <span class="at">yend =</span> .<span class="dv">0005</span>),</span>
<span id="cb194-2677"><a href="#cb194-2677" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb194-2678"><a href="#cb194-2678" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb194-2679"><a href="#cb194-2679" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.4</span>, <span class="at">y =</span> .<span class="dv">001</span>, <span class="at">xend =</span> point_estimates_b2<span class="sc">$</span>samples_b[[<span class="dv">2</span>]], <span class="at">yend =</span> .<span class="dv">001</span>),</span>
<span id="cb194-2680"><a href="#cb194-2680" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span>  </span>
<span id="cb194-2681"><a href="#cb194-2681" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb194-2682"><a href="#cb194-2682" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.85</span>, <span class="at">y =</span> .<span class="dv">0015</span>, <span class="at">xend =</span> point_estimates_b2<span class="sc">$</span>samples_b[[<span class="dv">3</span>]], <span class="at">yend =</span> .<span class="dv">0015</span>),</span>
<span id="cb194-2683"><a href="#cb194-2683" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb194-2684"><a href="#cb194-2684" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb194-2685"><a href="#cb194-2685" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.85</span>, <span class="at">y =</span> .<span class="dv">002</span>, <span class="at">xend =</span> point_estimates_b2<span class="sc">$</span>samples_b[[<span class="dv">4</span>]], <span class="at">yend =</span> .<span class="dv">002</span>),</span>
<span id="cb194-2686"><a href="#cb194-2686" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb194-2687"><a href="#cb194-2687" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-2688"><a href="#cb194-2688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2689"><a href="#cb194-2689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2690"><a href="#cb194-2690" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb194-2691"><a href="#cb194-2691" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb194-2692"><a href="#cb194-2692" aria-hidden="true" tabindex="-1"></a>MAP (mode) is not the highest point in the more symmetric version (6</span>
<span id="cb194-2693"><a href="#cb194-2693" aria-hidden="true" tabindex="-1"></a>&#39;W&#39;, n=9)</span>
<span id="cb194-2694"><a href="#cb194-2694" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2695"><a href="#cb194-2695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2696"><a href="#cb194-2696" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb194-2697"><a href="#cb194-2697" aria-hidden="true" tabindex="-1"></a>I wounder if the calculation of the MAP of the somewhat symmetrical</span>
<span id="cb194-2698"><a href="#cb194-2698" aria-hidden="true" tabindex="-1"></a>version is correct, because the MAP or mode is not the highest value in</span>
<span id="cb194-2699"><a href="#cb194-2699" aria-hidden="true" tabindex="-1"></a>the distribution. In addition to calculate the mode with</span>
<span id="cb194-2700"><a href="#cb194-2700" aria-hidden="true" tabindex="-1"></a>{**tidybayes**}, I have also used R code 3.14b from</span>
<span id="cb194-2701"><a href="#cb194-2701" aria-hidden="true" tabindex="-1"></a>@cnj-point-estimates-b to compute MAP with</span>
<span id="cb194-2702"><a href="#cb194-2702" aria-hidden="true" tabindex="-1"></a><span class="in">`dplyr::arrange(dplyr::desc())`</span>.</span>
<span id="cb194-2703"><a href="#cb194-2703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2704"><a href="#cb194-2704" aria-hidden="true" tabindex="-1"></a>It turns out that there is difference: In contrast to {**tidybayes**}</span>
<span id="cb194-2705"><a href="#cb194-2705" aria-hidden="true" tabindex="-1"></a>arranging the data frame results in a MAP value (<span class="in">`mode2`</span>) which is</span>
<span id="cb194-2706"><a href="#cb194-2706" aria-hidden="true" tabindex="-1"></a>indeed the highest point of the distribution. I don&#39;t know how to</span>
<span id="cb194-2707"><a href="#cb194-2707" aria-hidden="true" tabindex="-1"></a>interpret this disparity.</span>
<span id="cb194-2708"><a href="#cb194-2708" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2709"><a href="#cb194-2709" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2710"><a href="#cb194-2710" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2711"><a href="#cb194-2711" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2712"><a href="#cb194-2712" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2713"><a href="#cb194-2713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2714"><a href="#cb194-2714" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Loss function to support particular decisions</span></span>
<span id="cb194-2715"><a href="#cb194-2715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2716"><a href="#cb194-2716" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2717"><a href="#cb194-2717" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2718"><a href="#cb194-2718" aria-hidden="true" tabindex="-1"></a>::: {#cnj-expected-loss-b}</span>
<span id="cb194-2719"><a href="#cb194-2719" aria-hidden="true" tabindex="-1"></a>b: Calculated expected loss for $p = 0.5$ with proportional and</span>
<span id="cb194-2720"><a href="#cb194-2720" aria-hidden="true" tabindex="-1"></a>quadratic loss function</span>
<span id="cb194-2721"><a href="#cb194-2721" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2722"><a href="#cb194-2722" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2723"><a href="#cb194-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2724"><a href="#cb194-2724" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2725"><a href="#cb194-2725" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-2726"><a href="#cb194-2726" aria-hidden="true" tabindex="-1"></a><span class="fu">###### $d-p$</span></span>
<span id="cb194-2727"><a href="#cb194-2727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2728"><a href="#cb194-2728" aria-hidden="true" tabindex="-1"></a>The absolute proportional loss $d-p$ for the decision $p = 0.5$ results</span>
<span id="cb194-2729"><a href="#cb194-2729" aria-hidden="true" tabindex="-1"></a>into the median.</span>
<span id="cb194-2730"><a href="#cb194-2730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2731"><a href="#cb194-2731" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2732"><a href="#cb194-2732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2733"><a href="#cb194-2733" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2734"><a href="#cb194-2734" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: expected-prop-loss-b</span></span>
<span id="cb194-2735"><a href="#cb194-2735" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-2736"><a href="#cb194-2736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2737"><a href="#cb194-2737" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.17b weighted average loss ##################</span></span>
<span id="cb194-2738"><a href="#cb194-2738" aria-hidden="true" tabindex="-1"></a>loss_avg_b <span class="ot">&lt;-</span> d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2739"><a href="#cb194-2739" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">expected loss</span><span class="st">`</span> <span class="ot">=</span> </span>
<span id="cb194-2740"><a href="#cb194-2740" aria-hidden="true" tabindex="-1"></a>               base<span class="sc">::</span><span class="fu">sum</span>(posterior_skewed_b <span class="sc">*</span> base<span class="sc">::</span><span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> p_grid_b)))</span>
<span id="cb194-2741"><a href="#cb194-2741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2742"><a href="#cb194-2742" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.18b for every possible value #############################</span></span>
<span id="cb194-2743"><a href="#cb194-2743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2744"><a href="#cb194-2744" aria-hidden="true" tabindex="-1"></a><span class="do">## write function</span></span>
<span id="cb194-2745"><a href="#cb194-2745" aria-hidden="true" tabindex="-1"></a>make_loss_b <span class="ot">&lt;-</span> <span class="cf">function</span>(our_d) {</span>
<span id="cb194-2746"><a href="#cb194-2746" aria-hidden="true" tabindex="-1"></a>  d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2747"><a href="#cb194-2747" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">loss_b =</span> posterior_skewed_b <span class="sc">*</span> base<span class="sc">::</span><span class="fu">abs</span>(our_d <span class="sc">-</span> p_grid_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2748"><a href="#cb194-2748" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">weighted_average_loss_b =</span> base<span class="sc">::</span><span class="fu">sum</span>(loss_b))</span>
<span id="cb194-2749"><a href="#cb194-2749" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-2750"><a href="#cb194-2750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2751"><a href="#cb194-2751" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate loss for all possible values </span></span>
<span id="cb194-2752"><a href="#cb194-2752" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Every possible loss values for decision 0.5 with proportional loss function</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb194-2753"><a href="#cb194-2753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2754"><a href="#cb194-2754" aria-hidden="true" tabindex="-1"></a>l_b <span class="ot">&lt;-</span></span>
<span id="cb194-2755"><a href="#cb194-2755" aria-hidden="true" tabindex="-1"></a>  d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2756"><a href="#cb194-2756" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(p_grid_b) <span class="sc">|&gt;</span> </span>
<span id="cb194-2757"><a href="#cb194-2757" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">decision_b =</span> p_grid_b) <span class="sc">|&gt;</span> </span>
<span id="cb194-2758"><a href="#cb194-2758" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">weighted_average_loss_b =</span> purrr<span class="sc">::</span><span class="fu">map</span>(decision_b, make_loss_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2759"><a href="#cb194-2759" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(weighted_average_loss_b) </span>
<span id="cb194-2760"><a href="#cb194-2760" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(l_b)</span>
<span id="cb194-2761"><a href="#cb194-2761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2762"><a href="#cb194-2762" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.19b minimized loss value #############################</span></span>
<span id="cb194-2763"><a href="#cb194-2763" aria-hidden="true" tabindex="-1"></a><span class="co"># this will help us find the x and y coordinates for the minimum value</span></span>
<span id="cb194-2764"><a href="#cb194-2764" aria-hidden="true" tabindex="-1"></a>loss_min_b <span class="ot">&lt;-</span></span>
<span id="cb194-2765"><a href="#cb194-2765" aria-hidden="true" tabindex="-1"></a>    l_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2766"><a href="#cb194-2766" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(weighted_average_loss_b <span class="sc">==</span> base<span class="sc">::</span><span class="fu">min</span>(weighted_average_loss_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2767"><a href="#cb194-2767" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">as.numeric</span>()</span>
<span id="cb194-2768"><a href="#cb194-2768" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2769"><a href="#cb194-2769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2770"><a href="#cb194-2770" aria-hidden="true" tabindex="-1"></a>**Results:**</span>
<span id="cb194-2771"><a href="#cb194-2771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2772"><a href="#cb194-2772" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Weighted average loss value = <span class="in">`r loss_avg_b`</span>.</span>
<span id="cb194-2773"><a href="#cb194-2773" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Parameter value that minimizes the loss = <span class="in">`r loss_min_b[[1]]`</span>. This is the posterior median that we already have calculated in @cnj-point-estimates-b. Because of sampling variation it is not identical but pretty close (<span class="in">`r median(samples_skewed_b$p_skewed_b)`</span> versus <span class="in">`r loss_min_b[[1]]`</span>).</span>
<span id="cb194-2774"><a href="#cb194-2774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2775"><a href="#cb194-2775" aria-hidden="true" tabindex="-1"></a><span class="fu">###### $(d−p)^{2}$</span></span>
<span id="cb194-2776"><a href="#cb194-2776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2777"><a href="#cb194-2777" aria-hidden="true" tabindex="-1"></a>The quadratic loss $(d−p)^{2}$ for the decision $p = 0.5$ suggests we</span>
<span id="cb194-2778"><a href="#cb194-2778" aria-hidden="true" tabindex="-1"></a>should use the mean.</span>
<span id="cb194-2779"><a href="#cb194-2779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2780"><a href="#cb194-2780" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2781"><a href="#cb194-2781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2782"><a href="#cb194-2782" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2783"><a href="#cb194-2783" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: expected-quad-loss-b</span></span>
<span id="cb194-2784"><a href="#cb194-2784" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-2785"><a href="#cb194-2785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2786"><a href="#cb194-2786" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.17b weighted average loss ##################</span></span>
<span id="cb194-2787"><a href="#cb194-2787" aria-hidden="true" tabindex="-1"></a>loss_avg_b2 <span class="ot">&lt;-</span> d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2788"><a href="#cb194-2788" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">expected loss</span><span class="st">`</span> <span class="ot">=</span> </span>
<span id="cb194-2789"><a href="#cb194-2789" aria-hidden="true" tabindex="-1"></a>               base<span class="sc">::</span><span class="fu">sum</span>(posterior_skewed_b <span class="sc">*</span> base<span class="sc">::</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> p_grid_b))))</span>
<span id="cb194-2790"><a href="#cb194-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2791"><a href="#cb194-2791" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.18b for every possible value #############################</span></span>
<span id="cb194-2792"><a href="#cb194-2792" aria-hidden="true" tabindex="-1"></a><span class="co"># amend our loss function</span></span>
<span id="cb194-2793"><a href="#cb194-2793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2794"><a href="#cb194-2794" aria-hidden="true" tabindex="-1"></a>make_loss2_b <span class="ot">&lt;-</span> <span class="cf">function</span>(our_d2) {</span>
<span id="cb194-2795"><a href="#cb194-2795" aria-hidden="true" tabindex="-1"></a>  d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2796"><a href="#cb194-2796" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">loss2_b =</span> posterior_skewed_b <span class="sc">*</span> (our_d2 <span class="sc">-</span> p_grid_b)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-2797"><a href="#cb194-2797" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">weighted_average_loss2_b =</span> base<span class="sc">::</span><span class="fu">sum</span>(loss2_b))</span>
<span id="cb194-2798"><a href="#cb194-2798" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-2799"><a href="#cb194-2799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2800"><a href="#cb194-2800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2801"><a href="#cb194-2801" aria-hidden="true" tabindex="-1"></a><span class="co"># remake our `l` data</span></span>
<span id="cb194-2802"><a href="#cb194-2802" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Every possible loss values for decision 0.5 with quadratic loss function</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb194-2803"><a href="#cb194-2803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2804"><a href="#cb194-2804" aria-hidden="true" tabindex="-1"></a>l2_b <span class="ot">&lt;-</span></span>
<span id="cb194-2805"><a href="#cb194-2805" aria-hidden="true" tabindex="-1"></a>    d_skewed_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2806"><a href="#cb194-2806" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(p_grid_b) <span class="sc">|&gt;</span> </span>
<span id="cb194-2807"><a href="#cb194-2807" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">decision2_b =</span> p_grid_b) <span class="sc">|&gt;</span> </span>
<span id="cb194-2808"><a href="#cb194-2808" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">weighted_average_loss2_b =</span> purrr<span class="sc">::</span><span class="fu">map</span>(decision2_b, make_loss2_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2809"><a href="#cb194-2809" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">unnest</span>(weighted_average_loss2_b)</span>
<span id="cb194-2810"><a href="#cb194-2810" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(l2_b)</span>
<span id="cb194-2811"><a href="#cb194-2811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2812"><a href="#cb194-2812" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.19b minimized loss value #############################</span></span>
<span id="cb194-2813"><a href="#cb194-2813" aria-hidden="true" tabindex="-1"></a><span class="co"># update to the new minimum loss coordinates</span></span>
<span id="cb194-2814"><a href="#cb194-2814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2815"><a href="#cb194-2815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2816"><a href="#cb194-2816" aria-hidden="true" tabindex="-1"></a>loss_min_b2 <span class="ot">&lt;-</span></span>
<span id="cb194-2817"><a href="#cb194-2817" aria-hidden="true" tabindex="-1"></a>    l2_b <span class="sc">|&gt;</span> </span>
<span id="cb194-2818"><a href="#cb194-2818" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(weighted_average_loss2_b <span class="sc">==</span> base<span class="sc">::</span><span class="fu">min</span>(weighted_average_loss2_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-2819"><a href="#cb194-2819" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">as.numeric</span>()</span>
<span id="cb194-2820"><a href="#cb194-2820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2821"><a href="#cb194-2821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2822"><a href="#cb194-2822" aria-hidden="true" tabindex="-1"></a>**Results:**</span>
<span id="cb194-2823"><a href="#cb194-2823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2824"><a href="#cb194-2824" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Weighted average loss value = <span class="in">`r loss_avg_b2`</span>.</span>
<span id="cb194-2825"><a href="#cb194-2825" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Parameter value that minimizes the loss = <span class="in">`r loss_min_b2[[1]]`</span>. This is the posterior mean that we already have calculated in @cnj-point-estimates-b. Because of sampling variation it is not identical but pretty close (<span class="in">`r mean(samples_skewed_b$p_skewed_b)`</span> versus <span class="in">`r loss_min_b2[[1]]`</span>).</span>
<span id="cb194-2826"><a href="#cb194-2826" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2827"><a href="#cb194-2827" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2828"><a href="#cb194-2828" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2829"><a href="#cb194-2829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2830"><a href="#cb194-2830" aria-hidden="true" tabindex="-1"></a>Now we&#39;re ready to reproduce the right panel of Figure 3.4., e.g.,</span>
<span id="cb194-2831"><a href="#cb194-2831" aria-hidden="true" tabindex="-1"></a>displaying the the loss function and computing the minimum loss value.</span>
<span id="cb194-2832"><a href="#cb194-2832" aria-hidden="true" tabindex="-1"></a>Remember: Different loss functions imply different point estimates.</span>
<span id="cb194-2833"><a href="#cb194-2833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2834"><a href="#cb194-2834" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2835"><a href="#cb194-2835" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2836"><a href="#cb194-2836" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-prop-loss-b}</span>
<span id="cb194-2837"><a href="#cb194-2837" aria-hidden="true" tabindex="-1"></a>b: Plot expected loss for $p = 0.5$ with proportional and quadratic loss</span>
<span id="cb194-2838"><a href="#cb194-2838" aria-hidden="true" tabindex="-1"></a>function</span>
<span id="cb194-2839"><a href="#cb194-2839" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2840"><a href="#cb194-2840" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2841"><a href="#cb194-2841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2842"><a href="#cb194-2842" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2843"><a href="#cb194-2843" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-2844"><a href="#cb194-2844" aria-hidden="true" tabindex="-1"></a><span class="fu">###### $d-p$</span></span>
<span id="cb194-2845"><a href="#cb194-2845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2846"><a href="#cb194-2846" aria-hidden="true" tabindex="-1"></a>The absolute proportional loss $d-p$ for the decision $p = 0.5$ results</span>
<span id="cb194-2847"><a href="#cb194-2847" aria-hidden="true" tabindex="-1"></a>into the median.</span>
<span id="cb194-2848"><a href="#cb194-2848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2849"><a href="#cb194-2849" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2850"><a href="#cb194-2850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2851"><a href="#cb194-2851" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2852"><a href="#cb194-2852" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-prop-loss-b</span></span>
<span id="cb194-2853"><a href="#cb194-2853" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Expected loss under the rule that loss is proportional to absolute distance of decision (horizontal axis) from the true value. The point marks the value of `p` that minimizes the expected loss, the posterior median.&quot;</span></span>
<span id="cb194-2854"><a href="#cb194-2854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2855"><a href="#cb194-2855" aria-hidden="true" tabindex="-1"></a><span class="do">## right panel figure 3.4 ########################</span></span>
<span id="cb194-2856"><a href="#cb194-2856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2857"><a href="#cb194-2857" aria-hidden="true" tabindex="-1"></a>l_b <span class="sc">|&gt;</span>   </span>
<span id="cb194-2858"><a href="#cb194-2858" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> decision_b, <span class="at">y =</span> weighted_average_loss_b)) <span class="sc">+</span></span>
<span id="cb194-2859"><a href="#cb194-2859" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2860"><a href="#cb194-2860" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> loss_min_b[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-2861"><a href="#cb194-2861" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> loss_min_b[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-2862"><a href="#cb194-2862" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;expected proportional loss&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2863"><a href="#cb194-2863" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-2864"><a href="#cb194-2864" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-2865"><a href="#cb194-2865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2866"><a href="#cb194-2866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2867"><a href="#cb194-2867" aria-hidden="true" tabindex="-1"></a>We saved the exact minimum value as <span class="in">`loss_min_b[1]`</span>, which is</span>
<span id="cb194-2868"><a href="#cb194-2868" aria-hidden="true" tabindex="-1"></a><span class="in">`r loss_min_b[1]`</span>. Within sampling error, this is the posterior median</span>
<span id="cb194-2869"><a href="#cb194-2869" aria-hidden="true" tabindex="-1"></a>as depicted by our samples (<span class="in">`r median(samples_skewed_b$p_skewed_b)`</span></span>
<span id="cb194-2870"><a href="#cb194-2870" aria-hidden="true" tabindex="-1"></a>versus <span class="in">`r loss_min_b[[1]]`</span>).</span>
<span id="cb194-2871"><a href="#cb194-2871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2872"><a href="#cb194-2872" aria-hidden="true" tabindex="-1"></a><span class="fu">###### $(d−p)^{2}$</span></span>
<span id="cb194-2873"><a href="#cb194-2873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2874"><a href="#cb194-2874" aria-hidden="true" tabindex="-1"></a>The quadratic loss $(d−p)^{2}$ for the decision $p = 0.5$ suggests we</span>
<span id="cb194-2875"><a href="#cb194-2875" aria-hidden="true" tabindex="-1"></a>should use the mean.</span>
<span id="cb194-2876"><a href="#cb194-2876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2877"><a href="#cb194-2877" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2878"><a href="#cb194-2878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2879"><a href="#cb194-2879" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2880"><a href="#cb194-2880" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-quad-loss-b</span></span>
<span id="cb194-2881"><a href="#cb194-2881" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Expected loss under the rule that loss is quadratic to the distance of decision (horizontal axis) from the true value. The point marks the value of `p` that minimizes the expected loss, the posterior mean&quot;</span></span>
<span id="cb194-2882"><a href="#cb194-2882" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-2883"><a href="#cb194-2883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2884"><a href="#cb194-2884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2885"><a href="#cb194-2885" aria-hidden="true" tabindex="-1"></a><span class="co"># update the plot</span></span>
<span id="cb194-2886"><a href="#cb194-2886" aria-hidden="true" tabindex="-1"></a>l2_b <span class="sc">|&gt;</span>   </span>
<span id="cb194-2887"><a href="#cb194-2887" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> decision2_b, <span class="at">y =</span> weighted_average_loss2_b)) <span class="sc">+</span></span>
<span id="cb194-2888"><a href="#cb194-2888" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2889"><a href="#cb194-2889" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> loss_min_b2[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-2890"><a href="#cb194-2890" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> loss_min_b2[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-2891"><a href="#cb194-2891" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;expected proportional loss&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-2892"><a href="#cb194-2892" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-2893"><a href="#cb194-2893" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-2894"><a href="#cb194-2894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2895"><a href="#cb194-2895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2896"><a href="#cb194-2896" aria-hidden="true" tabindex="-1"></a>Based on quadratic loss $(d−p)^{2}$, the exact minimum value is</span>
<span id="cb194-2897"><a href="#cb194-2897" aria-hidden="true" tabindex="-1"></a><span class="in">`r loss_min_b2[1]`</span>. Within sampling error, this is the posterior mean of</span>
<span id="cb194-2898"><a href="#cb194-2898" aria-hidden="true" tabindex="-1"></a>our samples (<span class="in">`r mean(samples_skewed_b$p_skewed_b)`</span> versus</span>
<span id="cb194-2899"><a href="#cb194-2899" aria-hidden="true" tabindex="-1"></a><span class="in">`r loss_min_b2[[1]]`</span>).</span>
<span id="cb194-2900"><a href="#cb194-2900" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2901"><a href="#cb194-2901" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2902"><a href="#cb194-2902" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2903"><a href="#cb194-2903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2904"><a href="#cb194-2904" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sampling to simulate prediction</span></span>
<span id="cb194-2905"><a href="#cb194-2905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2906"><a href="#cb194-2906" aria-hidden="true" tabindex="-1"></a><span class="fu">### ORIGINAL</span></span>
<span id="cb194-2907"><a href="#cb194-2907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2908"><a href="#cb194-2908" aria-hidden="true" tabindex="-1"></a>::: my-procedure</span>
<span id="cb194-2909"><a href="#cb194-2909" aria-hidden="true" tabindex="-1"></a>::: my-procedure-header</span>
<span id="cb194-2910"><a href="#cb194-2910" aria-hidden="true" tabindex="-1"></a>::: {#prp-ease-sim}</span>
<span id="cb194-2911"><a href="#cb194-2911" aria-hidden="true" tabindex="-1"></a>: 5 Reasons to simulate implied observations</span>
<span id="cb194-2912"><a href="#cb194-2912" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2913"><a href="#cb194-2913" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2914"><a href="#cb194-2914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2915"><a href="#cb194-2915" aria-hidden="true" tabindex="-1"></a>::: my-procedure-container</span>
<span id="cb194-2916"><a href="#cb194-2916" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Another common job for samples is to ease **simulation** of the</span></span>
<span id="cb194-2917"><a href="#cb194-2917" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; model&#39;s implied observations. Generating implied observations from a</span></span>
<span id="cb194-2918"><a href="#cb194-2918" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; model is useful for at least ~~four~~ five reasons.&quot; ([McElreath,</span></span>
<span id="cb194-2919"><a href="#cb194-2919" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 2020, p. 61](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-2920"><a href="#cb194-2920" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=80&amp;annotation=N8SBHXFN)</span><span class="at">)</span></span>
<span id="cb194-2921"><a href="#cb194-2921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2922"><a href="#cb194-2922" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Model design</span>
<span id="cb194-2923"><a href="#cb194-2923" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Model checking</span>
<span id="cb194-2924"><a href="#cb194-2924" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Software validation</span>
<span id="cb194-2925"><a href="#cb194-2925" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Research design</span>
<span id="cb194-2926"><a href="#cb194-2926" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Forecasting</span>
<span id="cb194-2927"><a href="#cb194-2927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2928"><a href="#cb194-2928" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;We will call such simulated data **dummy data**, to indicate that it</span></span>
<span id="cb194-2929"><a href="#cb194-2929" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; is a stand-in for actual data.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-2930"><a href="#cb194-2930" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 62](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-2931"><a href="#cb194-2931" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=81&amp;annotation=EG7YYPVK)</span><span class="at">)</span></span>
<span id="cb194-2932"><a href="#cb194-2932" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-2933"><a href="#cb194-2933" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-2934"><a href="#cb194-2934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2935"><a href="#cb194-2935" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dummy data</span></span>
<span id="cb194-2936"><a href="#cb194-2936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2937"><a href="#cb194-2937" aria-hidden="true" tabindex="-1"></a>Likelihood functions work in both directions:</span>
<span id="cb194-2938"><a href="#cb194-2938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2939"><a href="#cb194-2939" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>They help to infer the plausibility of each possible value of *p*.</span>
<span id="cb194-2940"><a href="#cb194-2940" aria-hidden="true" tabindex="-1"></a>    &quot;With the globe tossing model, the <span class="in">`r glossary(&quot;dummy data&quot;)`</span></span>
<span id="cb194-2941"><a href="#cb194-2941" aria-hidden="true" tabindex="-1"></a>    arises from a binomial likelihood:&quot; ([McElreath, 2020, p.</span>
<span id="cb194-2942"><a href="#cb194-2942" aria-hidden="true" tabindex="-1"></a>    62](zotero://select/groups/5243560/items/NFUEVASQ))</span>
<span id="cb194-2943"><a href="#cb194-2943" aria-hidden="true" tabindex="-1"></a>    (<span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=81&amp;annotation=5PLAWZ8J)</span>)</span>
<span id="cb194-2944"><a href="#cb194-2944" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>They can be used to simulate the observations that the model</span>
<span id="cb194-2945"><a href="#cb194-2945" aria-hidden="true" tabindex="-1"></a>    implies. &quot;You could use <span class="in">`base::sample()`</span> to do this, but R provides</span>
<span id="cb194-2946"><a href="#cb194-2946" aria-hidden="true" tabindex="-1"></a>    convenient sampling functions for all the ordinary probability</span>
<span id="cb194-2947"><a href="#cb194-2947" aria-hidden="true" tabindex="-1"></a>    distributions, like the binomial.&quot; ([McElreath, 2020, p.</span>
<span id="cb194-2948"><a href="#cb194-2948" aria-hidden="true" tabindex="-1"></a>    62](zotero://select/groups/5243560/items/NFUEVASQ))</span>
<span id="cb194-2949"><a href="#cb194-2949" aria-hidden="true" tabindex="-1"></a>    (<span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=81&amp;annotation=W69A2SQI)</span>)</span>
<span id="cb194-2950"><a href="#cb194-2950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2951"><a href="#cb194-2951" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Given a realized observation, the likelihood function says how</span></span>
<span id="cb194-2952"><a href="#cb194-2952" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; plausible the observation is. And given only the parameters, the</span></span>
<span id="cb194-2953"><a href="#cb194-2953" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; likelihood defines a distribution of possible observations that we can</span></span>
<span id="cb194-2954"><a href="#cb194-2954" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; sample from, to simulate observation.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-2955"><a href="#cb194-2955" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 62](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-2956"><a href="#cb194-2956" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=81&amp;annotation=PNGM8F8P)</span><span class="at">)</span></span>
<span id="cb194-2957"><a href="#cb194-2957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2958"><a href="#cb194-2958" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-2959"><a href="#cb194-2959" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-2960"><a href="#cb194-2960" aria-hidden="true" tabindex="-1"></a>::: {#cnj-two-tosses-a}</span>
<span id="cb194-2961"><a href="#cb194-2961" aria-hidden="true" tabindex="-1"></a>a: Suppose $N = 2$, two tosses of the globe with $p = 0.7$</span>
<span id="cb194-2962"><a href="#cb194-2962" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2963"><a href="#cb194-2963" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-2964"><a href="#cb194-2964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2965"><a href="#cb194-2965" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-2966"><a href="#cb194-2966" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-2967"><a href="#cb194-2967" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Probability</span></span>
<span id="cb194-2968"><a href="#cb194-2968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2969"><a href="#cb194-2969" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2970"><a href="#cb194-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2971"><a href="#cb194-2971" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2972"><a href="#cb194-2972" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: two-tosses-prob-a</span></span>
<span id="cb194-2973"><a href="#cb194-2973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2974"><a href="#cb194-2974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2975"><a href="#cb194-2975" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.20a #############################</span></span>
<span id="cb194-2976"><a href="#cb194-2976" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb194-2977"><a href="#cb194-2977" aria-hidden="true" tabindex="-1"></a>  two_tosses_prob_a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb194-2978"><a href="#cb194-2978" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-2979"><a href="#cb194-2979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-2980"><a href="#cb194-2980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2981"><a href="#cb194-2981" aria-hidden="true" tabindex="-1"></a>**Interpretation of the observed result of two tosses with a probability</span>
<span id="cb194-2982"><a href="#cb194-2982" aria-hidden="true" tabindex="-1"></a>of** $p = 0.7$</span>
<span id="cb194-2983"><a href="#cb194-2983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2984"><a href="#cb194-2984" aria-hidden="true" tabindex="-1"></a>With $N = 2$ there are only three possibilities: 0, 1 or 2 water.</span>
<span id="cb194-2985"><a href="#cb194-2985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2986"><a href="#cb194-2986" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`r two_tosses_prob_a[[1]] * 100`</span>% chance of observing 0 water.</span>
<span id="cb194-2987"><a href="#cb194-2987" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`r two_tosses_prob_a[[2]] * 100`</span>% chance of observing 1 water.</span>
<span id="cb194-2988"><a href="#cb194-2988" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`r two_tosses_prob_a[[3]] * 100`</span>% chance of observing 2 water.</span>
<span id="cb194-2989"><a href="#cb194-2989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2990"><a href="#cb194-2990" aria-hidden="true" tabindex="-1"></a>With different $p$ you will get a different result.</span>
<span id="cb194-2991"><a href="#cb194-2991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2992"><a href="#cb194-2992" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Simulation</span></span>
<span id="cb194-2993"><a href="#cb194-2993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2994"><a href="#cb194-2994" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-2995"><a href="#cb194-2995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2996"><a href="#cb194-2996" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-2997"><a href="#cb194-2997" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: two-tosses-sim-a</span></span>
<span id="cb194-2998"><a href="#cb194-2998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-2999"><a href="#cb194-2999" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>) <span class="co"># for reproducibility</span></span>
<span id="cb194-3000"><a href="#cb194-3000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3001"><a href="#cb194-3001" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.21a #############################</span></span>
<span id="cb194-3002"><a href="#cb194-3002" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb194-3003"><a href="#cb194-3003" aria-hidden="true" tabindex="-1"></a>  two_tosses_sim_a <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb194-3004"><a href="#cb194-3004" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-3005"><a href="#cb194-3005" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3006"><a href="#cb194-3006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3007"><a href="#cb194-3007" aria-hidden="true" tabindex="-1"></a>**Interpretation of the simulated result of two tosses with a</span>
<span id="cb194-3008"><a href="#cb194-3008" aria-hidden="true" tabindex="-1"></a>probability of** $p = 0.7$</span>
<span id="cb194-3009"><a href="#cb194-3009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3010"><a href="#cb194-3010" aria-hidden="true" tabindex="-1"></a>One simulation (trial) consists with $N = 2$ of two simulated tosses:</span>
<span id="cb194-3011"><a href="#cb194-3011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3012"><a href="#cb194-3012" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In our simulation (trial) of two simulated tosses $N = 2$ we got</span>
<span id="cb194-3013"><a href="#cb194-3013" aria-hidden="true" tabindex="-1"></a>    <span class="in">`r two_tosses_sim_a`</span> water.</span>
<span id="cb194-3014"><a href="#cb194-3014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3015"><a href="#cb194-3015" aria-hidden="true" tabindex="-1"></a>Without the <span class="in">`base::set.seed()`</span> function the result will change. Try it.</span>
<span id="cb194-3016"><a href="#cb194-3016" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3017"><a href="#cb194-3017" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3018"><a href="#cb194-3018" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3019"><a href="#cb194-3019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3020"><a href="#cb194-3020" aria-hidden="true" tabindex="-1"></a>With <span class="in">`rbinom()`</span> you can also generate more than one simulation (trial)</span>
<span id="cb194-3021"><a href="#cb194-3021" aria-hidden="true" tabindex="-1"></a>at a time.</span>
<span id="cb194-3022"><a href="#cb194-3022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3023"><a href="#cb194-3023" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3024"><a href="#cb194-3024" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3025"><a href="#cb194-3025" aria-hidden="true" tabindex="-1"></a>::: {#cnj-several-sims}</span>
<span id="cb194-3026"><a href="#cb194-3026" aria-hidden="true" tabindex="-1"></a>a: Using <span class="in">`rbinom()`</span> to simulate two tosses to generate 10 and 100,000</span>
<span id="cb194-3027"><a href="#cb194-3027" aria-hidden="true" tabindex="-1"></a>dummy observations</span>
<span id="cb194-3028"><a href="#cb194-3028" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3029"><a href="#cb194-3029" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3030"><a href="#cb194-3030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3031"><a href="#cb194-3031" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3032"><a href="#cb194-3032" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-3033"><a href="#cb194-3033" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 10 trials</span></span>
<span id="cb194-3034"><a href="#cb194-3034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3035"><a href="#cb194-3035" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3036"><a href="#cb194-3036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3037"><a href="#cb194-3037" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3038"><a href="#cb194-3038" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: simulate-10-obs-a</span></span>
<span id="cb194-3039"><a href="#cb194-3039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3040"><a href="#cb194-3040" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3041"><a href="#cb194-3041" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.22a #############################</span></span>
<span id="cb194-3042"><a href="#cb194-3042" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb194-3043"><a href="#cb194-3043" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3044"><a href="#cb194-3044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3045"><a href="#cb194-3045" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 1e5 trials</span></span>
<span id="cb194-3046"><a href="#cb194-3046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3047"><a href="#cb194-3047" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3048"><a href="#cb194-3048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3049"><a href="#cb194-3049" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3050"><a href="#cb194-3050" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: simulate-1e5-obs-a</span></span>
<span id="cb194-3051"><a href="#cb194-3051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3052"><a href="#cb194-3052" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3053"><a href="#cb194-3053" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.23a #############################</span></span>
<span id="cb194-3054"><a href="#cb194-3054" aria-hidden="true" tabindex="-1"></a>dummy_w_a <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb194-3055"><a href="#cb194-3055" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dummy_w_a) <span class="sc">/</span> <span class="fl">1e5</span></span>
<span id="cb194-3056"><a href="#cb194-3056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3057"><a href="#cb194-3057" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3058"><a href="#cb194-3058" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3059"><a href="#cb194-3059" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3060"><a href="#cb194-3060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3061"><a href="#cb194-3061" aria-hidden="true" tabindex="-1"></a>Now let&#39;s simulate the same amount of tosses (sample size = 9) as we</span>
<span id="cb194-3062"><a href="#cb194-3062" aria-hidden="true" tabindex="-1"></a>have used previously. I will provide two kinds of R graphs: One for</span>
<span id="cb194-3063"><a href="#cb194-3063" aria-hidden="true" tabindex="-1"></a><span class="in">`rethinking::simplehist()`</span> as in the book and one using base R with</span>
<span id="cb194-3064"><a href="#cb194-3064" aria-hidden="true" tabindex="-1"></a><span class="in">`graphics::hist()`</span>.</span>
<span id="cb194-3065"><a href="#cb194-3065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3066"><a href="#cb194-3066" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3067"><a href="#cb194-3067" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3068"><a href="#cb194-3068" aria-hidden="true" tabindex="-1"></a>::: {#cnj-9-toss-fig-a}</span>
<span id="cb194-3069"><a href="#cb194-3069" aria-hidden="true" tabindex="-1"></a>a: Distribution of simulated sample observations from 9 tosses of the</span>
<span id="cb194-3070"><a href="#cb194-3070" aria-hidden="true" tabindex="-1"></a>globe</span>
<span id="cb194-3071"><a href="#cb194-3071" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3072"><a href="#cb194-3072" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3073"><a href="#cb194-3073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3074"><a href="#cb194-3074" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3075"><a href="#cb194-3075" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-3076"><a href="#cb194-3076" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Base R</span></span>
<span id="cb194-3077"><a href="#cb194-3077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3078"><a href="#cb194-3078" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3079"><a href="#cb194-3079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3080"><a href="#cb194-3080" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3081"><a href="#cb194-3081" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot-hist-figure-3.5-a</span></span>
<span id="cb194-3082"><a href="#cb194-3082" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Distribution of simulated sample observations from 9 tosses of the globe. These samples assume the proportion of water is 0.7. The plot uses the base R `hist()` function&quot;</span></span>
<span id="cb194-3083"><a href="#cb194-3083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3084"><a href="#cb194-3084" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3085"><a href="#cb194-3085" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.24a with hist() ##############</span></span>
<span id="cb194-3086"><a href="#cb194-3086" aria-hidden="true" tabindex="-1"></a>dummy_w_a <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e5</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb194-3087"><a href="#cb194-3087" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dummy_w_a, <span class="at">xlab =</span> <span class="st">&quot;dummy water count&quot;</span>)</span>
<span id="cb194-3088"><a href="#cb194-3088" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3089"><a href="#cb194-3089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3090"><a href="#cb194-3090" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Rethinking</span></span>
<span id="cb194-3091"><a href="#cb194-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3092"><a href="#cb194-3092" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3093"><a href="#cb194-3093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3094"><a href="#cb194-3094" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3095"><a href="#cb194-3095" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot-simplehist-figure-3.5-a</span></span>
<span id="cb194-3096"><a href="#cb194-3096" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Distribution of simulated sample observations from 9 tosses of the globe. These samples assume the proportion of water is 0.7. the plot uses the `rethinking::simplehist()``` function&quot;</span></span>
<span id="cb194-3097"><a href="#cb194-3097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3098"><a href="#cb194-3098" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3099"><a href="#cb194-3099" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.24a with simplehist() #############################</span></span>
<span id="cb194-3100"><a href="#cb194-3100" aria-hidden="true" tabindex="-1"></a>dummy_w_a <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="fl">1e5</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb194-3101"><a href="#cb194-3101" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">simplehist</span>(dummy_w_a, <span class="at">xlab =</span> <span class="st">&quot;dummy water count&quot;</span>)</span>
<span id="cb194-3102"><a href="#cb194-3102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3103"><a href="#cb194-3103" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3104"><a href="#cb194-3104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3105"><a href="#cb194-3105" aria-hidden="true" tabindex="-1"></a>Note that in our example using <span class="in">`base::set.seed(3)`</span> the simulation does</span>
<span id="cb194-3106"><a href="#cb194-3106" aria-hidden="true" tabindex="-1"></a>not generate the water in its true proportion of $0.7$.</span>
<span id="cb194-3107"><a href="#cb194-3107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3108"><a href="#cb194-3108" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;That&#39;s the nature of observation: There is a one-to-many relationship</span></span>
<span id="cb194-3109"><a href="#cb194-3109" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; between data and data-generating processes. You should </span><span class="sc">\[</span><span class="at">delete the</span></span>
<span id="cb194-3110"><a href="#cb194-3110" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`base::set.seed()`</span><span class="at"> line and</span><span class="sc">\]</span><span class="at"> experiment with sample size, the </span><span class="in">`size`</span></span>
<span id="cb194-3111"><a href="#cb194-3111" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; input in the code above, as well as the </span><span class="in">`prob`</span><span class="at">, to see how the</span></span>
<span id="cb194-3112"><a href="#cb194-3112" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; distribution of simulated samples changes shape and location.&quot;</span></span>
<span id="cb194-3113"><a href="#cb194-3113" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ([McElreath, 2020, p.</span></span>
<span id="cb194-3114"><a href="#cb194-3114" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 63](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-3115"><a href="#cb194-3115" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=82&amp;annotation=2NRZ2EV9)</span><span class="at">)</span></span>
<span id="cb194-3116"><a href="#cb194-3116" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-3117"><a href="#cb194-3117" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-3118"><a href="#cb194-3118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3119"><a href="#cb194-3119" aria-hidden="true" tabindex="-1"></a>::: my-important</span>
<span id="cb194-3120"><a href="#cb194-3120" aria-hidden="true" tabindex="-1"></a>::: my-important-header</span>
<span id="cb194-3121"><a href="#cb194-3121" aria-hidden="true" tabindex="-1"></a>Sampling distributions versus Samples drawn from the posterior</span>
<span id="cb194-3122"><a href="#cb194-3122" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3123"><a href="#cb194-3123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3124"><a href="#cb194-3124" aria-hidden="true" tabindex="-1"></a>::: my-important-container</span>
<span id="cb194-3125"><a href="#cb194-3125" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Many readers will already have seen simulated observations.</span></span>
<span id="cb194-3126"><a href="#cb194-3126" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`r glossary(&quot;Sampling distribution&quot;, &quot;Sampling distributions&quot;)`</span><span class="at"> are</span></span>
<span id="cb194-3127"><a href="#cb194-3127" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the foundation of common non-Bayesian statistical traditions. In those</span></span>
<span id="cb194-3128"><a href="#cb194-3128" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; approaches, inference about parameters is made through the sampling</span></span>
<span id="cb194-3129"><a href="#cb194-3129" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; distribution. In this book, inference about parameters is never done</span></span>
<span id="cb194-3130"><a href="#cb194-3130" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; directly through a sampling distribution. The posterior distribution</span></span>
<span id="cb194-3131"><a href="#cb194-3131" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; is not sampled, but deduced logically. Then samples can be drawn from</span></span>
<span id="cb194-3132"><a href="#cb194-3132" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the posterior, as earlier in this chapter, to aid in inference. In</span></span>
<span id="cb194-3133"><a href="#cb194-3133" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; neither case is &#39;sampling&#39; a physical act. In both cases, it&#39;s just a</span></span>
<span id="cb194-3134"><a href="#cb194-3134" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; mathematical device and produces only *small world* (@sec-chap02)</span></span>
<span id="cb194-3135"><a href="#cb194-3135" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; numbers.&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-3136"><a href="#cb194-3136" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 63](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-3137"><a href="#cb194-3137" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=82&amp;annotation=C7QLRFPI)</span><span class="at">)</span></span>
<span id="cb194-3138"><a href="#cb194-3138" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-3139"><a href="#cb194-3139" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb194-3140"><a href="#cb194-3140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3141"><a href="#cb194-3141" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model checking</span></span>
<span id="cb194-3142"><a href="#cb194-3142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3143"><a href="#cb194-3143" aria-hidden="true" tabindex="-1"></a>Two main purposes:</span>
<span id="cb194-3144"><a href="#cb194-3144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3145"><a href="#cb194-3145" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Checking if software is working correctly</span>
<span id="cb194-3146"><a href="#cb194-3146" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Evaluation the adequacy of the model</span>
<span id="cb194-3147"><a href="#cb194-3147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3148"><a href="#cb194-3148" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;All that is required is averaging over the posterior density for $p$,</span></span>
<span id="cb194-3149"><a href="#cb194-3149" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; while computing the predictions. For each possible value of the</span></span>
<span id="cb194-3150"><a href="#cb194-3150" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; parameter $p$, there is an implied distribution of outcomes. So if you</span></span>
<span id="cb194-3151"><a href="#cb194-3151" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; were to compute the sampling distribution of outcomes at each value of</span></span>
<span id="cb194-3152"><a href="#cb194-3152" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $p$, then you could average all of these prediction distributions</span></span>
<span id="cb194-3153"><a href="#cb194-3153" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; together, using the posterior probabilities of each value of $p$, to</span></span>
<span id="cb194-3154"><a href="#cb194-3154" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; get a </span><span class="in">`r glossary(&quot;posterior predictive distribution&quot;)`</span><span class="at">.&quot; ([McElreath,</span></span>
<span id="cb194-3155"><a href="#cb194-3155" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 2020, p. 65](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-3156"><a href="#cb194-3156" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=84&amp;annotation=EZT523XH)</span><span class="at">)</span></span>
<span id="cb194-3157"><a href="#cb194-3157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3158"><a href="#cb194-3158" aria-hidden="true" tabindex="-1"></a>::: my-procedure</span>
<span id="cb194-3159"><a href="#cb194-3159" aria-hidden="true" tabindex="-1"></a>::: my-procedure-header</span>
<span id="cb194-3160"><a href="#cb194-3160" aria-hidden="true" tabindex="-1"></a>::: {#prp-post-pred-sim-a}</span>
<span id="cb194-3161"><a href="#cb194-3161" aria-hidden="true" tabindex="-1"></a>a: How to generate the <span class="in">`r glossary(&quot;posterior predictive distribution&quot;)`</span></span>
<span id="cb194-3162"><a href="#cb194-3162" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3163"><a href="#cb194-3163" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3164"><a href="#cb194-3164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3165"><a href="#cb194-3165" aria-hidden="true" tabindex="-1"></a>::: my-procedure-container</span>
<span id="cb194-3166"><a href="#cb194-3166" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Use <span class="in">`rbinom()`</span> to generate random binomial samples.</span>
<span id="cb194-3167"><a href="#cb194-3167" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Use as <span class="in">`prob`</span> value not a single value but samples from the</span>
<span id="cb194-3168"><a href="#cb194-3168" aria-hidden="true" tabindex="-1"></a>    posterior</span>
<span id="cb194-3169"><a href="#cb194-3169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3170"><a href="#cb194-3170" aria-hidden="true" tabindex="-1"></a>I will not reproduce Figure 3.6 in the upcoming section. The complex</span>
<span id="cb194-3171"><a href="#cb194-3171" aria-hidden="true" tabindex="-1"></a>procedure to plot the graph does not add much understanding in Bayesian</span>
<span id="cb194-3172"><a href="#cb194-3172" aria-hidden="true" tabindex="-1"></a>statistics. But the content of the picture itself is very important to</span>
<span id="cb194-3173"><a href="#cb194-3173" aria-hidden="true" tabindex="-1"></a>understand how the posterior predictive distribution is generated.</span>
<span id="cb194-3174"><a href="#cb194-3174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3175"><a href="#cb194-3175" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb194-3176"><a href="#cb194-3176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3177"><a href="#cb194-3177" aria-hidden="true" tabindex="-1"></a>![&quot;Simulating predictions from the total posterior. Top: The familiar</span>
<span id="cb194-3178"><a href="#cb194-3178" aria-hidden="true" tabindex="-1"></a>posterior distribution for the globe tossing data. Ten example parameter</span>
<span id="cb194-3179"><a href="#cb194-3179" aria-hidden="true" tabindex="-1"></a>values are marked by the vertical lines. Values with greater posterior</span>
<span id="cb194-3180"><a href="#cb194-3180" aria-hidden="true" tabindex="-1"></a>probability indicated by thicker lines. Middle row: Each of the ten</span>
<span id="cb194-3181"><a href="#cb194-3181" aria-hidden="true" tabindex="-1"></a>parameter values implies a unique sampling distribution of predictions.</span>
<span id="cb194-3182"><a href="#cb194-3182" aria-hidden="true" tabindex="-1"></a>Bottom: Combining simulated observation distributions for all parameter</span>
<span id="cb194-3183"><a href="#cb194-3183" aria-hidden="true" tabindex="-1"></a>values (not just the ten shown), each weighted by its posterior</span>
<span id="cb194-3184"><a href="#cb194-3184" aria-hidden="true" tabindex="-1"></a>probability, produces the posterior predictive distribution. This</span>
<span id="cb194-3185"><a href="#cb194-3185" aria-hidden="true" tabindex="-1"></a>distribution propagates uncertainty about parameter to uncertainty about</span>
<span id="cb194-3186"><a href="#cb194-3186" aria-hidden="true" tabindex="-1"></a>prediction.&quot; ([McElreath, 2020, p.</span>
<span id="cb194-3187"><a href="#cb194-3187" aria-hidden="true" tabindex="-1"></a>65](zotero://select/groups/5243560/items/NFUEVASQ))</span>
<span id="cb194-3188"><a href="#cb194-3188" aria-hidden="true" tabindex="-1"></a>(<span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=84&amp;annotation=ZBMIA85F)</span>)](img/SR2-fig3_6.png){#fig-3-6</span>
<span id="cb194-3189"><a href="#cb194-3189" aria-hidden="true" tabindex="-1"></a>fig-alt=&quot;Top panel shows the posterior probability, middle panel the sampling distribution and the bottom panel the posterior predictive distribution&quot;</span>
<span id="cb194-3190"><a href="#cb194-3190" aria-hidden="true" tabindex="-1"></a>fig-align=&quot;center&quot; width=&quot;90%&quot;}</span>
<span id="cb194-3191"><a href="#cb194-3191" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3192"><a href="#cb194-3192" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3193"><a href="#cb194-3193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3194"><a href="#cb194-3194" aria-hidden="true" tabindex="-1"></a>We will generates 10,000 (1e4) simulated predictions of 9 globe tosses</span>
<span id="cb194-3195"><a href="#cb194-3195" aria-hidden="true" tabindex="-1"></a>(size = 9)</span>
<span id="cb194-3196"><a href="#cb194-3196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3197"><a href="#cb194-3197" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3198"><a href="#cb194-3198" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3199"><a href="#cb194-3199" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-post-pred-sim-a}</span>
<span id="cb194-3200"><a href="#cb194-3200" aria-hidden="true" tabindex="-1"></a>a: Simulate predicted observations for a single value ($p = 0.6$) and</span>
<span id="cb194-3201"><a href="#cb194-3201" aria-hidden="true" tabindex="-1"></a>with samples of the posterior</span>
<span id="cb194-3202"><a href="#cb194-3202" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3203"><a href="#cb194-3203" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3204"><a href="#cb194-3204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3205"><a href="#cb194-3205" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3206"><a href="#cb194-3206" aria-hidden="true" tabindex="-1"></a>Generating 10,000 (1e4) simulated predictions of 9 globe tosses (size =</span>
<span id="cb194-3207"><a href="#cb194-3207" aria-hidden="true" tabindex="-1"></a>9).</span>
<span id="cb194-3208"><a href="#cb194-3208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3209"><a href="#cb194-3209" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-3210"><a href="#cb194-3210" aria-hidden="true" tabindex="-1"></a><span class="fu">###### p = single value of 0.6</span></span>
<span id="cb194-3211"><a href="#cb194-3211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3212"><a href="#cb194-3212" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3213"><a href="#cb194-3213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3214"><a href="#cb194-3214" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3215"><a href="#cb194-3215" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-post-pred-sim-a1</span></span>
<span id="cb194-3216"><a href="#cb194-3216" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Simulate predicted observations for a single value p value of 0.6&quot;</span></span>
<span id="cb194-3217"><a href="#cb194-3217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3218"><a href="#cb194-3218" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3219"><a href="#cb194-3219" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.25a #############################</span></span>
<span id="cb194-3220"><a href="#cb194-3220" aria-hidden="true" tabindex="-1"></a>w_a1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb194-3221"><a href="#cb194-3221" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">simplehist</span>(w_a1)</span>
<span id="cb194-3222"><a href="#cb194-3222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3223"><a href="#cb194-3223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3224"><a href="#cb194-3224" aria-hidden="true" tabindex="-1"></a>The predictions are stored as counts of water, so the theoretical</span>
<span id="cb194-3225"><a href="#cb194-3225" aria-hidden="true" tabindex="-1"></a>minimum is zero and the theoretical maximum is nine. Although our fix</span>
<span id="cb194-3226"><a href="#cb194-3226" aria-hidden="true" tabindex="-1"></a><span class="in">`prob`</span> value = 0.6 the samples show 5 as the mode of the randomly</span>
<span id="cb194-3227"><a href="#cb194-3227" aria-hidden="true" tabindex="-1"></a>generated distribution.</span>
<span id="cb194-3228"><a href="#cb194-3228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3229"><a href="#cb194-3229" aria-hidden="true" tabindex="-1"></a><span class="fu">###### p = posterior samples</span></span>
<span id="cb194-3230"><a href="#cb194-3230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3231"><a href="#cb194-3231" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3232"><a href="#cb194-3232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3233"><a href="#cb194-3233" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3234"><a href="#cb194-3234" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-post-pred-sim-a2</span></span>
<span id="cb194-3235"><a href="#cb194-3235" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Simulate predicted observations with samples of the posterior&quot;</span></span>
<span id="cb194-3236"><a href="#cb194-3236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3237"><a href="#cb194-3237" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3238"><a href="#cb194-3238" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.26a #############################</span></span>
<span id="cb194-3239"><a href="#cb194-3239" aria-hidden="true" tabindex="-1"></a>w_a2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> samples_a)</span>
<span id="cb194-3240"><a href="#cb194-3240" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">simplehist</span>(w_a2)</span>
<span id="cb194-3241"><a href="#cb194-3241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3242"><a href="#cb194-3242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3243"><a href="#cb194-3243" aria-hidden="true" tabindex="-1"></a>The code propagate parameter uncertainty into the predictions by</span>
<span id="cb194-3244"><a href="#cb194-3244" aria-hidden="true" tabindex="-1"></a>replacing a fixed <span class="in">`prob`</span> value by the vector <span class="in">`samples_a`</span>. The symbol</span>
<span id="cb194-3245"><a href="#cb194-3245" aria-hidden="true" tabindex="-1"></a><span class="in">`samples_a`</span> is the same list of random samples from the posterior</span>
<span id="cb194-3246"><a href="#cb194-3246" aria-hidden="true" tabindex="-1"></a>distribution that we have calculated in @cnj-sample-globe-tossing and</span>
<span id="cb194-3247"><a href="#cb194-3247" aria-hidden="true" tabindex="-1"></a>used in previous sections.</span>
<span id="cb194-3248"><a href="#cb194-3248" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3249"><a href="#cb194-3249" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3250"><a href="#cb194-3250" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3251"><a href="#cb194-3251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3252"><a href="#cb194-3252" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;For each sampled value, a random binomial observation is generated.</span></span>
<span id="cb194-3253"><a href="#cb194-3253" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Since the sampled values appear in proportion to their posterior</span></span>
<span id="cb194-3254"><a href="#cb194-3254" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probabilities, the resulting simulated observations are averaged over</span></span>
<span id="cb194-3255"><a href="#cb194-3255" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the posterior. You can manipulate these simulated observations just</span></span>
<span id="cb194-3256"><a href="#cb194-3256" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; like you manipulate samples from the posterior---you can compute</span></span>
<span id="cb194-3257"><a href="#cb194-3257" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; intervals and point statistics using the same procedures.&quot;</span></span>
<span id="cb194-3258"><a href="#cb194-3258" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ([McElreath, 2020, p.</span></span>
<span id="cb194-3259"><a href="#cb194-3259" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 66](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-3260"><a href="#cb194-3260" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=85&amp;annotation=BVUDPY9U)</span><span class="at">)</span></span>
<span id="cb194-3261"><a href="#cb194-3261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3262"><a href="#cb194-3262" aria-hidden="true" tabindex="-1"></a>But @fig-post-pred-sim-a2 just predicts the posterior distribution as</span>
<span id="cb194-3263"><a href="#cb194-3263" aria-hidden="true" tabindex="-1"></a>our model sees the data. To evaluate the adequacy of the model for</span>
<span id="cb194-3264"><a href="#cb194-3264" aria-hidden="true" tabindex="-1"></a>certain purposes it is important to investigate it under different point</span>
<span id="cb194-3265"><a href="#cb194-3265" aria-hidden="true" tabindex="-1"></a>of views. McElreath proposes two look at the data in additional two</span>
<span id="cb194-3266"><a href="#cb194-3266" aria-hidden="true" tabindex="-1"></a>ways:</span>
<span id="cb194-3267"><a href="#cb194-3267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3268"><a href="#cb194-3268" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Plot the distribution of the longest run of either water or land.</span>
<span id="cb194-3269"><a href="#cb194-3269" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Plot the distribution of the number of switches from water to land</span>
<span id="cb194-3270"><a href="#cb194-3270" aria-hidden="true" tabindex="-1"></a>    and reverse.</span>
<span id="cb194-3271"><a href="#cb194-3271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3272"><a href="#cb194-3272" aria-hidden="true" tabindex="-1"></a>The calculation and reproduction of Figure 3.7 is demonstrated in the</span>
<span id="cb194-3273"><a href="#cb194-3273" aria-hidden="true" tabindex="-1"></a>next tidyverse section.</span>
<span id="cb194-3274"><a href="#cb194-3274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3275"><a href="#cb194-3275" aria-hidden="true" tabindex="-1"></a><span class="fu">### TIDYVERSE</span></span>
<span id="cb194-3276"><a href="#cb194-3276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3277"><a href="#cb194-3277" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dummy data</span></span>
<span id="cb194-3278"><a href="#cb194-3278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3279"><a href="#cb194-3279" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3280"><a href="#cb194-3280" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3281"><a href="#cb194-3281" aria-hidden="true" tabindex="-1"></a>::: {#cnj-two-tosses-b}</span>
<span id="cb194-3282"><a href="#cb194-3282" aria-hidden="true" tabindex="-1"></a>b: Suppose $N = 2$, two tosses of the globe with $p = 0.7$</span>
<span id="cb194-3283"><a href="#cb194-3283" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3284"><a href="#cb194-3284" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3285"><a href="#cb194-3285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3286"><a href="#cb194-3286" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3287"><a href="#cb194-3287" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-3288"><a href="#cb194-3288" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Probability</span></span>
<span id="cb194-3289"><a href="#cb194-3289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3290"><a href="#cb194-3290" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3291"><a href="#cb194-3291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3292"><a href="#cb194-3292" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3293"><a href="#cb194-3293" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: two-tosses-prob-b</span></span>
<span id="cb194-3294"><a href="#cb194-3294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3295"><a href="#cb194-3295" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.20b ######################</span></span>
<span id="cb194-3296"><a href="#cb194-3296" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">n      =</span> <span class="dv">2</span>,</span>
<span id="cb194-3297"><a href="#cb194-3297" aria-hidden="true" tabindex="-1"></a>       <span class="st">`</span><span class="at">p(w)</span><span class="st">`</span> <span class="ot">=</span> .<span class="dv">7</span>,</span>
<span id="cb194-3298"><a href="#cb194-3298" aria-hidden="true" tabindex="-1"></a>       <span class="at">w      =</span> <span class="dv">0</span><span class="sc">:</span>n) <span class="sc">|&gt;</span> </span>
<span id="cb194-3299"><a href="#cb194-3299" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">density =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(w, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="st">`</span><span class="at">p(w)</span><span class="st">`</span>))</span>
<span id="cb194-3300"><a href="#cb194-3300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3301"><a href="#cb194-3301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3302"><a href="#cb194-3302" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Simulation</span></span>
<span id="cb194-3303"><a href="#cb194-3303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3304"><a href="#cb194-3304" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3305"><a href="#cb194-3305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3306"><a href="#cb194-3306" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3307"><a href="#cb194-3307" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: two-tosses-sim-b</span></span>
<span id="cb194-3308"><a href="#cb194-3308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3309"><a href="#cb194-3309" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.21b = 3.21a ######################</span></span>
<span id="cb194-3310"><a href="#cb194-3310" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3311"><a href="#cb194-3311" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> .<span class="dv">7</span>)</span>
<span id="cb194-3312"><a href="#cb194-3312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3313"><a href="#cb194-3313" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3314"><a href="#cb194-3314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3315"><a href="#cb194-3315" aria-hidden="true" tabindex="-1"></a>Compare the results with the calculation in @cnj-two-tosses-a.</span>
<span id="cb194-3316"><a href="#cb194-3316" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3317"><a href="#cb194-3317" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3318"><a href="#cb194-3318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3319"><a href="#cb194-3319" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3320"><a href="#cb194-3320" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3321"><a href="#cb194-3321" aria-hidden="true" tabindex="-1"></a>&lt;div&gt;</span>
<span id="cb194-3322"><a href="#cb194-3322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3323"><a href="#cb194-3323" aria-hidden="true" tabindex="-1"></a>b: Using <span class="in">`stats::rbinom()`</span> to simulate two tosses to generate 10 and</span>
<span id="cb194-3324"><a href="#cb194-3324" aria-hidden="true" tabindex="-1"></a>100,000 dummy observations</span>
<span id="cb194-3325"><a href="#cb194-3325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3326"><a href="#cb194-3326" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb194-3327"><a href="#cb194-3327" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3328"><a href="#cb194-3328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3329"><a href="#cb194-3329" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3330"><a href="#cb194-3330" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-3331"><a href="#cb194-3331" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 10 trials</span></span>
<span id="cb194-3332"><a href="#cb194-3332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3333"><a href="#cb194-3333" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3334"><a href="#cb194-3334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3335"><a href="#cb194-3335" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3336"><a href="#cb194-3336" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: simulate-10-obs-b</span></span>
<span id="cb194-3337"><a href="#cb194-3337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3338"><a href="#cb194-3338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3339"><a href="#cb194-3339" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3340"><a href="#cb194-3340" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.22b = 3.22a #############################</span></span>
<span id="cb194-3341"><a href="#cb194-3341" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb194-3342"><a href="#cb194-3342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3343"><a href="#cb194-3343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3344"><a href="#cb194-3344" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 1e5 trials</span></span>
<span id="cb194-3345"><a href="#cb194-3345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3346"><a href="#cb194-3346" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3347"><a href="#cb194-3347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3348"><a href="#cb194-3348" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3349"><a href="#cb194-3349" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: simulate-1e5-obs-b</span></span>
<span id="cb194-3350"><a href="#cb194-3350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3351"><a href="#cb194-3351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3352"><a href="#cb194-3352" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.23b ########################</span></span>
<span id="cb194-3353"><a href="#cb194-3353" aria-hidden="true" tabindex="-1"></a>n_draws_b <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb194-3354"><a href="#cb194-3354" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3355"><a href="#cb194-3355" aria-hidden="true" tabindex="-1"></a>dummy_w_b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">draws =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(n_draws_b, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> .<span class="dv">7</span>)) </span>
<span id="cb194-3356"><a href="#cb194-3356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3357"><a href="#cb194-3357" aria-hidden="true" tabindex="-1"></a>dummy_w_b <span class="sc">|&gt;</span> </span>
<span id="cb194-3358"><a href="#cb194-3358" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(draws) <span class="sc">|&gt;</span> </span>
<span id="cb194-3359"><a href="#cb194-3359" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> base<span class="sc">::</span><span class="fu">nrow</span>(dummy_w_b))</span>
<span id="cb194-3360"><a href="#cb194-3360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3361"><a href="#cb194-3361" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3362"><a href="#cb194-3362" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3363"><a href="#cb194-3363" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3364"><a href="#cb194-3364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3365"><a href="#cb194-3365" aria-hidden="true" tabindex="-1"></a>The simulation updated to $n=9$ and plotting the tidyverse version of</span>
<span id="cb194-3366"><a href="#cb194-3366" aria-hidden="true" tabindex="-1"></a>Figure 3.5.</span>
<span id="cb194-3367"><a href="#cb194-3367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3368"><a href="#cb194-3368" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3369"><a href="#cb194-3369" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3370"><a href="#cb194-3370" aria-hidden="true" tabindex="-1"></a>::: {#cnj-9-toss-fig-b}</span>
<span id="cb194-3371"><a href="#cb194-3371" aria-hidden="true" tabindex="-1"></a>b: Distribution of simulated sample observations from 9 tosses of the</span>
<span id="cb194-3372"><a href="#cb194-3372" aria-hidden="true" tabindex="-1"></a>globe</span>
<span id="cb194-3373"><a href="#cb194-3373" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3374"><a href="#cb194-3374" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3375"><a href="#cb194-3375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3376"><a href="#cb194-3376" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3377"><a href="#cb194-3377" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3378"><a href="#cb194-3378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3379"><a href="#cb194-3379" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3380"><a href="#cb194-3380" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot-ggplot2-figure-3.5-b</span></span>
<span id="cb194-3381"><a href="#cb194-3381" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Distribution of simulated sample observations from 9 tosses of the globe. These samples assume the proportion of water is 0.7. The plot uses the {**ggplot2**} functions. The left panel is Kurz&#39;s original, the right one is my version slightly changed.&quot;</span></span>
<span id="cb194-3382"><a href="#cb194-3382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3383"><a href="#cb194-3383" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.24b with ggplot2 #########################</span></span>
<span id="cb194-3384"><a href="#cb194-3384" aria-hidden="true" tabindex="-1"></a>n_draws_b <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb194-3385"><a href="#cb194-3385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3386"><a href="#cb194-3386" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3387"><a href="#cb194-3387" aria-hidden="true" tabindex="-1"></a>dummy_w2_b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">draws =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(n_draws_b, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> .<span class="dv">7</span>))</span>
<span id="cb194-3388"><a href="#cb194-3388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3389"><a href="#cb194-3389" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dummy_w2_b <span class="sc">|&gt;</span> </span>
<span id="cb194-3390"><a href="#cb194-3390" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span> </span>
<span id="cb194-3391"><a href="#cb194-3391" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb194-3392"><a href="#cb194-3392" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb194-3393"><a href="#cb194-3393" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-3394"><a href="#cb194-3394" aria-hidden="true" tabindex="-1"></a>    <span class="co"># breaks = 0:10 * 2 = equivalent in Kurz&#39;s versions:  breaks = 0:4 * 2</span></span>
<span id="cb194-3395"><a href="#cb194-3395" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb194-3396"><a href="#cb194-3396" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-3397"><a href="#cb194-3397" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb194-3398"><a href="#cb194-3398" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb194-3399"><a href="#cb194-3399" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-3400"><a href="#cb194-3400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3401"><a href="#cb194-3401" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dummy_w2_b <span class="sc">|&gt;</span> </span>
<span id="cb194-3402"><a href="#cb194-3402" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span> </span>
<span id="cb194-3403"><a href="#cb194-3403" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb194-3404"><a href="#cb194-3404" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb194-3405"><a href="#cb194-3405" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-3406"><a href="#cb194-3406" aria-hidden="true" tabindex="-1"></a>    <span class="do">## breaks = 0:10 * 2 = equivalent in Kurz&#39;s versions:  breaks = 0:4 * 2</span></span>
<span id="cb194-3407"><a href="#cb194-3407" aria-hidden="true" tabindex="-1"></a>    <span class="do">## I decided to set a break at each of the draws: breaks = 0:9 * 1</span></span>
<span id="cb194-3408"><a href="#cb194-3408" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">*</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb194-3409"><a href="#cb194-3409" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-3410"><a href="#cb194-3410" aria-hidden="true" tabindex="-1"></a>    <span class="do">## I did not zoom into the graph because doesn&#39;t look so nice</span></span>
<span id="cb194-3411"><a href="#cb194-3411" aria-hidden="true" tabindex="-1"></a>    <span class="do">## for instance the last line in Kurz’ version is not visible</span></span>
<span id="cb194-3412"><a href="#cb194-3412" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_cartesian(xlim = c(0, 9)) +</span></span>
<span id="cb194-3413"><a href="#cb194-3413" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-3414"><a href="#cb194-3414" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-3415"><a href="#cb194-3415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3416"><a href="#cb194-3416" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb194-3417"><a href="#cb194-3417" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb194-3418"><a href="#cb194-3418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3419"><a href="#cb194-3419" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3420"><a href="#cb194-3420" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3421"><a href="#cb194-3421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3422"><a href="#cb194-3422" aria-hidden="true" tabindex="-1"></a>McElreath suggested to play around with different values of <span class="in">`size`</span> and</span>
<span id="cb194-3423"><a href="#cb194-3423" aria-hidden="true" tabindex="-1"></a><span class="in">`prob`</span>. But instead of reproducing all codes block introduced by Kurz, I</span>
<span id="cb194-3424"><a href="#cb194-3424" aria-hidden="true" tabindex="-1"></a>will just replicate the first chunk, because it has some interesting and</span>
<span id="cb194-3425"><a href="#cb194-3425" aria-hidden="true" tabindex="-1"></a>(for me) unfamiliar functions.</span>
<span id="cb194-3426"><a href="#cb194-3426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3427"><a href="#cb194-3427" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3428"><a href="#cb194-3428" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3429"><a href="#cb194-3429" aria-hidden="true" tabindex="-1"></a>::: {#cnj-sim-9-cond}</span>
<span id="cb194-3430"><a href="#cb194-3430" aria-hidden="true" tabindex="-1"></a>b: Simulated sample observations, using different sizes and</span>
<span id="cb194-3431"><a href="#cb194-3431" aria-hidden="true" tabindex="-1"></a>probabilities</span>
<span id="cb194-3432"><a href="#cb194-3432" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3433"><a href="#cb194-3433" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3434"><a href="#cb194-3434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3435"><a href="#cb194-3435" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3436"><a href="#cb194-3436" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-3437"><a href="#cb194-3437" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Simulation</span></span>
<span id="cb194-3438"><a href="#cb194-3438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3439"><a href="#cb194-3439" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3440"><a href="#cb194-3440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3441"><a href="#cb194-3441" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3442"><a href="#cb194-3442" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: simulate-9-conditions</span></span>
<span id="cb194-3443"><a href="#cb194-3443" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Distribution of 9 simulated sample observations, using different size (number of tosses: 3, 6, 9) and different probabilities (prob: 0.3, 0.6, 0.9).&quot;</span></span>
<span id="cb194-3444"><a href="#cb194-3444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3445"><a href="#cb194-3445" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb194-3446"><a href="#cb194-3446" aria-hidden="true" tabindex="-1"></a>simulate_binom <span class="ot">&lt;-</span> <span class="cf">function</span>(n, probability) {</span>
<span id="cb194-3447"><a href="#cb194-3447" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3448"><a href="#cb194-3448" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">rbinom</span>(n_draws, <span class="at">size =</span> n, <span class="at">prob =</span> probability) </span>
<span id="cb194-3449"><a href="#cb194-3449" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-3450"><a href="#cb194-3450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3451"><a href="#cb194-3451" aria-hidden="true" tabindex="-1"></a>d9_b <span class="ot">&lt;-</span></span>
<span id="cb194-3452"><a href="#cb194-3452" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">crossing</span>(<span class="at">n9_b           =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>),</span>
<span id="cb194-3453"><a href="#cb194-3453" aria-hidden="true" tabindex="-1"></a>           <span class="at">probability9_b =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">6</span>, .<span class="dv">9</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-3454"><a href="#cb194-3454" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">draws9_b =</span> purrr<span class="sc">::</span><span class="fu">map2</span>(n9_b, probability9_b, simulate_binom)) <span class="sc">|&gt;</span> </span>
<span id="cb194-3455"><a href="#cb194-3455" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb194-3456"><a href="#cb194-3456" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n           =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="st">&quot;n = &quot;</span>, n9_b),</span>
<span id="cb194-3457"><a href="#cb194-3457" aria-hidden="true" tabindex="-1"></a>         <span class="at">probability =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="st">&quot;p = &quot;</span>, probability9_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-3458"><a href="#cb194-3458" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(draws9_b)</span>
<span id="cb194-3459"><a href="#cb194-3459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3460"><a href="#cb194-3460" aria-hidden="true" tabindex="-1"></a>d9_b <span class="sc">|&gt;</span> </span>
<span id="cb194-3461"><a href="#cb194-3461" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-3462"><a href="#cb194-3462" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(n9_b)</span>
<span id="cb194-3463"><a href="#cb194-3463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3464"><a href="#cb194-3464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3465"><a href="#cb194-3465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3466"><a href="#cb194-3466" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb194-3467"><a href="#cb194-3467" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb194-3468"><a href="#cb194-3468" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`tidyr::crossing()`</span> and <span class="in">`tidyr::unnest()`</span></span>
<span id="cb194-3469"><a href="#cb194-3469" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3470"><a href="#cb194-3470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3471"><a href="#cb194-3471" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb194-3472"><a href="#cb194-3472" aria-hidden="true" tabindex="-1"></a>I am still not very experienced with <span class="in">`tidyr::crossing()`</span> and</span>
<span id="cb194-3473"><a href="#cb194-3473" aria-hidden="true" tabindex="-1"></a><span class="in">`tidyr::unnest()`</span>:</span>
<span id="cb194-3474"><a href="#cb194-3474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3475"><a href="#cb194-3475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`tidyr::crossing()`** is a wrapper around <span class="in">`tidyr::expand_grid()`</span></span>
<span id="cb194-3476"><a href="#cb194-3476" aria-hidden="true" tabindex="-1"></a>    (not to confuse with <span class="in">`base::expand.grid()`</span>) and therefore creates a</span>
<span id="cb194-3477"><a href="#cb194-3477" aria-hidden="true" tabindex="-1"></a>    tibble from all combination of inputs. In addition to</span>
<span id="cb194-3478"><a href="#cb194-3478" aria-hidden="true" tabindex="-1"></a>    <span class="in">`tidyr::expand_grid()`</span> it de-duplicates and sorts its input.</span>
<span id="cb194-3479"><a href="#cb194-3479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`tidyr::unnest()`** expands a list-column containing data frames</span>
<span id="cb194-3480"><a href="#cb194-3480" aria-hidden="true" tabindex="-1"></a>    into row and columns. In the above case <span class="in">`purrr::map2()`</span> returns a</span>
<span id="cb194-3481"><a href="#cb194-3481" aria-hidden="true" tabindex="-1"></a>    list and stores the data in <span class="in">`draws9_b`</span>.</span>
<span id="cb194-3482"><a href="#cb194-3482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3483"><a href="#cb194-3483" aria-hidden="true" tabindex="-1"></a>Instead of <span class="in">`utils::head()`</span> I used <span class="in">`dplyr::slice_sample()`</span> and ordered</span>
<span id="cb194-3484"><a href="#cb194-3484" aria-hidden="true" tabindex="-1"></a>the result by the first column. I think this will get a better glimpse</span>
<span id="cb194-3485"><a href="#cb194-3485" aria-hidden="true" tabindex="-1"></a>on the data as just the first 6 rows.</span>
<span id="cb194-3486"><a href="#cb194-3486" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3487"><a href="#cb194-3487" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3488"><a href="#cb194-3488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3489"><a href="#cb194-3489" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Plot</span></span>
<span id="cb194-3490"><a href="#cb194-3490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3491"><a href="#cb194-3491" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3492"><a href="#cb194-3492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3493"><a href="#cb194-3493" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3494"><a href="#cb194-3494" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-sim-plot-9-cond-b</span></span>
<span id="cb194-3495"><a href="#cb194-3495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3496"><a href="#cb194-3496" aria-hidden="true" tabindex="-1"></a>d9_b <span class="sc">|&gt;</span> </span>
<span id="cb194-3497"><a href="#cb194-3497" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> draws9_b)) <span class="sc">+</span></span>
<span id="cb194-3498"><a href="#cb194-3498" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb194-3499"><a href="#cb194-3499" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-3500"><a href="#cb194-3500" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb194-3501"><a href="#cb194-3501" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-3502"><a href="#cb194-3502" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb194-3503"><a href="#cb194-3503" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-3504"><a href="#cb194-3504" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb194-3505"><a href="#cb194-3505" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_grid</span>(n9_b <span class="sc">~</span> probability9_b)</span>
<span id="cb194-3506"><a href="#cb194-3506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3507"><a href="#cb194-3507" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3508"><a href="#cb194-3508" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3509"><a href="#cb194-3509" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3510"><a href="#cb194-3510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3511"><a href="#cb194-3511" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model checking</span></span>
<span id="cb194-3512"><a href="#cb194-3512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3513"><a href="#cb194-3513" aria-hidden="true" tabindex="-1"></a>::: my-resource</span>
<span id="cb194-3514"><a href="#cb194-3514" aria-hidden="true" tabindex="-1"></a>::: my-resource-header</span>
<span id="cb194-3515"><a href="#cb194-3515" aria-hidden="true" tabindex="-1"></a>Checking if the software works correctly</span>
<span id="cb194-3516"><a href="#cb194-3516" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3517"><a href="#cb194-3517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3518"><a href="#cb194-3518" aria-hidden="true" tabindex="-1"></a>::: my-resource-container</span>
<span id="cb194-3519"><a href="#cb194-3519" aria-hidden="true" tabindex="-1"></a>On software checking Kurz refers to some material, that is too special</span>
<span id="cb194-3520"><a href="#cb194-3520" aria-hidden="true" tabindex="-1"></a>at the moment for me. I will it include here, even if I had not read it.</span>
<span id="cb194-3521"><a href="#cb194-3521" aria-hidden="true" tabindex="-1"></a>Maybe I will come later here again and pick up these resources when I</span>
<span id="cb194-3522"><a href="#cb194-3522" aria-hidden="true" tabindex="-1"></a>have more experiences with Bayesian statistics and the necessary tools.</span>
<span id="cb194-3523"><a href="#cb194-3523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3524"><a href="#cb194-3524" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>[Esther Williams in the Harold Holt Memorial Swimming</span>
<span id="cb194-3525"><a href="#cb194-3525" aria-hidden="true" tabindex="-1"></a>    Pool](https://youtu.be/pKZLJPrZLhU?t=26285) by [Dan</span>
<span id="cb194-3526"><a href="#cb194-3526" aria-hidden="true" tabindex="-1"></a>    Simpson](https://twitter.com/dan_p_simpson)</span>
<span id="cb194-3527"><a href="#cb194-3527" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>[Visualisation in Bayesian</span>
<span id="cb194-3528"><a href="#cb194-3528" aria-hidden="true" tabindex="-1"></a>    workflow](https://www.youtube.com/watch?v=E8vdXoJId8M), YouTube</span>
<span id="cb194-3529"><a href="#cb194-3529" aria-hidden="true" tabindex="-1"></a>    video lecture at the Royal Statistics Society by Jonah Gabry &amp;</span>
<span id="cb194-3530"><a href="#cb194-3530" aria-hidden="true" tabindex="-1"></a>    Daniel Simpson</span>
<span id="cb194-3531"><a href="#cb194-3531" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>[Maybe it&#39;s time to let the old ways die; or We broke R-hat so now</span>
<span id="cb194-3532"><a href="#cb194-3532" aria-hidden="true" tabindex="-1"></a>    we have to fix</span>
<span id="cb194-3533"><a href="#cb194-3533" aria-hidden="true" tabindex="-1"></a>    it](https://statmodeling.stat.columbia.edu/2019/03/19/maybe-its-time-to-let-the-old-ways-die-or-we-broke-r-hat-so-now-we-have-to-fix-it/),</span>
<span id="cb194-3534"><a href="#cb194-3534" aria-hidden="true" tabindex="-1"></a>    blog post by Daniel Simpson</span>
<span id="cb194-3535"><a href="#cb194-3535" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Vehtari, A., Gelman, A., Simpson, D., Carpenter, B., &amp; Bürkner,</span>
<span id="cb194-3536"><a href="#cb194-3536" aria-hidden="true" tabindex="-1"></a>    P.-C. (2021). Rank-normalization, folding, and localization: An</span>
<span id="cb194-3537"><a href="#cb194-3537" aria-hidden="true" tabindex="-1"></a>    improved $\widehat{R}$ for assessing convergence of MCMC. Bayesian</span>
<span id="cb194-3538"><a href="#cb194-3538" aria-hidden="true" tabindex="-1"></a>    Analysis, 16(2). https://doi.org/10.1214/20-BA1221</span>
<span id="cb194-3539"><a href="#cb194-3539" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3540"><a href="#cb194-3540" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3541"><a href="#cb194-3541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3542"><a href="#cb194-3542" aria-hidden="true" tabindex="-1"></a>There are three computing steps to reproduce the three levels of Figure</span>
<span id="cb194-3543"><a href="#cb194-3543" aria-hidden="true" tabindex="-1"></a>3.6 copied here as @fig-3-6.</span>
<span id="cb194-3544"><a href="#cb194-3544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3545"><a href="#cb194-3545" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Posterior probability (top level)</span>
<span id="cb194-3546"><a href="#cb194-3546" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Sampling distributions for nine values (0.1-0.9) (middle level)</span>
<span id="cb194-3547"><a href="#cb194-3547" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Posterior predictive distribution (bottom level)</span>
<span id="cb194-3548"><a href="#cb194-3548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3549"><a href="#cb194-3549" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3550"><a href="#cb194-3550" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3551"><a href="#cb194-3551" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-3-6-top}</span>
<span id="cb194-3552"><a href="#cb194-3552" aria-hidden="true" tabindex="-1"></a>b: Posterior probability</span>
<span id="cb194-3553"><a href="#cb194-3553" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3554"><a href="#cb194-3554" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3555"><a href="#cb194-3555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3556"><a href="#cb194-3556" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3557"><a href="#cb194-3557" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-3558"><a href="#cb194-3558" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Top</span></span>
<span id="cb194-3559"><a href="#cb194-3559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3560"><a href="#cb194-3560" aria-hidden="true" tabindex="-1"></a>**Posterior probability**</span>
<span id="cb194-3561"><a href="#cb194-3561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3562"><a href="#cb194-3562" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3563"><a href="#cb194-3563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3564"><a href="#cb194-3564" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3565"><a href="#cb194-3565" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-repr-figure-3.6-top-b</span></span>
<span id="cb194-3566"><a href="#cb194-3566" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Reproduction of the top part of figure 3.6&quot;</span></span>
<span id="cb194-3567"><a href="#cb194-3567" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-3568"><a href="#cb194-3568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3569"><a href="#cb194-3569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3570"><a href="#cb194-3570" aria-hidden="true" tabindex="-1"></a><span class="do">## data wrangling ####################</span></span>
<span id="cb194-3571"><a href="#cb194-3571" aria-hidden="true" tabindex="-1"></a>n2_b <span class="ot">&lt;-</span> <span class="dv">1001</span>L</span>
<span id="cb194-3572"><a href="#cb194-3572" aria-hidden="true" tabindex="-1"></a>n_success <span class="ot">&lt;-</span> <span class="dv">6</span>L</span>
<span id="cb194-3573"><a href="#cb194-3573" aria-hidden="true" tabindex="-1"></a>n_trials  <span class="ot">&lt;-</span> <span class="dv">9</span>L</span>
<span id="cb194-3574"><a href="#cb194-3574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3575"><a href="#cb194-3575" aria-hidden="true" tabindex="-1"></a>d2_b <span class="ot">&lt;-</span></span>
<span id="cb194-3576"><a href="#cb194-3576" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid2_b =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> n2_b),</span>
<span id="cb194-3577"><a href="#cb194-3577" aria-hidden="true" tabindex="-1"></a>         <span class="co"># note we&#39;re still using a flat uniform prior</span></span>
<span id="cb194-3578"><a href="#cb194-3578" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior2_b  =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-3579"><a href="#cb194-3579" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">likelihood2_b =</span> </span>
<span id="cb194-3580"><a href="#cb194-3580" aria-hidden="true" tabindex="-1"></a>                stats<span class="sc">::</span><span class="fu">dbinom</span>(n_success, <span class="at">size =</span> n_trials, <span class="at">prob =</span> p_grid2_b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-3581"><a href="#cb194-3581" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">posterior2_b =</span> </span>
<span id="cb194-3582"><a href="#cb194-3582" aria-hidden="true" tabindex="-1"></a>                (likelihood2_b <span class="sc">*</span> prior2_b) <span class="sc">/</span> <span class="fu">sum</span>(likelihood2_b <span class="sc">*</span> prior2_b))</span>
<span id="cb194-3583"><a href="#cb194-3583" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d2_b)</span>
<span id="cb194-3584"><a href="#cb194-3584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3585"><a href="#cb194-3585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3586"><a href="#cb194-3586" aria-hidden="true" tabindex="-1"></a><span class="do">## plot ##############################</span></span>
<span id="cb194-3587"><a href="#cb194-3587" aria-hidden="true" tabindex="-1"></a>d2_b <span class="sc">|&gt;</span> </span>
<span id="cb194-3588"><a href="#cb194-3588" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid2_b, <span class="at">y =</span> posterior2_b)) <span class="sc">+</span></span>
<span id="cb194-3589"><a href="#cb194-3589" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">color =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-3590"><a href="#cb194-3590" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(<span class="at">data =</span> d2_b <span class="sc">|&gt;</span>   </span>
<span id="cb194-3591"><a href="#cb194-3591" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">filter</span>(p_grid2_b <span class="sc">%in%</span> </span>
<span id="cb194-3592"><a href="#cb194-3592" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">1</span>, <span class="at">to =</span> .<span class="dv">9</span>, <span class="at">by =</span> .<span class="dv">1</span>), <span class="dv">3</span> <span class="sc">/</span> <span class="dv">10</span>)),</span>
<span id="cb194-3593"><a href="#cb194-3593" aria-hidden="true" tabindex="-1"></a>     <span class="do">## Note how we Wweight the widths of the vertical lines </span></span>
<span id="cb194-3594"><a href="#cb194-3594" aria-hidden="true" tabindex="-1"></a>     <span class="do">## by the posterior density `posterior2_b`</span></span>
<span id="cb194-3595"><a href="#cb194-3595" aria-hidden="true" tabindex="-1"></a>         ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xend =</span> p_grid2_b, <span class="at">yend =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> posterior2_b),</span>
<span id="cb194-3596"><a href="#cb194-3596" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb194-3597"><a href="#cb194-3597" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> d2_b <span class="sc">|&gt;</span>  </span>
<span id="cb194-3598"><a href="#cb194-3598" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">filter</span>(p_grid2_b <span class="sc">%in%</span> </span>
<span id="cb194-3599"><a href="#cb194-3599" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">1</span>, <span class="at">to =</span> .<span class="dv">9</span>, <span class="at">by =</span> .<span class="dv">1</span>), <span class="dv">3</span> <span class="sc">/</span> <span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb194-3600"><a href="#cb194-3600" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb194-3601"><a href="#cb194-3601" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> .<span class="dv">08</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb194-3602"><a href="#cb194-3602" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;Posterior probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-3603"><a href="#cb194-3603" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_linewidth_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb194-3604"><a href="#cb194-3604" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;probability of water&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-3605"><a href="#cb194-3605" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb194-3606"><a href="#cb194-3606" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-3607"><a href="#cb194-3607" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>()</span>
<span id="cb194-3608"><a href="#cb194-3608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3609"><a href="#cb194-3609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3610"><a href="#cb194-3610" aria-hidden="true" tabindex="-1"></a>At first I thought I do not need to refresh the original grid</span>
<span id="cb194-3611"><a href="#cb194-3611" aria-hidden="true" tabindex="-1"></a>approximation from @cnj-grid-globe-tossing-b as I have it stored it with</span>
<span id="cb194-3612"><a href="#cb194-3612" aria-hidden="true" tabindex="-1"></a>the unique name <span class="in">`d_b`</span>. But it turned out that the above code with</span>
<span id="cb194-3613"><a href="#cb194-3613" aria-hidden="true" tabindex="-1"></a><span class="in">`n_grid_b = 1000L`</span> does not work, because it draws no vertical lines by</span>
<span id="cb194-3614"><a href="#cb194-3614" aria-hidden="true" tabindex="-1"></a>the posterior density. Instead one has to sample 1001 times.</span>
<span id="cb194-3615"><a href="#cb194-3615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3616"><a href="#cb194-3616" aria-hidden="true" tabindex="-1"></a>I noticed that with most sample numbers the plot does not work</span>
<span id="cb194-3617"><a href="#cb194-3617" aria-hidden="true" tabindex="-1"></a>correctly. It worked with 1071. The sequence 1011, 1021, 1031, 1041,</span>
<span id="cb194-3618"><a href="#cb194-3618" aria-hidden="true" tabindex="-1"></a>1051, 1061 misses just one vertical line at $p = 0.7$ An exception is</span>
<span id="cb194-3619"><a href="#cb194-3619" aria-hidden="true" tabindex="-1"></a>1041, which misses $p = 0.6$. I do not know why this happens.</span>
<span id="cb194-3620"><a href="#cb194-3620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3621"><a href="#cb194-3621" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Middle</span></span>
<span id="cb194-3622"><a href="#cb194-3622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3623"><a href="#cb194-3623" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3624"><a href="#cb194-3624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3625"><a href="#cb194-3625" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3626"><a href="#cb194-3626" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-repr-figure-3.6-middle-b</span></span>
<span id="cb194-3627"><a href="#cb194-3627" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Reproduction of the middle part of figure 3.6&quot;</span></span>
<span id="cb194-3628"><a href="#cb194-3628" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-3629"><a href="#cb194-3629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3630"><a href="#cb194-3630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3631"><a href="#cb194-3631" aria-hidden="true" tabindex="-1"></a><span class="do">## data wrangling #####################</span></span>
<span id="cb194-3632"><a href="#cb194-3632" aria-hidden="true" tabindex="-1"></a>n_draws_b <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb194-3633"><a href="#cb194-3633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3634"><a href="#cb194-3634" aria-hidden="true" tabindex="-1"></a>simulate_binom <span class="ot">&lt;-</span> <span class="cf">function</span>(probability) {</span>
<span id="cb194-3635"><a href="#cb194-3635" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3636"><a href="#cb194-3636" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">rbinom</span>(n_draws_b, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> probability) </span>
<span id="cb194-3637"><a href="#cb194-3637" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-3638"><a href="#cb194-3638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3639"><a href="#cb194-3639" aria-hidden="true" tabindex="-1"></a>d_small_b <span class="ot">&lt;-</span></span>
<span id="cb194-3640"><a href="#cb194-3640" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">probability =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">1</span>, <span class="at">to =</span> .<span class="dv">9</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-3641"><a href="#cb194-3641" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">draws =</span> purrr<span class="sc">::</span><span class="fu">map</span>(probability, simulate_binom)) <span class="sc">|&gt;</span>  </span>
<span id="cb194-3642"><a href="#cb194-3642" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(draws) <span class="sc">|&gt;</span> </span>
<span id="cb194-3643"><a href="#cb194-3643" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">label =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="st">&quot;p = &quot;</span>, probability))</span>
<span id="cb194-3644"><a href="#cb194-3644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3645"><a href="#cb194-3645" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(d_small_b)</span>
<span id="cb194-3646"><a href="#cb194-3646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3647"><a href="#cb194-3647" aria-hidden="true" tabindex="-1"></a><span class="do">## plot ###############################</span></span>
<span id="cb194-3648"><a href="#cb194-3648" aria-hidden="true" tabindex="-1"></a>d_small_b <span class="sc">|&gt;</span></span>
<span id="cb194-3649"><a href="#cb194-3649" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span></span>
<span id="cb194-3650"><a href="#cb194-3650" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb194-3651"><a href="#cb194-3651" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-3652"><a href="#cb194-3652" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-3653"><a href="#cb194-3653" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb194-3654"><a href="#cb194-3654" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Sampling distributions&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-3655"><a href="#cb194-3655" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb194-3656"><a href="#cb194-3656" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-3657"><a href="#cb194-3657" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb194-3658"><a href="#cb194-3658" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span> label, <span class="at">ncol =</span> <span class="dv">9</span>)</span>
<span id="cb194-3659"><a href="#cb194-3659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3660"><a href="#cb194-3660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3661"><a href="#cb194-3661" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Bottom</span></span>
<span id="cb194-3662"><a href="#cb194-3662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3663"><a href="#cb194-3663" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3664"><a href="#cb194-3664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3665"><a href="#cb194-3665" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3666"><a href="#cb194-3666" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-repr-figure-3.6-bottom-b</span></span>
<span id="cb194-3667"><a href="#cb194-3667" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Reproduction of the bottom part of figure 3.6&quot;</span></span>
<span id="cb194-3668"><a href="#cb194-3668" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-3669"><a href="#cb194-3669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3670"><a href="#cb194-3670" aria-hidden="true" tabindex="-1"></a><span class="do">## data wrangling ########################################</span></span>
<span id="cb194-3671"><a href="#cb194-3671" aria-hidden="true" tabindex="-1"></a><span class="co"># how many samples would you like?</span></span>
<span id="cb194-3672"><a href="#cb194-3672" aria-hidden="true" tabindex="-1"></a>n_samples_b <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb194-3673"><a href="#cb194-3673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3674"><a href="#cb194-3674" aria-hidden="true" tabindex="-1"></a><span class="co"># make it reproducible</span></span>
<span id="cb194-3675"><a href="#cb194-3675" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3676"><a href="#cb194-3676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3677"><a href="#cb194-3677" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="ot">&lt;-</span></span>
<span id="cb194-3678"><a href="#cb194-3678" aria-hidden="true" tabindex="-1"></a>  d2_b <span class="sc">|&gt;</span> </span>
<span id="cb194-3679"><a href="#cb194-3679" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples_b, <span class="at">weight_by =</span> posterior2_b, <span class="at">replace =</span> T)  <span class="sc">|&gt;</span>  </span>
<span id="cb194-3680"><a href="#cb194-3680" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">w =</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(p_grid2_b, stats<span class="sc">::</span>rbinom, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb194-3681"><a href="#cb194-3681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3682"><a href="#cb194-3682" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(d2_samples_b)</span>
<span id="cb194-3683"><a href="#cb194-3683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3684"><a href="#cb194-3684" aria-hidden="true" tabindex="-1"></a><span class="do">## plot ###################################</span></span>
<span id="cb194-3685"><a href="#cb194-3685" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-3686"><a href="#cb194-3686" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> w)) <span class="sc">+</span></span>
<span id="cb194-3687"><a href="#cb194-3687" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb194-3688"><a href="#cb194-3688" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-3689"><a href="#cb194-3689" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of water samples&quot;</span>,</span>
<span id="cb194-3690"><a href="#cb194-3690" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-3691"><a href="#cb194-3691" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb194-3692"><a href="#cb194-3692" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Posterior predictive distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-3693"><a href="#cb194-3693" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>),</span>
<span id="cb194-3694"><a href="#cb194-3694" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3000</span>)) <span class="sc">+</span></span>
<span id="cb194-3695"><a href="#cb194-3695" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-3696"><a href="#cb194-3696" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-3697"><a href="#cb194-3697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3698"><a href="#cb194-3698" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3699"><a href="#cb194-3699" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3700"><a href="#cb194-3700" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3701"><a href="#cb194-3701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3702"><a href="#cb194-3702" aria-hidden="true" tabindex="-1"></a>In Figure 3.7, McElreath checked the adequacy of the model with</span>
<span id="cb194-3703"><a href="#cb194-3703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3704"><a href="#cb194-3704" aria-hidden="true" tabindex="-1"></a>(a) the longest sequence of the sample values and</span>
<span id="cb194-3705"><a href="#cb194-3705" aria-hidden="true" tabindex="-1"></a>(b) number of switches between water and land.</span>
<span id="cb194-3706"><a href="#cb194-3706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3707"><a href="#cb194-3707" aria-hidden="true" tabindex="-1"></a>But he didn&#39;t show who to calculate and produce his Figure 3.7. To</span>
<span id="cb194-3708"><a href="#cb194-3708" aria-hidden="true" tabindex="-1"></a>compute these alternative views and replicate the graph Kurz used the</span>
<span id="cb194-3709"><a href="#cb194-3709" aria-hidden="true" tabindex="-1"></a>(for me until now unknown) <span class="in">`base::rle()`</span> function in a brilliant manner.</span>
<span id="cb194-3710"><a href="#cb194-3710" aria-hidden="true" tabindex="-1"></a>Before we replicate his computation let&#39;s look more into the details of</span>
<span id="cb194-3711"><a href="#cb194-3711" aria-hidden="true" tabindex="-1"></a><span class="in">`base::rle()`</span></span>
<span id="cb194-3712"><a href="#cb194-3712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3713"><a href="#cb194-3713" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3714"><a href="#cb194-3714" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3715"><a href="#cb194-3715" aria-hidden="true" tabindex="-1"></a>::: {#cnj-rle-function}</span>
<span id="cb194-3716"><a href="#cb194-3716" aria-hidden="true" tabindex="-1"></a>b: How the <span class="in">`base::rle()`</span> function works for checking our model</span>
<span id="cb194-3717"><a href="#cb194-3717" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3718"><a href="#cb194-3718" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3719"><a href="#cb194-3719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3720"><a href="#cb194-3720" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3721"><a href="#cb194-3721" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3722"><a href="#cb194-3722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3723"><a href="#cb194-3723" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3724"><a href="#cb194-3724" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rle-function</span></span>
<span id="cb194-3725"><a href="#cb194-3725" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-3726"><a href="#cb194-3726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3727"><a href="#cb194-3727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3728"><a href="#cb194-3728" aria-hidden="true" tabindex="-1"></a>tosses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>)</span>
<span id="cb194-3729"><a href="#cb194-3729" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">rle</span>(tosses)</span>
<span id="cb194-3730"><a href="#cb194-3730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3731"><a href="#cb194-3731" aria-hidden="true" tabindex="-1"></a><span class="do">## In the left panel of Figure 3.7 we are interested in maximal length</span></span>
<span id="cb194-3732"><a href="#cb194-3732" aria-hidden="true" tabindex="-1"></a><span class="fu">rle</span>(tosses)<span class="sc">$</span>lengths  <span class="sc">|&gt;</span>  <span class="fu">max</span>()</span>
<span id="cb194-3733"><a href="#cb194-3733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3734"><a href="#cb194-3734" aria-hidden="true" tabindex="-1"></a><span class="do">## In the right panel of Figure 3.7 we are interested in maximal switches</span></span>
<span id="cb194-3735"><a href="#cb194-3735" aria-hidden="true" tabindex="-1"></a><span class="fu">rle</span>(tosses)<span class="sc">$</span>lengths <span class="sc">|&gt;</span>  <span class="fu">length</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb194-3736"><a href="#cb194-3736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3737"><a href="#cb194-3737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3738"><a href="#cb194-3738" aria-hidden="true" tabindex="-1"></a>The observed events in our globe tossing example are:</span>
<span id="cb194-3739"><a href="#cb194-3739" aria-hidden="true" tabindex="-1"></a><span class="in">`w,l,w,w,w,l,w,l,w`</span>. The maximal length of consecutive water events is:</span>
<span id="cb194-3740"><a href="#cb194-3740" aria-hidden="true" tabindex="-1"></a><span class="in">`rle(tosses)$lengths  |&gt;  max()`</span> = <span class="in">`r rle(tosses)$lengths  |&gt;  max()`</span>.</span>
<span id="cb194-3741"><a href="#cb194-3741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3742"><a href="#cb194-3742" aria-hidden="true" tabindex="-1"></a>Because <span class="in">`rle()`</span> aggregated the consecutive length of water and land we</span>
<span id="cb194-3743"><a href="#cb194-3743" aria-hidden="true" tabindex="-1"></a>can use this result as the maximum length of switches between water and</span>
<span id="cb194-3744"><a href="#cb194-3744" aria-hidden="true" tabindex="-1"></a>land: <span class="in">`rle(tosses)$lengths |&gt;  length() - 1`</span> =</span>
<span id="cb194-3745"><a href="#cb194-3745" aria-hidden="true" tabindex="-1"></a><span class="in">`r rle(tosses)$lengths |&gt;  length() - 1`</span></span>
<span id="cb194-3746"><a href="#cb194-3746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3747"><a href="#cb194-3747" aria-hidden="true" tabindex="-1"></a>::: my-typo</span>
<span id="cb194-3748"><a href="#cb194-3748" aria-hidden="true" tabindex="-1"></a>::: my-typo-header</span>
<span id="cb194-3749"><a href="#cb194-3749" aria-hidden="true" tabindex="-1"></a>Different observations versus switches</span>
<span id="cb194-3750"><a href="#cb194-3750" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3751"><a href="#cb194-3751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3752"><a href="#cb194-3752" aria-hidden="true" tabindex="-1"></a>::: my-typo-container</span>
<span id="cb194-3753"><a href="#cb194-3753" aria-hidden="true" tabindex="-1"></a>I think there is a small miscalculation in Kurz&#39; text: The number of</span>
<span id="cb194-3754"><a href="#cb194-3754" aria-hidden="true" tabindex="-1"></a>switches is the length of different observation minus one. There are 7</span>
<span id="cb194-3755"><a href="#cb194-3755" aria-hidden="true" tabindex="-1"></a>different observation but only 6 switches. This also conforms to the</span>
<span id="cb194-3756"><a href="#cb194-3756" aria-hidden="true" tabindex="-1"></a>book.</span>
<span id="cb194-3757"><a href="#cb194-3757" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3758"><a href="#cb194-3758" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3759"><a href="#cb194-3759" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3760"><a href="#cb194-3760" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3761"><a href="#cb194-3761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3762"><a href="#cb194-3762" aria-hidden="true" tabindex="-1"></a>Now we will follow Kurz&#39; procedure of calculating and plotting Figure</span>
<span id="cb194-3763"><a href="#cb194-3763" aria-hidden="true" tabindex="-1"></a>3.7.</span>
<span id="cb194-3764"><a href="#cb194-3764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3765"><a href="#cb194-3765" aria-hidden="true" tabindex="-1"></a>::: my-procedure</span>
<span id="cb194-3766"><a href="#cb194-3766" aria-hidden="true" tabindex="-1"></a>::: my-procedure-header</span>
<span id="cb194-3767"><a href="#cb194-3767" aria-hidden="true" tabindex="-1"></a>::: {#prp-rle-function}</span>
<span id="cb194-3768"><a href="#cb194-3768" aria-hidden="true" tabindex="-1"></a>: How the <span class="in">`base::rle()`</span> function works</span>
<span id="cb194-3769"><a href="#cb194-3769" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3770"><a href="#cb194-3770" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3771"><a href="#cb194-3771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3772"><a href="#cb194-3772" aria-hidden="true" tabindex="-1"></a>::: my-procedure-container</span>
<span id="cb194-3773"><a href="#cb194-3773" aria-hidden="true" tabindex="-1"></a>He reasoned:</span>
<span id="cb194-3774"><a href="#cb194-3774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3775"><a href="#cb194-3775" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>We&#39;ve been using <span class="in">`stats::rbinom()`</span> with the size parameter set to 9</span>
<span id="cb194-3776"><a href="#cb194-3776" aria-hidden="true" tabindex="-1"></a>    for our simulations for a certain number of observation, e.g., 10</span>
<span id="cb194-3777"><a href="#cb194-3777" aria-hidden="true" tabindex="-1"></a>    experiments á la 9 tosses each. This gives us the aggregated results</span>
<span id="cb194-3778"><a href="#cb194-3778" aria-hidden="true" tabindex="-1"></a>    of the number of water events: <span class="in">`rbinom(10, size = 9, prob = .6)`</span> =</span>
<span id="cb194-3779"><a href="#cb194-3779" aria-hidden="true" tabindex="-1"></a>    <span class="in">`r rbinom(10, size = 9, prob = .6)`</span></span>
<span id="cb194-3780"><a href="#cb194-3780" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>But what we need is to simulate nine *individual* trials many times</span>
<span id="cb194-3781"><a href="#cb194-3781" aria-hidden="true" tabindex="-1"></a>    over: <span class="in">`rbinom(9, size = 1, prob = .6)`</span> =</span>
<span id="cb194-3782"><a href="#cb194-3782" aria-hidden="true" tabindex="-1"></a>    <span class="in">`r rbinom(9, size = 1, prob = .6)`</span></span>
<span id="cb194-3783"><a href="#cb194-3783" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>We simulate the result of individual trials many times and add their</span>
<span id="cb194-3784"><a href="#cb194-3784" aria-hidden="true" tabindex="-1"></a>    outcomes into a tibble <span class="in">`d2_samples_b`</span>.</span>
<span id="cb194-3785"><a href="#cb194-3785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3786"><a href="#cb194-3786" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3787"><a href="#cb194-3787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3788"><a href="#cb194-3788" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3789"><a href="#cb194-3789" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim-indiv-trials</span></span>
<span id="cb194-3790"><a href="#cb194-3790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3791"><a href="#cb194-3791" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-3792"><a href="#cb194-3792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3793"><a href="#cb194-3793" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="ot">&lt;-</span></span>
<span id="cb194-3794"><a href="#cb194-3794" aria-hidden="true" tabindex="-1"></a>  d2_samples_b <span class="sc">|&gt;</span> </span>
<span id="cb194-3795"><a href="#cb194-3795" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">iter  =</span> <span class="dv">1</span><span class="sc">:</span>dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb194-3796"><a href="#cb194-3796" aria-hidden="true" tabindex="-1"></a>         <span class="at">draws =</span> purrr<span class="sc">::</span><span class="fu">map</span>(p_grid2_b, rbinom, <span class="at">n =</span> <span class="dv">9</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-3797"><a href="#cb194-3797" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(draws)</span>
<span id="cb194-3798"><a href="#cb194-3798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3799"><a href="#cb194-3799" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(d2_samples_b)</span>
<span id="cb194-3800"><a href="#cb194-3800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3801"><a href="#cb194-3801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3802"><a href="#cb194-3802" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Now we can use the <span class="in">`base:rle()`</span>function to compute consecutive</span>
<span id="cb194-3803"><a href="#cb194-3803" aria-hidden="true" tabindex="-1"></a>    length and number of switches:</span>
<span id="cb194-3804"><a href="#cb194-3804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3805"><a href="#cb194-3805" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb194-3806"><a href="#cb194-3806" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Length</span></span>
<span id="cb194-3807"><a href="#cb194-3807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3808"><a href="#cb194-3808" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3809"><a href="#cb194-3809" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3810"><a href="#cb194-3810" aria-hidden="true" tabindex="-1"></a>::: {#cnj-repl-fig-3.7-left}</span>
<span id="cb194-3811"><a href="#cb194-3811" aria-hidden="true" tabindex="-1"></a>b: Replication of left panel of Figure 3.7</span>
<span id="cb194-3812"><a href="#cb194-3812" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3813"><a href="#cb194-3813" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3814"><a href="#cb194-3814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3815"><a href="#cb194-3815" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3816"><a href="#cb194-3816" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3817"><a href="#cb194-3817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3818"><a href="#cb194-3818" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3819"><a href="#cb194-3819" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-left-panel-3-7</span></span>
<span id="cb194-3820"><a href="#cb194-3820" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;The length of the maximum run of water or land&quot;</span></span>
<span id="cb194-3821"><a href="#cb194-3821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3822"><a href="#cb194-3822" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="sc">|&gt;</span></span>
<span id="cb194-3823"><a href="#cb194-3823" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(iter) <span class="sc">|&gt;</span> </span>
<span id="cb194-3824"><a href="#cb194-3824" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">longest_run_length =</span> base<span class="sc">::</span><span class="fu">rle</span>(draws)<span class="sc">$</span>lengths <span class="sc">|&gt;</span> </span>
<span id="cb194-3825"><a href="#cb194-3825" aria-hidden="true" tabindex="-1"></a>              base<span class="sc">::</span><span class="fu">max</span>()) <span class="sc">|&gt;</span></span>
<span id="cb194-3826"><a href="#cb194-3826" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-3827"><a href="#cb194-3827" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> longest_run_length)) <span class="sc">+</span></span>
<span id="cb194-3828"><a href="#cb194-3828" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">fill =</span> longest_run_length <span class="sc">==</span> <span class="dv">3</span>),</span>
<span id="cb194-3829"><a href="#cb194-3829" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb194-3830"><a href="#cb194-3830" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-3831"><a href="#cb194-3831" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb194-3832"><a href="#cb194-3832" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;longest run length&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-3833"><a href="#cb194-3833" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-3834"><a href="#cb194-3834" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb194-3835"><a href="#cb194-3835" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb194-3836"><a href="#cb194-3836" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb194-3837"><a href="#cb194-3837" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) </span>
<span id="cb194-3838"><a href="#cb194-3838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3839"><a href="#cb194-3839" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3840"><a href="#cb194-3840" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3841"><a href="#cb194-3841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3842"><a href="#cb194-3842" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Switches</span></span>
<span id="cb194-3843"><a href="#cb194-3843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3844"><a href="#cb194-3844" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3845"><a href="#cb194-3845" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3846"><a href="#cb194-3846" aria-hidden="true" tabindex="-1"></a>&lt;div&gt;</span>
<span id="cb194-3847"><a href="#cb194-3847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3848"><a href="#cb194-3848" aria-hidden="true" tabindex="-1"></a>b: Replication of right panel of Figure 3.7</span>
<span id="cb194-3849"><a href="#cb194-3849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3850"><a href="#cb194-3850" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb194-3851"><a href="#cb194-3851" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3852"><a href="#cb194-3852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3853"><a href="#cb194-3853" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3854"><a href="#cb194-3854" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3855"><a href="#cb194-3855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3856"><a href="#cb194-3856" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3857"><a href="#cb194-3857" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-right-panel-3-7</span></span>
<span id="cb194-3858"><a href="#cb194-3858" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;The number of switches between water and land samples&quot;</span></span>
<span id="cb194-3859"><a href="#cb194-3859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3860"><a href="#cb194-3860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3861"><a href="#cb194-3861" aria-hidden="true" tabindex="-1"></a>d2_samples_b <span class="sc">|&gt;</span></span>
<span id="cb194-3862"><a href="#cb194-3862" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(iter) <span class="sc">|&gt;</span></span>
<span id="cb194-3863"><a href="#cb194-3863" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">number_of_switches =</span> base<span class="sc">::</span><span class="fu">rle</span>(draws)<span class="sc">$</span>lengths <span class="sc">|&gt;</span></span>
<span id="cb194-3864"><a href="#cb194-3864" aria-hidden="true" tabindex="-1"></a>                     base<span class="sc">::</span><span class="fu">length</span>()) <span class="sc">|&gt;</span></span>
<span id="cb194-3865"><a href="#cb194-3865" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-3866"><a href="#cb194-3866" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> number_of_switches)) <span class="sc">+</span></span>
<span id="cb194-3867"><a href="#cb194-3867" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">fill =</span> number_of_switches <span class="sc">==</span> <span class="dv">6</span>),</span>
<span id="cb194-3868"><a href="#cb194-3868" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb194-3869"><a href="#cb194-3869" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-3870"><a href="#cb194-3870" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb194-3871"><a href="#cb194-3871" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of switches&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-3872"><a href="#cb194-3872" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-3873"><a href="#cb194-3873" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb194-3874"><a href="#cb194-3874" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb194-3875"><a href="#cb194-3875" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb194-3876"><a href="#cb194-3876" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb194-3877"><a href="#cb194-3877" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3878"><a href="#cb194-3878" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3879"><a href="#cb194-3879" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3880"><a href="#cb194-3880" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3881"><a href="#cb194-3881" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3882"><a href="#cb194-3882" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3883"><a href="#cb194-3883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3884"><a href="#cb194-3884" aria-hidden="true" tabindex="-1"></a>::: my-important</span>
<span id="cb194-3885"><a href="#cb194-3885" aria-hidden="true" tabindex="-1"></a>::: my-important-header</span>
<span id="cb194-3886"><a href="#cb194-3886" aria-hidden="true" tabindex="-1"></a>Check model adequacy with alternative views of the same posterior</span>
<span id="cb194-3887"><a href="#cb194-3887" aria-hidden="true" tabindex="-1"></a>predictive distribution</span>
<span id="cb194-3888"><a href="#cb194-3888" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3889"><a href="#cb194-3889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3890"><a href="#cb194-3890" aria-hidden="true" tabindex="-1"></a>::: my-important-container</span>
<span id="cb194-3891"><a href="#cb194-3891" aria-hidden="true" tabindex="-1"></a>For me there are two conclusion to draw from the section on model</span>
<span id="cb194-3892"><a href="#cb194-3892" aria-hidden="true" tabindex="-1"></a>checking:</span>
<span id="cb194-3893"><a href="#cb194-3893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3894"><a href="#cb194-3894" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>It is possible and also important to look at the data generated by</span>
<span id="cb194-3895"><a href="#cb194-3895" aria-hidden="true" tabindex="-1"></a>    the model from different angels.</span>
<span id="cb194-3896"><a href="#cb194-3896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3897"><a href="#cb194-3897" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; &quot;Instead of considering the data as the model saw it, as a sum of</span></span>
<span id="cb194-3898"><a href="#cb194-3898" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; water samples, now we view the data as both the length of the maximum</span></span>
<span id="cb194-3899"><a href="#cb194-3899" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; run of water or land (left) and the number of switches between water</span></span>
<span id="cb194-3900"><a href="#cb194-3900" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; and land samples (right).&quot; ([McElreath, 2020, p.</span></span>
<span id="cb194-3901"><a href="#cb194-3901" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 67](zotero://select/groups/5243560/items/NFUEVASQ))</span></span>
<span id="cb194-3902"><a href="#cb194-3902" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5243560/items/CPFRPHX8?page=86&amp;annotation=W7II5H76)</span><span class="at">)</span></span>
<span id="cb194-3903"><a href="#cb194-3903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3904"><a href="#cb194-3904" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>To generate alternative views at the requires some ingenuity and an</span>
<span id="cb194-3905"><a href="#cb194-3905" aria-hidden="true" tabindex="-1"></a>    evaluation if the model is adequate. For instance: 6 switches in 9</span>
<span id="cb194-3906"><a href="#cb194-3906" aria-hidden="true" tabindex="-1"></a>    tosses in not consistent with the distribution of the longest runs.</span>
<span id="cb194-3907"><a href="#cb194-3907" aria-hidden="true" tabindex="-1"></a>    There should be fewer switches.</span>
<span id="cb194-3908"><a href="#cb194-3908" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3909"><a href="#cb194-3909" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3910"><a href="#cb194-3910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3911"><a href="#cb194-3911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3912"><a href="#cb194-3912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3913"><a href="#cb194-3913" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Let&#39;s practice with {**brms**}</span></span>
<span id="cb194-3914"><a href="#cb194-3914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3915"><a href="#cb194-3915" aria-hidden="true" tabindex="-1"></a>The content of this section is more or less copied from Kurz without</span>
<span id="cb194-3916"><a href="#cb194-3916" aria-hidden="true" tabindex="-1"></a>much knowledge of {**brms**}. The following code chunks are therefore my</span>
<span id="cb194-3917"><a href="#cb194-3917" aria-hidden="true" tabindex="-1"></a>first acquaintance with the {**brms**} package and my reassurance that</span>
<span id="cb194-3918"><a href="#cb194-3918" aria-hidden="true" tabindex="-1"></a>the package installation did work and to test if I get the same results</span>
<span id="cb194-3919"><a href="#cb194-3919" aria-hidden="true" tabindex="-1"></a>as Kurz.</span>
<span id="cb194-3920"><a href="#cb194-3920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3921"><a href="#cb194-3921" aria-hidden="true" tabindex="-1"></a>::: my-resource</span>
<span id="cb194-3922"><a href="#cb194-3922" aria-hidden="true" tabindex="-1"></a>::: my-resource-header</span>
<span id="cb194-3923"><a href="#cb194-3923" aria-hidden="true" tabindex="-1"></a>How to use <span class="in">`r glossary(&quot;brms&quot;)`</span></span>
<span id="cb194-3924"><a href="#cb194-3924" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3925"><a href="#cb194-3925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3926"><a href="#cb194-3926" aria-hidden="true" tabindex="-1"></a>::: my-resource-container</span>
<span id="cb194-3927"><a href="#cb194-3927" aria-hidden="true" tabindex="-1"></a>I still have to read [How to use</span>
<span id="cb194-3928"><a href="#cb194-3928" aria-hidden="true" tabindex="-1"></a>{**brms**}](https://github.com/paul-buerkner/brms#how-to-use-brms) and</span>
<span id="cb194-3929"><a href="#cb194-3929" aria-hidden="true" tabindex="-1"></a>the many <span class="co">[</span><span class="ot">packages vignettes</span><span class="co">](https://paul-buerkner.github.io/brms/)</span> in</span>
<span id="cb194-3930"><a href="#cb194-3930" aria-hidden="true" tabindex="-1"></a>the help file or at the website.</span>
<span id="cb194-3931"><a href="#cb194-3931" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3932"><a href="#cb194-3932" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3933"><a href="#cb194-3933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3934"><a href="#cb194-3934" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; With {**brms**}, we&#39;ll fit the primary model of $w=6$ and $n=9$ much</span></span>
<span id="cb194-3935"><a href="#cb194-3935" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; like we did at the end of @sec-chap02.</span></span>
<span id="cb194-3936"><a href="#cb194-3936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3937"><a href="#cb194-3937" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb194-3938"><a href="#cb194-3938" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb194-3939"><a href="#cb194-3939" aria-hidden="true" tabindex="-1"></a>::: {#cnj-b3.1}</span>
<span id="cb194-3940"><a href="#cb194-3940" aria-hidden="true" tabindex="-1"></a>b: Fit model and compute posterior summary for <span class="in">`b_Intercept`</span>, the</span>
<span id="cb194-3941"><a href="#cb194-3941" aria-hidden="true" tabindex="-1"></a>probability of a &quot;w&quot;</span>
<span id="cb194-3942"><a href="#cb194-3942" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3943"><a href="#cb194-3943" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3944"><a href="#cb194-3944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3945"><a href="#cb194-3945" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb194-3946"><a href="#cb194-3946" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-3947"><a href="#cb194-3947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3948"><a href="#cb194-3948" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-3949"><a href="#cb194-3949" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: brms-model-fit-b</span></span>
<span id="cb194-3950"><a href="#cb194-3950" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb194-3951"><a href="#cb194-3951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3952"><a href="#cb194-3952" aria-hidden="true" tabindex="-1"></a>b3<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb194-3953"><a href="#cb194-3953" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span>(<span class="at">data =</span> <span class="fu">list</span>(<span class="at">w =</span> <span class="dv">6</span>), </span>
<span id="cb194-3954"><a href="#cb194-3954" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb194-3955"><a href="#cb194-3955" aria-hidden="true" tabindex="-1"></a>      w <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">9</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept,</span>
<span id="cb194-3956"><a href="#cb194-3956" aria-hidden="true" tabindex="-1"></a>      <span class="co"># this is a flat prior</span></span>
<span id="cb194-3957"><a href="#cb194-3957" aria-hidden="true" tabindex="-1"></a>      brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">lb =</span> <span class="dv">0</span>, <span class="at">ub =</span> <span class="dv">1</span>),</span>
<span id="cb194-3958"><a href="#cb194-3958" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb194-3959"><a href="#cb194-3959" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">3</span>,</span>
<span id="cb194-3960"><a href="#cb194-3960" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b03.01&quot;</span>)</span>
<span id="cb194-3961"><a href="#cb194-3961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3962"><a href="#cb194-3962" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">posterior_summary</span>(b3<span class="fl">.1</span>)[<span class="st">&quot;b_Intercept&quot;</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb194-3963"><a href="#cb194-3963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb194-3964"><a href="#cb194-3964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-3965"><a href="#cb194-3965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3966"><a href="#cb194-3966" aria-hidden="true" tabindex="-1"></a>**Explication of the result**</span>
<span id="cb194-3967"><a href="#cb194-3967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3968"><a href="#cb194-3968" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Estimate`</span> is the posterior mean,</span>
<span id="cb194-3969"><a href="#cb194-3969" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the two <span class="in">`Q`</span> columns are the quantile-based 95% intervals,</span>
<span id="cb194-3970"><a href="#cb194-3970" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the <span class="in">`Est.Error`</span> is the posterior standard deviation.</span>
<span id="cb194-3971"><a href="#cb194-3971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3972"><a href="#cb194-3972" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3973"><a href="#cb194-3973" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3974"><a href="#cb194-3974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3975"><a href="#cb194-3975" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb194-3976"><a href="#cb194-3976" aria-hidden="true" tabindex="-1"></a>I have already some experience with the beta distribution from my study</span>
<span id="cb194-3977"><a href="#cb194-3977" aria-hidden="true" tabindex="-1"></a>of [Bayesian Statistics the Fun Way: Understanding Statistics and</span>
<span id="cb194-3978"><a href="#cb194-3978" aria-hidden="true" tabindex="-1"></a>Probability With Star Wars, LEGO, and Rubber</span>
<span id="cb194-3979"><a href="#cb194-3979" aria-hidden="true" tabindex="-1"></a>Ducks](https://nostarch.com/learnbayes) by Will Kurt <span class="co">[</span><span class="ot">@kurt2019</span><span class="co">]</span>. See</span>
<span id="cb194-3980"><a href="#cb194-3980" aria-hidden="true" tabindex="-1"></a>also my [Quarto book</span>
<span id="cb194-3981"><a href="#cb194-3981" aria-hidden="true" tabindex="-1"></a>notes](https://bookdown.org/pbaumgartner/bayesian-fun/). There is more</span>
<span id="cb194-3982"><a href="#cb194-3982" aria-hidden="true" tabindex="-1"></a>about the beta distribution in @sec-chap12.</span>
<span id="cb194-3983"><a href="#cb194-3983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3984"><a href="#cb194-3984" aria-hidden="true" tabindex="-1"></a>But I will still have to learn about the syntax of the first three</span>
<span id="cb194-3985"><a href="#cb194-3985" aria-hidden="true" tabindex="-1"></a>lines. The rest of the model description is more or less</span>
<span id="cb194-3986"><a href="#cb194-3986" aria-hidden="true" tabindex="-1"></a>self-explanatory.</span>
<span id="cb194-3987"><a href="#cb194-3987" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-3988"><a href="#cb194-3988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3989"><a href="#cb194-3989" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Much like the way we used the </span><span class="in">`dplyr::slice_sample()`</span><span class="at"> function to</span></span>
<span id="cb194-3990"><a href="#cb194-3990" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; simulate probability values, above, we can do so with the</span></span>
<span id="cb194-3991"><a href="#cb194-3991" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`brms::fitted()`</span><span class="at"> function. But we will have to specify</span></span>
<span id="cb194-3992"><a href="#cb194-3992" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`scale = &quot;linear&quot;`</span><span class="at"> in order to return results in the probability</span></span>
<span id="cb194-3993"><a href="#cb194-3993" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; metric. By default, </span><span class="in">`brms::fitted()`</span><span class="at"> will return summary information.</span></span>
<span id="cb194-3994"><a href="#cb194-3994" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Since we want actual simulation draws, we&#39;ll specify </span><span class="in">`summary = F`</span><span class="at">.</span></span>
<span id="cb194-3995"><a href="#cb194-3995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3996"><a href="#cb194-3996" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-3997"><a href="#cb194-3997" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-3998"><a href="#cb194-3998" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-brms-sim-b}</span>
<span id="cb194-3999"><a href="#cb194-3999" aria-hidden="true" tabindex="-1"></a>b: Simulation of probability values </span>
<span id="cb194-4000"><a href="#cb194-4000" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4001"><a href="#cb194-4001" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4002"><a href="#cb194-4002" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4003"><a href="#cb194-4003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4004"><a href="#cb194-4004" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4005"><a href="#cb194-4005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4006"><a href="#cb194-4006" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4007"><a href="#cb194-4007" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim-prob-values-b</span></span>
<span id="cb194-4008"><a href="#cb194-4008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4009"><a href="#cb194-4009" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb194-4010"><a href="#cb194-4010" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">:::</span><span class="fu">fitted.brmsfit</span>(b3<span class="fl">.1</span>, </span>
<span id="cb194-4011"><a href="#cb194-4011" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F,</span>
<span id="cb194-4012"><a href="#cb194-4012" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-4013"><a href="#cb194-4013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb194-4014"><a href="#cb194-4014" aria-hidden="true" tabindex="-1"></a>  rlang<span class="sc">::</span><span class="fu">set_names</span>(<span class="st">&quot;p&quot;</span>)</span>
<span id="cb194-4015"><a href="#cb194-4015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4016"><a href="#cb194-4016" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(f)</span>
<span id="cb194-4017"><a href="#cb194-4017" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4018"><a href="#cb194-4018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4019"><a href="#cb194-4019" aria-hidden="true" tabindex="-1"></a>:::::{.my-watch-out}</span>
<span id="cb194-4020"><a href="#cb194-4020" aria-hidden="true" tabindex="-1"></a>:::{.my-watch-out-header}</span>
<span id="cb194-4021"><a href="#cb194-4021" aria-hidden="true" tabindex="-1"></a>How to use <span class="co">[</span><span class="ot">S3 methods</span><span class="co">](https://adv-r.hadley.nz/s3.html)</span> without</span>
<span id="cb194-4022"><a href="#cb194-4022" aria-hidden="true" tabindex="-1"></a>attached package?</span>
<span id="cb194-4023"><a href="#cb194-4023" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4024"><a href="#cb194-4024" aria-hidden="true" tabindex="-1"></a>::::{.my-watch-out-container}</span>
<span id="cb194-4025"><a href="#cb194-4025" aria-hidden="true" tabindex="-1"></a>I had problems with the following code chunk. See [my postings at Kurz&#39;s</span>
<span id="cb194-4026"><a href="#cb194-4026" aria-hidden="true" tabindex="-1"></a>repo](https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues/49).</span>
<span id="cb194-4027"><a href="#cb194-4027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4028"><a href="#cb194-4028" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4029"><a href="#cb194-4029" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4030"><a href="#cb194-4030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4031"><a href="#cb194-4031" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4032"><a href="#cb194-4032" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4033"><a href="#cb194-4033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4034"><a href="#cb194-4034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4035"><a href="#cb194-4035" aria-hidden="true" tabindex="-1"></a>Now we can display the density and the posterior predictive distribution</span>
<span id="cb194-4036"><a href="#cb194-4036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4037"><a href="#cb194-4037" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-4038"><a href="#cb194-4038" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Density</span></span>
<span id="cb194-4039"><a href="#cb194-4039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4040"><a href="#cb194-4040" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4041"><a href="#cb194-4041" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4042"><a href="#cb194-4042" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-fig-brms-3-6-top-b}</span>
<span id="cb194-4043"><a href="#cb194-4043" aria-hidden="true" tabindex="-1"></a>b: Model b3.1: Density and posterior predictive distribution</span>
<span id="cb194-4044"><a href="#cb194-4044" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4045"><a href="#cb194-4045" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4046"><a href="#cb194-4046" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4047"><a href="#cb194-4047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4048"><a href="#cb194-4048" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4049"><a href="#cb194-4049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4050"><a href="#cb194-4050" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4051"><a href="#cb194-4051" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-brms-3-6-top-b</span></span>
<span id="cb194-4052"><a href="#cb194-4052" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Density plot of the fittet {brms} model&quot;</span></span>
<span id="cb194-4053"><a href="#cb194-4053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4054"><a href="#cb194-4054" aria-hidden="true" tabindex="-1"></a>f <span class="sc">|&gt;</span> </span>
<span id="cb194-4055"><a href="#cb194-4055" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p)) <span class="sc">+</span></span>
<span id="cb194-4056"><a href="#cb194-4056" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;deepskyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-4057"><a href="#cb194-4057" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">08</span>, <span class="at">y =</span> <span class="fl">2.5</span>,</span>
<span id="cb194-4058"><a href="#cb194-4058" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Posterior probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-4059"><a href="#cb194-4059" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb194-4060"><a href="#cb194-4060" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>),</span>
<span id="cb194-4061"><a href="#cb194-4061" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb194-4062"><a href="#cb194-4062" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb194-4063"><a href="#cb194-4063" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-4064"><a href="#cb194-4064" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-4065"><a href="#cb194-4065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4066"><a href="#cb194-4066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4067"><a href="#cb194-4067" aria-hidden="true" tabindex="-1"></a>The graphic should look like the top part of @fig-3-6.</span>
<span id="cb194-4068"><a href="#cb194-4068" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4069"><a href="#cb194-4069" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4070"><a href="#cb194-4070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4071"><a href="#cb194-4071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4072"><a href="#cb194-4072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4073"><a href="#cb194-4073" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Predictive</span></span>
<span id="cb194-4074"><a href="#cb194-4074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4075"><a href="#cb194-4075" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4076"><a href="#cb194-4076" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4077"><a href="#cb194-4077" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-fig-brms-3-6-bottom-b}</span>
<span id="cb194-4078"><a href="#cb194-4078" aria-hidden="true" tabindex="-1"></a>b: Posterior predictive distribution for model b3.1</span>
<span id="cb194-4079"><a href="#cb194-4079" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4080"><a href="#cb194-4080" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4081"><a href="#cb194-4081" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4082"><a href="#cb194-4082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4083"><a href="#cb194-4083" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4084"><a href="#cb194-4084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4085"><a href="#cb194-4085" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4086"><a href="#cb194-4086" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-brms-3-6-bottom-b</span></span>
<span id="cb194-4087"><a href="#cb194-4087" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Simulation to predict posterior distribution&quot; </span></span>
<span id="cb194-4088"><a href="#cb194-4088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4089"><a href="#cb194-4089" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb194-4090"><a href="#cb194-4090" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb194-4091"><a href="#cb194-4091" aria-hidden="true" tabindex="-1"></a>  f <span class="sc">|&gt;</span> </span>
<span id="cb194-4092"><a href="#cb194-4092" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">w2 =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(dplyr<span class="sc">::</span><span class="fu">n</span>(), <span class="at">size =</span> <span class="dv">9</span>,  <span class="at">prob =</span> p))</span>
<span id="cb194-4093"><a href="#cb194-4093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4094"><a href="#cb194-4094" aria-hidden="true" tabindex="-1"></a><span class="co"># the plot</span></span>
<span id="cb194-4095"><a href="#cb194-4095" aria-hidden="true" tabindex="-1"></a>f <span class="sc">|&gt;</span> </span>
<span id="cb194-4096"><a href="#cb194-4096" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> w2)) <span class="sc">+</span></span>
<span id="cb194-4097"><a href="#cb194-4097" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb194-4098"><a href="#cb194-4098" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-4099"><a href="#cb194-4099" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of water samples&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb194-4100"><a href="#cb194-4100" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5000</span>)) <span class="sc">+</span></span>
<span id="cb194-4101"><a href="#cb194-4101" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Posterior predictive distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-4102"><a href="#cb194-4102" aria-hidden="true" tabindex="-1"></a><span class="co">#  ggplot2::coord_cartesian(xlim = c(0, 9)) +</span></span>
<span id="cb194-4103"><a href="#cb194-4103" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-4104"><a href="#cb194-4104" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-4105"><a href="#cb194-4105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4106"><a href="#cb194-4106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4107"><a href="#cb194-4107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4108"><a href="#cb194-4108" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Much like we did with samples, we can use this distribution of</span></span>
<span id="cb194-4109"><a href="#cb194-4109" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probabilities to predict histograms of $w$ counts. With those in hand,</span></span>
<span id="cb194-4110"><a href="#cb194-4110" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; we can make an analogue to the histogram in the bottom panel of Figure</span></span>
<span id="cb194-4111"><a href="#cb194-4111" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 3.6 (copied here into the text as @fig-3-6)</span></span>
<span id="cb194-4112"><a href="#cb194-4112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4113"><a href="#cb194-4113" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4114"><a href="#cb194-4114" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4115"><a href="#cb194-4115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4116"><a href="#cb194-4116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4117"><a href="#cb194-4117" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4118"><a href="#cb194-4118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4119"><a href="#cb194-4119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4120"><a href="#cb194-4120" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practice</span></span>
<span id="cb194-4121"><a href="#cb194-4121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4122"><a href="#cb194-4122" aria-hidden="true" tabindex="-1"></a><span class="fu">### Easy</span></span>
<span id="cb194-4123"><a href="#cb194-4123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4124"><a href="#cb194-4124" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4125"><a href="#cb194-4125" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4126"><a href="#cb194-4126" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-exercise-data-3.27}</span>
<span id="cb194-4127"><a href="#cb194-4127" aria-hidden="true" tabindex="-1"></a>: Posterior distribution for the globe tossing example exercises</span>
<span id="cb194-4128"><a href="#cb194-4128" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4129"><a href="#cb194-4129" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4130"><a href="#cb194-4130" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4131"><a href="#cb194-4131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4132"><a href="#cb194-4132" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-4133"><a href="#cb194-4133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4134"><a href="#cb194-4134" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Original</span></span>
<span id="cb194-4135"><a href="#cb194-4135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4136"><a href="#cb194-4136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4137"><a href="#cb194-4137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4138"><a href="#cb194-4138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4139"><a href="#cb194-4139" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4140"><a href="#cb194-4140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4141"><a href="#cb194-4141" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4142"><a href="#cb194-4142" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-data-3.27a</span></span>
<span id="cb194-4143"><a href="#cb194-4143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4144"><a href="#cb194-4144" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.27a for exercises  #######################</span></span>
<span id="cb194-4145"><a href="#cb194-4145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4146"><a href="#cb194-4146" aria-hidden="true" tabindex="-1"></a>p_grid_3ea <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb194-4147"><a href="#cb194-4147" aria-hidden="true" tabindex="-1"></a>prior_3ea <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb194-4148"><a href="#cb194-4148" aria-hidden="true" tabindex="-1"></a>likelihood_3ea <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid_3ea)</span>
<span id="cb194-4149"><a href="#cb194-4149" aria-hidden="true" tabindex="-1"></a>posterior_3ea <span class="ot">&lt;-</span> likelihood_3ea <span class="sc">*</span> prior_3ea</span>
<span id="cb194-4150"><a href="#cb194-4150" aria-hidden="true" tabindex="-1"></a>posterior_3ea <span class="ot">&lt;-</span> posterior_3ea <span class="sc">/</span> <span class="fu">sum</span>(posterior_3ea)</span>
<span id="cb194-4151"><a href="#cb194-4151" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-4152"><a href="#cb194-4152" aria-hidden="true" tabindex="-1"></a>samples_3ea <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid_3ea, <span class="at">prob =</span> posterior_3ea, <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-4153"><a href="#cb194-4153" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(samples_3ea,</span>
<span id="cb194-4154"><a href="#cb194-4154" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Probability&quot;</span>,</span>
<span id="cb194-4155"><a href="#cb194-4155" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span>,</span>
<span id="cb194-4156"><a href="#cb194-4156" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Posterior distribution for the globe tossing example&quot;</span>)</span>
<span id="cb194-4157"><a href="#cb194-4157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4158"><a href="#cb194-4158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4159"><a href="#cb194-4159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4160"><a href="#cb194-4160" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Tidyverse</span></span>
<span id="cb194-4161"><a href="#cb194-4161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4162"><a href="#cb194-4162" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4163"><a href="#cb194-4163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4164"><a href="#cb194-4164" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4165"><a href="#cb194-4165" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-data-3.27b</span></span>
<span id="cb194-4166"><a href="#cb194-4166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4167"><a href="#cb194-4167" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.27b for exercises  #######################</span></span>
<span id="cb194-4168"><a href="#cb194-4168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4169"><a href="#cb194-4169" aria-hidden="true" tabindex="-1"></a>df_3eb <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_3eb =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb194-4170"><a href="#cb194-4170" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_3eb =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>),</span>
<span id="cb194-4171"><a href="#cb194-4171" aria-hidden="true" tabindex="-1"></a>               <span class="at">likelihood_3eb =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid_3eb),</span>
<span id="cb194-4172"><a href="#cb194-4172" aria-hidden="true" tabindex="-1"></a>               <span class="at">posterior_3eb =</span> likelihood_3eb <span class="sc">*</span> prior_3eb,</span>
<span id="cb194-4173"><a href="#cb194-4173" aria-hidden="true" tabindex="-1"></a>               <span class="at">posterior_std_3eb =</span> posterior_3eb <span class="sc">/</span> <span class="fu">sum</span>(posterior_3eb))</span>
<span id="cb194-4174"><a href="#cb194-4174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4175"><a href="#cb194-4175" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-4176"><a href="#cb194-4176" aria-hidden="true" tabindex="-1"></a>samples_3eb <span class="ot">&lt;-</span> df_3eb <span class="sc">|&gt;</span> </span>
<span id="cb194-4177"><a href="#cb194-4177" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>, </span>
<span id="cb194-4178"><a href="#cb194-4178" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight_by =</span> posterior_std_3eb, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-4179"><a href="#cb194-4179" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">p_samples_3eb =</span> p_grid_3eb)</span>
<span id="cb194-4180"><a href="#cb194-4180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4181"><a href="#cb194-4181" aria-hidden="true" tabindex="-1"></a>samples_3eb <span class="sc">|&gt;</span> </span>
<span id="cb194-4182"><a href="#cb194-4182" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_samples_3eb)) <span class="sc">+</span></span>
<span id="cb194-4183"><a href="#cb194-4183" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-4184"><a href="#cb194-4184" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb194-4185"><a href="#cb194-4185" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Propability&quot;</span>,</span>
<span id="cb194-4186"><a href="#cb194-4186" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>,</span>
<span id="cb194-4187"><a href="#cb194-4187" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">&quot;Posterior distribution for the globe tossing example&quot;</span>)</span>
<span id="cb194-4188"><a href="#cb194-4188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4189"><a href="#cb194-4189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4190"><a href="#cb194-4190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4191"><a href="#cb194-4191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4192"><a href="#cb194-4192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4193"><a href="#cb194-4193" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4194"><a href="#cb194-4194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4195"><a href="#cb194-4195" aria-hidden="true" tabindex="-1"></a>**Original**: </span>
<span id="cb194-4196"><a href="#cb194-4196" aria-hidden="true" tabindex="-1"></a><span class="in">`r head(samples_3ea, 5)`</span>, …</span>
<span id="cb194-4197"><a href="#cb194-4197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4198"><a href="#cb194-4198" aria-hidden="true" tabindex="-1"></a>**Tidyerse**: </span>
<span id="cb194-4199"><a href="#cb194-4199" aria-hidden="true" tabindex="-1"></a><span class="in">`r head(samples_3eb$p_samples_3eb, 5)`</span>, …</span>
<span id="cb194-4200"><a href="#cb194-4200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4201"><a href="#cb194-4201" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4202"><a href="#cb194-4202" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4203"><a href="#cb194-4203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4204"><a href="#cb194-4204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4205"><a href="#cb194-4205" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercises 3E1 - 3E7</span></span>
<span id="cb194-4206"><a href="#cb194-4206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4207"><a href="#cb194-4207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4208"><a href="#cb194-4208" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-4209"><a href="#cb194-4209" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-4210"><a href="#cb194-4210" aria-hidden="true" tabindex="-1"></a>Exercises 3E1 - 3E7</span>
<span id="cb194-4211"><a href="#cb194-4211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4212"><a href="#cb194-4212" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E1.** How much posterior probability lies below $p = 0.2$? </span>
<span id="cb194-4213"><a href="#cb194-4213" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E2.** How much posterior probability lies above $p = 0.8$? </span>
<span id="cb194-4214"><a href="#cb194-4214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E3.** How much posterior probability lies between $p = 0.2$ and $p = 0.8$? </span>
<span id="cb194-4215"><a href="#cb194-4215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E4.** $20\%$ of the posterior probability lies below which value of $p$? </span>
<span id="cb194-4216"><a href="#cb194-4216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E5.** $20\%$ of the posterior probability lies above which value of $p$? </span>
<span id="cb194-4217"><a href="#cb194-4217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E6.** Which values of $p$ contain the narrowest interval equal to $66\%$ of the posterior probability? </span>
<span id="cb194-4218"><a href="#cb194-4218" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E7.** Which values of $p$ contain $66\%$ of the posterior probability, assuming equal posterior probability both below and above the interval?</span>
<span id="cb194-4219"><a href="#cb194-4219" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4220"><a href="#cb194-4220" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-4221"><a href="#cb194-4221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4222"><a href="#cb194-4222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4223"><a href="#cb194-4223" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-4224"><a href="#cb194-4224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4225"><a href="#cb194-4225" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Original</span></span>
<span id="cb194-4226"><a href="#cb194-4226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4227"><a href="#cb194-4227" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4228"><a href="#cb194-4228" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4229"><a href="#cb194-4229" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-easy-03a}</span>
<span id="cb194-4230"><a href="#cb194-4230" aria-hidden="true" tabindex="-1"></a>a: Exercises 3E1 - 3E7 (Original)</span>
<span id="cb194-4231"><a href="#cb194-4231" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4232"><a href="#cb194-4232" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4233"><a href="#cb194-4233" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4234"><a href="#cb194-4234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4235"><a href="#cb194-4235" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4236"><a href="#cb194-4236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4237"><a href="#cb194-4237" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4238"><a href="#cb194-4238" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3ea</span></span>
<span id="cb194-4239"><a href="#cb194-4239" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-4240"><a href="#cb194-4240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4241"><a href="#cb194-4241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4242"><a href="#cb194-4242" aria-hidden="true" tabindex="-1"></a><span class="do">## exercises 3E1a - 3E7a ####################</span></span>
<span id="cb194-4243"><a href="#cb194-4243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4244"><a href="#cb194-4244" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(samples_3ea <span class="sc">&lt;</span> <span class="fl">0.2</span>) <span class="sc">/</span> <span class="fl">1e4</span>                            <span class="do">## 3.7a</span></span>
<span id="cb194-4245"><a href="#cb194-4245" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(samples_3ea <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">/</span> <span class="fl">1e4</span>                            <span class="do">## 3.7a</span></span>
<span id="cb194-4246"><a href="#cb194-4246" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(samples_3ea <span class="sc">&gt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> samples_3ea <span class="sc">&lt;</span> <span class="fl">0.8</span>) <span class="sc">/</span> <span class="fl">1e4</span>        <span class="do">## 3.8a</span></span>
<span id="cb194-4247"><a href="#cb194-4247" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples_3ea, <span class="fl">0.2</span>)                       <span class="do">## 3.9a</span></span>
<span id="cb194-4248"><a href="#cb194-4248" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples_3ea, <span class="fl">0.8</span>)                       <span class="do">## 3.10a</span></span>
<span id="cb194-4249"><a href="#cb194-4249" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3ea, <span class="at">prob =</span> <span class="fl">0.66</span>)              <span class="do">## 3.13a</span></span>
<span id="cb194-4250"><a href="#cb194-4250" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3ea, <span class="at">prob =</span> <span class="fl">0.66</span>)                <span class="do">## 3.12a1</span></span>
<span id="cb194-4251"><a href="#cb194-4251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4252"><a href="#cb194-4252" aria-hidden="true" tabindex="-1"></a><span class="do">## same as above</span></span>
<span id="cb194-4253"><a href="#cb194-4253" aria-hidden="true" tabindex="-1"></a><span class="do">## quantile(samples_3ea, prob = c(.1667, .8333))    ## 3.12a2</span></span>
<span id="cb194-4254"><a href="#cb194-4254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4255"><a href="#cb194-4255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4256"><a href="#cb194-4256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4257"><a href="#cb194-4257" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-4258"><a href="#cb194-4258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4259"><a href="#cb194-4259" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E1.** <span class="in">`r (sum(samples_3ea &lt; 0.2) / 1e4) * 100`</span>% of the posterior probability lies below $p = 0.2$. </span>
<span id="cb194-4260"><a href="#cb194-4260" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E2.** <span class="in">`r (sum(samples_3ea &gt; 0.8) / 1e4) * 100`</span>% of the posterior probability lies above $p = 0.8$. </span>
<span id="cb194-4261"><a href="#cb194-4261" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E3.** <span class="in">`r (sum(samples_3ea &gt; 0.2 &amp; samples_3ea &lt; 0.8) / 1e4) * 100`</span>% posterior probability lies between $p = 0.2$ and $p = 0.8$.</span>
<span id="cb194-4262"><a href="#cb194-4262" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E4.** $20\%$ of the posterior probability lies below $p =$ <span class="in">`r round(quantile(samples_3ea, 0.2), 3)`</span>. </span>
<span id="cb194-4263"><a href="#cb194-4263" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E5.** $20\%$ of the posterior probability lies above $p =$ <span class="in">`r round(quantile(samples_3ea, 0.8), 3)`</span>. </span>
<span id="cb194-4264"><a href="#cb194-4264" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E6.** $66\%$ of the narrowest interval lies between <span class="in">`r round(rethinking::HPDI(samples_3ea, prob = 0.66)[1], 3)`</span> and <span class="in">`r round(rethinking::HPDI(samples_3ea, prob = 0.66)[2], 3)`</span>.</span>
<span id="cb194-4265"><a href="#cb194-4265" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E7.** The interval between <span class="in">`r round(rethinking::PI(samples_3ea, prob = 0.66)[1], 3)`</span> and <span class="in">`r round(rethinking::PI(samples_3ea, prob = 0.66)[2], 3)`</span> contains $66\%$ of the posterior probability, assuming equal posterior probability both below and above the interval.</span>
<span id="cb194-4266"><a href="#cb194-4266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4267"><a href="#cb194-4267" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4268"><a href="#cb194-4268" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4269"><a href="#cb194-4269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4270"><a href="#cb194-4270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4271"><a href="#cb194-4271" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Tidyverse</span></span>
<span id="cb194-4272"><a href="#cb194-4272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4273"><a href="#cb194-4273" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4274"><a href="#cb194-4274" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4275"><a href="#cb194-4275" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-easy-03b}</span>
<span id="cb194-4276"><a href="#cb194-4276" aria-hidden="true" tabindex="-1"></a>b: Exercises 3E1 - 3E7 (Tidyverse)</span>
<span id="cb194-4277"><a href="#cb194-4277" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4278"><a href="#cb194-4278" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4279"><a href="#cb194-4279" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4280"><a href="#cb194-4280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4281"><a href="#cb194-4281" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4282"><a href="#cb194-4282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4283"><a href="#cb194-4283" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4284"><a href="#cb194-4284" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3eb</span></span>
<span id="cb194-4285"><a href="#cb194-4285" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-4286"><a href="#cb194-4286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4287"><a href="#cb194-4287" aria-hidden="true" tabindex="-1"></a><span class="do">## exercises 3E1b - 3E7b ####################</span></span>
<span id="cb194-4288"><a href="#cb194-4288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4289"><a href="#cb194-4289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4290"><a href="#cb194-4290" aria-hidden="true" tabindex="-1"></a>(e3b1 <span class="ot">&lt;-</span> samples_3eb <span class="sc">|&gt;</span> </span>
<span id="cb194-4291"><a href="#cb194-4291" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_samples_3eb <span class="sc">&lt;</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-4292"><a href="#cb194-4292" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> <span class="fl">1e4</span>) <span class="sc">|&gt;</span></span>
<span id="cb194-4293"><a href="#cb194-4293" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>())  </span>
<span id="cb194-4294"><a href="#cb194-4294" aria-hidden="true" tabindex="-1"></a>                                                        <span class="do">## 3.7b</span></span>
<span id="cb194-4295"><a href="#cb194-4295" aria-hidden="true" tabindex="-1"></a>(e3b2 <span class="ot">&lt;-</span> samples_3eb <span class="sc">|&gt;</span> </span>
<span id="cb194-4296"><a href="#cb194-4296" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_samples_3eb <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-4297"><a href="#cb194-4297" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> <span class="fl">1e4</span>) <span class="sc">|&gt;</span>            <span class="do">## 3.7b</span></span>
<span id="cb194-4298"><a href="#cb194-4298" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>())</span>
<span id="cb194-4299"><a href="#cb194-4299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4300"><a href="#cb194-4300" aria-hidden="true" tabindex="-1"></a>(e3b3 <span class="ot">&lt;-</span> samples_3eb <span class="sc">|&gt;</span> </span>
<span id="cb194-4301"><a href="#cb194-4301" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_samples_3eb <span class="sc">&gt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> p_samples_3eb <span class="sc">&lt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-4302"><a href="#cb194-4302" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">/</span> <span class="fl">1e4</span>) <span class="sc">|&gt;</span>            <span class="do">## 3.8b</span></span>
<span id="cb194-4303"><a href="#cb194-4303" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>())</span>
<span id="cb194-4304"><a href="#cb194-4304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4305"><a href="#cb194-4305" aria-hidden="true" tabindex="-1"></a>(e3b4 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">quantile</span>(samples_3eb<span class="sc">$</span>p_samples_3eb, <span class="at">probs =</span> .<span class="dv">2</span>))</span>
<span id="cb194-4306"><a href="#cb194-4306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4307"><a href="#cb194-4307" aria-hidden="true" tabindex="-1"></a>(e3b5 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">quantile</span>(samples_3eb<span class="sc">$</span>p_samples_3eb, <span class="at">probs =</span> .<span class="dv">8</span>))</span>
<span id="cb194-4308"><a href="#cb194-4308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4309"><a href="#cb194-4309" aria-hidden="true" tabindex="-1"></a>(e3b6 <span class="ot">&lt;-</span> tidybayes<span class="sc">::</span><span class="fu">mode_hdci</span>(samples_3eb<span class="sc">$</span>p_samples_3eb, <span class="at">.width =</span> .<span class="dv">66</span>))</span>
<span id="cb194-4310"><a href="#cb194-4310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4311"><a href="#cb194-4311" aria-hidden="true" tabindex="-1"></a><span class="do">## tidybayes::mean_hdci(samples_3eb$p_samples_3eb, .width = .66)</span></span>
<span id="cb194-4312"><a href="#cb194-4312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4313"><a href="#cb194-4313" aria-hidden="true" tabindex="-1"></a><span class="do">## same as above</span></span>
<span id="cb194-4314"><a href="#cb194-4314" aria-hidden="true" tabindex="-1"></a>(e3b7 <span class="ot">&lt;-</span> tidybayes<span class="sc">::</span><span class="fu">qi</span>(samples_3eb<span class="sc">$</span>p_samples_3eb, <span class="at">.width =</span> .<span class="dv">66</span>))</span>
<span id="cb194-4315"><a href="#cb194-4315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4316"><a href="#cb194-4316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4317"><a href="#cb194-4317" aria-hidden="true" tabindex="-1"></a><span class="do">### R Code 3.7b with alternative methods #########</span></span>
<span id="cb194-4318"><a href="#cb194-4318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4319"><a href="#cb194-4319" aria-hidden="true" tabindex="-1"></a><span class="co">#base::sum(samples_3eb$p_samples_3eb &lt; 0.2) / 1e4           ## 3.7b</span></span>
<span id="cb194-4320"><a href="#cb194-4320" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb194-4321"><a href="#cb194-4321" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_3eb |&gt; </span></span>
<span id="cb194-4322"><a href="#cb194-4322" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::summarize(sum = mean(p_samples_3eb &gt; .8))       ## 3.7b</span></span>
<span id="cb194-4323"><a href="#cb194-4323" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb194-4324"><a href="#cb194-4324" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_3eb |&gt; </span></span>
<span id="cb194-4325"><a href="#cb194-4325" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::count(p_samples_3eb &gt; .8) |&gt; </span></span>
<span id="cb194-4326"><a href="#cb194-4326" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::mutate(probability = 1e4 / base::sum(1e4))   ## 3.7b</span></span>
<span id="cb194-4327"><a href="#cb194-4327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4328"><a href="#cb194-4328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4329"><a href="#cb194-4329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4330"><a href="#cb194-4330" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-4331"><a href="#cb194-4331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4332"><a href="#cb194-4332" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E1.** <span class="in">`r e3b1 * 100`</span>% of the posterior probability lies below $p = 0.2$. </span>
<span id="cb194-4333"><a href="#cb194-4333" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E2.** <span class="in">`r e3b2 * 100`</span>% of the posterior probability lies above $p = 0.8$. </span>
<span id="cb194-4334"><a href="#cb194-4334" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E3.** <span class="in">`r e3b3 * 100`</span>% posterior probability lies between $p = 0.2$ and $p = 0.8$.</span>
<span id="cb194-4335"><a href="#cb194-4335" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E4.** $20\%$ of the posterior probability lies below $p =$ <span class="in">`r round(e3b4, 3)`</span>. </span>
<span id="cb194-4336"><a href="#cb194-4336" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E5.** $20\%$ of the posterior probability lies above $p =$ <span class="in">`r round(e3b5, 3)`</span>. </span>
<span id="cb194-4337"><a href="#cb194-4337" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E6.** $66\%$ of the narrowest interval lies between <span class="in">`r round(e3b6$ymin, 3)`</span> and <span class="in">`r round(e3b6$ymax, 3)`</span>.</span>
<span id="cb194-4338"><a href="#cb194-4338" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3E7.** The interval between <span class="in">`r round(e3b7[1], 3)`</span> and <span class="in">`r round(e3b7[2], 3)`</span> contains $66\%$ of the posterior probability, assuming equal posterior probability both below and above the interval.</span>
<span id="cb194-4339"><a href="#cb194-4339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4340"><a href="#cb194-4340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4341"><a href="#cb194-4341" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb194-4342"><a href="#cb194-4342" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb194-4343"><a href="#cb194-4343" aria-hidden="true" tabindex="-1"></a>:::::: {#cor-3e3b}</span>
<span id="cb194-4344"><a href="#cb194-4344" aria-hidden="true" tabindex="-1"></a>: Using <span class="in">`dplyr::between()`</span></span>
<span id="cb194-4345"><a href="#cb194-4345" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4346"><a href="#cb194-4346" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4347"><a href="#cb194-4347" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb194-4348"><a href="#cb194-4348" aria-hidden="true" tabindex="-1"></a>I learned from Jake Thompson that I could have used <span class="in">`dplyr::between()`</span> for the exercise 3E3: <span class="in">`mean(dplyr::between(p_samples_3eb$samples_3eb, 0.2, 0.8))`</span> = <span class="in">`r mean(dplyr::between(samples_3eb$p_samples_3eb, 0.2, 0.8))`</span></span>
<span id="cb194-4349"><a href="#cb194-4349" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4350"><a href="#cb194-4350" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4351"><a href="#cb194-4351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4352"><a href="#cb194-4352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4353"><a href="#cb194-4353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4354"><a href="#cb194-4354" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4355"><a href="#cb194-4355" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4356"><a href="#cb194-4356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4357"><a href="#cb194-4357" aria-hidden="true" tabindex="-1"></a>:::::{.my-watch-out}</span>
<span id="cb194-4358"><a href="#cb194-4358" aria-hidden="true" tabindex="-1"></a>:::{.my-watch-out-header}</span>
<span id="cb194-4359"><a href="#cb194-4359" aria-hidden="true" tabindex="-1"></a>Difference between <span class="in">`rethinking::HPDI()`</span> and <span class="in">`tidybayes::mode_hdci()`</span></span>
<span id="cb194-4360"><a href="#cb194-4360" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4361"><a href="#cb194-4361" aria-hidden="true" tabindex="-1"></a>::::{.my-watch-out-container}</span>
<span id="cb194-4362"><a href="#cb194-4362" aria-hidden="true" tabindex="-1"></a>There is a small difference between <span class="in">`rethinking::HPDI()`</span> (<span class="in">`r rethinking::HPDI(samples_3ea, prob = 0.66)[1]`</span> resp. <span class="in">`r rethinking::HPDI(samples_3ea, prob = 0.66)[2]`</span>) and <span class="in">`tidybayes::mode_hdci()`</span> (<span class="in">`r e3b6$ymin`</span> and <span class="in">`r e3b6$ymax`</span>). </span>
<span id="cb194-4363"><a href="#cb194-4363" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4364"><a href="#cb194-4364" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4365"><a href="#cb194-4365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4366"><a href="#cb194-4366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4367"><a href="#cb194-4367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4368"><a href="#cb194-4368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4369"><a href="#cb194-4369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4370"><a href="#cb194-4370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4371"><a href="#cb194-4371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4372"><a href="#cb194-4372" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4373"><a href="#cb194-4373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4374"><a href="#cb194-4374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4375"><a href="#cb194-4375" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4376"><a href="#cb194-4376" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4377"><a href="#cb194-4377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4378"><a href="#cb194-4378" aria-hidden="true" tabindex="-1"></a><span class="fu">### Middle</span></span>
<span id="cb194-4379"><a href="#cb194-4379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4380"><a href="#cb194-4380" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3M1 {#sec-e3m1}</span></span>
<span id="cb194-4381"><a href="#cb194-4381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4382"><a href="#cb194-4382" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-4383"><a href="#cb194-4383" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-4384"><a href="#cb194-4384" aria-hidden="true" tabindex="-1"></a>Exercise 3M1: Suppose the globe tossing data had turned out to be 8 water in 15 tosses. Construct the posterior distribution, using grid approximation. Use the same flat prior as before.</span>
<span id="cb194-4385"><a href="#cb194-4385" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4386"><a href="#cb194-4386" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-4387"><a href="#cb194-4387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4388"><a href="#cb194-4388" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-4389"><a href="#cb194-4389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4390"><a href="#cb194-4390" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Original</span></span>
<span id="cb194-4391"><a href="#cb194-4391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4392"><a href="#cb194-4392" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4393"><a href="#cb194-4393" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4394"><a href="#cb194-4394" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m1a}</span>
<span id="cb194-4395"><a href="#cb194-4395" aria-hidden="true" tabindex="-1"></a>: Exercise 3M1a (Original)</span>
<span id="cb194-4396"><a href="#cb194-4396" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4397"><a href="#cb194-4397" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4398"><a href="#cb194-4398" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4399"><a href="#cb194-4399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4400"><a href="#cb194-4400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height=7}</span></span>
<span id="cb194-4401"><a href="#cb194-4401" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-exercise-3m1a</span></span>
<span id="cb194-4402"><a href="#cb194-4402" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 7</span></span>
<span id="cb194-4403"><a href="#cb194-4403" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: &quot;Posterior distribution for 8 &#39;W&#39; in 15 tosses (Original)&quot;</span></span>
<span id="cb194-4404"><a href="#cb194-4404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4405"><a href="#cb194-4405" aria-hidden="true" tabindex="-1"></a><span class="in">p_grid_3m1a &lt;- seq(from = 0, to = 1, length.out = 1000)</span></span>
<span id="cb194-4406"><a href="#cb194-4406" aria-hidden="true" tabindex="-1"></a><span class="in">prior_3m1a &lt;- rep(1, 1000)</span></span>
<span id="cb194-4407"><a href="#cb194-4407" aria-hidden="true" tabindex="-1"></a><span class="in">likelihood_3m1a &lt;- stats::dbinom(8, size = 15, prob = p_grid_3m1a)</span></span>
<span id="cb194-4408"><a href="#cb194-4408" aria-hidden="true" tabindex="-1"></a><span class="in">posterior_3m1a &lt;-  likelihood_3m1a * prior_3m1a</span></span>
<span id="cb194-4409"><a href="#cb194-4409" aria-hidden="true" tabindex="-1"></a><span class="in">posterior_std_3m1a &lt;-  posterior_3m1a / sum(posterior_3m1a) </span></span>
<span id="cb194-4410"><a href="#cb194-4410" aria-hidden="true" tabindex="-1"></a><span class="in">plot(p_grid_3m1a, posterior_std_3m1a, type = &quot;l&quot;, </span></span>
<span id="cb194-4411"><a href="#cb194-4411" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab = &quot;Proportion of water (p)&quot;,</span></span>
<span id="cb194-4412"><a href="#cb194-4412" aria-hidden="true" tabindex="-1"></a><span class="in">     ylab = &quot;Posterior density&quot;)</span></span>
<span id="cb194-4413"><a href="#cb194-4413" aria-hidden="true" tabindex="-1"></a><span class="in">grid(lty = 1)</span></span>
<span id="cb194-4414"><a href="#cb194-4414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4415"><a href="#cb194-4415" aria-hidden="true" tabindex="-1"></a><span class="in">map_3m1a &lt;- p_grid_3m1a[which.max(posterior_std_3m1a)]</span></span>
<span id="cb194-4416"><a href="#cb194-4416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4417"><a href="#cb194-4417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4418"><a href="#cb194-4418" aria-hidden="true" tabindex="-1"></a>The modus (<span class="in">`r glossary(&quot;MAP&quot;)`</span>) is at p = <span class="in">`r round(map_3m1a, 3)`</span> with a posterior density of <span class="in">`r round(max(posterior_std_3m1a), 5)`</span>.</span>
<span id="cb194-4419"><a href="#cb194-4419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4420"><a href="#cb194-4420" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4421"><a href="#cb194-4421" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4422"><a href="#cb194-4422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4423"><a href="#cb194-4423" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Tidyverse</span></span>
<span id="cb194-4424"><a href="#cb194-4424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4425"><a href="#cb194-4425" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4426"><a href="#cb194-4426" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4427"><a href="#cb194-4427" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m1a}</span>
<span id="cb194-4428"><a href="#cb194-4428" aria-hidden="true" tabindex="-1"></a>: Exercise 3M1b (Tidyverse)</span>
<span id="cb194-4429"><a href="#cb194-4429" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4430"><a href="#cb194-4430" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4431"><a href="#cb194-4431" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4432"><a href="#cb194-4432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4433"><a href="#cb194-4433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4434"><a href="#cb194-4434" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4435"><a href="#cb194-4435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4436"><a href="#cb194-4436" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4437"><a href="#cb194-4437" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3m1b</span></span>
<span id="cb194-4438"><a href="#cb194-4438" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Posterior distribution for 8 &#39;W&#39; in 15 tosses (Tidyverse)&quot;</span></span>
<span id="cb194-4439"><a href="#cb194-4439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4440"><a href="#cb194-4440" aria-hidden="true" tabindex="-1"></a>df_3m1b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb194-4441"><a href="#cb194-4441" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_grid_3m1b =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb194-4442"><a href="#cb194-4442" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_3m1b =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>),</span>
<span id="cb194-4443"><a href="#cb194-4443" aria-hidden="true" tabindex="-1"></a>  <span class="at">likelihood_3m1b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">8</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> p_grid_3m1b),</span>
<span id="cb194-4444"><a href="#cb194-4444" aria-hidden="true" tabindex="-1"></a>  <span class="at">posterior_3m1b =</span>  likelihood_3m1b <span class="sc">*</span> prior_3m1b,</span>
<span id="cb194-4445"><a href="#cb194-4445" aria-hidden="true" tabindex="-1"></a>  <span class="at">posterior_std_3m1b =</span> posterior_3m1b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m1b)</span>
<span id="cb194-4446"><a href="#cb194-4446" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb194-4447"><a href="#cb194-4447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4448"><a href="#cb194-4448" aria-hidden="true" tabindex="-1"></a>df_3m1b <span class="sc">|&gt;</span> </span>
<span id="cb194-4449"><a href="#cb194-4449" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3m1b, <span class="at">y =</span> posterior_std_3m1b)) <span class="sc">+</span></span>
<span id="cb194-4450"><a href="#cb194-4450" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-4451"><a href="#cb194-4451" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Proportion of water (p)&quot;</span>,</span>
<span id="cb194-4452"><a href="#cb194-4452" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Posterior density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-4453"><a href="#cb194-4453" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-4454"><a href="#cb194-4454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4455"><a href="#cb194-4455" aria-hidden="true" tabindex="-1"></a>map_3m1b <span class="ot">&lt;-</span> df_3m1b <span class="sc">|&gt;</span> </span>
<span id="cb194-4456"><a href="#cb194-4456" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(posterior_std_3m1b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-4457"><a href="#cb194-4457" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(dplyr<span class="sc">::</span><span class="fu">first</span>(p_grid_3m1b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-4458"><a href="#cb194-4458" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">1</span>)</span>
<span id="cb194-4459"><a href="#cb194-4459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4460"><a href="#cb194-4460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4461"><a href="#cb194-4461" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-4462"><a href="#cb194-4462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4463"><a href="#cb194-4463" aria-hidden="true" tabindex="-1"></a>The modus (<span class="in">`r glossary(&quot;MAP&quot;)`</span>) is at p = <span class="in">`r map_3m1b`</span> with a posterior density of <span class="in">`r max(df_3m1b$posterior_std_3m1b)`</span>.</span>
<span id="cb194-4464"><a href="#cb194-4464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4465"><a href="#cb194-4465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4466"><a href="#cb194-4466" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4467"><a href="#cb194-4467" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4468"><a href="#cb194-4468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4469"><a href="#cb194-4469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4470"><a href="#cb194-4470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4471"><a href="#cb194-4471" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4472"><a href="#cb194-4472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4473"><a href="#cb194-4473" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4474"><a href="#cb194-4474" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4475"><a href="#cb194-4475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4476"><a href="#cb194-4476" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-4477"><a href="#cb194-4477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4478"><a href="#cb194-4478" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3M2</span></span>
<span id="cb194-4479"><a href="#cb194-4479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4480"><a href="#cb194-4480" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-4481"><a href="#cb194-4481" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-4482"><a href="#cb194-4482" aria-hidden="true" tabindex="-1"></a>Exercise 3M2: Draw $10,000$ samples from the grid approximation from above. Then use the samples to calculate the $90\%$ and $99\%$ HPDI for $p$.</span>
<span id="cb194-4483"><a href="#cb194-4483" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4484"><a href="#cb194-4484" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-4485"><a href="#cb194-4485" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-4486"><a href="#cb194-4486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4487"><a href="#cb194-4487" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Original</span></span>
<span id="cb194-4488"><a href="#cb194-4488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4489"><a href="#cb194-4489" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4490"><a href="#cb194-4490" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4491"><a href="#cb194-4491" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m2a}</span>
<span id="cb194-4492"><a href="#cb194-4492" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M2 (Original)</span>
<span id="cb194-4493"><a href="#cb194-4493" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4494"><a href="#cb194-4494" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4495"><a href="#cb194-4495" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4496"><a href="#cb194-4496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4497"><a href="#cb194-4497" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4498"><a href="#cb194-4498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4499"><a href="#cb194-4499" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4500"><a href="#cb194-4500" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3m2a</span></span>
<span id="cb194-4501"><a href="#cb194-4501" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;10,000 samples from the grid approximation 8 water with 15 tosses (Original)&quot;</span></span>
<span id="cb194-4502"><a href="#cb194-4502" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-4503"><a href="#cb194-4503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4504"><a href="#cb194-4504" aria-hidden="true" tabindex="-1"></a><span class="do">## 1e4 samples #############</span></span>
<span id="cb194-4505"><a href="#cb194-4505" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-4506"><a href="#cb194-4506" aria-hidden="true" tabindex="-1"></a>samples_3m2a <span class="ot">&lt;-</span>  <span class="fu">sample</span>(<span class="at">x =</span> p_grid_3m1a,</span>
<span id="cb194-4507"><a href="#cb194-4507" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prob =</span> posterior_std_3m1a, </span>
<span id="cb194-4508"><a href="#cb194-4508" aria-hidden="true" tabindex="-1"></a>                       <span class="at">size =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-4509"><a href="#cb194-4509" aria-hidden="true" tabindex="-1"></a>                       <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-4510"><a href="#cb194-4510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4511"><a href="#cb194-4511" aria-hidden="true" tabindex="-1"></a><span class="do">## Density with rethinking::dens() ########</span></span>
<span id="cb194-4512"><a href="#cb194-4512" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(samples_3m2a, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb194-4513"><a href="#cb194-4513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4514"><a href="#cb194-4514" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameters #########</span></span>
<span id="cb194-4515"><a href="#cb194-4515" aria-hidden="true" tabindex="-1"></a>(pi_3m2a_1 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m2a, <span class="at">prob =</span> .<span class="dv">9</span>))</span>
<span id="cb194-4516"><a href="#cb194-4516" aria-hidden="true" tabindex="-1"></a>(pi_3m2a_2 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m2a, <span class="at">prob =</span> .<span class="dv">99</span>))</span>
<span id="cb194-4517"><a href="#cb194-4517" aria-hidden="true" tabindex="-1"></a>(hpdi_3m2a_1 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m2a, <span class="at">prob =</span> .<span class="dv">9</span>))</span>
<span id="cb194-4518"><a href="#cb194-4518" aria-hidden="true" tabindex="-1"></a>(hpdi_3m2a_2 <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m2a, <span class="at">prob =</span> .<span class="dv">99</span>))</span>
<span id="cb194-4519"><a href="#cb194-4519" aria-hidden="true" tabindex="-1"></a>(mean_3m2a <span class="ot">&lt;-</span> <span class="fu">mean</span>(samples_3m2a))</span>
<span id="cb194-4520"><a href="#cb194-4520" aria-hidden="true" tabindex="-1"></a>(median_3m2a <span class="ot">&lt;-</span> <span class="fu">median</span>(samples_3m2a))</span>
<span id="cb194-4521"><a href="#cb194-4521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4522"><a href="#cb194-4522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4523"><a href="#cb194-4523" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Mean**:   <span class="in">`r round(mean_3m2a, 3)`</span></span>
<span id="cb194-4524"><a href="#cb194-4524" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Median**: <span class="in">`r round(median_3m2a, 3)`</span></span>
<span id="cb194-4525"><a href="#cb194-4525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4526"><a href="#cb194-4526" aria-hidden="true" tabindex="-1"></a>| Prior = 1   | Low                  | High                 | Diff                                    |</span>
<span id="cb194-4527"><a href="#cb194-4527" aria-hidden="true" tabindex="-1"></a>|----------|----------------------|----------------------|-----------------------------------------|</span>
<span id="cb194-4528"><a href="#cb194-4528" aria-hidden="true" tabindex="-1"></a>| PI .90   | <span class="in">`r pi_3m2a_1[[1]]`</span>   | <span class="in">`r pi_3m2a_1[[2]]`</span>   | <span class="in">`r pi_3m2a_1[[2]] - pi_3m2a_1[[1]]`</span>     |</span>
<span id="cb194-4529"><a href="#cb194-4529" aria-hidden="true" tabindex="-1"></a>| PI .99   | <span class="in">`r pi_3m2a_2[[1]]`</span>   | <span class="in">`r pi_3m2a_2[[2]]`</span>   | <span class="in">`r pi_3m2a_1[[2]] - pi_3m2a_1[[1]]`</span>     |</span>
<span id="cb194-4530"><a href="#cb194-4530" aria-hidden="true" tabindex="-1"></a>| HPDI .90 | <span class="in">`r hpdi_3m2a_1[[1]]`</span> | <span class="in">`r hpdi_3m2a_1[[2]]`</span> | <span class="in">`r hpdi_3m2a_1[[2]] - hpdi_3m2a_1[[1]]`</span> |</span>
<span id="cb194-4531"><a href="#cb194-4531" aria-hidden="true" tabindex="-1"></a>| HPDI .99 | <span class="in">`r hpdi_3m2a_2[[1]]`</span> | <span class="in">`r hpdi_3m2a_2[[2]]`</span> | <span class="in">`r hpdi_3m2a_2[[2]] - hpdi_3m2a_2[[1]]`</span> |</span>
<span id="cb194-4532"><a href="#cb194-4532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4533"><a href="#cb194-4533" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4534"><a href="#cb194-4534" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4535"><a href="#cb194-4535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4536"><a href="#cb194-4536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4537"><a href="#cb194-4537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4538"><a href="#cb194-4538" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Tidyverse</span></span>
<span id="cb194-4539"><a href="#cb194-4539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4540"><a href="#cb194-4540" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4541"><a href="#cb194-4541" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4542"><a href="#cb194-4542" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m2b}</span>
<span id="cb194-4543"><a href="#cb194-4543" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M2 (Tidyverse)</span>
<span id="cb194-4544"><a href="#cb194-4544" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4545"><a href="#cb194-4545" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4546"><a href="#cb194-4546" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4547"><a href="#cb194-4547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4548"><a href="#cb194-4548" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4549"><a href="#cb194-4549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4550"><a href="#cb194-4550" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4551"><a href="#cb194-4551" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3m2b</span></span>
<span id="cb194-4552"><a href="#cb194-4552" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;10,000 samples from the grid approximation 8 water with 15 tosses (Tidyverse)&quot;</span></span>
<span id="cb194-4553"><a href="#cb194-4553" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-4554"><a href="#cb194-4554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4555"><a href="#cb194-4555" aria-hidden="true" tabindex="-1"></a><span class="do">## 1e4 samples ##########</span></span>
<span id="cb194-4556"><a href="#cb194-4556" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-4557"><a href="#cb194-4557" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="ot">&lt;-</span> df_3m1b <span class="sc">|&gt;</span> </span>
<span id="cb194-4558"><a href="#cb194-4558" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>, </span>
<span id="cb194-4559"><a href="#cb194-4559" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight_by =</span> posterior_std_3m1b, </span>
<span id="cb194-4560"><a href="#cb194-4560" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-4561"><a href="#cb194-4561" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">p_samples_3m2b =</span> p_grid_3m1b)  </span>
<span id="cb194-4562"><a href="#cb194-4562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4563"><a href="#cb194-4563" aria-hidden="true" tabindex="-1"></a><span class="do">## Density with ggplot2</span></span>
<span id="cb194-4564"><a href="#cb194-4564" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb194-4565"><a href="#cb194-4565" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_samples_3m2b)) <span class="sc">+</span></span>
<span id="cb194-4566"><a href="#cb194-4566" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">adjust =</span> <span class="fl">1.0</span>) <span class="sc">+</span> <span class="co"># 1.0 = default value</span></span>
<span id="cb194-4567"><a href="#cb194-4567" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;N = 10000, Bandwith = 1.0&quot;</span>,</span>
<span id="cb194-4568"><a href="#cb194-4568" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-4569"><a href="#cb194-4569" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-4570"><a href="#cb194-4570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4571"><a href="#cb194-4571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4572"><a href="#cb194-4572" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameters ########</span></span>
<span id="cb194-4573"><a href="#cb194-4573" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb194-4574"><a href="#cb194-4574" aria-hidden="true" tabindex="-1"></a>  param_3m2b <span class="ot">&lt;-</span>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb194-4575"><a href="#cb194-4575" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">mean_qi</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>)),</span>
<span id="cb194-4576"><a href="#cb194-4576" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">median_qi</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>)),</span>
<span id="cb194-4577"><a href="#cb194-4577" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">mode_qi</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>)),</span>
<span id="cb194-4578"><a href="#cb194-4578" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">mode_hdci</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>)),</span>
<span id="cb194-4579"><a href="#cb194-4579" aria-hidden="true" tabindex="-1"></a>    ggdist<span class="sc">::</span><span class="fu">mode_hdi</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.99</span>))</span>
<span id="cb194-4580"><a href="#cb194-4580" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb194-4581"><a href="#cb194-4581" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-4582"><a href="#cb194-4582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4583"><a href="#cb194-4583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4584"><a href="#cb194-4584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4585"><a href="#cb194-4585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4586"><a href="#cb194-4586" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4587"><a href="#cb194-4587" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4588"><a href="#cb194-4588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4589"><a href="#cb194-4589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4590"><a href="#cb194-4590" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4591"><a href="#cb194-4591" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4592"><a href="#cb194-4592" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4593"><a href="#cb194-4593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4594"><a href="#cb194-4594" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-4595"><a href="#cb194-4595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4596"><a href="#cb194-4596" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3M3</span></span>
<span id="cb194-4597"><a href="#cb194-4597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4598"><a href="#cb194-4598" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-4599"><a href="#cb194-4599" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-4600"><a href="#cb194-4600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4601"><a href="#cb194-4601" aria-hidden="true" tabindex="-1"></a>Exercise 3M3: Construct a posterior predictive check for this model and data. This means simulate the distribution of samples, averaging over the posterior uncertainty in $p$. What is the probability of observing 8 water in 15 tosses?</span>
<span id="cb194-4602"><a href="#cb194-4602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4603"><a href="#cb194-4603" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4604"><a href="#cb194-4604" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-4605"><a href="#cb194-4605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4606"><a href="#cb194-4606" aria-hidden="true" tabindex="-1"></a>In the following set of tabs &quot;Original&quot; is abbreviated with &quot;O&quot; and Tidyverse with &quot;T&quot;.</span>
<span id="cb194-4607"><a href="#cb194-4607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4608"><a href="#cb194-4608" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-4609"><a href="#cb194-4609" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Data (O)</span></span>
<span id="cb194-4610"><a href="#cb194-4610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4611"><a href="#cb194-4611" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4612"><a href="#cb194-4612" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4613"><a href="#cb194-4613" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m3a-data}</span>
<span id="cb194-4614"><a href="#cb194-4614" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M3 -- Data (Original)</span>
<span id="cb194-4615"><a href="#cb194-4615" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4616"><a href="#cb194-4616" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4617"><a href="#cb194-4617" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4618"><a href="#cb194-4618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4619"><a href="#cb194-4619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4620"><a href="#cb194-4620" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4621"><a href="#cb194-4621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4622"><a href="#cb194-4622" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4623"><a href="#cb194-4623" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-data-3m3a</span></span>
<span id="cb194-4624"><a href="#cb194-4624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4625"><a href="#cb194-4625" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-4626"><a href="#cb194-4626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4627"><a href="#cb194-4627" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.23a #############################</span></span>
<span id="cb194-4628"><a href="#cb194-4628" aria-hidden="true" tabindex="-1"></a>dummy_3m3a <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> samples_3m2a)</span>
<span id="cb194-4629"><a href="#cb194-4629" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">table</span>(dummy_3m3a))</span>
<span id="cb194-4630"><a href="#cb194-4630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4631"><a href="#cb194-4631" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4632"><a href="#cb194-4632" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4633"><a href="#cb194-4633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4634"><a href="#cb194-4634" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Plot (O)</span></span>
<span id="cb194-4635"><a href="#cb194-4635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4636"><a href="#cb194-4636" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4637"><a href="#cb194-4637" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4638"><a href="#cb194-4638" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m3a-plot}</span>
<span id="cb194-4639"><a href="#cb194-4639" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M3 -- Histogram (Original)</span>
<span id="cb194-4640"><a href="#cb194-4640" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4641"><a href="#cb194-4641" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4642"><a href="#cb194-4642" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4643"><a href="#cb194-4643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4644"><a href="#cb194-4644" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4645"><a href="#cb194-4645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4646"><a href="#cb194-4646" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4647"><a href="#cb194-4647" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-plot-3m3a</span></span>
<span id="cb194-4648"><a href="#cb194-4648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4649"><a href="#cb194-4649" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">simplehist</span>(dummy_3m3a, <span class="at">xlab =</span> <span class="st">&quot;Dummy water count&quot;</span>)</span>
<span id="cb194-4650"><a href="#cb194-4650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4651"><a href="#cb194-4651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4652"><a href="#cb194-4652" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4653"><a href="#cb194-4653" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4654"><a href="#cb194-4654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4655"><a href="#cb194-4655" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Result (O)</span></span>
<span id="cb194-4656"><a href="#cb194-4656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4657"><a href="#cb194-4657" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4658"><a href="#cb194-4658" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4659"><a href="#cb194-4659" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m3a-result}</span>
<span id="cb194-4660"><a href="#cb194-4660" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M3 -- Result (Original)</span>
<span id="cb194-4661"><a href="#cb194-4661" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4662"><a href="#cb194-4662" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4663"><a href="#cb194-4663" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4664"><a href="#cb194-4664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4665"><a href="#cb194-4665" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4666"><a href="#cb194-4666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4667"><a href="#cb194-4667" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4668"><a href="#cb194-4668" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-result-3m3a</span></span>
<span id="cb194-4669"><a href="#cb194-4669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4670"><a href="#cb194-4670" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb194-4671"><a href="#cb194-4671" aria-hidden="true" tabindex="-1"></a>  mean_dummy_3m3a <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m3a <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb194-4672"><a href="#cb194-4672" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-4673"><a href="#cb194-4673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4674"><a href="#cb194-4674" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4675"><a href="#cb194-4675" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4676"><a href="#cb194-4676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4677"><a href="#cb194-4677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4678"><a href="#cb194-4678" aria-hidden="true" tabindex="-1"></a>The probability of observing 8 water in 15 tosses = <span class="in">`r mean_dummy_3m3a * 100`</span>%.</span>
<span id="cb194-4679"><a href="#cb194-4679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4680"><a href="#cb194-4680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4681"><a href="#cb194-4681" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Data (T)</span></span>
<span id="cb194-4682"><a href="#cb194-4682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4683"><a href="#cb194-4683" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4684"><a href="#cb194-4684" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4685"><a href="#cb194-4685" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m3b-data}</span>
<span id="cb194-4686"><a href="#cb194-4686" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M3 -- Data (Tidyverse)</span>
<span id="cb194-4687"><a href="#cb194-4687" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4688"><a href="#cb194-4688" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4689"><a href="#cb194-4689" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4690"><a href="#cb194-4690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4691"><a href="#cb194-4691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4692"><a href="#cb194-4692" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4693"><a href="#cb194-4693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4694"><a href="#cb194-4694" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4695"><a href="#cb194-4695" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-data-3m3b</span></span>
<span id="cb194-4696"><a href="#cb194-4696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4697"><a href="#cb194-4697" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-4698"><a href="#cb194-4698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4699"><a href="#cb194-4699" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.23b #############################</span></span>
<span id="cb194-4700"><a href="#cb194-4700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4701"><a href="#cb194-4701" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="ot">&lt;-</span> samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb194-4702"><a href="#cb194-4702" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dummy_3m3b =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> p_samples_3m2b))</span>
<span id="cb194-4703"><a href="#cb194-4703" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-4704"><a href="#cb194-4704" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb194-4705"><a href="#cb194-4705" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(dummy_3m3b) <span class="sc">|&gt;</span> </span>
<span id="cb194-4706"><a href="#cb194-4706" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">dummy_cnt =</span> dplyr<span class="sc">::</span><span class="fu">n</span>())</span>
<span id="cb194-4707"><a href="#cb194-4707" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-4708"><a href="#cb194-4708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4709"><a href="#cb194-4709" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4710"><a href="#cb194-4710" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4711"><a href="#cb194-4711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4712"><a href="#cb194-4712" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Plot (T)</span></span>
<span id="cb194-4713"><a href="#cb194-4713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4714"><a href="#cb194-4714" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4715"><a href="#cb194-4715" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4716"><a href="#cb194-4716" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m3b-plot}</span>
<span id="cb194-4717"><a href="#cb194-4717" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M3 -- Histogram (Tidyverse)</span>
<span id="cb194-4718"><a href="#cb194-4718" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4719"><a href="#cb194-4719" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4720"><a href="#cb194-4720" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4721"><a href="#cb194-4721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4722"><a href="#cb194-4722" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4723"><a href="#cb194-4723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4724"><a href="#cb194-4724" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4725"><a href="#cb194-4725" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-plot-3m3b</span></span>
<span id="cb194-4726"><a href="#cb194-4726" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Posterior predictive check for 8 water with 15 tosses&quot;</span></span>
<span id="cb194-4727"><a href="#cb194-4727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4728"><a href="#cb194-4728" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb194-4729"><a href="#cb194-4729" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> dummy_3m3b)) <span class="sc">+</span></span>
<span id="cb194-4730"><a href="#cb194-4730" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">16</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-4731"><a href="#cb194-4731" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb194-4732"><a href="#cb194-4732" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dummy water count&quot;</span>,</span>
<span id="cb194-4733"><a href="#cb194-4733" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Frequnecy&quot;</span>)</span>
<span id="cb194-4734"><a href="#cb194-4734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4735"><a href="#cb194-4735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4736"><a href="#cb194-4736" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4737"><a href="#cb194-4737" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4738"><a href="#cb194-4738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4739"><a href="#cb194-4739" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Result (T)</span></span>
<span id="cb194-4740"><a href="#cb194-4740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4741"><a href="#cb194-4741" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4742"><a href="#cb194-4742" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4743"><a href="#cb194-4743" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m3b-result}</span>
<span id="cb194-4744"><a href="#cb194-4744" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M3 -- Result (Tidyverse)</span>
<span id="cb194-4745"><a href="#cb194-4745" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4746"><a href="#cb194-4746" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4747"><a href="#cb194-4747" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4748"><a href="#cb194-4748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4749"><a href="#cb194-4749" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4750"><a href="#cb194-4750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4751"><a href="#cb194-4751" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4752"><a href="#cb194-4752" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-result-3m3b</span></span>
<span id="cb194-4753"><a href="#cb194-4753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4754"><a href="#cb194-4754" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb194-4755"><a href="#cb194-4755" aria-hidden="true" tabindex="-1"></a>  mean_dummy_3m3b <span class="ot">&lt;-</span> samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb194-4756"><a href="#cb194-4756" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="fu">mean</span>(dummy_3m3b <span class="sc">==</span> <span class="dv">8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-4757"><a href="#cb194-4757" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>()</span>
<span id="cb194-4758"><a href="#cb194-4758" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-4759"><a href="#cb194-4759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4760"><a href="#cb194-4760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4761"><a href="#cb194-4761" aria-hidden="true" tabindex="-1"></a>The probability of observing 8 water in 15 tosses = <span class="in">`r mean_dummy_3m3b * 100`</span>%.</span>
<span id="cb194-4762"><a href="#cb194-4762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4763"><a href="#cb194-4763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4764"><a href="#cb194-4764" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4765"><a href="#cb194-4765" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4766"><a href="#cb194-4766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4767"><a href="#cb194-4767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4768"><a href="#cb194-4768" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4769"><a href="#cb194-4769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4770"><a href="#cb194-4770" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4771"><a href="#cb194-4771" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4772"><a href="#cb194-4772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4773"><a href="#cb194-4773" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-4774"><a href="#cb194-4774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4775"><a href="#cb194-4775" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3M4</span></span>
<span id="cb194-4776"><a href="#cb194-4776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4777"><a href="#cb194-4777" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-4778"><a href="#cb194-4778" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-4779"><a href="#cb194-4779" aria-hidden="true" tabindex="-1"></a>Exercise 3M4: Using the posterior distribution constructed from the new (8/15) data, now calculate the probability of observing 6 water in 9 tosses.</span>
<span id="cb194-4780"><a href="#cb194-4780" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4781"><a href="#cb194-4781" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-4782"><a href="#cb194-4782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4783"><a href="#cb194-4783" aria-hidden="true" tabindex="-1"></a>There are two possible approaches for the solution:</span>
<span id="cb194-4784"><a href="#cb194-4784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4785"><a href="#cb194-4785" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**S1**: Random generation of the binomial distribution with the probability of the sampling distribution.</span>
<span id="cb194-4786"><a href="#cb194-4786" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**S2**: Computing the density for 6/9 but with the posterior distribution from 8/15 as prior.</span>
<span id="cb194-4787"><a href="#cb194-4787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4788"><a href="#cb194-4788" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-4789"><a href="#cb194-4789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4790"><a href="#cb194-4790" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Original S1</span></span>
<span id="cb194-4791"><a href="#cb194-4791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4792"><a href="#cb194-4792" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4793"><a href="#cb194-4793" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4794"><a href="#cb194-4794" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m4a1}</span>
<span id="cb194-4795"><a href="#cb194-4795" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M4 (Original: Method S1)</span>
<span id="cb194-4796"><a href="#cb194-4796" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4797"><a href="#cb194-4797" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4798"><a href="#cb194-4798" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4799"><a href="#cb194-4799" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4800"><a href="#cb194-4800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4801"><a href="#cb194-4801" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4802"><a href="#cb194-4802" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m4a1</span></span>
<span id="cb194-4803"><a href="#cb194-4803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4804"><a href="#cb194-4804" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-4805"><a href="#cb194-4805" aria-hidden="true" tabindex="-1"></a>samples_3m4a <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> samples_3m2a)</span>
<span id="cb194-4806"><a href="#cb194-4806" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples_3m4a <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb194-4807"><a href="#cb194-4807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4808"><a href="#cb194-4808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4809"><a href="#cb194-4809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4810"><a href="#cb194-4810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4811"><a href="#cb194-4811" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4812"><a href="#cb194-4812" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4813"><a href="#cb194-4813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4814"><a href="#cb194-4814" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Original S2 </span></span>
<span id="cb194-4815"><a href="#cb194-4815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4816"><a href="#cb194-4816" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4817"><a href="#cb194-4817" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4818"><a href="#cb194-4818" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m4a2}</span>
<span id="cb194-4819"><a href="#cb194-4819" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M4 (Original: Method S2)</span>
<span id="cb194-4820"><a href="#cb194-4820" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4821"><a href="#cb194-4821" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4822"><a href="#cb194-4822" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4823"><a href="#cb194-4823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4824"><a href="#cb194-4824" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4825"><a href="#cb194-4825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4826"><a href="#cb194-4826" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4827"><a href="#cb194-4827" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: exercise-3m4a2</span></span>
<span id="cb194-4828"><a href="#cb194-4828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4829"><a href="#cb194-4829" aria-hidden="true" tabindex="-1"></a>likelihood_6of9_3m4a <span class="ot">&lt;-</span>  stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid_3m1a)</span>
<span id="cb194-4830"><a href="#cb194-4830" aria-hidden="true" tabindex="-1"></a>prior_6of9_3m4a <span class="ot">&lt;-</span>  posterior_std_3m1a</span>
<span id="cb194-4831"><a href="#cb194-4831" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb194-4832"><a href="#cb194-4832" aria-hidden="true" tabindex="-1"></a>  posterior_6of9_3m4a <span class="ot">&lt;-</span> <span class="fu">sum</span>(likelihood_6of9_3m4a <span class="sc">*</span> prior_6of9_3m4a)</span>
<span id="cb194-4833"><a href="#cb194-4833" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-4834"><a href="#cb194-4834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4835"><a href="#cb194-4835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4836"><a href="#cb194-4836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4837"><a href="#cb194-4837" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4838"><a href="#cb194-4838" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4839"><a href="#cb194-4839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4840"><a href="#cb194-4840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4841"><a href="#cb194-4841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4842"><a href="#cb194-4842" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Tidyverse S1</span></span>
<span id="cb194-4843"><a href="#cb194-4843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4844"><a href="#cb194-4844" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4845"><a href="#cb194-4845" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4846"><a href="#cb194-4846" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m4b}</span>
<span id="cb194-4847"><a href="#cb194-4847" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M4 (Tidyverse: Method S1)</span>
<span id="cb194-4848"><a href="#cb194-4848" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4849"><a href="#cb194-4849" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4850"><a href="#cb194-4850" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4851"><a href="#cb194-4851" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4852"><a href="#cb194-4852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4853"><a href="#cb194-4853" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4854"><a href="#cb194-4854" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m41b</span></span>
<span id="cb194-4855"><a href="#cb194-4855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4856"><a href="#cb194-4856" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-4857"><a href="#cb194-4857" aria-hidden="true" tabindex="-1"></a>samples_3m2b <span class="sc">|&gt;</span> </span>
<span id="cb194-4858"><a href="#cb194-4858" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb194-4859"><a href="#cb194-4859" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_6of9_3m4b =</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_samples_3m2b)</span>
<span id="cb194-4860"><a href="#cb194-4860" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb194-4861"><a href="#cb194-4861" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> base<span class="sc">::</span><span class="fu">mean</span>(p_6of9_3m4b <span class="sc">==</span> <span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-4862"><a href="#cb194-4862" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>()</span>
<span id="cb194-4863"><a href="#cb194-4863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4864"><a href="#cb194-4864" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4865"><a href="#cb194-4865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4866"><a href="#cb194-4866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4867"><a href="#cb194-4867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4868"><a href="#cb194-4868" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4869"><a href="#cb194-4869" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4870"><a href="#cb194-4870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4871"><a href="#cb194-4871" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Tidyverse M2</span></span>
<span id="cb194-4872"><a href="#cb194-4872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4873"><a href="#cb194-4873" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4874"><a href="#cb194-4874" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4875"><a href="#cb194-4875" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m4b}</span>
<span id="cb194-4876"><a href="#cb194-4876" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M4 (Tidyverse Method S2)</span>
<span id="cb194-4877"><a href="#cb194-4877" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4878"><a href="#cb194-4878" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4879"><a href="#cb194-4879" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4880"><a href="#cb194-4880" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4881"><a href="#cb194-4881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4882"><a href="#cb194-4882" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4883"><a href="#cb194-4883" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m42b</span></span>
<span id="cb194-4884"><a href="#cb194-4884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4885"><a href="#cb194-4885" aria-hidden="true" tabindex="-1"></a>df_3m1b <span class="sc">|&gt;</span> </span>
<span id="cb194-4886"><a href="#cb194-4886" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb194-4887"><a href="#cb194-4887" aria-hidden="true" tabindex="-1"></a>    <span class="at">likelihood_6of9_3m4b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid_3m1b),</span>
<span id="cb194-4888"><a href="#cb194-4888" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_6of9_3m4b =</span> posterior_std_3m1b) <span class="sc">|&gt;</span> </span>
<span id="cb194-4889"><a href="#cb194-4889" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum =</span> base<span class="sc">::</span><span class="fu">sum</span>(likelihood_6of9_3m4b <span class="sc">*</span> prior_6of9_3m4b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-4890"><a href="#cb194-4890" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>()</span>
<span id="cb194-4891"><a href="#cb194-4891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4892"><a href="#cb194-4892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4893"><a href="#cb194-4893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4894"><a href="#cb194-4894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4895"><a href="#cb194-4895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4896"><a href="#cb194-4896" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4897"><a href="#cb194-4897" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4898"><a href="#cb194-4898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4899"><a href="#cb194-4899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4900"><a href="#cb194-4900" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4901"><a href="#cb194-4901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4902"><a href="#cb194-4902" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4903"><a href="#cb194-4903" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4904"><a href="#cb194-4904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4905"><a href="#cb194-4905" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-4906"><a href="#cb194-4906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4907"><a href="#cb194-4907" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3M5</span></span>
<span id="cb194-4908"><a href="#cb194-4908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4909"><a href="#cb194-4909" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-4910"><a href="#cb194-4910" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-4911"><a href="#cb194-4911" aria-hidden="true" tabindex="-1"></a>Exercise 3M5: Start over at Exercise 3M1 (@sec-e3m1), but now use a prior that is zero below $p = 0.5$ and a constant above $p = 0.5$. This corresponds to prior information that a majority of the Earth’s surface is water. Repeat each problem above and compare the inferences. What difference does the better prior make? If it helps, compare inferences (using both priors) to the true value $p = 0.7$.</span>
<span id="cb194-4912"><a href="#cb194-4912" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4913"><a href="#cb194-4913" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-4914"><a href="#cb194-4914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4915"><a href="#cb194-4915" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-4916"><a href="#cb194-4916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4917"><a href="#cb194-4917" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3M5.1a</span></span>
<span id="cb194-4918"><a href="#cb194-4918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4919"><a href="#cb194-4919" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4920"><a href="#cb194-4920" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4921"><a href="#cb194-4921" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m5a-1}</span>
<span id="cb194-4922"><a href="#cb194-4922" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M5: Posterior Distribution (~ 3M1: Original)</span>
<span id="cb194-4923"><a href="#cb194-4923" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4924"><a href="#cb194-4924" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4925"><a href="#cb194-4925" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4926"><a href="#cb194-4926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4927"><a href="#cb194-4927" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4928"><a href="#cb194-4928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4929"><a href="#cb194-4929" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4930"><a href="#cb194-4930" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3m5a-1</span></span>
<span id="cb194-4931"><a href="#cb194-4931" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Posterior distribution for 8 &#39;W&#39; in 15 tosses with prior &lt; 0.5 = 0 otherwise prior = 1 (Original)&quot;</span></span>
<span id="cb194-4932"><a href="#cb194-4932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4933"><a href="#cb194-4933" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M1a ###########</span></span>
<span id="cb194-4934"><a href="#cb194-4934" aria-hidden="true" tabindex="-1"></a>p_grid_3m5a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb194-4935"><a href="#cb194-4935" aria-hidden="true" tabindex="-1"></a>prior_3m5a <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_grid_3m5a <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb194-4936"><a href="#cb194-4936" aria-hidden="true" tabindex="-1"></a>likelihood_3m5a <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="dv">8</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> p_grid_3m5a)</span>
<span id="cb194-4937"><a href="#cb194-4937" aria-hidden="true" tabindex="-1"></a>posterior_3m5a <span class="ot">&lt;-</span>  likelihood_3m5a <span class="sc">*</span> prior_3m5a</span>
<span id="cb194-4938"><a href="#cb194-4938" aria-hidden="true" tabindex="-1"></a>posterior_std_3m5a <span class="ot">&lt;-</span>  posterior_3m5a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m5a) </span>
<span id="cb194-4939"><a href="#cb194-4939" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid_3m5a, posterior_std_3m5a, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb194-4940"><a href="#cb194-4940" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Proportion of water (p)&quot;</span>,</span>
<span id="cb194-4941"><a href="#cb194-4941" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Posterior density&quot;</span>)</span>
<span id="cb194-4942"><a href="#cb194-4942" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p_grid_3m1a, posterior_std_3m1a)</span>
<span id="cb194-4943"><a href="#cb194-4943" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> .<span class="dv">7</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb194-4944"><a href="#cb194-4944" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb194-4945"><a href="#cb194-4945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4946"><a href="#cb194-4946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4947"><a href="#cb194-4947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4948"><a href="#cb194-4948" aria-hidden="true" tabindex="-1"></a>Compared with the true value of $0.7$ the new prior ($0$ under $p = 0.5$, otherwise $p = 1$) is better, but there is still a big difference between the true value and the mode of the probability density.</span>
<span id="cb194-4949"><a href="#cb194-4949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4950"><a href="#cb194-4950" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4951"><a href="#cb194-4951" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4952"><a href="#cb194-4952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4953"><a href="#cb194-4953" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3M5.2a</span></span>
<span id="cb194-4954"><a href="#cb194-4954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4955"><a href="#cb194-4955" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4956"><a href="#cb194-4956" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4957"><a href="#cb194-4957" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m5a-2}</span>
<span id="cb194-4958"><a href="#cb194-4958" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M5.2: HPDI of 90% from 1e4 samples (~3M2: Original)</span>
<span id="cb194-4959"><a href="#cb194-4959" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4960"><a href="#cb194-4960" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-4961"><a href="#cb194-4961" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-4962"><a href="#cb194-4962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4963"><a href="#cb194-4963" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-4964"><a href="#cb194-4964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4965"><a href="#cb194-4965" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-4966"><a href="#cb194-4966" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m5a-2</span></span>
<span id="cb194-4967"><a href="#cb194-4967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4968"><a href="#cb194-4968" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M2a #############</span></span>
<span id="cb194-4969"><a href="#cb194-4969" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-4970"><a href="#cb194-4970" aria-hidden="true" tabindex="-1"></a>samples_3m5a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> p_grid_3m5a, </span>
<span id="cb194-4971"><a href="#cb194-4971" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="fl">1e4</span>, </span>
<span id="cb194-4972"><a href="#cb194-4972" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb194-4973"><a href="#cb194-4973" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prob =</span> posterior_std_3m5a</span>
<span id="cb194-4974"><a href="#cb194-4974" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb194-4975"><a href="#cb194-4975" aria-hidden="true" tabindex="-1"></a>hpdi_3m5a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m5a, .<span class="dv">9</span>)</span>
<span id="cb194-4976"><a href="#cb194-4976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4977"><a href="#cb194-4977" aria-hidden="true" tabindex="-1"></a>max_3m2a <span class="ot">&lt;-</span> <span class="fu">max</span>(posterior_std_3m1a)</span>
<span id="cb194-4978"><a href="#cb194-4978" aria-hidden="true" tabindex="-1"></a>max_3m5a <span class="ot">&lt;-</span> <span class="fu">max</span>(posterior_std_3m5a)</span>
<span id="cb194-4979"><a href="#cb194-4979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-4980"><a href="#cb194-4980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4981"><a href="#cb194-4981" aria-hidden="true" tabindex="-1"></a>| Prior | Low                | High               | Diff                                | Max Density  |</span>
<span id="cb194-4982"><a href="#cb194-4982" aria-hidden="true" tabindex="-1"></a>|-------|--------------------|--------------------|-------------------------------------|--------------|</span>
<span id="cb194-4983"><a href="#cb194-4983" aria-hidden="true" tabindex="-1"></a>| 1     | <span class="in">`r hpdi_3m2a_1[[1]]`</span> | <span class="in">`r hpdi_3m2a_1[[2]]`</span> | <span class="in">`r hpdi_3m2a_1[[2]] - hpdi_3m2a_1[[1]]`</span> | <span class="in">`r max_3m2a`</span> |</span>
<span id="cb194-4984"><a href="#cb194-4984" aria-hidden="true" tabindex="-1"></a>| 0/1   | <span class="in">`r hpdi_3m5a[[1]]`</span> | <span class="in">`r hpdi_3m5a[[2]]`</span> | <span class="in">`r hpdi_3m5a[[2]] - hpdi_3m5a[[1]]`</span> | <span class="in">`r max_3m5a`</span> |</span>
<span id="cb194-4985"><a href="#cb194-4985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4986"><a href="#cb194-4986" aria-hidden="true" tabindex="-1"></a>The HPDI interval is smaller with the the new prior $p &lt; .5 = 0 \operatorname{and} p &gt;= .5 = 1$ than with a constant prior of $1$. The new prior is better as it gives more precise information.</span>
<span id="cb194-4987"><a href="#cb194-4987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4988"><a href="#cb194-4988" aria-hidden="true" tabindex="-1"></a>The maximum posterior density of the new prior $0/1$ is higher than the maximum with the prior of $1$. Values of $p &lt; 0.5$ are no longer taking up posterior density because they are $0$. This can also be seen in @fig-exercise-3m5a-1.</span>
<span id="cb194-4989"><a href="#cb194-4989" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-4990"><a href="#cb194-4990" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-4991"><a href="#cb194-4991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4992"><a href="#cb194-4992" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3M5.3a</span></span>
<span id="cb194-4993"><a href="#cb194-4993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4994"><a href="#cb194-4994" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-4995"><a href="#cb194-4995" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-4996"><a href="#cb194-4996" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m5a-3}</span>
<span id="cb194-4997"><a href="#cb194-4997" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M5.3: Posterior predictive check (~3M3: Original)</span>
<span id="cb194-4998"><a href="#cb194-4998" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-4999"><a href="#cb194-4999" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5000"><a href="#cb194-5000" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5001"><a href="#cb194-5001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5002"><a href="#cb194-5002" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5003"><a href="#cb194-5003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5004"><a href="#cb194-5004" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5005"><a href="#cb194-5005" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m5a-3-4</span></span>
<span id="cb194-5006"><a href="#cb194-5006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5007"><a href="#cb194-5007" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M3a ##############</span></span>
<span id="cb194-5008"><a href="#cb194-5008" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-5009"><a href="#cb194-5009" aria-hidden="true" tabindex="-1"></a>dummy_3m5a_1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">15</span>, samples_3m5a)</span>
<span id="cb194-5010"><a href="#cb194-5010" aria-hidden="true" tabindex="-1"></a>mean_3m5a_1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5a_1 <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb194-5011"><a href="#cb194-5011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5012"><a href="#cb194-5012" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M4a ##############</span></span>
<span id="cb194-5013"><a href="#cb194-5013" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-5014"><a href="#cb194-5014" aria-hidden="true" tabindex="-1"></a>dummy_3m5a_2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">9</span>, samples_3m5a)</span>
<span id="cb194-5015"><a href="#cb194-5015" aria-hidden="true" tabindex="-1"></a>mean_3m5a_2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5a_2 <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb194-5016"><a href="#cb194-5016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5017"><a href="#cb194-5017" aria-hidden="true" tabindex="-1"></a><span class="do">## compare with p = 0.7 ##############</span></span>
<span id="cb194-5018"><a href="#cb194-5018" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-5019"><a href="#cb194-5019" aria-hidden="true" tabindex="-1"></a>dummy_3m5a_3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">15</span>, <span class="fl">0.7</span>)</span>
<span id="cb194-5020"><a href="#cb194-5020" aria-hidden="true" tabindex="-1"></a>mean_3m5a_3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5a_3 <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb194-5021"><a href="#cb194-5021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5022"><a href="#cb194-5022" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-5023"><a href="#cb194-5023" aria-hidden="true" tabindex="-1"></a>dummy_3m5a_4 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">9</span>, <span class="fl">0.7</span>)</span>
<span id="cb194-5024"><a href="#cb194-5024" aria-hidden="true" tabindex="-1"></a>mean_3m5a_4 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5a_4 <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb194-5025"><a href="#cb194-5025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5026"><a href="#cb194-5026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5027"><a href="#cb194-5027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5028"><a href="#cb194-5028" aria-hidden="true" tabindex="-1"></a>| Name      | Mean of 15/08   | Mean of 09/06   |</span>
<span id="cb194-5029"><a href="#cb194-5029" aria-hidden="true" tabindex="-1"></a>|-----------|-----------------|-----------------|</span>
<span id="cb194-5030"><a href="#cb194-5030" aria-hidden="true" tabindex="-1"></a>| Samples   | <span class="in">`r mean_3m5a_1`</span> | <span class="in">`r mean_3m5a_2`</span> |</span>
<span id="cb194-5031"><a href="#cb194-5031" aria-hidden="true" tabindex="-1"></a>| Value 0.7 | <span class="in">`r mean_3m5a_3`</span> | <span class="in">`r mean_3m5a_4`</span> |</span>
<span id="cb194-5032"><a href="#cb194-5032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5033"><a href="#cb194-5033" aria-hidden="true" tabindex="-1"></a>The mean of the samples of 6 water observations with 9 tosses are higher than 8 water with 15 tosses. This represents the fact that the real value of 0.7 is nearer with 6/9 = <span class="in">`r round(6 / 9, 3)`</span> than with 8/15 = <span class="in">`r round(8 / 15, 3)`</span>. Also note that a predictive check with the real value of $0.7$ shows a very small mean value with 15/8 but a much higher mean with 9/6.</span>
<span id="cb194-5034"><a href="#cb194-5034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5035"><a href="#cb194-5035" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5036"><a href="#cb194-5036" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5037"><a href="#cb194-5037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5038"><a href="#cb194-5038" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3M5.1b</span></span>
<span id="cb194-5039"><a href="#cb194-5039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5040"><a href="#cb194-5040" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5041"><a href="#cb194-5041" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5042"><a href="#cb194-5042" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m5b-1}</span>
<span id="cb194-5043"><a href="#cb194-5043" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M5: Posterior Distribution (~ 3M1: Tidyverse)</span>
<span id="cb194-5044"><a href="#cb194-5044" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5045"><a href="#cb194-5045" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5046"><a href="#cb194-5046" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5047"><a href="#cb194-5047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5048"><a href="#cb194-5048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5049"><a href="#cb194-5049" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5050"><a href="#cb194-5050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5051"><a href="#cb194-5051" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5052"><a href="#cb194-5052" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3m5b-1</span></span>
<span id="cb194-5053"><a href="#cb194-5053" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Posterior distribution for 8 &#39;W&#39; in 15 tosses with prior &lt; 0.5 = 0 otherwise prior = 1 (Tidyverse)&quot;</span></span>
<span id="cb194-5054"><a href="#cb194-5054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5055"><a href="#cb194-5055" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M1b ##############</span></span>
<span id="cb194-5056"><a href="#cb194-5056" aria-hidden="true" tabindex="-1"></a>df_3m5b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb194-5057"><a href="#cb194-5057" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_grid_3m5b =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb194-5058"><a href="#cb194-5058" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_3m5b =</span> base<span class="sc">::</span><span class="fu">ifelse</span>(p_grid_3m5b <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb194-5059"><a href="#cb194-5059" aria-hidden="true" tabindex="-1"></a>  <span class="at">likelihood_3m5b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">8</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">prob =</span> p_grid_3m5b),</span>
<span id="cb194-5060"><a href="#cb194-5060" aria-hidden="true" tabindex="-1"></a>  <span class="at">posterior_3m5b =</span>  likelihood_3m5b <span class="sc">*</span> prior_3m5b,</span>
<span id="cb194-5061"><a href="#cb194-5061" aria-hidden="true" tabindex="-1"></a>  <span class="at">posterior_std_3m5b =</span> posterior_3m5b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m5b)</span>
<span id="cb194-5062"><a href="#cb194-5062" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb194-5063"><a href="#cb194-5063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5064"><a href="#cb194-5064" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb194-5065"><a href="#cb194-5065" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> df_3m5b,</span>
<span id="cb194-5066"><a href="#cb194-5066" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3m5b, <span class="at">y =</span> posterior_std_3m5b,</span>
<span id="cb194-5067"><a href="#cb194-5067" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linetype =</span> <span class="st">&quot;ifelse(p &lt; 0.5, 0, 1)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb194-5068"><a href="#cb194-5068" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> df_3m1b,</span>
<span id="cb194-5069"><a href="#cb194-5069" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3m1b, <span class="at">y =</span> posterior_std_3m1b,</span>
<span id="cb194-5070"><a href="#cb194-5070" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">linetype =</span> <span class="st">&quot;1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb194-5071"><a href="#cb194-5071" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">scale_linetype_manual</span>(<span class="st">&quot;Prior:&quot;</span>, </span>
<span id="cb194-5072"><a href="#cb194-5072" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>)) <span class="sc">+</span></span>
<span id="cb194-5073"><a href="#cb194-5073" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">7</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5074"><a href="#cb194-5074" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Proportion of water (p)&quot;</span>,</span>
<span id="cb194-5075"><a href="#cb194-5075" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="st">&quot;Posterior density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5076"><a href="#cb194-5076" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-5077"><a href="#cb194-5077" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5078"><a href="#cb194-5078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5079"><a href="#cb194-5079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5080"><a href="#cb194-5080" aria-hidden="true" tabindex="-1"></a>Compared with the true value of $0.7$ the new prior ($0$ under $p = 0.5$, otherwise $p = 1$) is better, but there is still a big difference between the true value and the mode of the probability density.</span>
<span id="cb194-5081"><a href="#cb194-5081" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5082"><a href="#cb194-5082" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5083"><a href="#cb194-5083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5084"><a href="#cb194-5084" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3M5.2b</span></span>
<span id="cb194-5085"><a href="#cb194-5085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5086"><a href="#cb194-5086" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5087"><a href="#cb194-5087" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5088"><a href="#cb194-5088" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m5b-2}</span>
<span id="cb194-5089"><a href="#cb194-5089" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M5.2: HPDI of 90% from 1e4 samples (~3M2: Tidyverse)</span>
<span id="cb194-5090"><a href="#cb194-5090" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5091"><a href="#cb194-5091" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5092"><a href="#cb194-5092" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5093"><a href="#cb194-5093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5094"><a href="#cb194-5094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5095"><a href="#cb194-5095" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5096"><a href="#cb194-5096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5097"><a href="#cb194-5097" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5098"><a href="#cb194-5098" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m5b-2</span></span>
<span id="cb194-5099"><a href="#cb194-5099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5100"><a href="#cb194-5100" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M2b ##############</span></span>
<span id="cb194-5101"><a href="#cb194-5101" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-5102"><a href="#cb194-5102" aria-hidden="true" tabindex="-1"></a>samples_3m5b <span class="ot">&lt;-</span> df_3m5b <span class="sc">|&gt;</span> </span>
<span id="cb194-5103"><a href="#cb194-5103" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5104"><a href="#cb194-5104" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight_by =</span> posterior_std_3m5b,</span>
<span id="cb194-5105"><a href="#cb194-5105" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb194-5106"><a href="#cb194-5106" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">p_samples_3m5b =</span> p_grid_3m5b)</span>
<span id="cb194-5107"><a href="#cb194-5107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5108"><a href="#cb194-5108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5109"><a href="#cb194-5109" aria-hidden="true" tabindex="-1"></a>hpdi_3m2b <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m2b<span class="sc">$</span>p_samples_3m2b, .<span class="dv">9</span>)</span>
<span id="cb194-5110"><a href="#cb194-5110" aria-hidden="true" tabindex="-1"></a>hpdi_3m5b <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3m5b<span class="sc">$</span>p_samples_3m5b, .<span class="dv">9</span>)</span>
<span id="cb194-5111"><a href="#cb194-5111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5112"><a href="#cb194-5112" aria-hidden="true" tabindex="-1"></a>max_3m2b <span class="ot">&lt;-</span> <span class="fu">max</span>(df_3m1b<span class="sc">$</span>posterior_std_3m1b)</span>
<span id="cb194-5113"><a href="#cb194-5113" aria-hidden="true" tabindex="-1"></a>max_3m5b <span class="ot">&lt;-</span> <span class="fu">max</span>(df_3m5b<span class="sc">$</span>posterior_std_3m5b)</span>
<span id="cb194-5114"><a href="#cb194-5114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5115"><a href="#cb194-5115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5116"><a href="#cb194-5116" aria-hidden="true" tabindex="-1"></a>| Prior | Low                | High               | Diff                                | Max Density  |</span>
<span id="cb194-5117"><a href="#cb194-5117" aria-hidden="true" tabindex="-1"></a>|-------|--------------------|--------------------|-------------------------------------|--------------|</span>
<span id="cb194-5118"><a href="#cb194-5118" aria-hidden="true" tabindex="-1"></a>| 1     | <span class="in">`r hpdi_3m2b[[1]]`</span> | <span class="in">`r hpdi_3m2b[[2]]`</span> | <span class="in">`r hpdi_3m2b[[2]] - hpdi_3m2b[[1]]`</span> | <span class="in">`r max_3m2b`</span> |</span>
<span id="cb194-5119"><a href="#cb194-5119" aria-hidden="true" tabindex="-1"></a>| 0/1   | <span class="in">`r hpdi_3m5b[[1]]`</span> | <span class="in">`r hpdi_3m5b[[2]]`</span> | <span class="in">`r hpdi_3m5b[[2]] - hpdi_3m5b[[1]]`</span> | <span class="in">`r max_3m5b`</span> |</span>
<span id="cb194-5120"><a href="#cb194-5120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5121"><a href="#cb194-5121" aria-hidden="true" tabindex="-1"></a>The HPDI interval is smaller with the the new prior $p &lt; .5 = 0 \operatorname{and} p &gt;= .5 = 1$ than with a constant prior of $1$. The new prior is better as it gives more precise information.</span>
<span id="cb194-5122"><a href="#cb194-5122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5123"><a href="#cb194-5123" aria-hidden="true" tabindex="-1"></a>The maximum posterior density of the new prior $0/1$ is higher than the maximum with the prior of $1$. Values of $p &lt; 0.5$ are no longer taking up posterior density because they are $0$. This can also be seen in @fig-exercise-3m5b-1.</span>
<span id="cb194-5124"><a href="#cb194-5124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5125"><a href="#cb194-5125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5126"><a href="#cb194-5126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5127"><a href="#cb194-5127" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5128"><a href="#cb194-5128" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5129"><a href="#cb194-5129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5130"><a href="#cb194-5130" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3M5.3b</span></span>
<span id="cb194-5131"><a href="#cb194-5131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5132"><a href="#cb194-5132" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5133"><a href="#cb194-5133" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5134"><a href="#cb194-5134" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m5b-3}</span>
<span id="cb194-5135"><a href="#cb194-5135" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M5.3: Posterior predictive check (~3M3: Tidyverse)</span>
<span id="cb194-5136"><a href="#cb194-5136" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5137"><a href="#cb194-5137" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5138"><a href="#cb194-5138" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5139"><a href="#cb194-5139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5140"><a href="#cb194-5140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5141"><a href="#cb194-5141" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5142"><a href="#cb194-5142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5143"><a href="#cb194-5143" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5144"><a href="#cb194-5144" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m5b-3-4</span></span>
<span id="cb194-5145"><a href="#cb194-5145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5146"><a href="#cb194-5146" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M3b ##############</span></span>
<span id="cb194-5147"><a href="#cb194-5147" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-5148"><a href="#cb194-5148" aria-hidden="true" tabindex="-1"></a>dummy_3m5b_1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">15</span>, samples_3m5b<span class="sc">$</span>p_samples_3m5b)</span>
<span id="cb194-5149"><a href="#cb194-5149" aria-hidden="true" tabindex="-1"></a>mean_3m5b_1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5b_1 <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb194-5150"><a href="#cb194-5150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5151"><a href="#cb194-5151" aria-hidden="true" tabindex="-1"></a><span class="do">## repr 3M4b ##############</span></span>
<span id="cb194-5152"><a href="#cb194-5152" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-5153"><a href="#cb194-5153" aria-hidden="true" tabindex="-1"></a>dummy_3m5b_2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">9</span>, samples_3m5b<span class="sc">$</span>p_samples_3m5b)</span>
<span id="cb194-5154"><a href="#cb194-5154" aria-hidden="true" tabindex="-1"></a>mean_3m5b_2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5b_2 <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb194-5155"><a href="#cb194-5155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5156"><a href="#cb194-5156" aria-hidden="true" tabindex="-1"></a><span class="do">## compare with p = 0.7 ##############</span></span>
<span id="cb194-5157"><a href="#cb194-5157" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-5158"><a href="#cb194-5158" aria-hidden="true" tabindex="-1"></a>dummy_3m5b_3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">15</span>, <span class="fl">0.7</span>)</span>
<span id="cb194-5159"><a href="#cb194-5159" aria-hidden="true" tabindex="-1"></a>mean_3m5b_3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5b_3 <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb194-5160"><a href="#cb194-5160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5161"><a href="#cb194-5161" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb194-5162"><a href="#cb194-5162" aria-hidden="true" tabindex="-1"></a>dummy_3m5b_4 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="dv">9</span>, <span class="fl">0.7</span>)</span>
<span id="cb194-5163"><a href="#cb194-5163" aria-hidden="true" tabindex="-1"></a>mean_3m5b_4 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dummy_3m5b_4 <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb194-5164"><a href="#cb194-5164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5165"><a href="#cb194-5165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5166"><a href="#cb194-5166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5167"><a href="#cb194-5167" aria-hidden="true" tabindex="-1"></a>| Name      | Mean of 15/08   | Mean of 09/06   |</span>
<span id="cb194-5168"><a href="#cb194-5168" aria-hidden="true" tabindex="-1"></a>|-----------|-----------------|-----------------|</span>
<span id="cb194-5169"><a href="#cb194-5169" aria-hidden="true" tabindex="-1"></a>| Samples   | <span class="in">`r mean_3m5b_1`</span> | <span class="in">`r mean_3m5b_2`</span> |</span>
<span id="cb194-5170"><a href="#cb194-5170" aria-hidden="true" tabindex="-1"></a>| Value 0.7 | <span class="in">`r mean_3m5b_3`</span> | <span class="in">`r mean_3m5b_4`</span> |</span>
<span id="cb194-5171"><a href="#cb194-5171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5172"><a href="#cb194-5172" aria-hidden="true" tabindex="-1"></a>The mean of the samples of 6 water observations with 9 tosses are higher than 8 water with 15 tosses. This represents the fact that the real value of 0.7 is nearer with 6/9 = <span class="in">`r round(6 / 9, 3)`</span> than with 8/15 = <span class="in">`r round(8 / 15, 3)`</span>. Also note that a predictive check with the real value of $0.7$ shows a very small mean value with 15/8 but a much higher mean with 9/6.</span>
<span id="cb194-5173"><a href="#cb194-5173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5174"><a href="#cb194-5174" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5175"><a href="#cb194-5175" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5176"><a href="#cb194-5176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5177"><a href="#cb194-5177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5178"><a href="#cb194-5178" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5179"><a href="#cb194-5179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5180"><a href="#cb194-5180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5181"><a href="#cb194-5181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5182"><a href="#cb194-5182" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5183"><a href="#cb194-5183" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5184"><a href="#cb194-5184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5185"><a href="#cb194-5185" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-5186"><a href="#cb194-5186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5187"><a href="#cb194-5187" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3M6</span></span>
<span id="cb194-5188"><a href="#cb194-5188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5189"><a href="#cb194-5189" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-5190"><a href="#cb194-5190" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-5191"><a href="#cb194-5191" aria-hidden="true" tabindex="-1"></a>Exercise 3M6: Suppose you want to estimate the Earth’s proportion of water very precisely. Specifically, you want the 99% percentile interval of the posterior distribution of $p$ to be only $0.05$ wide. This means the distance between the upper and lower bound of the interval should be $0.05$. </span>
<span id="cb194-5192"><a href="#cb194-5192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5193"><a href="#cb194-5193" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**N tosses**: How many times will you have to toss the globe to do this?</span>
<span id="cb194-5194"><a href="#cb194-5194" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Width**: How influences the sample size the difference between samples?</span>
<span id="cb194-5195"><a href="#cb194-5195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5196"><a href="#cb194-5196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5197"><a href="#cb194-5197" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5198"><a href="#cb194-5198" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-5199"><a href="#cb194-5199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5200"><a href="#cb194-5200" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-5201"><a href="#cb194-5201" aria-hidden="true" tabindex="-1"></a><span class="fu">###### N tosses (O)</span></span>
<span id="cb194-5202"><a href="#cb194-5202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5203"><a href="#cb194-5203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5204"><a href="#cb194-5204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5205"><a href="#cb194-5205" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5206"><a href="#cb194-5206" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5207"><a href="#cb194-5207" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m6a-1}</span>
<span id="cb194-5208"><a href="#cb194-5208" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M6-1: How many times will you have to toss the globe to get a $0.05$ wide interval with $PI = .99$?  (Original)</span>
<span id="cb194-5209"><a href="#cb194-5209" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5210"><a href="#cb194-5210" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5211"><a href="#cb194-5211" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5212"><a href="#cb194-5212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5213"><a href="#cb194-5213" aria-hidden="true" tabindex="-1"></a>Although McElreath states explicitly that he won&#39;t require an exact answer but rather wants to see the chosen approach (<span class="co">[</span><span class="ot">Winter 2019 Homework</span><span class="co">](https://github.com/rmcelreath/statrethinking_winter2019/blob/master/homework/week01.pdf)</span>) I was curious about the figure and how to program this process. It turned out that the chosen <span class="in">`set.seed()`</span> number has effects how many times one has to toss the globe.</span>
<span id="cb194-5214"><a href="#cb194-5214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5215"><a href="#cb194-5215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5216"><a href="#cb194-5216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5217"><a href="#cb194-5217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5218"><a href="#cb194-5218" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5219"><a href="#cb194-5219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5220"><a href="#cb194-5220" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5221"><a href="#cb194-5221" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m6a-1</span></span>
<span id="cb194-5222"><a href="#cb194-5222" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5223"><a href="#cb194-5223" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb194-5224"><a href="#cb194-5224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5225"><a href="#cb194-5225" aria-hidden="true" tabindex="-1"></a>pi99_3m6a <span class="ot">&lt;-</span> <span class="cf">function</span>(N, seed) {</span>
<span id="cb194-5226"><a href="#cb194-5226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb194-5227"><a href="#cb194-5227" aria-hidden="true" tabindex="-1"></a>  p_true <span class="ot">&lt;-</span>  <span class="fl">0.7</span></span>
<span id="cb194-5228"><a href="#cb194-5228" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">prob =</span> p_true)</span>
<span id="cb194-5229"><a href="#cb194-5229" aria-hidden="true" tabindex="-1"></a>  p_grid_3m6a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb194-5230"><a href="#cb194-5230" aria-hidden="true" tabindex="-1"></a>  prior_3m6a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb194-5231"><a href="#cb194-5231" aria-hidden="true" tabindex="-1"></a>  likelihood_3m6a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(W, <span class="at">size =</span> N, <span class="at">prob =</span> p_grid_3m6a)</span>
<span id="cb194-5232"><a href="#cb194-5232" aria-hidden="true" tabindex="-1"></a>  posterior_3m6a <span class="ot">&lt;-</span> likelihood_3m6a <span class="sc">*</span> prior_3m6a</span>
<span id="cb194-5233"><a href="#cb194-5233" aria-hidden="true" tabindex="-1"></a>  posterior_std_3m6a <span class="ot">&lt;-</span>  posterior_3m6a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m6a)</span>
<span id="cb194-5234"><a href="#cb194-5234" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-5235"><a href="#cb194-5235" aria-hidden="true" tabindex="-1"></a>  samples_3m6a <span class="ot">&lt;-</span></span>
<span id="cb194-5236"><a href="#cb194-5236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(p_grid_3m6a,</span>
<span id="cb194-5237"><a href="#cb194-5237" aria-hidden="true" tabindex="-1"></a>           <span class="at">prob =</span> posterior_std_3m6a,</span>
<span id="cb194-5238"><a href="#cb194-5238" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5239"><a href="#cb194-5239" aria-hidden="true" tabindex="-1"></a>           <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-5240"><a href="#cb194-5240" aria-hidden="true" tabindex="-1"></a>  rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m6a, <span class="fl">0.99</span>)</span>
<span id="cb194-5241"><a href="#cb194-5241" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-5242"><a href="#cb194-5242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5243"><a href="#cb194-5243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5244"><a href="#cb194-5244" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb194-5245"><a href="#cb194-5245" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb194-5246"><a href="#cb194-5246" aria-hidden="true" tabindex="-1"></a>my_seed <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">42</span>, <span class="dv">100</span>, <span class="dv">150</span>)</span>
<span id="cb194-5247"><a href="#cb194-5247" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb194-5248"><a href="#cb194-5248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5249"><a href="#cb194-5249" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(my_seed)) {</span>
<span id="cb194-5250"><a href="#cb194-5250" aria-hidden="true" tabindex="-1"></a>  PI99 <span class="ot">&lt;-</span> <span class="fu">pi99_3m6a</span>(N, my_seed[i])</span>
<span id="cb194-5251"><a href="#cb194-5251" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">as.numeric</span>(PI99[<span class="dv">2</span>] <span class="sc">-</span> PI99[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>)) {</span>
<span id="cb194-5252"><a href="#cb194-5252" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> N <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb194-5253"><a href="#cb194-5253" aria-hidden="true" tabindex="-1"></a>    PI99 <span class="ot">&lt;-</span> <span class="fu">pi99_3m6a</span>(N, my_seed[i])</span>
<span id="cb194-5254"><a href="#cb194-5254" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb194-5255"><a href="#cb194-5255" aria-hidden="true" tabindex="-1"></a>  s[i] <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;With set.seed({my_seed[i]}) we need to toss the globe {N} times.</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-5256"><a href="#cb194-5256" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb194-5257"><a href="#cb194-5257" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-5258"><a href="#cb194-5258" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb194-5259"><a href="#cb194-5259" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb194-5260"><a href="#cb194-5260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5261"><a href="#cb194-5261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5262"><a href="#cb194-5262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5263"><a href="#cb194-5263" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5264"><a href="#cb194-5264" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5265"><a href="#cb194-5265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5266"><a href="#cb194-5266" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Width (O)</span></span>
<span id="cb194-5267"><a href="#cb194-5267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5268"><a href="#cb194-5268" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5269"><a href="#cb194-5269" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5270"><a href="#cb194-5270" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m6a-2}</span>
<span id="cb194-5271"><a href="#cb194-5271" aria-hidden="true" tabindex="-1"></a>a: Exercise 3M6-2: Demonstrate the variation of the interval width with different number of simulations (Original)</span>
<span id="cb194-5272"><a href="#cb194-5272" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5273"><a href="#cb194-5273" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5274"><a href="#cb194-5274" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5275"><a href="#cb194-5275" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5276"><a href="#cb194-5276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5277"><a href="#cb194-5277" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5278"><a href="#cb194-5278" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m6a-2</span></span>
<span id="cb194-5279"><a href="#cb194-5279" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb194-5280"><a href="#cb194-5280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5281"><a href="#cb194-5281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5282"><a href="#cb194-5282" aria-hidden="true" tabindex="-1"></a>f_3m6a <span class="ot">&lt;-</span> <span class="cf">function</span>(N) {</span>
<span id="cb194-5283"><a href="#cb194-5283" aria-hidden="true" tabindex="-1"></a>  p_true <span class="ot">&lt;-</span>  <span class="fl">0.7</span></span>
<span id="cb194-5284"><a href="#cb194-5284" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">prob =</span> p_true)</span>
<span id="cb194-5285"><a href="#cb194-5285" aria-hidden="true" tabindex="-1"></a>  p_grid_3m6a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb194-5286"><a href="#cb194-5286" aria-hidden="true" tabindex="-1"></a>  prior_3m6a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb194-5287"><a href="#cb194-5287" aria-hidden="true" tabindex="-1"></a>  likelihood_3m6a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(W, <span class="at">size =</span> N, <span class="at">prob =</span> p_grid_3m6a)</span>
<span id="cb194-5288"><a href="#cb194-5288" aria-hidden="true" tabindex="-1"></a>  posterior_3m6a <span class="ot">&lt;-</span> likelihood_3m6a <span class="sc">*</span> prior_3m6a</span>
<span id="cb194-5289"><a href="#cb194-5289" aria-hidden="true" tabindex="-1"></a>  posterior_std_3m6a <span class="ot">&lt;-</span>  posterior_3m6a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m6a)</span>
<span id="cb194-5290"><a href="#cb194-5290" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-5291"><a href="#cb194-5291" aria-hidden="true" tabindex="-1"></a>  samples_3m6a <span class="ot">&lt;-</span></span>
<span id="cb194-5292"><a href="#cb194-5292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(p_grid_3m6a,</span>
<span id="cb194-5293"><a href="#cb194-5293" aria-hidden="true" tabindex="-1"></a>           <span class="at">prob =</span> posterior_std_3m6a,</span>
<span id="cb194-5294"><a href="#cb194-5294" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5295"><a href="#cb194-5295" aria-hidden="true" tabindex="-1"></a>           <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-5296"><a href="#cb194-5296" aria-hidden="true" tabindex="-1"></a>  pi_99_3m6a <span class="ot">&lt;-</span>  rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m6a, <span class="fl">0.99</span>)</span>
<span id="cb194-5297"><a href="#cb194-5297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(pi_99_3m6a[<span class="dv">2</span>] <span class="sc">-</span> pi_99_3m6a[<span class="dv">1</span>])</span>
<span id="cb194-5298"><a href="#cb194-5298" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-5299"><a href="#cb194-5299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5300"><a href="#cb194-5300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5301"><a href="#cb194-5301" aria-hidden="true" tabindex="-1"></a>Nlist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>) </span>
<span id="cb194-5302"><a href="#cb194-5302" aria-hidden="true" tabindex="-1"></a>Nlist <span class="ot">&lt;-</span> <span class="fu">rep</span>(Nlist, <span class="at">each =</span> <span class="dv">100</span>) </span>
<span id="cb194-5303"><a href="#cb194-5303" aria-hidden="true" tabindex="-1"></a>width <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Nlist, f_3m6a) </span>
<span id="cb194-5304"><a href="#cb194-5304" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Nlist, width) </span>
<span id="cb194-5305"><a href="#cb194-5305" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb194-5306"><a href="#cb194-5306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5307"><a href="#cb194-5307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5308"><a href="#cb194-5308" aria-hidden="true" tabindex="-1"></a>The difference between samples shrinks as the sample size increases.</span>
<span id="cb194-5309"><a href="#cb194-5309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5310"><a href="#cb194-5310" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What are we looking at in this plot? The horizontal is sample size. The points are individual interval widths, one for each simulation. The red line is drawn at a width of $0.05$. Looks like we need more than $2000$ tosses of the globe to get the interval to be that precise.</span></span>
<span id="cb194-5311"><a href="#cb194-5311" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb194-5312"><a href="#cb194-5312" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The above is a general feature of learning from data: The greatest returns on learning come early on. Each additional observation contributes less and less. So it takes very much effort to progressively reduce our uncertainty. So if your application requires a very precise estimate, be prepared to collect a lot of data. Or to change your approach. (</span><span class="co">[</span><span class="ot">Solution, Week-01, Winter 2019</span><span class="co">](https://github.com/rmcelreath/statrethinking_winter2019/blob/master/homework/week01_solutions.pdf)</span><span class="at">)</span></span>
<span id="cb194-5313"><a href="#cb194-5313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5314"><a href="#cb194-5314" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5315"><a href="#cb194-5315" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5316"><a href="#cb194-5316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5317"><a href="#cb194-5317" aria-hidden="true" tabindex="-1"></a><span class="fu">###### N tosses (T)</span></span>
<span id="cb194-5318"><a href="#cb194-5318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5319"><a href="#cb194-5319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5320"><a href="#cb194-5320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5321"><a href="#cb194-5321" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5322"><a href="#cb194-5322" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5323"><a href="#cb194-5323" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m6b-1}</span>
<span id="cb194-5324"><a href="#cb194-5324" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M6-1: How many times will you have to toss the globe to get a $0.05$ wide interval with $PI = .99$?  (Tidyverse)</span>
<span id="cb194-5325"><a href="#cb194-5325" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5326"><a href="#cb194-5326" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5327"><a href="#cb194-5327" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5328"><a href="#cb194-5328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5329"><a href="#cb194-5329" aria-hidden="true" tabindex="-1"></a>Because of the slow performance of manipulating whole data frame, I am going to use here just one <span class="in">`set.seed()`</span> function. This is only to show that we get the same result as in the first loop of @cnj-3m6a-1.</span>
<span id="cb194-5330"><a href="#cb194-5330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5331"><a href="#cb194-5331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5332"><a href="#cb194-5332" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5333"><a href="#cb194-5333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5334"><a href="#cb194-5334" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5335"><a href="#cb194-5335" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m6b-1</span></span>
<span id="cb194-5336"><a href="#cb194-5336" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5337"><a href="#cb194-5337" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb194-5338"><a href="#cb194-5338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5339"><a href="#cb194-5339" aria-hidden="true" tabindex="-1"></a>pi99_3m6b <span class="ot">&lt;-</span> <span class="cf">function</span>(N, seed) {</span>
<span id="cb194-5340"><a href="#cb194-5340" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">set.seed</span>(seed)</span>
<span id="cb194-5341"><a href="#cb194-5341" aria-hidden="true" tabindex="-1"></a>  p_true <span class="ot">&lt;-</span>  <span class="fl">0.7</span></span>
<span id="cb194-5342"><a href="#cb194-5342" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">prob =</span> p_true)</span>
<span id="cb194-5343"><a href="#cb194-5343" aria-hidden="true" tabindex="-1"></a>  df_3m6b <span class="ot">&lt;-</span>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_3m6b =</span> </span>
<span id="cb194-5344"><a href="#cb194-5344" aria-hidden="true" tabindex="-1"></a>                            base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-5345"><a href="#cb194-5345" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">prior_3m6b =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>),</span>
<span id="cb194-5346"><a href="#cb194-5346" aria-hidden="true" tabindex="-1"></a>           <span class="at">likelihood_3m6b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(W, <span class="at">size =</span> N, <span class="at">prob =</span> p_grid_3m6b),</span>
<span id="cb194-5347"><a href="#cb194-5347" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_3m6b =</span> likelihood_3m6b <span class="sc">*</span> prior_3m6b,</span>
<span id="cb194-5348"><a href="#cb194-5348" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_std_3m6b =</span> posterior_3m6b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m6b))</span>
<span id="cb194-5349"><a href="#cb194-5349" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-5350"><a href="#cb194-5350" aria-hidden="true" tabindex="-1"></a>  samples_3m6b <span class="ot">&lt;-</span> df_3m6b <span class="sc">|&gt;</span> </span>
<span id="cb194-5351"><a href="#cb194-5351" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5352"><a href="#cb194-5352" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weight_by =</span> posterior_std_3m6b,</span>
<span id="cb194-5353"><a href="#cb194-5353" aria-hidden="true" tabindex="-1"></a>                        <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-5354"><a href="#cb194-5354" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-5355"><a href="#cb194-5355" aria-hidden="true" tabindex="-1"></a>  rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m6b<span class="sc">$</span>p_grid_3m6b, <span class="fl">0.99</span>)</span>
<span id="cb194-5356"><a href="#cb194-5356" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-5357"><a href="#cb194-5357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5358"><a href="#cb194-5358" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb194-5359"><a href="#cb194-5359" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb194-5360"><a href="#cb194-5360" aria-hidden="true" tabindex="-1"></a>my_seed <span class="ot">=</span> <span class="dv">3</span> <span class="do">## just one loop!</span></span>
<span id="cb194-5361"><a href="#cb194-5361" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb194-5362"><a href="#cb194-5362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5363"><a href="#cb194-5363" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(my_seed)) {</span>
<span id="cb194-5364"><a href="#cb194-5364" aria-hidden="true" tabindex="-1"></a>  PI99_3m6b <span class="ot">&lt;-</span> <span class="fu">pi99_3m6b</span>(N, my_seed[i])</span>
<span id="cb194-5365"><a href="#cb194-5365" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">as.numeric</span>(PI99_3m6b[<span class="dv">2</span>] <span class="sc">-</span> PI99_3m6b[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>)) {</span>
<span id="cb194-5366"><a href="#cb194-5366" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> N <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb194-5367"><a href="#cb194-5367" aria-hidden="true" tabindex="-1"></a>    PI99_3m6b <span class="ot">&lt;-</span> <span class="fu">pi99_3m6b</span>(N, my_seed[i])</span>
<span id="cb194-5368"><a href="#cb194-5368" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb194-5369"><a href="#cb194-5369" aria-hidden="true" tabindex="-1"></a>  s[i] <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;With set.seed({my_seed[i]}) we need to toss the globe {N} times.</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb194-5370"><a href="#cb194-5370" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb194-5371"><a href="#cb194-5371" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-5372"><a href="#cb194-5372" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb194-5373"><a href="#cb194-5373" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb194-5374"><a href="#cb194-5374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5375"><a href="#cb194-5375" aria-hidden="true" tabindex="-1"></a>Compare the execution time of just one set.seed() calculation with four in @cnj-3m6a-1. Using data frames turns out about 16(!) times slower the computation with vectors. (Already just one set.seed() computation with tibbles is 4 times slower than the processing time of 4 set.seed() loops with base R vectors.)</span>
<span id="cb194-5376"><a href="#cb194-5376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5377"><a href="#cb194-5377" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5378"><a href="#cb194-5378" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5379"><a href="#cb194-5379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5380"><a href="#cb194-5380" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Width (T)</span></span>
<span id="cb194-5381"><a href="#cb194-5381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5382"><a href="#cb194-5382" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5383"><a href="#cb194-5383" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5384"><a href="#cb194-5384" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3m6b-2}</span>
<span id="cb194-5385"><a href="#cb194-5385" aria-hidden="true" tabindex="-1"></a>b: Exercise 3M6-2: Demonstrate the variation of the interval width with different number of simulations (Tidyverse)</span>
<span id="cb194-5386"><a href="#cb194-5386" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5387"><a href="#cb194-5387" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5388"><a href="#cb194-5388" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5389"><a href="#cb194-5389" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5390"><a href="#cb194-5390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5391"><a href="#cb194-5391" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5392"><a href="#cb194-5392" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3m6b-2</span></span>
<span id="cb194-5393"><a href="#cb194-5393" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb194-5394"><a href="#cb194-5394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5395"><a href="#cb194-5395" aria-hidden="true" tabindex="-1"></a>f_3m6b <span class="ot">&lt;-</span> <span class="cf">function</span>(N) {</span>
<span id="cb194-5396"><a href="#cb194-5396" aria-hidden="true" tabindex="-1"></a>  p_true <span class="ot">&lt;-</span>  <span class="fl">0.7</span></span>
<span id="cb194-5397"><a href="#cb194-5397" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">prob =</span> p_true)</span>
<span id="cb194-5398"><a href="#cb194-5398" aria-hidden="true" tabindex="-1"></a>  df_3m6b <span class="ot">&lt;-</span>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_3m6b =</span> </span>
<span id="cb194-5399"><a href="#cb194-5399" aria-hidden="true" tabindex="-1"></a>                            base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-5400"><a href="#cb194-5400" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">prior_3m6b =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>),</span>
<span id="cb194-5401"><a href="#cb194-5401" aria-hidden="true" tabindex="-1"></a>           <span class="at">likelihood_3m6b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(W, <span class="at">size =</span> N, <span class="at">prob =</span> p_grid_3m6b),</span>
<span id="cb194-5402"><a href="#cb194-5402" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_3m6b =</span> likelihood_3m6b <span class="sc">*</span> prior_3m6b,</span>
<span id="cb194-5403"><a href="#cb194-5403" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_std_3m6b =</span> posterior_3m6b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3m6b))</span>
<span id="cb194-5404"><a href="#cb194-5404" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-5405"><a href="#cb194-5405" aria-hidden="true" tabindex="-1"></a>  samples_3m6b <span class="ot">&lt;-</span> df_3m6b <span class="sc">|&gt;</span> </span>
<span id="cb194-5406"><a href="#cb194-5406" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5407"><a href="#cb194-5407" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weight_by =</span> posterior_std_3m6b,</span>
<span id="cb194-5408"><a href="#cb194-5408" aria-hidden="true" tabindex="-1"></a>                        <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-5409"><a href="#cb194-5409" aria-hidden="true" tabindex="-1"></a>  pi_99_3m6b <span class="ot">&lt;-</span>  rethinking<span class="sc">::</span><span class="fu">PI</span>(samples_3m6b<span class="sc">$</span>p_grid_3m6b, <span class="fl">0.99</span>)</span>
<span id="cb194-5410"><a href="#cb194-5410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(pi_99_3m6b[<span class="dv">2</span>] <span class="sc">-</span> pi_99_3m6b[<span class="dv">1</span>])</span>
<span id="cb194-5411"><a href="#cb194-5411" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-5412"><a href="#cb194-5412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5413"><a href="#cb194-5413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5414"><a href="#cb194-5414" aria-hidden="true" tabindex="-1"></a>Nlist_3m6b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>) </span>
<span id="cb194-5415"><a href="#cb194-5415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5416"><a href="#cb194-5416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5417"><a href="#cb194-5417" aria-hidden="true" tabindex="-1"></a>df_3m6b_2 <span class="ot">&lt;-</span> </span>
<span id="cb194-5418"><a href="#cb194-5418" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">Nlist_3m6b =</span> base<span class="sc">::</span><span class="fu">rep</span>(Nlist_3m6b, <span class="at">each =</span> <span class="dv">100</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-5419"><a href="#cb194-5419" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">width_3m6b =</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(Nlist_3m6b, f_3m6b))</span>
<span id="cb194-5420"><a href="#cb194-5420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5421"><a href="#cb194-5421" aria-hidden="true" tabindex="-1"></a>df_3m6b_2 <span class="sc">|&gt;</span> </span>
<span id="cb194-5422"><a href="#cb194-5422" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Nlist_3m6b,</span>
<span id="cb194-5423"><a href="#cb194-5423" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> width_3m6b)) <span class="sc">+</span></span>
<span id="cb194-5424"><a href="#cb194-5424" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb194-5425"><a href="#cb194-5425" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of samples&quot;</span>,</span>
<span id="cb194-5426"><a href="#cb194-5426" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Width of PI = 0.99&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5427"><a href="#cb194-5427" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">05</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5428"><a href="#cb194-5428" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-5429"><a href="#cb194-5429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5430"><a href="#cb194-5430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5431"><a href="#cb194-5431" aria-hidden="true" tabindex="-1"></a>The difference between samples shrinks as the sample size increases.</span>
<span id="cb194-5432"><a href="#cb194-5432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5433"><a href="#cb194-5433" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What are we looking at in this plot? The horizontal is sample size. The points are individual interval widths, one for each simulation. The red line is drawn at a width of $0.05$. Looks like we need more than $2000$ tosses of the globe to get the interval to be that precise.</span></span>
<span id="cb194-5434"><a href="#cb194-5434" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb194-5435"><a href="#cb194-5435" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The above is a general feature of learning from data: The greatest returns on learning come early on. Each additional observation contributes less and less. So it takes very much effort to progressively reduce our uncertainty. So if your application requires a very precise estimate, be prepared to collect a lot of data. Or to change your approach. (</span><span class="co">[</span><span class="ot">Solution, Week-01, Winter 2019</span><span class="co">](https://github.com/rmcelreath/statrethinking_winter2019/blob/master/homework/week01_solutions.pdf)</span><span class="at">)</span></span>
<span id="cb194-5436"><a href="#cb194-5436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5437"><a href="#cb194-5437" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5438"><a href="#cb194-5438" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5439"><a href="#cb194-5439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5440"><a href="#cb194-5440" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5441"><a href="#cb194-5441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5442"><a href="#cb194-5442" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5443"><a href="#cb194-5443" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5444"><a href="#cb194-5444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5445"><a href="#cb194-5445" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-5446"><a href="#cb194-5446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5447"><a href="#cb194-5447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5448"><a href="#cb194-5448" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hard</span></span>
<span id="cb194-5449"><a href="#cb194-5449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5450"><a href="#cb194-5450" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5451"><a href="#cb194-5451" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5452"><a href="#cb194-5452" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3h1-5}</span>
<span id="cb194-5453"><a href="#cb194-5453" aria-hidden="true" tabindex="-1"></a>: Reported first and second born children in 100 two-child families</span>
<span id="cb194-5454"><a href="#cb194-5454" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5455"><a href="#cb194-5455" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5456"><a href="#cb194-5456" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5457"><a href="#cb194-5457" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5458"><a href="#cb194-5458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5459"><a href="#cb194-5459" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5460"><a href="#cb194-5460" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-3h1-5 </span></span>
<span id="cb194-5461"><a href="#cb194-5461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5462"><a href="#cb194-5462" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.28 ###############</span></span>
<span id="cb194-5463"><a href="#cb194-5463" aria-hidden="true" tabindex="-1"></a>birth1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb194-5464"><a href="#cb194-5464" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb194-5465"><a href="#cb194-5465" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb194-5466"><a href="#cb194-5466" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb194-5467"><a href="#cb194-5467" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span></span>
<span id="cb194-5468"><a href="#cb194-5468" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-5469"><a href="#cb194-5469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5470"><a href="#cb194-5470" aria-hidden="true" tabindex="-1"></a>birth2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb194-5471"><a href="#cb194-5471" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb194-5472"><a href="#cb194-5472" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb194-5473"><a href="#cb194-5473" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb194-5474"><a href="#cb194-5474" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb194-5475"><a href="#cb194-5475" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-5476"><a href="#cb194-5476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5477"><a href="#cb194-5477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5478"><a href="#cb194-5478" aria-hidden="true" tabindex="-1"></a><span class="do">## R code 3.30 ###############</span></span>
<span id="cb194-5479"><a href="#cb194-5479" aria-hidden="true" tabindex="-1"></a>n_boys <span class="ot">&lt;-</span> <span class="fu">sum</span>(birth1) <span class="sc">+</span> <span class="fu">sum</span>(birth2)</span>
<span id="cb194-5480"><a href="#cb194-5480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5481"><a href="#cb194-5481" aria-hidden="true" tabindex="-1"></a>200 Births of these are boys:</span>
<span id="cb194-5482"><a href="#cb194-5482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5483"><a href="#cb194-5483" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>1st born: <span class="in">`r sum(birth1)`</span></span>
<span id="cb194-5484"><a href="#cb194-5484" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>2nd born: <span class="in">`r sum(birth2)`</span>, </span>
<span id="cb194-5485"><a href="#cb194-5485" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>total: <span class="in">`r n_boys`</span></span>
<span id="cb194-5486"><a href="#cb194-5486" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5487"><a href="#cb194-5487" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5488"><a href="#cb194-5488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5489"><a href="#cb194-5489" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3H1</span></span>
<span id="cb194-5490"><a href="#cb194-5490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5491"><a href="#cb194-5491" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-5492"><a href="#cb194-5492" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-5493"><a href="#cb194-5493" aria-hidden="true" tabindex="-1"></a>Exercise 3H1: Using grid approximation, compute the posterior distribution for the probability of a birth being a boy. Assume a uniform prior probability. Which parameter value maximizes the posterior probability?</span>
<span id="cb194-5494"><a href="#cb194-5494" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5495"><a href="#cb194-5495" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-5496"><a href="#cb194-5496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5497"><a href="#cb194-5497" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-5498"><a href="#cb194-5498" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Boys (Original)</span></span>
<span id="cb194-5499"><a href="#cb194-5499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5500"><a href="#cb194-5500" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5501"><a href="#cb194-5501" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5502"><a href="#cb194-5502" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3H1a}</span>
<span id="cb194-5503"><a href="#cb194-5503" aria-hidden="true" tabindex="-1"></a>a: Posterior distribution for the probability of a birth being a boy (Original)</span>
<span id="cb194-5504"><a href="#cb194-5504" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5505"><a href="#cb194-5505" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5506"><a href="#cb194-5506" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5507"><a href="#cb194-5507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5508"><a href="#cb194-5508" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5509"><a href="#cb194-5509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5510"><a href="#cb194-5510" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5511"><a href="#cb194-5511" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h1a</span></span>
<span id="cb194-5512"><a href="#cb194-5512" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Posterior distribution of boys rate probability (Original)&quot;</span></span>
<span id="cb194-5513"><a href="#cb194-5513" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5514"><a href="#cb194-5514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5515"><a href="#cb194-5515" aria-hidden="true" tabindex="-1"></a>p_grid_3h1a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>,</span>
<span id="cb194-5516"><a href="#cb194-5516" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="dv">1</span>,</span>
<span id="cb194-5517"><a href="#cb194-5517" aria-hidden="true" tabindex="-1"></a>                   <span class="at">length.out =</span> <span class="fl">1e3</span>)</span>
<span id="cb194-5518"><a href="#cb194-5518" aria-hidden="true" tabindex="-1"></a>prior_3h1a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="fl">1e3</span>)</span>
<span id="cb194-5519"><a href="#cb194-5519" aria-hidden="true" tabindex="-1"></a>likelihood_3h1a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="fu">sum</span>(birth1) <span class="sc">+</span> <span class="fu">sum</span>(birth2),</span>
<span id="cb194-5520"><a href="#cb194-5520" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="dv">200</span>,</span>
<span id="cb194-5521"><a href="#cb194-5521" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prob =</span> p_grid_3h1a)</span>
<span id="cb194-5522"><a href="#cb194-5522" aria-hidden="true" tabindex="-1"></a>posterior_3h1a <span class="ot">&lt;-</span>  prior_3h1a <span class="sc">*</span> likelihood_3h1a</span>
<span id="cb194-5523"><a href="#cb194-5523" aria-hidden="true" tabindex="-1"></a>posterior_std_3h1a <span class="ot">&lt;-</span> posterior_3h1a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3h1a)</span>
<span id="cb194-5524"><a href="#cb194-5524" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid_3h1a, posterior_std_3h1a, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb194-5525"><a href="#cb194-5525" aria-hidden="true" tabindex="-1"></a>map_3h1a <span class="ot">&lt;-</span> p_grid_3h1a[<span class="fu">which.max</span>(posterior_std_3h1a)]</span>
<span id="cb194-5526"><a href="#cb194-5526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5527"><a href="#cb194-5527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5528"><a href="#cb194-5528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5529"><a href="#cb194-5529" aria-hidden="true" tabindex="-1"></a>The mode or <span class="in">`r glossary(&quot;MAP&quot;)`</span> is at <span class="in">`r round(map_3h1a,3)`</span>, e.g. the birth ratio for boys is <span class="in">`r round(map_3h1a,3) * 100`</span>%.</span>
<span id="cb194-5530"><a href="#cb194-5530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5531"><a href="#cb194-5531" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5532"><a href="#cb194-5532" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5533"><a href="#cb194-5533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5534"><a href="#cb194-5534" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Boys (Tidyverse)</span></span>
<span id="cb194-5535"><a href="#cb194-5535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5536"><a href="#cb194-5536" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5537"><a href="#cb194-5537" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5538"><a href="#cb194-5538" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3h1b}</span>
<span id="cb194-5539"><a href="#cb194-5539" aria-hidden="true" tabindex="-1"></a>b: Posterior distribution for the probability of a birth being a boy (Tidyverse)</span>
<span id="cb194-5540"><a href="#cb194-5540" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5541"><a href="#cb194-5541" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5542"><a href="#cb194-5542" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5543"><a href="#cb194-5543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5544"><a href="#cb194-5544" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5545"><a href="#cb194-5545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5546"><a href="#cb194-5546" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5547"><a href="#cb194-5547" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h1b</span></span>
<span id="cb194-5548"><a href="#cb194-5548" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Posterior distribution of boys rate probability (Tidyverse)&quot; </span></span>
<span id="cb194-5549"><a href="#cb194-5549" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5550"><a href="#cb194-5550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5551"><a href="#cb194-5551" aria-hidden="true" tabindex="-1"></a>df_3h1b <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">p_grid_3h1b =</span> base<span class="sc">::</span><span class="fu">seq</span>(</span>
<span id="cb194-5552"><a href="#cb194-5552" aria-hidden="true" tabindex="-1"></a>                   <span class="at">from =</span> <span class="dv">0</span>,</span>
<span id="cb194-5553"><a href="#cb194-5553" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="dv">1</span>,</span>
<span id="cb194-5554"><a href="#cb194-5554" aria-hidden="true" tabindex="-1"></a>                   <span class="at">length.out =</span> <span class="fl">1e3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-5555"><a href="#cb194-5555" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">prior_3h1b =</span> base<span class="sc">::</span><span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="fl">1e3</span>),</span>
<span id="cb194-5556"><a href="#cb194-5556" aria-hidden="true" tabindex="-1"></a>           <span class="at">likelihood_3h1b =</span> stats<span class="sc">::</span><span class="fu">dbinom</span>(</span>
<span id="cb194-5557"><a href="#cb194-5557" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> base<span class="sc">::</span><span class="fu">sum</span>(birth1) <span class="sc">+</span> base<span class="sc">::</span><span class="fu">sum</span>(birth2),</span>
<span id="cb194-5558"><a href="#cb194-5558" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="dv">200</span>,</span>
<span id="cb194-5559"><a href="#cb194-5559" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prob =</span> p_grid_3h1b),</span>
<span id="cb194-5560"><a href="#cb194-5560" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_3h1b =</span> prior_3h1b <span class="sc">*</span> likelihood_3h1b,</span>
<span id="cb194-5561"><a href="#cb194-5561" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior_std_3h1b =</span> posterior_3h1b <span class="sc">/</span> <span class="fu">sum</span>(posterior_3h1b))</span>
<span id="cb194-5562"><a href="#cb194-5562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5563"><a href="#cb194-5563" aria-hidden="true" tabindex="-1"></a>map_3h1b <span class="ot">&lt;-</span> df_3h1b <span class="sc">|&gt;</span> </span>
<span id="cb194-5564"><a href="#cb194-5564" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(posterior_std_3h1b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-5565"><a href="#cb194-5565" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(dplyr<span class="sc">::</span><span class="fu">first</span>(p_grid_3h1b)) <span class="sc">|&gt;</span> </span>
<span id="cb194-5566"><a href="#cb194-5566" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">1</span>)</span>
<span id="cb194-5567"><a href="#cb194-5567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5568"><a href="#cb194-5568" aria-hidden="true" tabindex="-1"></a>df_3h1b <span class="sc">|&gt;</span> </span>
<span id="cb194-5569"><a href="#cb194-5569" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3h1b,</span>
<span id="cb194-5570"><a href="#cb194-5570" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> posterior_std_3h1b)) <span class="sc">+</span></span>
<span id="cb194-5571"><a href="#cb194-5571" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb194-5572"><a href="#cb194-5572" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> map_3h1b, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5573"><a href="#cb194-5573" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Ratio of boy births&quot;</span>,</span>
<span id="cb194-5574"><a href="#cb194-5574" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Posterior distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5575"><a href="#cb194-5575" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-5576"><a href="#cb194-5576" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-5577"><a href="#cb194-5577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5578"><a href="#cb194-5578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5579"><a href="#cb194-5579" aria-hidden="true" tabindex="-1"></a>The mode or <span class="in">`r glossary(&quot;MAP&quot;)`</span> is at <span class="in">`r round(map_3h1b,3)`</span>, e.g. the birth ratio for boys is <span class="in">`r round(map_3h1b,3) * 100`</span>%.</span>
<span id="cb194-5580"><a href="#cb194-5580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5581"><a href="#cb194-5581" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb194-5582"><a href="#cb194-5582" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb194-5583"><a href="#cb194-5583" aria-hidden="true" tabindex="-1"></a>Note: {*tidybayes*} point intervals needs samples</span>
<span id="cb194-5584"><a href="#cb194-5584" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5585"><a href="#cb194-5585" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb194-5586"><a href="#cb194-5586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5587"><a href="#cb194-5587" aria-hidden="true" tabindex="-1"></a>I computed the mode by arranging the data frame with the highest value at the top. This is exactly the same value as in the book version. Another Base R solution would be <span class="in">`df_3h1b$p_grid_3h1b[which.max(df_3h1b$posterior_std_3h1b)]`</span> = <span class="in">`r df_3h1b$p_grid_3h1b[which.max(df_3h1b$posterior_std_3h1b)] * 100`</span>%.</span>
<span id="cb194-5588"><a href="#cb194-5588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5589"><a href="#cb194-5589" aria-hidden="true" tabindex="-1"></a>I tried to calculate the mode also with the {**tidybayes**} package. But all mode values from this package (<span class="in">`mode_qi()`</span>, <span class="in">`mode_hdci()`</span>, <span class="in">`mode_hdi()`</span> and <span class="in">`Mode())`</span> result in smaller values, for instance <span class="in">`tidybayes::Mode(samples_3m2b$p_samples_3m2b)`</span> = <span class="in">`r round(tidybayes::Mode(samples_3m2b$p_samples_3m2b), 3) * 100`</span>%. </span>
<span id="cb194-5590"><a href="#cb194-5590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5591"><a href="#cb194-5591" aria-hidden="true" tabindex="-1"></a>After many trials and exerpiments I came to the conclusion that above mentioned functions of the {**tidybayes**} package work only with generated samples. Therefore I do not have to address two columns as with the `which.max()` (one outside and one inside the square brackets) and I have to supply vectors with the above mentioned family of function form the {**tidybayes**} package.</span>
<span id="cb194-5592"><a href="#cb194-5592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5593"><a href="#cb194-5593" aria-hidden="true" tabindex="-1"></a>Furthermore I noticed that all point_intervals without <span class="in">`mode_`</span>, <span class="in">`median_`</span> and <span class="in">`mean_`</span> in front of the <span class="in">`qi`</span>, <span class="in">`ll`</span>, <span class="in">`ul`</span>, <span class="in">`hdi`</span>, <span class="in">`hdci`</span> is not in {**tidybayes**} but in the accompanying package {**ggdist**} and need therefore as prefix <span class="in">`ggdist::`</span>. Furthermore these functions needs numerical vectors and can&#39;t therfore used with the pipe.</span>
<span id="cb194-5594"><a href="#cb194-5594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5595"><a href="#cb194-5595" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5596"><a href="#cb194-5596" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5597"><a href="#cb194-5597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5598"><a href="#cb194-5598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5599"><a href="#cb194-5599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5600"><a href="#cb194-5600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5601"><a href="#cb194-5601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5602"><a href="#cb194-5602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5603"><a href="#cb194-5603" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5604"><a href="#cb194-5604" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5605"><a href="#cb194-5605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5606"><a href="#cb194-5606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5607"><a href="#cb194-5607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5608"><a href="#cb194-5608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5609"><a href="#cb194-5609" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5610"><a href="#cb194-5610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5611"><a href="#cb194-5611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5612"><a href="#cb194-5612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5613"><a href="#cb194-5613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5614"><a href="#cb194-5614" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5615"><a href="#cb194-5615" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5616"><a href="#cb194-5616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5617"><a href="#cb194-5617" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-5618"><a href="#cb194-5618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5619"><a href="#cb194-5619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5620"><a href="#cb194-5620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5621"><a href="#cb194-5621" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3H2</span></span>
<span id="cb194-5622"><a href="#cb194-5622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5623"><a href="#cb194-5623" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-5624"><a href="#cb194-5624" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-5625"><a href="#cb194-5625" aria-hidden="true" tabindex="-1"></a>Exercise 3H2: Using the <span class="in">`sample()`</span> function, draw $10,000$ random parameter values from the posterior distribution you calculated above. Use these samples to estimate the $50\%$, $89\%$, and $97\%$ highest posterior density intervals.</span>
<span id="cb194-5626"><a href="#cb194-5626" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5627"><a href="#cb194-5627" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-5628"><a href="#cb194-5628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5629"><a href="#cb194-5629" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-5630"><a href="#cb194-5630" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Sample (Original)</span></span>
<span id="cb194-5631"><a href="#cb194-5631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5632"><a href="#cb194-5632" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5633"><a href="#cb194-5633" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5634"><a href="#cb194-5634" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3h2a}</span>
<span id="cb194-5635"><a href="#cb194-5635" aria-hidden="true" tabindex="-1"></a>a: Draw $10,000$ random parameter values from the posterior distribution you calculated above (Original)</span>
<span id="cb194-5636"><a href="#cb194-5636" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5637"><a href="#cb194-5637" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5638"><a href="#cb194-5638" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5639"><a href="#cb194-5639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5640"><a href="#cb194-5640" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5641"><a href="#cb194-5641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5642"><a href="#cb194-5642" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5643"><a href="#cb194-5643" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h2a</span></span>
<span id="cb194-5644"><a href="#cb194-5644" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;10.000 samples from the posterior distribution of the birth data (Original)&quot;</span></span>
<span id="cb194-5645"><a href="#cb194-5645" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5646"><a href="#cb194-5646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5647"><a href="#cb194-5647" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-5648"><a href="#cb194-5648" aria-hidden="true" tabindex="-1"></a>samples_3h2a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> p_grid_3h1a,</span>
<span id="cb194-5649"><a href="#cb194-5649" aria-hidden="true" tabindex="-1"></a>                       <span class="at">size =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5650"><a href="#cb194-5650" aria-hidden="true" tabindex="-1"></a>                       <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb194-5651"><a href="#cb194-5651" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prob =</span> posterior_std_3h1a)</span>
<span id="cb194-5652"><a href="#cb194-5652" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples_3h2a, <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">89</span>, .<span class="dv">97</span>))</span>
<span id="cb194-5653"><a href="#cb194-5653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5654"><a href="#cb194-5654" aria-hidden="true" tabindex="-1"></a>map_3h2a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">chainmode</span>(samples_3h2a, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb194-5655"><a href="#cb194-5655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5656"><a href="#cb194-5656" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(samples_3h2a, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb194-5657"><a href="#cb194-5657" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> map_3h2a, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb194-5658"><a href="#cb194-5658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5659"><a href="#cb194-5659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5660"><a href="#cb194-5660" aria-hidden="true" tabindex="-1"></a>The red line is the density mode (<span class="in">`r round(map_3h2a, 3)`</span>) calculated with <span class="in">`rethinking::chainmode()`</span>.</span>
<span id="cb194-5661"><a href="#cb194-5661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5662"><a href="#cb194-5662" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5663"><a href="#cb194-5663" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5664"><a href="#cb194-5664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5665"><a href="#cb194-5665" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Sample (Tidyverse)</span></span>
<span id="cb194-5666"><a href="#cb194-5666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5667"><a href="#cb194-5667" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5668"><a href="#cb194-5668" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5669"><a href="#cb194-5669" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3h2b}</span>
<span id="cb194-5670"><a href="#cb194-5670" aria-hidden="true" tabindex="-1"></a>b: Draw $10,000$ random parameter values from the posterior distribution you calculated above (Tidyverse)</span>
<span id="cb194-5671"><a href="#cb194-5671" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5672"><a href="#cb194-5672" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5673"><a href="#cb194-5673" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5674"><a href="#cb194-5674" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5675"><a href="#cb194-5675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5676"><a href="#cb194-5676" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5677"><a href="#cb194-5677" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h2b</span></span>
<span id="cb194-5678"><a href="#cb194-5678" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;10.000 samples from the posterior distribution of the birth data (Tidyverse)&quot;</span></span>
<span id="cb194-5679"><a href="#cb194-5679" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5680"><a href="#cb194-5680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5681"><a href="#cb194-5681" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-5682"><a href="#cb194-5682" aria-hidden="true" tabindex="-1"></a>samples_3h2b <span class="ot">&lt;-</span>  df_3h1b <span class="sc">|&gt;</span> </span>
<span id="cb194-5683"><a href="#cb194-5683" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5684"><a href="#cb194-5684" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb194-5685"><a href="#cb194-5685" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight_by =</span> posterior_std_3h1b)</span>
<span id="cb194-5686"><a href="#cb194-5686" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb194-5687"><a href="#cb194-5687" aria-hidden="true" tabindex="-1"></a>  map_3h2b <span class="ot">&lt;-</span> samples_3h2b <span class="sc">|&gt;</span> </span>
<span id="cb194-5688"><a href="#cb194-5688" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">mode_hdi</span>(p_grid_3h1b, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">89</span>, .<span class="dv">97</span>)) </span>
<span id="cb194-5689"><a href="#cb194-5689" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-5690"><a href="#cb194-5690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5691"><a href="#cb194-5691" aria-hidden="true" tabindex="-1"></a>samples_3h2b <span class="sc">|&gt;</span> </span>
<span id="cb194-5692"><a href="#cb194-5692" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> p_grid_3h1b)) <span class="sc">+</span></span>
<span id="cb194-5693"><a href="#cb194-5693" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb194-5694"><a href="#cb194-5694" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> map_3h2b[[<span class="dv">1</span>, <span class="dv">1</span>]], <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5695"><a href="#cb194-5695" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Ratio of boy births&quot;</span>,</span>
<span id="cb194-5696"><a href="#cb194-5696" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">&quot;Samples from the posterior distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5697"><a href="#cb194-5697" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-5698"><a href="#cb194-5698" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-5699"><a href="#cb194-5699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5700"><a href="#cb194-5700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5701"><a href="#cb194-5701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5702"><a href="#cb194-5702" aria-hidden="true" tabindex="-1"></a>The red line is the density mode (<span class="in">`r round(map_3h2b[[1, 1]], 3)`</span>) calculated with <span class="in">`tidybayes::mode_hdi()`</span> and also displayed in the column <span class="in">`p_grid_3h1b`</span>.</span>
<span id="cb194-5703"><a href="#cb194-5703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5704"><a href="#cb194-5704" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5705"><a href="#cb194-5705" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5706"><a href="#cb194-5706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5707"><a href="#cb194-5707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5708"><a href="#cb194-5708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5709"><a href="#cb194-5709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5710"><a href="#cb194-5710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5711"><a href="#cb194-5711" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5712"><a href="#cb194-5712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5713"><a href="#cb194-5713" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5714"><a href="#cb194-5714" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5715"><a href="#cb194-5715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5716"><a href="#cb194-5716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5717"><a href="#cb194-5717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5718"><a href="#cb194-5718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5719"><a href="#cb194-5719" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-5720"><a href="#cb194-5720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5721"><a href="#cb194-5721" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3H3</span></span>
<span id="cb194-5722"><a href="#cb194-5722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5723"><a href="#cb194-5723" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-5724"><a href="#cb194-5724" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-5725"><a href="#cb194-5725" aria-hidden="true" tabindex="-1"></a>Exercise 3H3: Use <span class="in">`rbinom()`</span> to simulate $10,000$ replicates of $200$ births. You should end up with $10,000$ numbers, each one a count of boys out of $200$ births. Compare the distribution of predicted numbers of boys to the actual count in the data ($111$ boys out of $200$ births). There are many good ways to visualize the simulations, but the <span class="in">`dens()`</span>  command (part of the {**rethinking**} package) is probably the easiest way in this case. Does it look like the model fits the data well? That is, does the distribution of predictions include the actual observation as a central, likely outcome?</span>
<span id="cb194-5726"><a href="#cb194-5726" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5727"><a href="#cb194-5727" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-5728"><a href="#cb194-5728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5729"><a href="#cb194-5729" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-5730"><a href="#cb194-5730" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3H3a </span></span>
<span id="cb194-5731"><a href="#cb194-5731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5732"><a href="#cb194-5732" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5733"><a href="#cb194-5733" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5734"><a href="#cb194-5734" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3h3a}</span>
<span id="cb194-5735"><a href="#cb194-5735" aria-hidden="true" tabindex="-1"></a>a: Posterior predictive distribution with 10,000 replicates of 200 births (Original)</span>
<span id="cb194-5736"><a href="#cb194-5736" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5737"><a href="#cb194-5737" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5738"><a href="#cb194-5738" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5739"><a href="#cb194-5739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5740"><a href="#cb194-5740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5741"><a href="#cb194-5741" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5742"><a href="#cb194-5742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5743"><a href="#cb194-5743" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5744"><a href="#cb194-5744" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h3a</span></span>
<span id="cb194-5745"><a href="#cb194-5745" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Create posterior predictive distribution with 10,000 replicates of 200 births (Original)&quot;</span></span>
<span id="cb194-5746"><a href="#cb194-5746" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5747"><a href="#cb194-5747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5748"><a href="#cb194-5748" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-5749"><a href="#cb194-5749" aria-hidden="true" tabindex="-1"></a>dummy_data_3h3a <span class="ot">&lt;-</span>  <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5750"><a href="#cb194-5750" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">200</span>,</span>
<span id="cb194-5751"><a href="#cb194-5751" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2a)</span>
<span id="cb194-5752"><a href="#cb194-5752" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dummy_data_3h3a, <span class="dv">10</span>)</span>
<span id="cb194-5753"><a href="#cb194-5753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5754"><a href="#cb194-5754" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(dummy_data_3h3a, </span>
<span id="cb194-5755"><a href="#cb194-5755" aria-hidden="true" tabindex="-1"></a>                 <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb194-5756"><a href="#cb194-5756" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">sum</span>(birth1 <span class="sc">+</span> birth2), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb194-5757"><a href="#cb194-5757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5758"><a href="#cb194-5758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5759"><a href="#cb194-5759" aria-hidden="true" tabindex="-1"></a>The model appears to fit well, because the observed value of 111 boys is in the middle of the <span class="in">`r glossary(&quot;posterior predictive distribution&quot;)`</span> which has a mean of <span class="in">`r mean(dummy_data_3h3a)`</span> and a median of <span class="in">`r median(dummy_data_3h3a)`</span>.</span>
<span id="cb194-5760"><a href="#cb194-5760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5761"><a href="#cb194-5761" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5762"><a href="#cb194-5762" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5763"><a href="#cb194-5763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5764"><a href="#cb194-5764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5765"><a href="#cb194-5765" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3H3b</span></span>
<span id="cb194-5766"><a href="#cb194-5766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5767"><a href="#cb194-5767" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5768"><a href="#cb194-5768" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5769"><a href="#cb194-5769" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3h3b}</span>
<span id="cb194-5770"><a href="#cb194-5770" aria-hidden="true" tabindex="-1"></a>b: Posterior predictive distribution with 10,000 replicates of 200 births (Tidyverse)</span>
<span id="cb194-5771"><a href="#cb194-5771" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5772"><a href="#cb194-5772" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5773"><a href="#cb194-5773" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5774"><a href="#cb194-5774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5775"><a href="#cb194-5775" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5776"><a href="#cb194-5776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5777"><a href="#cb194-5777" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5778"><a href="#cb194-5778" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h3b</span></span>
<span id="cb194-5779"><a href="#cb194-5779" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Create posterior predictive distribution with 10,000 replicates of 200 births (Tidyverse)&quot;</span></span>
<span id="cb194-5780"><a href="#cb194-5780" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5781"><a href="#cb194-5781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5782"><a href="#cb194-5782" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-5783"><a href="#cb194-5783" aria-hidden="true" tabindex="-1"></a>dummy_data_3h3b <span class="ot">&lt;-</span>  stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5784"><a href="#cb194-5784" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">200</span>,</span>
<span id="cb194-5785"><a href="#cb194-5785" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2b<span class="sc">$</span>p_grid_3h1b</span>
<span id="cb194-5786"><a href="#cb194-5786" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb194-5787"><a href="#cb194-5787" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(dummy_data_3h3b, <span class="dv">10</span>)</span>
<span id="cb194-5788"><a href="#cb194-5788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5789"><a href="#cb194-5789" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb194-5790"><a href="#cb194-5790" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_slabinterval</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> dummy_data_3h3b),</span>
<span id="cb194-5791"><a href="#cb194-5791" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.66</span>, <span class="fl">0.89</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb194-5792"><a href="#cb194-5792" aria-hidden="true" tabindex="-1"></a>                            <span class="at">slab_fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb194-5793"><a href="#cb194-5793" aria-hidden="true" tabindex="-1"></a>                            <span class="at">density =</span> <span class="st">&quot;bounded&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5794"><a href="#cb194-5794" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb194-5795"><a href="#cb194-5795" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> n_boys), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5796"><a href="#cb194-5796" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of Boys&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5797"><a href="#cb194-5797" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-5798"><a href="#cb194-5798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5799"><a href="#cb194-5799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5800"><a href="#cb194-5800" aria-hidden="true" tabindex="-1"></a>I have used the graphic function from the {**ggdist**}</span>
<span id="cb194-5801"><a href="#cb194-5801" aria-hidden="true" tabindex="-1"></a> resp. {**tidybayes**} package. I learned about this familiy of functions from the <span class="co">[</span><span class="ot">solution by Jake Thompson</span><span class="co">](https://sr2-solutions.wjakethompson.com/bayesian-inference#chapter-3)</span>. </span>
<span id="cb194-5802"><a href="#cb194-5802" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb194-5803"><a href="#cb194-5803" aria-hidden="true" tabindex="-1"></a>The model appears to fit well, because the observed value of 111 boys is in the middle of the <span class="in">`r glossary(&quot;posterior predictive distribution&quot;)`</span> which has a mean of <span class="in">`r mean(dummy_data_3h3b)`</span> and a median of <span class="in">`r median(dummy_data_3h3b)`</span>.</span>
<span id="cb194-5804"><a href="#cb194-5804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5805"><a href="#cb194-5805" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5806"><a href="#cb194-5806" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5807"><a href="#cb194-5807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5808"><a href="#cb194-5808" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5809"><a href="#cb194-5809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5810"><a href="#cb194-5810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5811"><a href="#cb194-5811" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5812"><a href="#cb194-5812" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5813"><a href="#cb194-5813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5814"><a href="#cb194-5814" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-5815"><a href="#cb194-5815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5816"><a href="#cb194-5816" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3H4</span></span>
<span id="cb194-5817"><a href="#cb194-5817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5818"><a href="#cb194-5818" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-5819"><a href="#cb194-5819" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-5820"><a href="#cb194-5820" aria-hidden="true" tabindex="-1"></a>Exercise 3H4: Now compare $10,000$ counts of boys from $100$ simulated first borns only to the number of boys in the first births, <span class="in">`birth1`</span>. How does the model look in this light?</span>
<span id="cb194-5821"><a href="#cb194-5821" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5822"><a href="#cb194-5822" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-5823"><a href="#cb194-5823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5824"><a href="#cb194-5824" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-5825"><a href="#cb194-5825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5826"><a href="#cb194-5826" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3H4a</span></span>
<span id="cb194-5827"><a href="#cb194-5827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5828"><a href="#cb194-5828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5829"><a href="#cb194-5829" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5830"><a href="#cb194-5830" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5831"><a href="#cb194-5831" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3h4a}</span>
<span id="cb194-5832"><a href="#cb194-5832" aria-hidden="true" tabindex="-1"></a>a: Compare $10,000$ counts of boys from $100$ simulated first borns (Original)</span>
<span id="cb194-5833"><a href="#cb194-5833" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5834"><a href="#cb194-5834" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5835"><a href="#cb194-5835" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5836"><a href="#cb194-5836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5837"><a href="#cb194-5837" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5838"><a href="#cb194-5838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5839"><a href="#cb194-5839" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5840"><a href="#cb194-5840" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h4a</span></span>
<span id="cb194-5841"><a href="#cb194-5841" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Compare 10,000 counts of boys from 100 simulated first borns (Original)&quot;</span></span>
<span id="cb194-5842"><a href="#cb194-5842" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5843"><a href="#cb194-5843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5844"><a href="#cb194-5844" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-5845"><a href="#cb194-5845" aria-hidden="true" tabindex="-1"></a>dummy_data_3h4a <span class="ot">&lt;-</span>  <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5846"><a href="#cb194-5846" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">100</span>,</span>
<span id="cb194-5847"><a href="#cb194-5847" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2a)</span>
<span id="cb194-5848"><a href="#cb194-5848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5849"><a href="#cb194-5849" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(dummy_data_3h4a, <span class="dv">10</span>)</span>
<span id="cb194-5850"><a href="#cb194-5850" aria-hidden="true" tabindex="-1"></a>map_3h4a <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">chainmode</span>(dummy_data_3h4a, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb194-5851"><a href="#cb194-5851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5852"><a href="#cb194-5852" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(dummy_data_3h4a, <span class="at">adj =</span> <span class="fl">0.7</span>)</span>
<span id="cb194-5853"><a href="#cb194-5853" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">sum</span>(birth1), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb194-5854"><a href="#cb194-5854" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> map_3h4a, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb194-5855"><a href="#cb194-5855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5856"><a href="#cb194-5856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5857"><a href="#cb194-5857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5858"><a href="#cb194-5858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5859"><a href="#cb194-5859" aria-hidden="true" tabindex="-1"></a>Observed first born boys: <span class="in">`r sum(birth1)`</span></span>
<span id="cb194-5860"><a href="#cb194-5860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5861"><a href="#cb194-5861" aria-hidden="true" tabindex="-1"></a>Simulation of first born boys:</span>
<span id="cb194-5862"><a href="#cb194-5862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5863"><a href="#cb194-5863" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mean: <span class="in">`r mean(dummy_data_3h4a)`</span></span>
<span id="cb194-5864"><a href="#cb194-5864" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Median: <span class="in">`r median(dummy_data_3h4a)`</span></span>
<span id="cb194-5865"><a href="#cb194-5865" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mode: <span class="in">`r round(map_3h4a, 3)`</span></span>
<span id="cb194-5866"><a href="#cb194-5866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5867"><a href="#cb194-5867" aria-hidden="true" tabindex="-1"></a>With the <span class="in">`r glossary(&quot;posterior predictive distribution&quot;)`</span> for the first born boys the model does not appears to fit well, because the observed value of <span class="in">`r sum(birth1)`</span> boys (blue line) is not in the middle of the distribution.</span>
<span id="cb194-5868"><a href="#cb194-5868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5869"><a href="#cb194-5869" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5870"><a href="#cb194-5870" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5871"><a href="#cb194-5871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5872"><a href="#cb194-5872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5873"><a href="#cb194-5873" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3H4b</span></span>
<span id="cb194-5874"><a href="#cb194-5874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5875"><a href="#cb194-5875" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb194-5876"><a href="#cb194-5876" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb194-5877"><a href="#cb194-5877" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-3h4b}</span>
<span id="cb194-5878"><a href="#cb194-5878" aria-hidden="true" tabindex="-1"></a>b: Compare $10,000$ counts of boys from $100$ simulated first borns (Tidyverse)</span>
<span id="cb194-5879"><a href="#cb194-5879" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb194-5880"><a href="#cb194-5880" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5881"><a href="#cb194-5881" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb194-5882"><a href="#cb194-5882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5883"><a href="#cb194-5883" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5884"><a href="#cb194-5884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5885"><a href="#cb194-5885" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5886"><a href="#cb194-5886" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h4b</span></span>
<span id="cb194-5887"><a href="#cb194-5887" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Compare 10,000 counts of boys from 100 simulated first borns (Tidyverse)&quot;</span></span>
<span id="cb194-5888"><a href="#cb194-5888" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5889"><a href="#cb194-5889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5890"><a href="#cb194-5890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5891"><a href="#cb194-5891" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-5892"><a href="#cb194-5892" aria-hidden="true" tabindex="-1"></a>dummy_data_3h4b <span class="ot">&lt;-</span>  stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5893"><a href="#cb194-5893" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">100</span>,</span>
<span id="cb194-5894"><a href="#cb194-5894" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2b<span class="sc">$</span>p_grid_3h1b</span>
<span id="cb194-5895"><a href="#cb194-5895" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb194-5896"><a href="#cb194-5896" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(dummy_data_3h4b, <span class="dv">10</span>)</span>
<span id="cb194-5897"><a href="#cb194-5897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5898"><a href="#cb194-5898" aria-hidden="true" tabindex="-1"></a>map_3h4b <span class="ot">&lt;-</span> tidybayes<span class="sc">::</span><span class="fu">Mode</span>(dummy_data_3h4b)</span>
<span id="cb194-5899"><a href="#cb194-5899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5900"><a href="#cb194-5900" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb194-5901"><a href="#cb194-5901" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_slabinterval</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> dummy_data_3h4b),</span>
<span id="cb194-5902"><a href="#cb194-5902" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.66</span>, <span class="fl">0.89</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb194-5903"><a href="#cb194-5903" aria-hidden="true" tabindex="-1"></a>                            <span class="at">slab_fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb194-5904"><a href="#cb194-5904" aria-hidden="true" tabindex="-1"></a>                            <span class="at">density =</span> <span class="st">&quot;bounded&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5905"><a href="#cb194-5905" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb194-5906"><a href="#cb194-5906" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">sum</span>(birth1)), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5907"><a href="#cb194-5907" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb194-5908"><a href="#cb194-5908" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> map_3h4b), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5909"><a href="#cb194-5909" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of 1st born boys&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-5910"><a href="#cb194-5910" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-5911"><a href="#cb194-5911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5912"><a href="#cb194-5912" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5913"><a href="#cb194-5913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5914"><a href="#cb194-5914" aria-hidden="true" tabindex="-1"></a>Observed first born boys: <span class="in">`r sum(birth1)`</span></span>
<span id="cb194-5915"><a href="#cb194-5915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5916"><a href="#cb194-5916" aria-hidden="true" tabindex="-1"></a>Simulation of first born boys:</span>
<span id="cb194-5917"><a href="#cb194-5917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5918"><a href="#cb194-5918" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mean: <span class="in">`r mean(dummy_data_3h4b)`</span></span>
<span id="cb194-5919"><a href="#cb194-5919" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Median: <span class="in">`r median(dummy_data_3h4b)`</span></span>
<span id="cb194-5920"><a href="#cb194-5920" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mode: <span class="in">`r round(map_3h4b, 3)`</span></span>
<span id="cb194-5921"><a href="#cb194-5921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5922"><a href="#cb194-5922" aria-hidden="true" tabindex="-1"></a>With the <span class="in">`r glossary(&quot;posterior predictive distribution&quot;)`</span> for the first born boys the model does not appears so well as for all boys in @cnj-3h3b, because the observed value of <span class="in">`r sum(birth1)`</span> boys (blue line) is not in the middle of the distribution. However, it does not appear to be a large discrepancy, as the observed value is still within the middle 66% interval.</span>
<span id="cb194-5923"><a href="#cb194-5923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5924"><a href="#cb194-5924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5925"><a href="#cb194-5925" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5926"><a href="#cb194-5926" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5927"><a href="#cb194-5927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5928"><a href="#cb194-5928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5929"><a href="#cb194-5929" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5930"><a href="#cb194-5930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5931"><a href="#cb194-5931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5932"><a href="#cb194-5932" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-5933"><a href="#cb194-5933" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-5934"><a href="#cb194-5934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5935"><a href="#cb194-5935" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb194-5936"><a href="#cb194-5936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5937"><a href="#cb194-5937" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3H5</span></span>
<span id="cb194-5938"><a href="#cb194-5938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5939"><a href="#cb194-5939" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb194-5940"><a href="#cb194-5940" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb194-5941"><a href="#cb194-5941" aria-hidden="true" tabindex="-1"></a>Exercise 3H5: The model assumes that sex of first and second births are independent. To check this assumption, focus now on second births that followed female first borns. Compare 10,000 simulated counts of boys to only those second births that followed girls. To do this correctly, you need to count the number of first borns who were girls and simulate that many births, 10,000 times. Compare the counts of boys in your simulations to the actual observed count of boys following girls. How does the model look in this light? Any guesses what is going on in these data?</span>
<span id="cb194-5942"><a href="#cb194-5942" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-5943"><a href="#cb194-5943" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb194-5944"><a href="#cb194-5944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5945"><a href="#cb194-5945" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb194-5946"><a href="#cb194-5946" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3H5a</span></span>
<span id="cb194-5947"><a href="#cb194-5947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5948"><a href="#cb194-5948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5949"><a href="#cb194-5949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5950"><a href="#cb194-5950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5951"><a href="#cb194-5951" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5952"><a href="#cb194-5952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5953"><a href="#cb194-5953" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5954"><a href="#cb194-5954" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h5a</span></span>
<span id="cb194-5955"><a href="#cb194-5955" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Second births of boys that followed female first borns (Original)&quot;</span></span>
<span id="cb194-5956"><a href="#cb194-5956" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5957"><a href="#cb194-5957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5958"><a href="#cb194-5958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5959"><a href="#cb194-5959" aria-hidden="true" tabindex="-1"></a>df_birth_3h5a <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(birth1, birth2))</span>
<span id="cb194-5960"><a href="#cb194-5960" aria-hidden="true" tabindex="-1"></a>df_birth_3h5a <span class="ot">&lt;-</span> <span class="fu">subset</span>(df_birth_3h5a, birth1 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb194-5961"><a href="#cb194-5961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5962"><a href="#cb194-5962" aria-hidden="true" tabindex="-1"></a>n_1st_girls_3h5a <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fu">sum</span>(birth1)</span>
<span id="cb194-5963"><a href="#cb194-5963" aria-hidden="true" tabindex="-1"></a>n_2nd_boys_3h5a <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_birth_3h5a<span class="sc">$</span>birth1) <span class="sc">+</span> <span class="fu">sum</span>(df_birth_3h5a<span class="sc">$</span>birth2)</span>
<span id="cb194-5964"><a href="#cb194-5964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5965"><a href="#cb194-5965" aria-hidden="true" tabindex="-1"></a>p_grid_3h5a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>,</span>
<span id="cb194-5966"><a href="#cb194-5966" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="dv">1</span>,</span>
<span id="cb194-5967"><a href="#cb194-5967" aria-hidden="true" tabindex="-1"></a>                   <span class="at">length.out =</span> <span class="fl">1e3</span>)</span>
<span id="cb194-5968"><a href="#cb194-5968" aria-hidden="true" tabindex="-1"></a>prior_3h5a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="fl">1e3</span>)</span>
<span id="cb194-5969"><a href="#cb194-5969" aria-hidden="true" tabindex="-1"></a>likelihood_3h5a <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> n_2nd_boys_3h5a,</span>
<span id="cb194-5970"><a href="#cb194-5970" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> n_1st_girls_3h5a,</span>
<span id="cb194-5971"><a href="#cb194-5971" aria-hidden="true" tabindex="-1"></a>                              <span class="at">prob =</span> p_grid_3h5a)</span>
<span id="cb194-5972"><a href="#cb194-5972" aria-hidden="true" tabindex="-1"></a>posterior_3h5a <span class="ot">&lt;-</span>  prior_3h5a <span class="sc">*</span> likelihood_3h5a</span>
<span id="cb194-5973"><a href="#cb194-5973" aria-hidden="true" tabindex="-1"></a>posterior_std_3h5a <span class="ot">&lt;-</span> posterior_3h5a <span class="sc">/</span> <span class="fu">sum</span>(posterior_3h5a)</span>
<span id="cb194-5974"><a href="#cb194-5974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5975"><a href="#cb194-5975" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-5976"><a href="#cb194-5976" aria-hidden="true" tabindex="-1"></a>dummy_data_3h5a <span class="ot">&lt;-</span>  <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,</span>
<span id="cb194-5977"><a href="#cb194-5977" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> n_1st_girls_3h5a,</span>
<span id="cb194-5978"><a href="#cb194-5978" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> samples_3h2a)</span>
<span id="cb194-5979"><a href="#cb194-5979" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">dens</span>(dummy_data_3h5a, </span>
<span id="cb194-5980"><a href="#cb194-5980" aria-hidden="true" tabindex="-1"></a>                 <span class="at">adj =</span> <span class="dv">1</span>,</span>
<span id="cb194-5981"><a href="#cb194-5981" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlab =</span> <span class="st">&quot;Number of 2nd born boys that follow a 1st born girl&quot;</span>)</span>
<span id="cb194-5982"><a href="#cb194-5982" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> n_2nd_boys_3h5a, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb194-5983"><a href="#cb194-5983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5984"><a href="#cb194-5984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5985"><a href="#cb194-5985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-5986"><a href="#cb194-5986" aria-hidden="true" tabindex="-1"></a>The model predicts <span class="in">`r round(mean(dummy_data_3h5a), 0)`</span> 2nd born boys that follow a 1st born girl. But we have observed <span class="in">`r n_2nd_boys_3h5a`</span> boys. Our model underestimates the number of 2nd born boys so that our assumption that births are independent must be challenged.</span>
<span id="cb194-5987"><a href="#cb194-5987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5988"><a href="#cb194-5988" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3H5b</span></span>
<span id="cb194-5989"><a href="#cb194-5989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5990"><a href="#cb194-5990" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-5991"><a href="#cb194-5991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5992"><a href="#cb194-5992" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-5993"><a href="#cb194-5993" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exercise-3h5b</span></span>
<span id="cb194-5994"><a href="#cb194-5994" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Second births of boys that followed female first borns (Tidyverse)&quot;</span></span>
<span id="cb194-5995"><a href="#cb194-5995" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb194-5996"><a href="#cb194-5996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5997"><a href="#cb194-5997" aria-hidden="true" tabindex="-1"></a>n_1st_girls_3h5b <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fu">sum</span>(birth1)</span>
<span id="cb194-5998"><a href="#cb194-5998" aria-hidden="true" tabindex="-1"></a>n_2nd_boys_3h5b <span class="ot">&lt;-</span> <span class="fu">sum</span>(birth2[<span class="fu">which</span>(birth1 <span class="sc">==</span> <span class="dv">0</span>)])</span>
<span id="cb194-5999"><a href="#cb194-5999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6000"><a href="#cb194-6000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6001"><a href="#cb194-6001" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb194-6002"><a href="#cb194-6002" aria-hidden="true" tabindex="-1"></a>dummy_data_3h5b <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size =</span> n_1st_girls_3h5b, </span>
<span id="cb194-6003"><a href="#cb194-6003" aria-hidden="true" tabindex="-1"></a>            <span class="at">prob =</span> samples_3h2b<span class="sc">$</span>p_grid_3h1b)</span>
<span id="cb194-6004"><a href="#cb194-6004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6005"><a href="#cb194-6005" aria-hidden="true" tabindex="-1"></a>map_3h5b <span class="ot">&lt;-</span>  tidybayes<span class="sc">::</span><span class="fu">Mode</span>(dummy_data_3h5b)</span>
<span id="cb194-6006"><a href="#cb194-6006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6007"><a href="#cb194-6007" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb194-6008"><a href="#cb194-6008" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_slabinterval</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> dummy_data_3h5b),</span>
<span id="cb194-6009"><a href="#cb194-6009" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.66</span>, <span class="fl">0.89</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb194-6010"><a href="#cb194-6010" aria-hidden="true" tabindex="-1"></a>                            <span class="at">slab_fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb194-6011"><a href="#cb194-6011" aria-hidden="true" tabindex="-1"></a>                            <span class="at">density =</span> <span class="st">&quot;bounded&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-6012"><a href="#cb194-6012" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb194-6013"><a href="#cb194-6013" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> n_2nd_boys_3h5b), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-6014"><a href="#cb194-6014" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb194-6015"><a href="#cb194-6015" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xintercept =</span> map_3h5b), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-6016"><a href="#cb194-6016" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of 2nd born boys that follow a 1st born girl&quot;</span>, </span>
<span id="cb194-6017"><a href="#cb194-6017" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-6018"><a href="#cb194-6018" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb194-6019"><a href="#cb194-6019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb194-6020"><a href="#cb194-6020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6021"><a href="#cb194-6021" aria-hidden="true" tabindex="-1"></a>The model predicts <span class="in">`r round(mean(dummy_data_3h5b), 0)`</span> 2nd born boys that follow a 1st born girl. But we have observed <span class="in">`r n_2nd_boys_3h5b`</span> boys. Our model underestimates the number of 2nd born boys so that our assumption that births are independent appears to be violated. We have generally more 2nd born boys (<span class="in">`r sum(birth2)`</span>% versus <span class="in">`r sum(birth1)`</span>%) but especially more 2nd born boys when the first born was a girl (<span class="in">`r round((n_2nd_boys_3h5b / n_1st_girls_3h5b * 100), 2)`</span>%).</span>
<span id="cb194-6022"><a href="#cb194-6022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6023"><a href="#cb194-6023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6024"><a href="#cb194-6024" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb194-6025"><a href="#cb194-6025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6026"><a href="#cb194-6026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6027"><a href="#cb194-6027" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb194-6028"><a href="#cb194-6028" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb194-6029"><a href="#cb194-6029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6030"><a href="#cb194-6030" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session info</span></span>
<span id="cb194-6031"><a href="#cb194-6031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6032"><a href="#cb194-6032" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb194-6033"><a href="#cb194-6033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6034"><a href="#cb194-6034" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb194-6035"><a href="#cb194-6035" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: session-info</span></span>
<span id="cb194-6036"><a href="#cb194-6036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6037"><a href="#cb194-6037" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">sessionInfo</span>()</span>
<span id="cb194-6038"><a href="#cb194-6038" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-kurt2019" class="csl-entry" role="listitem">
Kurt, Will. 2019. <em>Bayesian Statistics the Fun Way: Understanding Statistics and Probability with Star Wars, LEGO, and Rubber Ducks</em>. Illustrated Edition. San Francisco: No Starch Press.
</div>
</div>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a  href="/02-small-and-large-worlds.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>Small and Large Worlds</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a  href="/04-geocentric-models.html" class="pagination-link">
        <span class="nav-page-text"><span class='chapter-number'>4</span>  <span class='chapter-title'>Geocentric Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->

</body>

</html>
